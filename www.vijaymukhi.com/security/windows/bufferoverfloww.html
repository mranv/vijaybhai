<html xmlns:v="urn:schemas-microsoft-com:vml"
xmlns:o="urn:schemas-microsoft-com:office:office"
xmlns:w="urn:schemas-microsoft-com:office:word"
xmlns="http://www.w3.org/TR/REC-html40">


<!-- Mirrored from www.vijaymukhi.com/security/windows/bufferoverfloww.htm by HTTrack Website Copier/3.x [XR&CO'2014], Fri, 11 Oct 2024 14:39:49 GMT -->
<head>
<meta http-equiv=Content-Type content="text/html; charset=windows-1252">
<meta name=ProgId content=Word.Document>
<meta name=Generator content="Microsoft Word 9">
<meta name=Originator content="Microsoft Word 9">
<link rel=File-List href="bufferoverfloww_files/filelist.xml">
<link rel=Edit-Time-Data href="bufferoverfloww_files/editdata.html">
<!--[if !mso]>
<style>
v\:* {behavior:url(#default#VML);}
o\:* {behavior:url(#default#VML);}
w\:* {behavior:url(#default#VML);}
.shape {behavior:url(#default#VML);}
</style>
<![endif]-->
<title>Buffer Overflow Windows</title>
<!--[if gte mso 9]><xml>
 <o:DocumentProperties>
  <o:Author>Mr. Vijay Mukhi</o:Author>
  <o:LastAuthor>Mr. Vijay Mukhi</o:LastAuthor>
  <o:Revision>14</o:Revision>
  <o:TotalTime>13</o:TotalTime>
  <o:LastPrinted>2003-11-06T05:45:00Z</o:LastPrinted>
  <o:Created>2004-06-07T12:33:00Z</o:Created>
  <o:LastSaved>2004-03-29T11:46:00Z</o:LastSaved>
  <o:Pages>43</o:Pages>
  <o:Words>8003</o:Words>
  <o:Characters>45618</o:Characters>
  <o:Company>VMCI</o:Company>
  <o:Lines>380</o:Lines>
  <o:Paragraphs>91</o:Paragraphs>
  <o:CharactersWithSpaces>56022</o:CharactersWithSpaces>
  <o:Version>9.2720</o:Version>
 </o:DocumentProperties>
</xml><![endif]--><!--[if gte mso 9]><xml>
 <w:WordDocument>
  <w:ActiveWritingStyle Lang="EN-US" VendorID="64" DLLVersion="131077"
   NLCheck="1">3</w:ActiveWritingStyle>
 </w:WordDocument>
</xml><![endif]-->
<style>
<!--
 /* Font Definitions */
@font-face
	{font-family:"MS Mincho";
	panose-1:0 0 0 0 0 0 0 0 0 0;
	mso-font-alt:"\FF2D\FF33 \660E\671D";
	mso-font-charset:128;
	mso-generic-font-family:roman;
	mso-font-format:other;
	mso-font-pitch:fixed;
	mso-font-signature:1 134676480 16 0 131072 0;}
@font-face
	{font-family:Tahoma;
	panose-1:2 11 6 4 3 5 4 4 2 4;
	mso-font-charset:0;
	mso-generic-font-family:swiss;
	mso-font-pitch:variable;
	mso-font-signature:553679495 -2147483648 8 0 66047 0;}
@font-face
	{font-family:"Trebuchet MS";
	panose-1:2 11 6 3 2 2 2 2 2 4;
	mso-font-charset:0;
	mso-generic-font-family:swiss;
	mso-font-pitch:variable;
	mso-font-signature:7 0 0 0 19 0;}
@font-face
	{font-family:"\@MS Mincho";
	panose-1:0 0 0 0 0 0 0 0 0 0;
	mso-font-charset:128;
	mso-generic-font-family:roman;
	mso-font-format:other;
	mso-font-pitch:fixed;
	mso-font-signature:1 134676480 16 0 131072 0;}
 /* Style Definitions */
p.MsoNormal, li.MsoNormal, div.MsoNormal
	{mso-style-parent:"";
	margin:0in;
	margin-bottom:.0001pt;
	mso-pagination:widow-orphan;
	font-size:12.0pt;
	font-family:"Times New Roman";
	mso-fareast-font-family:"Times New Roman";}
h1
	{mso-style-next:Normal;
	margin:0in;
	margin-bottom:.0001pt;
	text-align:justify;
	mso-pagination:widow-orphan;
	page-break-after:avoid;
	mso-outline-level:1;
	font-size:10.0pt;
	mso-bidi-font-size:12.0pt;
	font-family:"Trebuchet MS";
	mso-font-kerning:0pt;
	font-weight:normal;
	text-decoration:underline;
	text-underline:single;}
h2
	{mso-style-next:Normal;
	margin-top:12.0pt;
	margin-right:0in;
	margin-bottom:3.0pt;
	margin-left:0in;
	mso-pagination:widow-orphan;
	page-break-after:avoid;
	mso-outline-level:2;
	font-size:14.0pt;
	font-family:Arial;
	font-style:italic;}
h3
	{mso-style-next:Normal;
	margin-top:12.0pt;
	margin-right:0in;
	margin-bottom:3.0pt;
	margin-left:0in;
	mso-pagination:widow-orphan;
	page-break-after:avoid;
	mso-outline-level:3;
	font-size:13.0pt;
	font-family:Arial;}
h4
	{mso-style-next:Normal;
	margin-top:12.0pt;
	margin-right:0in;
	margin-bottom:3.0pt;
	margin-left:0in;
	mso-pagination:widow-orphan;
	page-break-after:avoid;
	mso-outline-level:4;
	font-size:14.0pt;
	font-family:"Times New Roman";}
h5
	{mso-style-next:Normal;
	margin-top:12.0pt;
	margin-right:0in;
	margin-bottom:3.0pt;
	margin-left:0in;
	mso-pagination:widow-orphan;
	mso-outline-level:5;
	font-size:13.0pt;
	font-family:"Times New Roman";
	font-style:italic;}
h6
	{mso-style-next:Normal;
	margin-top:12.0pt;
	margin-right:0in;
	margin-bottom:3.0pt;
	margin-left:0in;
	mso-pagination:widow-orphan;
	mso-outline-level:6;
	font-size:11.0pt;
	font-family:"Times New Roman";}
p.MsoHeading7, li.MsoHeading7, div.MsoHeading7
	{mso-style-next:Normal;
	margin-top:12.0pt;
	margin-right:0in;
	margin-bottom:3.0pt;
	margin-left:0in;
	mso-pagination:widow-orphan;
	mso-outline-level:7;
	font-size:12.0pt;
	font-family:"Times New Roman";
	mso-fareast-font-family:"Times New Roman";}
p.MsoHeading8, li.MsoHeading8, div.MsoHeading8
	{mso-style-next:Normal;
	margin-top:12.0pt;
	margin-right:0in;
	margin-bottom:3.0pt;
	margin-left:0in;
	mso-pagination:widow-orphan;
	mso-outline-level:8;
	font-size:12.0pt;
	font-family:"Times New Roman";
	mso-fareast-font-family:"Times New Roman";
	font-style:italic;}
p.MsoHeading9, li.MsoHeading9, div.MsoHeading9
	{mso-style-next:Normal;
	margin-top:12.0pt;
	margin-right:0in;
	margin-bottom:3.0pt;
	margin-left:0in;
	mso-pagination:widow-orphan;
	mso-outline-level:9;
	font-size:11.0pt;
	font-family:Arial;
	mso-fareast-font-family:"Times New Roman";}
p.MsoToc1, li.MsoToc1, div.MsoToc1
	{mso-style-update:auto;
	mso-style-next:Normal;
	margin-top:12.0pt;
	margin-right:0in;
	margin-bottom:6.0pt;
	margin-left:0in;
	mso-pagination:widow-orphan;
	font-size:12.0pt;
	font-family:"Times New Roman";
	mso-fareast-font-family:"Times New Roman";
	font-weight:bold;}
p.MsoToc2, li.MsoToc2, div.MsoToc2
	{mso-style-update:auto;
	mso-style-next:Normal;
	margin-top:6.0pt;
	margin-right:0in;
	margin-bottom:0in;
	margin-left:12.0pt;
	margin-bottom:.0001pt;
	mso-pagination:widow-orphan;
	font-size:12.0pt;
	font-family:"Times New Roman";
	mso-fareast-font-family:"Times New Roman";
	font-style:italic;}
p.MsoToc3, li.MsoToc3, div.MsoToc3
	{mso-style-update:auto;
	mso-style-next:Normal;
	margin-top:0in;
	margin-right:0in;
	margin-bottom:0in;
	margin-left:24.0pt;
	margin-bottom:.0001pt;
	mso-pagination:widow-orphan;
	font-size:12.0pt;
	font-family:"Times New Roman";
	mso-fareast-font-family:"Times New Roman";}
p.MsoToc4, li.MsoToc4, div.MsoToc4
	{mso-style-update:auto;
	mso-style-next:Normal;
	margin-top:0in;
	margin-right:0in;
	margin-bottom:0in;
	margin-left:.5in;
	margin-bottom:.0001pt;
	mso-pagination:widow-orphan;
	font-size:12.0pt;
	font-family:"Times New Roman";
	mso-fareast-font-family:"Times New Roman";}
p.MsoToc5, li.MsoToc5, div.MsoToc5
	{mso-style-update:auto;
	mso-style-next:Normal;
	margin-top:0in;
	margin-right:0in;
	margin-bottom:0in;
	margin-left:48.0pt;
	margin-bottom:.0001pt;
	mso-pagination:widow-orphan;
	font-size:12.0pt;
	font-family:"Times New Roman";
	mso-fareast-font-family:"Times New Roman";}
p.MsoToc6, li.MsoToc6, div.MsoToc6
	{mso-style-update:auto;
	mso-style-next:Normal;
	margin-top:0in;
	margin-right:0in;
	margin-bottom:0in;
	margin-left:60.0pt;
	margin-bottom:.0001pt;
	mso-pagination:widow-orphan;
	font-size:12.0pt;
	font-family:"Times New Roman";
	mso-fareast-font-family:"Times New Roman";}
p.MsoToc7, li.MsoToc7, div.MsoToc7
	{mso-style-update:auto;
	mso-style-next:Normal;
	margin-top:0in;
	margin-right:0in;
	margin-bottom:0in;
	margin-left:1.0in;
	margin-bottom:.0001pt;
	mso-pagination:widow-orphan;
	font-size:12.0pt;
	font-family:"Times New Roman";
	mso-fareast-font-family:"Times New Roman";}
p.MsoToc8, li.MsoToc8, div.MsoToc8
	{mso-style-update:auto;
	mso-style-next:Normal;
	margin-top:0in;
	margin-right:0in;
	margin-bottom:0in;
	margin-left:84.0pt;
	margin-bottom:.0001pt;
	mso-pagination:widow-orphan;
	font-size:12.0pt;
	font-family:"Times New Roman";
	mso-fareast-font-family:"Times New Roman";}
p.MsoToc9, li.MsoToc9, div.MsoToc9
	{mso-style-update:auto;
	mso-style-next:Normal;
	margin-top:0in;
	margin-right:0in;
	margin-bottom:0in;
	margin-left:96.0pt;
	margin-bottom:.0001pt;
	mso-pagination:widow-orphan;
	font-size:12.0pt;
	font-family:"Times New Roman";
	mso-fareast-font-family:"Times New Roman";}
p.MsoFooter, li.MsoFooter, div.MsoFooter
	{margin:0in;
	margin-bottom:.0001pt;
	mso-pagination:widow-orphan;
	tab-stops:center 3.0in right 6.0in;
	font-size:12.0pt;
	font-family:"Times New Roman";
	mso-fareast-font-family:"Times New Roman";}
p.MsoListBullet, li.MsoListBullet, div.MsoListBullet
	{mso-style-update:auto;
	margin-top:0in;
	margin-right:0in;
	margin-bottom:0in;
	margin-left:.25in;
	margin-bottom:.0001pt;
	text-indent:-.25in;
	mso-pagination:widow-orphan;
	mso-list:l0 level1 lfo3;
	tab-stops:list .25in;
	font-size:12.0pt;
	font-family:"Times New Roman";
	mso-fareast-font-family:"Times New Roman";}
p.MsoBodyText, li.MsoBodyText, div.MsoBodyText
	{margin:0in;
	margin-bottom:.0001pt;
	text-align:justify;
	mso-pagination:widow-orphan;
	font-size:12.0pt;
	mso-bidi-font-size:10.0pt;
	font-family:Tahoma;
	mso-fareast-font-family:"Times New Roman";}
p.MsoBodyText2, li.MsoBodyText2, div.MsoBodyText2
	{margin:0in;
	margin-bottom:.0001pt;
	text-align:justify;
	mso-pagination:widow-orphan;
	font-size:10.0pt;
	mso-bidi-font-size:12.0pt;
	font-family:"Trebuchet MS";
	mso-fareast-font-family:"Times New Roman";
	mso-bidi-font-family:"Times New Roman";
	color:#000066;}
a:link, span.MsoHyperlink
	{color:blue;
	text-decoration:underline;
	text-underline:single;}
a:visited, span.MsoHyperlinkFollowed
	{color:purple;
	text-decoration:underline;
	text-underline:single;}
p.MsoPlainText, li.MsoPlainText, div.MsoPlainText
	{margin:0in;
	margin-bottom:.0001pt;
	mso-pagination:widow-orphan;
	font-size:10.0pt;
	font-family:"Courier New";
	mso-fareast-font-family:"Times New Roman";}
@page Section1
	{size:8.5in 11.0in;
	margin:1.0in 1.25in 1.0in 1.25in;
	mso-header-margin:.5in;
	mso-footer-margin:.5in;
	mso-page-numbers:123;
	mso-even-footer:url("bufferoverfloww_files/header.html") ef1;
	mso-footer:url("bufferoverfloww_files/header.html") f1;
	mso-paper-source:0;}
div.Section1
	{page:Section1;}
 /* List Definitions */
@list l0
	{mso-list-id:-119;
	mso-list-type:simple;
	mso-list-template-ids:514123800;}
@list l0:level1
	{mso-level-number-format:bullet;
	mso-level-style-link:"List Bullet";
	mso-level-text:\F0B7;
	mso-level-tab-stop:.25in;
	mso-level-number-position:left;
	margin-left:.25in;
	text-indent:-.25in;
	font-family:Symbol;}
ol
	{margin-bottom:0in;}
ul
	{margin-bottom:0in;}
-->
</style>
<!--[if gte mso 9]><xml>
 <o:shapedefaults v:ext="edit" spidmax="1337">
  <o:colormru v:ext="edit" colors="#fafaff"/>
  <o:colormenu v:ext="edit" fillcolor="#fafaff"/>
 </o:shapedefaults></xml><![endif]--><!--[if gte mso 9]><xml>
 <o:shapelayout v:ext="edit">
  <o:idmap v:ext="edit" data="1"/>
 </o:shapelayout></xml><![endif]-->
</head>

<body bgcolor="#fafaff" lang=EN-US link=blue vlink=purple style='tab-interval:
.5in'>

<div class=Section1>

<table border=1 cellspacing=0 cellpadding=0 width="99%" bgcolor="#eeeeff"
 style='width:99.54%;background:#EEEEFF;border-collapse:collapse;border:none;
 mso-border-alt:solid windowtext .5pt;mso-padding-alt:0in 5.4pt 0in 5.4pt'>
 <tr style='height:15.1pt'>
  <td width="100%" valign=top style='width:100.0%;border:solid windowtext .5pt;
  padding:0in 5.4pt 0in 5.4pt;height:15.1pt'>
  <h6 align=center style='margin:0in;margin-bottom:.0001pt;text-align:center;
  page-break-after:avoid'><a name="_Toc60579148"><span style='mso-bidi-font-size:
  10.0pt;color:#000066;mso-text-raise:3.0pt;letter-spacing:1.0pt'>Buffer
  Overflow - Windows</span></a><a name="_top"></a><span style='mso-bookmark:
  _Toc60579148'><sup><o:p></o:p></sup></span></h6>
  </td>
  <span style='mso-bookmark:_Toc60579148'></span>
 </tr>
</table>

<p class=MsoNormal><span style='mso-bookmark:_Toc60579148'><sup><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></sup></span></p>

<span style='mso-bookmark:_Toc60579148'></span>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.0pt;
font-family:"Trebuchet MS";mso-bidi-font-family:Arial;color:#000066'>Security
is one of the fastest-growing areas in information technology management.
Denial Of Service, Buffer Overflows, Email viruses etc have become general
terms in today’s info world. There may not be a single computer user world over
who has not been hit by these and many more attacks. Therefore, recently a lot
of emphasis is laid on securing the computer systems from intruders and viruses
as the effects of these attacks can be so drastic and thus irreparable. <o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.0pt;
font-family:"Trebuchet MS";mso-bidi-font-family:Arial;color:#000066'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.0pt;
font-family:"Trebuchet MS";mso-bidi-font-family:Arial;color:#000066'>In our
papers, we will look at demystifying these grave attacks, from the coder’s
point of view. Our belief is that to understand these attacks, one needs to be
in the shoes of the hackers/crackers. And mind you, every hacker/cracker is a
born programmer. <o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.0pt;
mso-bidi-font-size:12.0pt;font-family:"Trebuchet MS";color:#000066'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.0pt;
mso-bidi-font-size:12.0pt;font-family:"Trebuchet MS";color:#000066'>This book
assumes that you have gained some knowledge of the C programming language. In
the process, we will re-revise some basic concepts and simultaneously learn
assembler too. <o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.0pt;
mso-bidi-font-size:12.0pt;font-family:"Trebuchet MS";color:#000066'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.0pt;
mso-bidi-font-size:12.0pt;font-family:"Trebuchet MS";color:#000066'>We can go
on and on but we’d rather take a break and start hacking. <o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.0pt;
mso-bidi-font-size:12.0pt;font-family:"Trebuchet MS";color:#000066'><span
style="mso-spacerun: yes"> </span><o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.0pt;
mso-bidi-font-size:12.0pt;font-family:"Trebuchet MS";color:#000066'>We start
our journey with the vulnerability of buffer overflow<o:p></o:p></span></p>

<p class=MsoNormal style='margin-top:.75pt;margin-right:.75pt;margin-bottom:
0in;margin-left:0in;margin-bottom:.0001pt;text-align:justify'><span
style='font-size:10.0pt;mso-bidi-font-size:12.0pt;font-family:"Trebuchet MS";
color:#000066'>Buffer overflow technically means an overflow of the buffer.
Every program is allocated some space or given buffer area in which it can
write. A Buffer overflow occurs when the program spills over this buffer or
tries to write in the area it is not supposed to. This allows an intruder to
overwrite the existing instruction in that area, thereupon gaining full control
over the system. </span><span style='font-size:10.0pt;mso-bidi-font-size:8.5pt;
font-family:"Trebuchet MS";color:#000066'>However, before we understand the
mechanism of this attack, we need to be well versed with memory management, a
few concepts of stack and heap memory area. <o:p></o:p></span></p>

<p class=MsoNormal style='margin-top:.75pt;margin-right:.75pt;margin-bottom:
0in;margin-left:0in;margin-bottom:.0001pt;text-align:justify'><span
style='font-size:10.0pt;mso-bidi-font-size:8.5pt;font-family:"Trebuchet MS";
color:#000066'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=MsoNormal><u><span style='font-size:11.0pt;mso-bidi-font-size:12.0pt;
color:#000066'>Stack Memory<o:p></o:p></span></u></p>

<p class=MsoNormal style='margin-top:.75pt;margin-right:.75pt;margin-bottom:
0in;margin-left:0in;margin-bottom:.0001pt;text-align:justify'><span
style='font-size:10.0pt;mso-bidi-font-size:8.5pt;font-family:"Trebuchet MS";
color:#000066'>The programs given below give an analysis of memory allocations
when a program is loaded.<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.0pt;
mso-bidi-font-size:12.0pt;font-family:"Trebuchet MS";color:#000066'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><u><span style='font-size:10.0pt;
mso-bidi-font-size:12.0pt;font-family:"Trebuchet MS";color:#000066'>A1.c</span></u><span
style='font-size:10.0pt;mso-bidi-font-size:12.0pt;font-family:"Trebuchet MS";
color:#000066'><o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.0pt;
mso-bidi-font-size:12.0pt;font-family:"Trebuchet MS";color:#000066'>main()<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.0pt;
mso-bidi-font-size:12.0pt;font-family:"Trebuchet MS";color:#000066'>{<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.0pt;
mso-bidi-font-size:12.0pt;font-family:"Trebuchet MS";color:#000066'>abc(1,2);<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.0pt;
mso-bidi-font-size:12.0pt;font-family:"Trebuchet MS";color:#000066'>pqr(3,4);<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.0pt;
mso-bidi-font-size:12.0pt;font-family:"Trebuchet MS";color:#000066'>xyz(5,6);<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.0pt;
mso-bidi-font-size:12.0pt;font-family:"Trebuchet MS";color:#000066'>abc(7,8);<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.0pt;
mso-bidi-font-size:12.0pt;font-family:"Trebuchet MS";color:#000066'>}<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.0pt;
mso-bidi-font-size:12.0pt;font-family:"Trebuchet MS";color:#000066'>abc(int i,
int j)<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.0pt;
mso-bidi-font-size:12.0pt;font-family:"Trebuchet MS";color:#000066'>{<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.0pt;
mso-bidi-font-size:12.0pt;font-family:"Trebuchet MS";color:#000066'>printf(&quot;%p
%p abc\n&quot;,</span><span style='font-size:10.0pt;mso-bidi-font-size:12.0pt;
font-family:Tahoma;mso-bidi-font-family:"Times New Roman";color:#000066'>&amp;</span><span
style='font-size:10.0pt;mso-bidi-font-size:12.0pt;font-family:"Trebuchet MS";
color:#000066'>i,</span><span style='font-size:10.0pt;mso-bidi-font-size:12.0pt;
font-family:Tahoma;mso-bidi-font-family:"Times New Roman";color:#000066'>&amp;</span><span
style='font-size:10.0pt;mso-bidi-font-size:12.0pt;font-family:"Trebuchet MS";
color:#000066'>j);<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.0pt;
mso-bidi-font-size:12.0pt;font-family:"Trebuchet MS";color:#000066'>}<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.0pt;
mso-bidi-font-size:12.0pt;font-family:"Trebuchet MS";color:#000066'>pqr(int x,
int y)<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.0pt;
mso-bidi-font-size:12.0pt;font-family:"Trebuchet MS";color:#000066'>{<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.0pt;
mso-bidi-font-size:12.0pt;font-family:"Trebuchet MS";color:#000066'>printf(&quot;%p
%p pqr\n&quot;,</span><span style='font-size:10.0pt;mso-bidi-font-size:12.0pt;
font-family:Tahoma;mso-bidi-font-family:"Times New Roman";color:#000066'>&amp;</span><span
style='font-size:10.0pt;mso-bidi-font-size:12.0pt;font-family:"Trebuchet MS";
color:#000066'>x,</span><span style='font-size:10.0pt;mso-bidi-font-size:12.0pt;
font-family:Tahoma;mso-bidi-font-family:"Times New Roman";color:#000066'>&amp;</span><span
style='font-size:10.0pt;mso-bidi-font-size:12.0pt;font-family:"Trebuchet MS";
color:#000066'>y);<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.0pt;
mso-bidi-font-size:12.0pt;font-family:"Trebuchet MS";color:#000066'>}<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.0pt;
mso-bidi-font-size:12.0pt;font-family:"Trebuchet MS";color:#000066'>xyz(int i,
int j)<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.0pt;
mso-bidi-font-size:12.0pt;font-family:"Trebuchet MS";color:#000066'>{<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.0pt;
mso-bidi-font-size:12.0pt;font-family:"Trebuchet MS";color:#000066'>printf(&quot;%p
%p xyz\n&quot;,</span><span style='font-size:10.0pt;mso-bidi-font-size:12.0pt;
font-family:Tahoma;mso-bidi-font-family:"Times New Roman";color:#000066'>&amp;</span><span
style='font-size:10.0pt;mso-bidi-font-size:12.0pt;font-family:"Trebuchet MS";
color:#000066'>i,</span><span style='font-size:10.0pt;mso-bidi-font-size:12.0pt;
font-family:Tahoma;mso-bidi-font-family:"Times New Roman";color:#000066'>&amp;</span><span
style='font-size:10.0pt;mso-bidi-font-size:12.0pt;font-family:"Trebuchet MS";
color:#000066'>j);<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.0pt;
mso-bidi-font-size:12.0pt;font-family:"Trebuchet MS";color:#000066'>}<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.0pt;
mso-bidi-font-size:12.0pt;font-family:"Trebuchet MS";color:#000066'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.0pt;
mso-bidi-font-size:12.0pt;font-family:"Trebuchet MS";color:#000066'>&gt;cl a.c<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.0pt;
mso-bidi-font-size:12.0pt;font-family:"Trebuchet MS";color:#000066'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.0pt;
mso-bidi-font-size:12.0pt;font-family:"Trebuchet MS";color:#000066'>&gt;a<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.0pt;
mso-bidi-font-size:12.0pt;font-family:"Trebuchet MS";color:#000066'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.0pt;
mso-bidi-font-size:12.0pt;font-family:"Trebuchet MS";color:#000066'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=MsoNormal><a name="_Toc60579149"><u><span style='font-size:10.0pt;
mso-bidi-font-size:12.0pt;font-family:"Trebuchet MS";color:#000066'>Output</span></u></a><u><span
style='font-size:10.0pt;mso-bidi-font-size:12.0pt;font-family:"Trebuchet MS";
color:#000066'><o:p></o:p></span></u></p>

<p class=MsoNormal><span style='color:#000066'>0012FEDC 0012FEE0 abc<o:p></o:p></span></p>

<p class=MsoNormal><span style='color:#000066'>0012FEDC 0012FEE0 pqr<o:p></o:p></span></p>

<p class=MsoNormal><span style='color:#000066'>0012FEDC 0012FEE0 xyz<o:p></o:p></span></p>

<p class=MsoNormal><span style='color:#000066'>0012FEDC 0012FEE0 abc<o:p></o:p></span></p>

<p class=MsoNormal><span style='color:#000066'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.0pt;
mso-bidi-font-size:12.0pt;font-family:"Trebuchet MS";color:#000066'>The above
program at first glance may seem simplistic, but it is our first cut at
learning internals. We are calling three functions abc, pqr and xyz with two
parameters each. The two parameters in functions abc and xyz are named as i and
j and for function pqr, the name is changed to x and y. <o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.0pt;
mso-bidi-font-size:12.0pt;font-family:"Trebuchet MS";color:#000066'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.0pt;
mso-bidi-font-size:12.0pt;font-family:"Trebuchet MS";color:#000066'>The program
simply displays the addresses of parameters in each function. What is
noteworthy here is that all functions display the same addresses for their
parameters. Thus, it can be safely stated that the parameters to each function
begin at the same place in memory. As in, for function abc, parameters i and j
have been allocated the same memory locations as that of p and q for function
pqr. <o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.0pt;
mso-bidi-font-size:12.0pt;font-family:"Trebuchet MS";color:#000066'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.0pt;
mso-bidi-font-size:12.0pt;font-family:"Trebuchet MS";color:#000066'>Thus,
memory allocated for parameters of function is always the same for every
function. Meaning to say, that there is no permanent memory allocated for
function parameters. <o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.0pt;
mso-bidi-font-size:12.0pt;font-family:"Trebuchet MS";color:#000066'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><u><span style='font-size:10.0pt;
mso-bidi-font-size:12.0pt;font-family:"Trebuchet MS";color:#000066'>A2.c</span></u><span
style='font-size:10.0pt;mso-bidi-font-size:12.0pt;font-family:"Trebuchet MS";
color:#000066'><o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.0pt;
mso-bidi-font-size:12.0pt;font-family:"Trebuchet MS";color:#000066'>main()<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.0pt;
mso-bidi-font-size:12.0pt;font-family:"Trebuchet MS";color:#000066'>{<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.0pt;
mso-bidi-font-size:12.0pt;font-family:"Trebuchet MS";color:#000066'>abc();<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.0pt;
mso-bidi-font-size:12.0pt;font-family:"Trebuchet MS";color:#000066'>pqr();<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.0pt;
mso-bidi-font-size:12.0pt;font-family:"Trebuchet MS";color:#000066'>xyz();<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.0pt;
mso-bidi-font-size:12.0pt;font-family:"Trebuchet MS";color:#000066'>abc();<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.0pt;
mso-bidi-font-size:12.0pt;font-family:"Trebuchet MS";color:#000066'>}<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.0pt;
mso-bidi-font-size:12.0pt;font-family:"Trebuchet MS";color:#000066'>abc()<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.0pt;
mso-bidi-font-size:12.0pt;font-family:"Trebuchet MS";color:#000066'>{<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.0pt;
mso-bidi-font-size:12.0pt;font-family:"Trebuchet MS";color:#000066'>int i,j;<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.0pt;
mso-bidi-font-size:12.0pt;font-family:"Trebuchet MS";color:#000066'>printf(&quot;%p
%p abc\n&quot;,</span><span style='font-size:10.0pt;mso-bidi-font-size:12.0pt;
font-family:Tahoma;mso-bidi-font-family:"Times New Roman";color:#000066'>&amp;</span><span
style='font-size:10.0pt;mso-bidi-font-size:12.0pt;font-family:"Trebuchet MS";
color:#000066'>i,</span><span style='font-size:10.0pt;mso-bidi-font-size:12.0pt;
font-family:Tahoma;mso-bidi-font-family:"Times New Roman";color:#000066'>&amp;</span><span
style='font-size:10.0pt;mso-bidi-font-size:12.0pt;font-family:"Trebuchet MS";
color:#000066'>j);<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.0pt;
mso-bidi-font-size:12.0pt;font-family:"Trebuchet MS";color:#000066'>}<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.0pt;
mso-bidi-font-size:12.0pt;font-family:"Trebuchet MS";color:#000066'>pqr()<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.0pt;
mso-bidi-font-size:12.0pt;font-family:"Trebuchet MS";color:#000066'>{<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.0pt;
mso-bidi-font-size:12.0pt;font-family:"Trebuchet MS";color:#000066'>int k,l;<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.0pt;
mso-bidi-font-size:12.0pt;font-family:"Trebuchet MS";color:#000066'>printf(&quot;%p
%p pqr\n&quot;,</span><span style='font-size:10.0pt;mso-bidi-font-size:12.0pt;
font-family:Tahoma;mso-bidi-font-family:"Times New Roman";color:#000066'>&amp;</span><span
style='font-size:10.0pt;mso-bidi-font-size:12.0pt;font-family:"Trebuchet MS";
color:#000066'>k,</span><span style='font-size:10.0pt;mso-bidi-font-size:12.0pt;
font-family:Tahoma;mso-bidi-font-family:"Times New Roman";color:#000066'>&amp;</span><span
style='font-size:10.0pt;mso-bidi-font-size:12.0pt;font-family:"Trebuchet MS";
color:#000066'>l);<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.0pt;
mso-bidi-font-size:12.0pt;font-family:"Trebuchet MS";color:#000066'>}<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.0pt;
mso-bidi-font-size:12.0pt;font-family:"Trebuchet MS";color:#000066'>xyz()<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.0pt;
mso-bidi-font-size:12.0pt;font-family:"Trebuchet MS";color:#000066'>{<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.0pt;
mso-bidi-font-size:12.0pt;font-family:"Trebuchet MS";color:#000066'>int i,j;<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.0pt;
mso-bidi-font-size:12.0pt;font-family:"Trebuchet MS";color:#000066'>printf(&quot;%p
%p xyz\n&quot;,</span><span style='font-size:10.0pt;mso-bidi-font-size:12.0pt;
font-family:Tahoma;mso-bidi-font-family:"Times New Roman";color:#000066'>&amp;</span><span
style='font-size:10.0pt;mso-bidi-font-size:12.0pt;font-family:"Trebuchet MS";
color:#000066'>i,</span><span style='font-size:10.0pt;mso-bidi-font-size:12.0pt;
font-family:Tahoma;mso-bidi-font-family:"Times New Roman";color:#000066'>&amp;</span><span
style='font-size:10.0pt;mso-bidi-font-size:12.0pt;font-family:"Trebuchet MS";
color:#000066'>j);<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.0pt;
mso-bidi-font-size:12.0pt;font-family:"Trebuchet MS";color:#000066'>}<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.0pt;
mso-bidi-font-size:12.0pt;font-family:"Trebuchet MS";color:#000066'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<h1><span style='color:#000066'>Output<o:p></o:p></span></h1>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.0pt;
mso-bidi-font-size:12.0pt;font-family:"Trebuchet MS";color:#000066'>0012FED8
0012FED4 abc<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.0pt;
mso-bidi-font-size:12.0pt;font-family:"Trebuchet MS";color:#000066'>0012FED8
0012FED4 pqr<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.0pt;
mso-bidi-font-size:12.0pt;font-family:"Trebuchet MS";color:#000066'>0012FED8
0012FED4 xyz<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.0pt;
mso-bidi-font-size:12.0pt;font-family:"Trebuchet MS";color:#000066'>0012FED8
0012FED4 abc<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.0pt;
mso-bidi-font-size:12.0pt;font-family:"Trebuchet MS";color:#000066'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.0pt;
mso-bidi-font-size:12.0pt;font-family:"Trebuchet MS";color:#000066'>The next example
is a slightly modified version. The functions abc, pqr and xyz have remained
the same but they do not accept parameters anymore. But variables are created
within these functions. Nevertheless, like before, all the printf’s display
identical addresses. This simply reassures the belief that local variables in a
function are allocated the same address each time a function is called. <o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.0pt;
mso-bidi-font-size:12.0pt;font-family:"Trebuchet MS";color:#000066'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.0pt;
mso-bidi-font-size:12.0pt;font-family:"Trebuchet MS";color:#000066'>The
technicality here is that when a function exits out, all the memory allocated
to it is given to the next function to be called. Thus, functions are given
volatile memory, as in, the memory allocated to it is reused by another
function. Also, variable names have no meaning; it is the addresses assigned to
these variables that hold value.<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.0pt;
mso-bidi-font-size:12.0pt;font-family:"Trebuchet MS";color:#000066'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><u><span style='font-size:10.0pt;
mso-bidi-font-size:12.0pt;font-family:"Trebuchet MS";color:#000066'>A3.c</span></u><span
style='font-size:10.0pt;mso-bidi-font-size:12.0pt;font-family:"Trebuchet MS";
color:#000066'><o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.0pt;
mso-bidi-font-size:12.0pt;font-family:"Trebuchet MS";color:#000066'>main()<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.0pt;
mso-bidi-font-size:12.0pt;font-family:"Trebuchet MS";color:#000066'>{<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.0pt;
mso-bidi-font-size:12.0pt;font-family:"Trebuchet MS";color:#000066'>abc(1,2);<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.0pt;
mso-bidi-font-size:12.0pt;font-family:"Trebuchet MS";color:#000066'>pqr(3,4);<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.0pt;
mso-bidi-font-size:12.0pt;font-family:"Trebuchet MS";color:#000066'>xyz(5,6);<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.0pt;
mso-bidi-font-size:12.0pt;font-family:"Trebuchet MS";color:#000066'>abc(7,8);<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.0pt;
mso-bidi-font-size:12.0pt;font-family:"Trebuchet MS";color:#000066'>}<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.0pt;
mso-bidi-font-size:12.0pt;font-family:"Trebuchet MS";color:#000066'>abc(int i1,
int j1)<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.0pt;
mso-bidi-font-size:12.0pt;font-family:"Trebuchet MS";color:#000066'>{<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.0pt;
mso-bidi-font-size:12.0pt;font-family:"Trebuchet MS";color:#000066'>int i,j;<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.0pt;
mso-bidi-font-size:12.0pt;font-family:"Trebuchet MS";color:#000066'>printf(&quot;i1=%p
j1=%p i=%p j=%p abc\n&quot;,</span><span style='font-size:10.0pt;mso-bidi-font-size:
12.0pt;font-family:Tahoma;mso-bidi-font-family:"Times New Roman";color:#000066'>&amp;</span><span
style='font-size:10.0pt;mso-bidi-font-size:12.0pt;font-family:"Trebuchet MS";
color:#000066'>i1, </span><span style='font-size:10.0pt;mso-bidi-font-size:
12.0pt;font-family:Tahoma;mso-bidi-font-family:"Times New Roman";color:#000066'>&amp;</span><span
style='font-size:10.0pt;mso-bidi-font-size:12.0pt;font-family:"Trebuchet MS";
color:#000066'>j1 , </span><span style='font-size:10.0pt;mso-bidi-font-size:
12.0pt;font-family:Tahoma;mso-bidi-font-family:"Times New Roman";color:#000066'>&amp;</span><span
style='font-size:10.0pt;mso-bidi-font-size:12.0pt;font-family:"Trebuchet MS";
color:#000066'>i,</span><span style='font-size:10.0pt;mso-bidi-font-size:12.0pt;
font-family:Tahoma;mso-bidi-font-family:"Times New Roman";color:#000066'>&amp;</span><span
style='font-size:10.0pt;mso-bidi-font-size:12.0pt;font-family:"Trebuchet MS";
color:#000066'>j);<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.0pt;
mso-bidi-font-size:12.0pt;font-family:"Trebuchet MS";color:#000066'>}<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.0pt;
mso-bidi-font-size:12.0pt;font-family:"Trebuchet MS";color:#000066'>pqr(int k1
, int l1)<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.0pt;
mso-bidi-font-size:12.0pt;font-family:"Trebuchet MS";color:#000066'>{<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.0pt;
mso-bidi-font-size:12.0pt;font-family:"Trebuchet MS";color:#000066'>int k,l;<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.0pt;
mso-bidi-font-size:12.0pt;font-family:"Trebuchet MS";color:#000066'>printf(&quot;k1=%p
l1=%p k=%p l=%p pqr\n&quot;,</span><span style='font-size:10.0pt;mso-bidi-font-size:
12.0pt;font-family:Tahoma;mso-bidi-font-family:"Times New Roman";color:#000066'>&amp;</span><span
style='font-size:10.0pt;mso-bidi-font-size:12.0pt;font-family:"Trebuchet MS";
color:#000066'>k1, </span><span style='font-size:10.0pt;mso-bidi-font-size:
12.0pt;font-family:Tahoma;mso-bidi-font-family:"Times New Roman";color:#000066'>&amp;</span><span
style='font-size:10.0pt;mso-bidi-font-size:12.0pt;font-family:"Trebuchet MS";
color:#000066'>l1 , </span><span style='font-size:10.0pt;mso-bidi-font-size:
12.0pt;font-family:Tahoma;mso-bidi-font-family:"Times New Roman";color:#000066'>&amp;</span><span
style='font-size:10.0pt;mso-bidi-font-size:12.0pt;font-family:"Trebuchet MS";
color:#000066'>k,</span><span style='font-size:10.0pt;mso-bidi-font-size:12.0pt;
font-family:Tahoma;mso-bidi-font-family:"Times New Roman";color:#000066'>&amp;</span><span
style='font-size:10.0pt;mso-bidi-font-size:12.0pt;font-family:"Trebuchet MS";
color:#000066'>l);<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.0pt;
mso-bidi-font-size:12.0pt;font-family:"Trebuchet MS";color:#000066'>}<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.0pt;
mso-bidi-font-size:12.0pt;font-family:"Trebuchet MS";color:#000066'>xyz(int i1,
int j1)<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.0pt;
mso-bidi-font-size:12.0pt;font-family:"Trebuchet MS";color:#000066'>{<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.0pt;
mso-bidi-font-size:12.0pt;font-family:"Trebuchet MS";color:#000066'>int i,j;<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.0pt;
mso-bidi-font-size:12.0pt;font-family:"Trebuchet MS";color:#000066'>printf(&quot;i1=%p
j1=%p i=%p j=%p xyz\n&quot;,</span><span style='font-size:10.0pt;mso-bidi-font-size:
12.0pt;font-family:Tahoma;mso-bidi-font-family:"Times New Roman";color:#000066'>&amp;</span><span
style='font-size:10.0pt;mso-bidi-font-size:12.0pt;font-family:"Trebuchet MS";
color:#000066'>i1, </span><span style='font-size:10.0pt;mso-bidi-font-size:
12.0pt;font-family:Tahoma;mso-bidi-font-family:"Times New Roman";color:#000066'>&amp;</span><span
style='font-size:10.0pt;mso-bidi-font-size:12.0pt;font-family:"Trebuchet MS";
color:#000066'>j1 , </span><span style='font-size:10.0pt;mso-bidi-font-size:
12.0pt;font-family:Tahoma;mso-bidi-font-family:"Times New Roman";color:#000066'>&amp;</span><span
style='font-size:10.0pt;mso-bidi-font-size:12.0pt;font-family:"Trebuchet MS";
color:#000066'>i,</span><span style='font-size:10.0pt;mso-bidi-font-size:12.0pt;
font-family:Tahoma;mso-bidi-font-family:"Times New Roman";color:#000066'>&amp;</span><span
style='font-size:10.0pt;mso-bidi-font-size:12.0pt;font-family:"Trebuchet MS";
color:#000066'>j);<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.0pt;
mso-bidi-font-size:12.0pt;font-family:"Trebuchet MS";color:#000066'>}<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.0pt;
mso-bidi-font-size:12.0pt;font-family:"Trebuchet MS";color:#000066'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<h1><span style='color:#000066'>Output<o:p></o:p></span></h1>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.0pt;
mso-bidi-font-size:12.0pt;font-family:"Trebuchet MS";color:#000066'>i1=0012FEDC
j1=0012FEE0 i=0012FED0 j=0012FECC abc<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.0pt;
mso-bidi-font-size:12.0pt;font-family:"Trebuchet MS";color:#000066'>x1=0012FEDC
y1=0012FEE0 x=0012FED0 y=0012FECC pqr<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.0pt;
mso-bidi-font-size:12.0pt;font-family:"Trebuchet MS";color:#000066'>i1=0012FEDC
j1=0012FEE0 i=0012FED0 j=0012FECC xyz<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.0pt;
mso-bidi-font-size:12.0pt;font-family:"Trebuchet MS";color:#000066'>i1=0012FEDC
j1=0012FEE0 i=0012FED0 j=0012FECC abc<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.0pt;
mso-bidi-font-size:12.0pt;font-family:"Trebuchet MS";color:#000066'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.0pt;
mso-bidi-font-size:12.0pt;font-family:"Trebuchet MS";color:#000066'>This
program is a merger of the above two programs. The functions names are the same
but now not only do they accept two parameters, the function further creates
two local variables on the stack. Printing out the addresses of the local
variables and the parameters bring no surprises at all. They all remain the
same for every function.<span style="mso-spacerun: yes">  </span><o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.0pt;
mso-bidi-font-size:12.0pt;font-family:"Trebuchet MS";color:#000066'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.0pt;
mso-bidi-font-size:12.0pt;font-family:"Trebuchet MS";color:#000066'>A detailed
version follows. <o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.0pt;
mso-bidi-font-size:12.0pt;font-family:"Trebuchet MS";color:#000066'>The value
of 1 and 2 given to function abc are passed on to parameters i1 and j1. These
parameters to functions take up some area in memory called the stack. The
internals of stack memory will be explained in just a short while. <o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.0pt;
mso-bidi-font-size:12.0pt;font-family:"Trebuchet MS";color:#000066'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.0pt;
mso-bidi-font-size:12.0pt;font-family:"Trebuchet MS";color:#000066'>The
parameters that are passed to a function are placed on the stack in the reverse
order, therefore first 2 goes on this stack memory and then 1. Figure 1 shows
these values on the stack.<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.0pt;
mso-bidi-font-size:12.0pt;font-family:"Trebuchet MS";color:#000066'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.0pt;
mso-bidi-font-size:12.0pt;font-family:"Trebuchet MS";color:#000066'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.0pt;
mso-bidi-font-size:12.0pt;font-family:"Trebuchet MS";color:#000066'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.0pt;
mso-bidi-font-size:12.0pt;font-family:"Trebuchet MS";color:#000066'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><!--[if gte vml 1]><v:shapetype
 id="_x0000_t202" coordsize="21600,21600" o:spt="202" path="m0,0l0,21600,21600,21600,21600,0xe">
 <v:stroke joinstyle="miter"/>
 <v:path gradientshapeok="t" o:connecttype="rect"/>
</v:shapetype><v:shape id="_x0000_s1068" type="#_x0000_t202" style='position:absolute;
 left:0;text-align:left;margin-left:126pt;margin-top:150.55pt;width:117pt;
 height:18pt;z-index:3' filled="f" stroked="f">
 <v:textbox style='mso-next-textbox:#_x0000_s1068'/>
 <w:wrap anchorx="page"/>
</v:shape><v:shape id="_x0000_s1075" type="#_x0000_t202" style='position:absolute;
 left:0;text-align:left;margin-left:126pt;margin-top:96.55pt;width:117pt;
 height:18pt;z-index:10' filled="f" stroked="f">
 <v:textbox style='mso-next-textbox:#_x0000_s1075'/>
 <w:wrap anchorx="page"/>
</v:shape><v:shape id="_x0000_s1082" type="#_x0000_t202" style='position:absolute;
 left:0;text-align:left;margin-left:126pt;margin-top:42.55pt;width:117pt;
 height:18pt;z-index:17' filled="f" stroked="f">
 <v:textbox style='mso-next-textbox:#_x0000_s1082'/>
 <w:wrap anchorx="page"/>
</v:shape><v:rect id="_x0000_s1064" style='position:absolute;left:0;
 text-align:left;margin-left:9pt;margin-top:0;width:90pt;height:162pt;
 z-index:1'>
 <w:wrap anchorx="page"/>
</v:rect><v:line id="_x0000_s1065" style='position:absolute;left:0;
 text-align:left;z-index:2' from="9pt,159.55pt" to="99pt,159.55pt">
 <w:wrap anchorx="page"/>
</v:line><v:shape id="_x0000_s1069" type="#_x0000_t202" style='position:absolute;
 left:0;text-align:left;margin-left:45pt;margin-top:125pt;width:27pt;height:27pt;
 z-index:4' filled="f" stroked="f">
 <v:textbox style='mso-next-textbox:#_x0000_s1069'>
  <![if !mso]>
  <table cellpadding=0 cellspacing=0 width="100%">
   <tr>
    <td><![endif]>
    <div>
    <p class=MsoNormal><span style='font-family:"Courier New"'>i<o:p></o:p></span></p>
    </div>
    <![if !mso]></td>
   </tr>
  </table>
  <![endif]></v:textbox>
 <w:wrap anchorx="page"/>
</v:shape><v:line id="_x0000_s1070" style='position:absolute;left:0;
 text-align:left;z-index:5' from="99pt,159.55pt" to="117pt,159.55pt">
 <v:stroke endarrow="block"/>
 <w:wrap anchorx="page"/>
</v:line><v:line id="_x0000_s1071" style='position:absolute;left:0;
 text-align:left;z-index:6' from="9pt,132.55pt" to="99pt,132.55pt">
 <w:wrap anchorx="page"/>
</v:line><v:line id="_x0000_s1073" style='position:absolute;left:0;
 text-align:left;z-index:8' from="99pt,132.55pt" to="117pt,132.55pt">
 <v:stroke endarrow="block"/>
 <w:wrap anchorx="page"/>
</v:line><v:line id="_x0000_s1074" style='position:absolute;left:0;
 text-align:left;z-index:9' from="9pt,105.55pt" to="99pt,105.55pt">
 <w:wrap anchorx="page"/>
</v:line><v:shape id="_x0000_s1076" type="#_x0000_t202" style='position:absolute;
 left:0;text-align:left;margin-left:45pt;margin-top:105.55pt;width:27pt;
 height:18pt;z-index:11' filled="f" stroked="f">
 <v:textbox style='mso-next-textbox:#_x0000_s1076'>
  <![if !mso]>
  <table cellpadding=0 cellspacing=0 width="100%">
   <tr>
    <td><![endif]>
    <div>
    <p class=MsoNormal><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>
    </div>
    <![if !mso]></td>
   </tr>
  </table>
  <![endif]></v:textbox>
 <w:wrap anchorx="page"/>
</v:shape><v:line id="_x0000_s1077" style='position:absolute;left:0;
 text-align:left;z-index:12' from="99pt,105.55pt" to="117pt,105.55pt">
 <v:stroke endarrow="block"/>
 <w:wrap anchorx="page"/>
</v:line><v:line id="_x0000_s1078" style='position:absolute;left:0;
 text-align:left;z-index:13' from="9pt,78.55pt" to="99pt,78.55pt">
 <w:wrap anchorx="page"/>
</v:line><v:line id="_x0000_s1080" style='position:absolute;left:0;
 text-align:left;z-index:15' from="99pt,78.55pt" to="117pt,78.55pt">
 <v:stroke endarrow="block"/>
 <w:wrap anchorx="page"/>
</v:line><v:line id="_x0000_s1081" style='position:absolute;left:0;
 text-align:left;z-index:16' from="9pt,51.55pt" to="99pt,51.55pt">
 <w:wrap anchorx="page"/>
</v:line><v:shape id="_x0000_s1083" type="#_x0000_t202" style='position:absolute;
 left:0;text-align:left;margin-left:36pt;margin-top:51.55pt;width:45pt;
 height:27pt;z-index:18' filled="f" stroked="f">
 <v:textbox style='mso-next-textbox:#_x0000_s1083'>
  <![if !mso]>
  <table cellpadding=0 cellspacing=0 width="100%">
   <tr>
    <td><![endif]>
    <div>
    <p class=MsoNormal><span style='font-family:"Courier New"'>i1=1<o:p></o:p></span></p>
    </div>
    <![if !mso]></td>
   </tr>
  </table>
  <![endif]></v:textbox>
 <w:wrap anchorx="page"/>
</v:shape><v:line id="_x0000_s1084" style='position:absolute;left:0;
 text-align:left;z-index:19' from="99pt,51.55pt" to="117pt,51.55pt">
 <v:stroke endarrow="block"/>
 <w:wrap anchorx="page"/>
</v:line><v:line id="_x0000_s1085" style='position:absolute;left:0;
 text-align:left;z-index:20' from="9pt,24.55pt" to="99pt,24.55pt">
 <w:wrap anchorx="page"/>
</v:line><v:line id="_x0000_s1087" style='position:absolute;left:0;
 text-align:left;z-index:22' from="99pt,24.55pt" to="117pt,24.55pt">
 <v:stroke endarrow="block"/>
 <w:wrap anchorx="page"/>
</v:line><v:line id="_x0000_s1088" style='position:absolute;left:0;
 text-align:left;z-index:23' from="9pt,186.55pt" to="99pt,186.55pt">
 <w:wrap anchorx="page"/>
</v:line><v:shape id="_x0000_s1090" type="#_x0000_t202" style='position:absolute;
 left:0;text-align:left;margin-left:45pt;margin-top:155.8pt;width:27pt;
 height:27pt;z-index:25' filled="f" stroked="f">
 <v:textbox style='mso-next-textbox:#_x0000_s1090'>
  <![if !mso]>
  <table cellpadding=0 cellspacing=0 width="100%">
   <tr>
    <td><![endif]>
    <div>
    <p class=MsoNormal><span style='font-family:"Courier New"'>j<o:p></o:p></span></p>
    </div>
    <![if !mso]></td>
   </tr>
  </table>
  <![endif]></v:textbox>
 <w:wrap anchorx="page"/>
</v:shape><v:line id="_x0000_s1091" style='position:absolute;left:0;
 text-align:left;z-index:26' from="99pt,186.55pt" to="117pt,186.55pt">
 <v:stroke endarrow="block"/>
 <w:wrap anchorx="page"/>
</v:line><v:shape id="_x0000_s1092" type="#_x0000_t202" style='position:absolute;
 left:0;text-align:left;margin-left:36pt;margin-top:24.55pt;width:45pt;
 height:27pt;z-index:27' filled="f" stroked="f">
 <v:textbox style='mso-next-textbox:#_x0000_s1092'>
  <![if !mso]>
  <table cellpadding=0 cellspacing=0 width="100%">
   <tr>
    <td><![endif]>
    <div>
    <p class=MsoNormal><span style='font-family:"Courier New"'>j1=2<o:p></o:p></span></p>
    </div>
    <![if !mso]></td>
   </tr>
  </table>
  <![endif]></v:textbox>
 <w:wrap anchorx="page"/>
</v:shape><v:shape id="_x0000_s1094" type="#_x0000_t202" style='position:absolute;
 left:0;text-align:left;margin-left:324pt;margin-top:-9pt;width:108pt;height:45pt;
 z-index:29' filled="f" stroked="f">
 <v:textbox style='mso-next-textbox:#_x0000_s1094'/>
 <w:wrap anchorx="page"/>
</v:shape><v:shape id="_x0000_s1096" type="#_x0000_t202" style='position:absolute;
 left:0;text-align:left;margin-left:378pt;margin-top:61.55pt;width:45pt;
 height:36pt;z-index:31' filled="f" stroked="f">
 <v:textbox style='mso-next-textbox:#_x0000_s1096'/>
 <w:wrap anchorx="page"/>
</v:shape><v:shape id="_x0000_s1089" type="#_x0000_t202" style='position:absolute;
 left:0;text-align:left;margin-left:126pt;margin-top:177.55pt;width:117pt;
 height:18pt;z-index:24' filled="f" stroked="f">
 <v:textbox style='mso-next-textbox:#_x0000_s1089'>
  <![if !mso]>
  <table cellpadding=0 cellspacing=0 width="100%">
   <tr>
    <td><![endif]>
    <div>
    <p class=MsoNormal>0x0012fecc</p>
    </div>
    <![if !mso]></td>
   </tr>
  </table>
  <![endif]></v:textbox>
 <w:wrap anchorx="page"/>
</v:shape><v:line id="_x0000_s1097" style='position:absolute;left:0;
 text-align:left;z-index:32' from="198pt,186.55pt" to="324pt,186.55pt">
 <v:stroke endarrow="block"/>
 <w:wrap anchorx="page"/>
</v:line><v:shape id="_x0000_s1098" type="#_x0000_t202" style='position:absolute;
 left:0;text-align:left;margin-left:324pt;margin-top:177.55pt;width:108pt;
 height:36pt;z-index:33' filled="f" stroked="f">
 <v:textbox style='mso-next-textbox:#_x0000_s1098'>
  <![if !mso]>
  <table cellpadding=0 cellspacing=0 width="100%">
   <tr>
    <td><![endif]>
    <div>
    <p class=MsoNormal><span style='font-size:10.0pt;mso-bidi-font-size:12.0pt;
    font-family:"Courier New"'>Stack pointer in function abc<o:p></o:p></span></p>
    </div>
    <![if !mso]></td>
   </tr>
  </table>
  <![endif]></v:textbox>
 <w:wrap anchorx="page"/>
</v:shape><v:line id="_x0000_s1095" style='position:absolute;left:0;
 text-align:left;z-index:30' from="369pt,50.65pt" to="369pt,149.65pt">
 <v:stroke endarrow="block"/>
 <w:wrap anchorx="page"/>
</v:line><v:line id="_x0000_s1093" style='position:absolute;left:0;
 text-align:left;flip:x;z-index:28' from="3in,0" to="306pt,0">
 <v:stroke endarrow="block"/>
 <w:wrap anchorx="page"/>
</v:line><v:shape id="_x0000_s1086" type="#_x0000_t202" style='position:absolute;
 left:0;text-align:left;margin-left:126pt;margin-top:15.55pt;width:117pt;
 height:18pt;z-index:21' filled="f" stroked="f">
 <v:textbox style='mso-next-textbox:#_x0000_s1086'/>
 <w:wrap anchorx="page"/>
</v:shape><v:shape id="_x0000_s1079" type="#_x0000_t202" style='position:absolute;
 left:0;text-align:left;margin-left:126pt;margin-top:69.55pt;width:117pt;
 height:18pt;z-index:14' filled="f" stroked="f">
 <v:textbox style='mso-next-textbox:#_x0000_s1079'/>
 <w:wrap anchorx="page"/>
</v:shape><v:shape id="_x0000_s1072" type="#_x0000_t202" style='position:absolute;
 left:0;text-align:left;margin-left:126pt;margin-top:123.55pt;width:117pt;
 height:18pt;z-index:7' filled="f" stroked="f">
 <v:textbox style='mso-next-textbox:#_x0000_s1072'/>
 <w:wrap anchorx="page"/>
</v:shape><![endif]--><![if !vml]><span style='mso-ignore:vglayout;position:
relative;z-index:2'><span style='left:0px;position:absolute;left:11px;
top:-12px;width:567px;height:299px'>

<table cellpadding=0 cellspacing=0 align=left>
 <tr>
  <td width=0 height=0></td>
  <td width=147></td>
  <td width=10></td>
  <td width=119></td>
  <td width=39></td>
  <td width=84></td>
  <td width=22></td>
  <td width=54></td>
  <td width=14></td>
  <td width=4></td>
  <td width=62></td>
  <td width=12></td>
 </tr>
 <tr>
  <td height=6></td>
  <td colspan=6></td>
  <td colspan=5 rowspan=6 width=146 height=62 align=left valign=top
  style='vertical-align:top'><![endif]><![if !mso]><span style='position:absolute;
  left:0pt;z-index:29'>
  <table cellpadding=0 cellspacing=0 width="100%">
   <tr>
    <td><![endif]>
    <div v:shape="_x0000_s1094" style='padding:3.6pt 7.2pt 3.6pt 7.2pt'
    class=shape>
    <p class=MsoNormal><span style='font-size:10.0pt;mso-bidi-font-size:12.0pt;
    font-family:"Courier New"'>Stack pointer before calling function abc<o:p></o:p></span></p>
    </div>
    <![if !mso]></td>
   </tr>
  </table>
  </span><![endif]><![if !mso & !vml]>&nbsp;<![endif]><![if !vml]></td>
 </tr>
 <tr>
  <td height=6></td>
  <td colspan=3></td>
  <td colspan=2 rowspan=2 align=left valign=top><img width=123 height=14
  src="bufferoverfloww_files/image001.gif" v:shapes="_x0000_s1093"></td>
 </tr>
 <tr>
  <td height=8></td>
  <td rowspan=20 align=left valign=top><img width=147 height=257
  src="bufferoverfloww_files/image002.gif" v:shapes="_x0000_s1064 _x0000_s1065 _x0000_s1069 _x0000_s1070 _x0000_s1071 _x0000_s1073 _x0000_s1074 _x0000_s1076 _x0000_s1077 _x0000_s1078 _x0000_s1080 _x0000_s1081 _x0000_s1083 _x0000_s1084 _x0000_s1085 _x0000_s1087 _x0000_s1088 _x0000_s1090 _x0000_s1091 _x0000_s1092"></td>
 </tr>
 <tr>
  <td height=13></td>
 </tr>
 <tr>
  <td height=26></td>
  <td></td>
  <td colspan=2 width=158 height=26 align=left valign=top style='vertical-align:
  top'><![endif]><![if !mso]><span style='position:absolute;z-index:21'>
  <table cellpadding=0 cellspacing=0 width="100%">
   <tr>
    <td><![endif]>
    <div v:shape="_x0000_s1086" style='padding:3.6pt 7.2pt 3.6pt 7.2pt'
    class=shape>
    <p class=MsoNormal>0x0012fee4</p>
    </div>
    <![if !mso]></td>
   </tr>
  </table>
  </span><![endif]><![if !mso & !vml]>&nbsp;<![endif]><![if !vml]></td>
 </tr>
 <tr>
  <td height=3></td>
 </tr>
 <tr>
  <td height=7></td>
 </tr>
 <tr>
  <td height=10></td>
  <td></td>
  <td colspan=2 rowspan=3 width=158 height=26 align=left valign=top
  style='vertical-align:top'><![endif]><![if !mso]><span style='position:absolute;
  z-index:17'>
  <table cellpadding=0 cellspacing=0 width="100%">
   <tr>
    <td><![endif]>
    <div v:shape="_x0000_s1082" style='padding:3.6pt 7.2pt 3.6pt 7.2pt'
    class=shape>
    <p class=MsoNormal>0x0012fee0</p>
    </div>
    <![if !mso]></td>
   </tr>
  </table>
  </span><![endif]><![if !mso & !vml]>&nbsp;<![endif]><![if !vml]></td>
 </tr>
 <tr>
  <td height=15></td>
  <td></td>
  <td colspan=3></td>
  <td rowspan=11 align=left valign=top><img width=14 height=135
  src="bufferoverfloww_files/image003.gif" v:shapes="_x0000_s1095"></td>
 </tr>
 <tr>
  <td height=1></td>
  <td></td>
  <td colspan=3></td>
  <td></td>
  <td rowspan=5 width=62 height=50 align=left valign=top style='vertical-align:
  top'><![endif]><![if !mso]><span style='position:absolute;z-index:31'>
  <table cellpadding=0 cellspacing=0 width="100%">
   <tr>
    <td><![endif]>
    <div v:shape="_x0000_s1096" style='padding:3.6pt 7.2pt 3.6pt 7.2pt'
    class=shape>
    <p class=MsoNormal><span style='font-size:10.0pt;mso-bidi-font-size:12.0pt;
    font-family:"Courier New"'>Moves<o:p></o:p></span></p>
    <p class=MsoNormal><span style='font-size:10.0pt;mso-bidi-font-size:12.0pt;
    font-family:"Courier New"'>down</span></p>
    </div>
    <![if !mso]></td>
   </tr>
  </table>
  </span><![endif]><![if !mso & !vml]>&nbsp;<![endif]><![if !vml]></td>
 </tr>
 <tr>
  <td height=10></td>
 </tr>
 <tr>
  <td height=26></td>
  <td></td>
  <td colspan=2 width=158 height=26 align=left valign=top style='vertical-align:
  top'><![endif]><![if !mso]><span style='position:absolute;z-index:14'>
  <table cellpadding=0 cellspacing=0 width="100%">
   <tr>
    <td><![endif]>
    <div v:shape="_x0000_s1079" style='padding:3.6pt 7.2pt 3.6pt 7.2pt'
    class=shape>
    <p class=MsoNormal>0x0012fedc</p>
    </div>
    <![if !mso]></td>
   </tr>
  </table>
  </span><![endif]><![if !mso & !vml]>&nbsp;<![endif]><![if !vml]></td>
 </tr>
 <tr>
  <td height=10></td>
 </tr>
 <tr>
  <td height=3></td>
  <td></td>
  <td colspan=2 rowspan=2 width=158 height=26 align=left valign=top
  style='vertical-align:top'><![endif]><![if !mso]><span style='position:absolute;
  z-index:10'>
  <table cellpadding=0 cellspacing=0 width="100%">
   <tr>
    <td><![endif]>
    <div v:shape="_x0000_s1075" style='padding:3.6pt 7.2pt 3.6pt 7.2pt'
    class=shape>
    <p class=MsoNormal>0x0012fed8</p>
    </div>
    <![if !mso]></td>
   </tr>
  </table>
  </span><![endif]><![if !mso & !vml]>&nbsp;<![endif]><![if !vml]></td>
 </tr>
 <tr>
  <td height=23></td>
 </tr>
 <tr>
  <td height=10></td>
 </tr>
 <tr>
  <td height=26></td>
  <td></td>
  <td colspan=2 width=158 height=26 align=left valign=top style='vertical-align:
  top'><![endif]><![if !mso]><span style='position:absolute;z-index:7'>
  <table cellpadding=0 cellspacing=0 width="100%">
   <tr>
    <td><![endif]>
    <div v:shape="_x0000_s1072" style='padding:3.6pt 7.2pt 3.6pt 7.2pt'
    class=shape>
    <p class=MsoNormal>0x0012fed4</p>
    </div>
    <![if !mso]></td>
   </tr>
  </table>
  </span><![endif]><![if !mso & !vml]>&nbsp;<![endif]><![if !vml]></td>
 </tr>
 <tr>
  <td height=10></td>
 </tr>
 <tr>
  <td height=1></td>
  <td></td>
  <td colspan=2 rowspan=2 width=158 height=26 align=left valign=top
  style='vertical-align:top'><![endif]><![if !mso]><span style='position:absolute;
  z-index:3'>
  <table cellpadding=0 cellspacing=0 width="100%">
   <tr>
    <td><![endif]>
    <div v:shape="_x0000_s1068" style='padding:3.6pt 7.2pt 3.6pt 7.2pt'
    class=shape>
    <p class=MsoNormal>0x0012fed0</p>
    </div>
    <![if !mso]></td>
   </tr>
  </table>
  </span><![endif]><![if !mso & !vml]>&nbsp;<![endif]><![if !vml]></td>
 </tr>
 <tr>
  <td height=25></td>
 </tr>
 <tr>
  <td height=10></td>
 </tr>
 <tr>
  <td height=20></td>
  <td></td>
  <td colspan=9 rowspan=2 align=left valign=top><img width=410 height=50
  src="bufferoverfloww_files/image004.gif" v:shapes="_x0000_s1089 _x0000_s1097 _x0000_s1098"></td>
 </tr>
 <tr>
  <td height=30></td>
 </tr>
</table>

</span></span><![endif]><span style='font-size:10.0pt;mso-bidi-font-size:12.0pt;
font-family:"Trebuchet MS";color:#000066'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.0pt;
mso-bidi-font-size:12.0pt;font-family:"Trebuchet MS";color:#000066'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.0pt;
mso-bidi-font-size:12.0pt;font-family:"Trebuchet MS";color:#000066'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.0pt;
mso-bidi-font-size:12.0pt;font-family:"Trebuchet MS";color:#000066'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.0pt;
mso-bidi-font-size:12.0pt;font-family:"Trebuchet MS";color:#000066'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.0pt;
mso-bidi-font-size:12.0pt;font-family:"Trebuchet MS";color:#000066'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.0pt;
mso-bidi-font-size:12.0pt;font-family:"Trebuchet MS";color:#000066'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.0pt;
mso-bidi-font-size:12.0pt;font-family:"Trebuchet MS";color:#000066'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.0pt;
mso-bidi-font-size:12.0pt;font-family:"Trebuchet MS";color:#000066'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.0pt;
mso-bidi-font-size:12.0pt;font-family:"Trebuchet MS";color:#000066'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.0pt;
mso-bidi-font-size:12.0pt;font-family:"Trebuchet MS";color:#000066'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.0pt;
mso-bidi-font-size:12.0pt;font-family:"Trebuchet MS";color:#000066'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.0pt;
mso-bidi-font-size:12.0pt;font-family:"Trebuchet MS";color:#000066'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.0pt;
mso-bidi-font-size:12.0pt;font-family:"Trebuchet MS";color:#000066'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.0pt;
mso-bidi-font-size:12.0pt;font-family:"Trebuchet MS";color:#000066'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.0pt;
mso-bidi-font-size:12.0pt;font-family:"Trebuchet MS";color:#000066'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<br style='mso-ignore:vglayout' clear=ALL>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.0pt;
mso-bidi-font-size:12.0pt;font-family:"Trebuchet MS";color:#000066'>Figure 1
(Last In First Out-LIFO model)<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.0pt;
mso-bidi-font-size:12.0pt;font-family:"Trebuchet MS";color:#000066'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.0pt;
mso-bidi-font-size:12.0pt;font-family:"Trebuchet MS";color:#000066'>For sake of
understanding, lets take the actual values, where the stack begins at memory
location 0x0012fee4. The value 2 is pushed or copied at this memory location thus
moving the stack pointer to 0x0012fee0 and giving this address to j1, followed
by 1 which is four memory locations away, i.e 0x0012fedc. This is very much
proved by the program output, which show the same address locations for
parameters i1 and j1.<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.0pt;
mso-bidi-font-size:12.0pt;font-family:"Trebuchet MS";color:#000066'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.0pt;
mso-bidi-font-size:12.0pt;font-family:"Trebuchet MS";color:#000066'>Once the
values are placed on the stack, the function code is executed. This function,
abc, creates two local variables i and j. These are created at positions
0x0012fed0 and 0x0012fecc as per the output. This goes to prove that besides
parameters, local variables also use up the stack memory. The difference of 8
bytes between the parameters and variables is given to function call.<span
style="mso-spacerun: yes">  </span>We know why but hang on, one concept at a
time.<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.0pt;
mso-bidi-font-size:12.0pt;font-family:"Trebuchet MS";color:#000066'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.0pt;
mso-bidi-font-size:12.0pt;font-family:"Trebuchet MS";color:#000066'>Now when
the function quits out, the stack resets back to its original position of
0012fee4. A sure indication that someone moves the current memory pointer/the
stack pointer up by 24 bytes. And, the same process is repeated for all
function calls.<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.0pt;
mso-bidi-font-size:12.0pt;font-family:"Trebuchet MS";color:#000066'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><u><span style='font-size:10.0pt;
mso-bidi-font-size:12.0pt;font-family:"Trebuchet MS";color:#000066'>A4.c</span></u><span
style='font-size:10.0pt;mso-bidi-font-size:12.0pt;font-family:"Trebuchet MS";
color:#000066'><o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.0pt;
mso-bidi-font-size:12.0pt;font-family:"Trebuchet MS";color:#000066'>main()<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.0pt;
mso-bidi-font-size:12.0pt;font-family:"Trebuchet MS";color:#000066'>{<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.0pt;
mso-bidi-font-size:12.0pt;font-family:"Trebuchet MS";color:#000066'>abc(1,2);<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.0pt;
mso-bidi-font-size:12.0pt;font-family:"Trebuchet MS";color:#000066'>}<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.0pt;
mso-bidi-font-size:12.0pt;font-family:"Trebuchet MS";color:#000066'>abc(int i1,
int j1)<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.0pt;
mso-bidi-font-size:12.0pt;font-family:"Trebuchet MS";color:#000066'>{<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.0pt;
mso-bidi-font-size:12.0pt;font-family:"Trebuchet MS";color:#000066'>int i,j;<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.0pt;
mso-bidi-font-size:12.0pt;font-family:"Trebuchet MS";color:#000066'>printf(&quot;i1=%p
j1=%p i=%p j=%p abc\n&quot;,</span><span style='font-size:10.0pt;mso-bidi-font-size:
12.0pt;font-family:Tahoma;mso-bidi-font-family:"Times New Roman";color:#000066'>&amp;</span><span
style='font-size:10.0pt;mso-bidi-font-size:12.0pt;font-family:"Trebuchet MS";
color:#000066'>i1, </span><span style='font-size:10.0pt;mso-bidi-font-size:
12.0pt;font-family:Tahoma;mso-bidi-font-family:"Times New Roman";color:#000066'>&amp;</span><span
style='font-size:10.0pt;mso-bidi-font-size:12.0pt;font-family:"Trebuchet MS";
color:#000066'>j1 , </span><span style='font-size:10.0pt;mso-bidi-font-size:
12.0pt;font-family:Tahoma;mso-bidi-font-family:"Times New Roman";color:#000066'>&amp;</span><span
style='font-size:10.0pt;mso-bidi-font-size:12.0pt;font-family:"Trebuchet MS";
color:#000066'>i,</span><span style='font-size:10.0pt;mso-bidi-font-size:12.0pt;
font-family:Tahoma;mso-bidi-font-family:"Times New Roman";color:#000066'>&amp;</span><span
style='font-size:10.0pt;mso-bidi-font-size:12.0pt;font-family:"Trebuchet MS";
color:#000066'>j);<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.0pt;
mso-bidi-font-size:12.0pt;font-family:"Trebuchet MS";color:#000066'>pqr(3,4);<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.0pt;
mso-bidi-font-size:12.0pt;font-family:"Trebuchet MS";color:#000066'>}<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.0pt;
mso-bidi-font-size:12.0pt;font-family:"Trebuchet MS";color:#000066'>pqr(int k1
, int l1)<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.0pt;
mso-bidi-font-size:12.0pt;font-family:"Trebuchet MS";color:#000066'>{<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.0pt;
mso-bidi-font-size:12.0pt;font-family:"Trebuchet MS";color:#000066'>int k,l;<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.0pt;
mso-bidi-font-size:12.0pt;font-family:"Trebuchet MS";color:#000066'>printf(&quot;k1=%p
l1=%p k=%p l=%p pqr\n&quot;,</span><span style='font-size:10.0pt;mso-bidi-font-size:
12.0pt;font-family:Tahoma;mso-bidi-font-family:"Times New Roman";color:#000066'>&amp;</span><span
style='font-size:10.0pt;mso-bidi-font-size:12.0pt;font-family:"Trebuchet MS";
color:#000066'>k1, </span><span style='font-size:10.0pt;mso-bidi-font-size:
12.0pt;font-family:Tahoma;mso-bidi-font-family:"Times New Roman";color:#000066'>&amp;</span><span
style='font-size:10.0pt;mso-bidi-font-size:12.0pt;font-family:"Trebuchet MS";
color:#000066'>l1 , </span><span style='font-size:10.0pt;mso-bidi-font-size:
12.0pt;font-family:Tahoma;mso-bidi-font-family:"Times New Roman";color:#000066'>&amp;</span><span
style='font-size:10.0pt;mso-bidi-font-size:12.0pt;font-family:"Trebuchet MS";
color:#000066'>k,</span><span style='font-size:10.0pt;mso-bidi-font-size:12.0pt;
font-family:Tahoma;mso-bidi-font-family:"Times New Roman";color:#000066'>&amp;</span><span
style='font-size:10.0pt;mso-bidi-font-size:12.0pt;font-family:"Trebuchet MS";
color:#000066'>l);<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.0pt;
mso-bidi-font-size:12.0pt;font-family:"Trebuchet MS";color:#000066'>xyz(5,6);<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.0pt;
mso-bidi-font-size:12.0pt;font-family:"Trebuchet MS";color:#000066'>aaa(8,9);<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.0pt;
mso-bidi-font-size:12.0pt;font-family:"Trebuchet MS";color:#000066'>}<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.0pt;
mso-bidi-font-size:12.0pt;font-family:"Trebuchet MS";color:#000066'>xyz(int i1,
int j1)<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.0pt;
mso-bidi-font-size:12.0pt;font-family:"Trebuchet MS";color:#000066'>{<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.0pt;
mso-bidi-font-size:12.0pt;font-family:"Trebuchet MS";color:#000066'>int i,j;<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.0pt;
mso-bidi-font-size:12.0pt;font-family:"Trebuchet MS";color:#000066'>printf(&quot;i1=%p
j1=%p i=%p j=%p xyz\n&quot;,</span><span style='font-size:10.0pt;mso-bidi-font-size:
12.0pt;font-family:Tahoma;mso-bidi-font-family:"Times New Roman";color:#000066'>&amp;</span><span
style='font-size:10.0pt;mso-bidi-font-size:12.0pt;font-family:"Trebuchet MS";
color:#000066'>i1, </span><span style='font-size:10.0pt;mso-bidi-font-size:
12.0pt;font-family:Tahoma;mso-bidi-font-family:"Times New Roman";color:#000066'>&amp;</span><span
style='font-size:10.0pt;mso-bidi-font-size:12.0pt;font-family:"Trebuchet MS";
color:#000066'>j1 , </span><span style='font-size:10.0pt;mso-bidi-font-size:
12.0pt;font-family:Tahoma;mso-bidi-font-family:"Times New Roman";color:#000066'>&amp;</span><span
style='font-size:10.0pt;mso-bidi-font-size:12.0pt;font-family:"Trebuchet MS";
color:#000066'>i,</span><span style='font-size:10.0pt;mso-bidi-font-size:12.0pt;
font-family:Tahoma;mso-bidi-font-family:"Times New Roman";color:#000066'>&amp;</span><span
style='font-size:10.0pt;mso-bidi-font-size:12.0pt;font-family:"Trebuchet MS";
color:#000066'>j);<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.0pt;
mso-bidi-font-size:12.0pt;font-family:"Trebuchet MS";color:#000066'>}<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.0pt;
mso-bidi-font-size:12.0pt;font-family:"Trebuchet MS";color:#000066'>aaa(int i1,
int j1)<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.0pt;
mso-bidi-font-size:12.0pt;font-family:"Trebuchet MS";color:#000066'>{<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.0pt;
mso-bidi-font-size:12.0pt;font-family:"Trebuchet MS";color:#000066'>int i,j;<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.0pt;
mso-bidi-font-size:12.0pt;font-family:"Trebuchet MS";color:#000066'>printf(&quot;i1=%p
j1=%p i=%p j=%p aaa\n&quot;,</span><span style='font-size:10.0pt;mso-bidi-font-size:
12.0pt;font-family:Tahoma;mso-bidi-font-family:"Times New Roman";color:#000066'>&amp;</span><span
style='font-size:10.0pt;mso-bidi-font-size:12.0pt;font-family:"Trebuchet MS";
color:#000066'>i1, </span><span style='font-size:10.0pt;mso-bidi-font-size:
12.0pt;font-family:Tahoma;mso-bidi-font-family:"Times New Roman";color:#000066'>&amp;</span><span
style='font-size:10.0pt;mso-bidi-font-size:12.0pt;font-family:"Trebuchet MS";
color:#000066'>j1 , </span><span style='font-size:10.0pt;mso-bidi-font-size:
12.0pt;font-family:Tahoma;mso-bidi-font-family:"Times New Roman";color:#000066'>&amp;</span><span
style='font-size:10.0pt;mso-bidi-font-size:12.0pt;font-family:"Trebuchet MS";
color:#000066'>i,</span><span style='font-size:10.0pt;mso-bidi-font-size:12.0pt;
font-family:Tahoma;mso-bidi-font-family:"Times New Roman";color:#000066'>&amp;</span><span
style='font-size:10.0pt;mso-bidi-font-size:12.0pt;font-family:"Trebuchet MS";
color:#000066'>j);<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.0pt;
mso-bidi-font-size:12.0pt;font-family:"Trebuchet MS";color:#000066'>}<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.0pt;
mso-bidi-font-size:12.0pt;font-family:"Trebuchet MS";color:#000066'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<h1><span style='color:#000066'>Output<o:p></o:p></span></h1>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.0pt;
mso-bidi-font-size:12.0pt;font-family:"Trebuchet MS";color:#000066'>i1=0012FEDC
j1=0012FEE0 i=0012FED0 j=0012FECC abc<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.0pt;
mso-bidi-font-size:12.0pt;font-family:"Trebuchet MS";color:#000066'>k1=0012FEC4
l1=0012FEC8 k=0012FEB8 l=0012FEB4 pqr<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.0pt;
mso-bidi-font-size:12.0pt;font-family:"Trebuchet MS";color:#000066'>i1=0012FEAC
j1=0012FEB0 i=0012FEA0 j=0012FE9C xyz<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.0pt;
mso-bidi-font-size:12.0pt;font-family:"Trebuchet MS";color:#000066'>i1=0012FEAC
j1=0012FEB0 i=0012FEA0 j=0012FE9C aaa<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.0pt;
mso-bidi-font-size:12.0pt;font-family:"Trebuchet MS";color:#000066'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.0pt;
mso-bidi-font-size:12.0pt;font-family:"Trebuchet MS";color:#000066'>The above
program reinforces the same principles that parameters and local variables are
created on the stack. <o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.0pt;
mso-bidi-font-size:12.0pt;font-family:"Trebuchet MS";color:#000066'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.0pt;
mso-bidi-font-size:12.0pt;font-family:"Trebuchet MS";color:#000066'>The entry
point function main calls function abc. Since, the stack starts at memory
0x0012fee4, the variables i and j are created at the memory locations
0x0012fed0 and 0x0012fecc respectively. There is a gap of 8 bytes as seen
before.<span style="mso-spacerun: yes">  </span><o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.0pt;
mso-bidi-font-size:12.0pt;font-family:"Trebuchet MS";color:#000066'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.0pt;
mso-bidi-font-size:12.0pt;font-family:"Trebuchet MS";color:#000066'>At this
point, the stack pointer is positioned at 0x0012fecc. When function pqr is
called from within abc, the parameters 4 and 3 are pushed on the stack. This is
in the reverse order, therefore first 4 goes on the stack at 0x0012fec8 and
then 3 at 0x0012fec4. These become the addresses of parameters k1 and l1
respectively. The call then allocates 8 bytes on the stack for itself, thus
giving the variables k and l the address of 0x0012feb8 and 0x0012feb4
respectively. <o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.0pt;
mso-bidi-font-size:12.0pt;font-family:"Trebuchet MS";color:#000066'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.0pt;
mso-bidi-font-size:12.0pt;font-family:"Trebuchet MS";color:#000066'>The next
two function-call of xyz and aaa both give the same values. For the call of
function xyz with function pqr, the stack is now at 0012feb4. The parameters 5
and 6 are pushed at address location 0x0012feb0 and 0x0012feac respectively.
The variables i and j then are allocated after moving 8 away, thus end up at
locations 0012Fea0 and 0012Fe9c. When this function ends, the system moves the
stack up the same amount that it moved down. Therefore, the stack at the end of
the call of xyz will come to location 0012Feb4. <o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.0pt;
mso-bidi-font-size:12.0pt;font-family:"Trebuchet MS";color:#000066'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.0pt;
mso-bidi-font-size:12.0pt;font-family:"Trebuchet MS";color:#000066'>The call of
the aaa function follows the same process, thus bringing the stack back to
0012Feb4 in the end. When function pqr exits, the stack returns to 0012Fecc. <o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.0pt;
mso-bidi-font-size:12.0pt;font-family:"Trebuchet MS";color:#000066'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.0pt;
mso-bidi-font-size:12.0pt;font-family:"Trebuchet MS";color:#000066'>As a
result, at the end of each function, the stack moves back to where it was
before the function is called. <o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.0pt;
mso-bidi-font-size:12.0pt;font-family:"Trebuchet MS";color:#000066'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.0pt;
mso-bidi-font-size:12.0pt;font-family:"Trebuchet MS";color:#000066'>This theory
can be tried out with as many functions, but eventually, each will see the
stack at the same position. These functions in turn may call as many functions
as well, however the same rules apply. At the end of a function call, the stack
moves up as much as it had moved down. Each one cleans up its own mess. <o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.0pt;
mso-bidi-font-size:12.0pt;font-family:"Trebuchet MS";color:#000066'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><u><span style='font-size:10.0pt;
mso-bidi-font-size:12.0pt;font-family:"Trebuchet MS";color:#000066'>A5.c</span></u><span
style='font-size:10.0pt;mso-bidi-font-size:12.0pt;font-family:"Trebuchet MS";
color:#000066'><o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.0pt;
mso-bidi-font-size:12.0pt;font-family:"Trebuchet MS";color:#000066'>main()<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.0pt;
mso-bidi-font-size:12.0pt;font-family:"Trebuchet MS";color:#000066'>{<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.0pt;
mso-bidi-font-size:12.0pt;font-family:"Trebuchet MS";color:#000066'>int i,j;<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.0pt;
mso-bidi-font-size:12.0pt;font-family:"Trebuchet MS";color:#000066'>i = 2;<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.0pt;
mso-bidi-font-size:12.0pt;font-family:"Trebuchet MS";color:#000066'>j = 3;<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.0pt;
mso-bidi-font-size:12.0pt;font-family:"Trebuchet MS";color:#000066'>printf(&quot;Address
of i=%p j=%p\n&quot;,</span><span style='font-size:10.0pt;mso-bidi-font-size:
12.0pt;font-family:Tahoma;mso-bidi-font-family:"Times New Roman";color:#000066'>&amp;</span><span
style='font-size:10.0pt;mso-bidi-font-size:12.0pt;font-family:"Trebuchet MS";
color:#000066'>i,</span><span style='font-size:10.0pt;mso-bidi-font-size:12.0pt;
font-family:Tahoma;mso-bidi-font-family:"Times New Roman";color:#000066'>&amp;</span><span
style='font-size:10.0pt;mso-bidi-font-size:12.0pt;font-family:"Trebuchet MS";
color:#000066'>j);<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.0pt;
mso-bidi-font-size:12.0pt;font-family:"Trebuchet MS";color:#000066'>abc(i,j);<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.0pt;
mso-bidi-font-size:12.0pt;font-family:"Trebuchet MS";color:#000066'>printf(&quot;i=%d\n&quot;,i);<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.0pt;
mso-bidi-font-size:12.0pt;font-family:"Trebuchet MS";color:#000066'>}<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.0pt;
mso-bidi-font-size:12.0pt;font-family:"Trebuchet MS";color:#000066'>int abc(int
x, int y)<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.0pt;
mso-bidi-font-size:12.0pt;font-family:"Trebuchet MS";color:#000066'>{<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.0pt;
mso-bidi-font-size:12.0pt;font-family:"Trebuchet MS";color:#000066'>int *z;<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.0pt;
mso-bidi-font-size:12.0pt;font-family:"Trebuchet MS";color:#000066'>printf(&quot;Adress
of z=%p x=%p y=%p\n&quot;,</span><span style='font-size:10.0pt;mso-bidi-font-size:
12.0pt;font-family:Tahoma;mso-bidi-font-family:"Times New Roman";color:#000066'>&amp;</span><span
style='font-size:10.0pt;mso-bidi-font-size:12.0pt;font-family:"Trebuchet MS";
color:#000066'>z,</span><span style='font-size:10.0pt;mso-bidi-font-size:12.0pt;
font-family:Tahoma;mso-bidi-font-family:"Times New Roman";color:#000066'>&amp;</span><span
style='font-size:10.0pt;mso-bidi-font-size:12.0pt;font-family:"Trebuchet MS";
color:#000066'>x,</span><span style='font-size:10.0pt;mso-bidi-font-size:12.0pt;
font-family:Tahoma;mso-bidi-font-family:"Times New Roman";color:#000066'>&amp;</span><span
style='font-size:10.0pt;mso-bidi-font-size:12.0pt;font-family:"Trebuchet MS";
color:#000066'>y);<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.0pt;
mso-bidi-font-size:12.0pt;font-family:"Trebuchet MS";color:#000066'>z = </span><span
style='font-size:10.0pt;mso-bidi-font-size:12.0pt;font-family:Tahoma;
mso-bidi-font-family:"Times New Roman";color:#000066'>&amp;</span><span
style='font-size:10.0pt;mso-bidi-font-size:12.0pt;font-family:"Trebuchet MS";
color:#000066'>y;<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.0pt;
mso-bidi-font-size:12.0pt;font-family:"Trebuchet MS";color:#000066'>z++;z++;<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.0pt;
mso-bidi-font-size:12.0pt;font-family:"Trebuchet MS";color:#000066'>printf(&quot;z=%p\n&quot;,z);<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.0pt;
mso-bidi-font-size:12.0pt;font-family:"Trebuchet MS";color:#000066'>*z = 8;<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.0pt;
mso-bidi-font-size:12.0pt;font-family:"Trebuchet MS";color:#000066'>}<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.0pt;
mso-bidi-font-size:12.0pt;font-family:"Trebuchet MS";color:#000066'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<h1><span style='color:#000066'>Output<o:p></o:p></span></h1>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.0pt;
mso-bidi-font-size:12.0pt;font-family:"Trebuchet MS";color:#000066'>Address of
i=0012FEE0 j=0012FEDC<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.0pt;
mso-bidi-font-size:12.0pt;font-family:"Trebuchet MS";color:#000066'>Adress of z=0012FEC8
x=0012FED4 y=0012FED8<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.0pt;
mso-bidi-font-size:12.0pt;font-family:"Trebuchet MS";color:#000066'>z=0012FEE0<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.0pt;
mso-bidi-font-size:12.0pt;font-family:"Trebuchet MS";color:#000066'>i=8<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.0pt;
mso-bidi-font-size:12.0pt;font-family:"Trebuchet MS";color:#000066'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.0pt;
mso-bidi-font-size:12.0pt;font-family:"Trebuchet MS";color:#000066'>This last
example on stack shows how dangerous stack manipulation can get. The function
main is the first function to be called and in all other aspects, it behaves in
a similar manner like the other functions when dealing with stack memory. The
local variables i and j in main are also created on the stack at 0x0012fee0 and
0x0012fedc. <o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.0pt;
mso-bidi-font-size:12.0pt;font-family:"Trebuchet MS";color:#000066'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.0pt;
mso-bidi-font-size:12.0pt;font-family:"Trebuchet MS";color:#000066'>The call to
function abc will place the values 3 and 2 on the stack at locations 0012Fed4
and 0012Fed8 before taking up 8 bytes for itself. The parameters x and y are at
the above addresses.<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.0pt;
mso-bidi-font-size:12.0pt;font-family:"Trebuchet MS";color:#000066'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.0pt;
mso-bidi-font-size:12.0pt;font-family:"Trebuchet MS";color:#000066'>The pointer
variable z is stored at location 0x0012fec8. This variable is initialized to
address of parameter y, which is a value of 0x0012fed8. Thereafter, z is
incremented by 8, hence its new value is 0x0012fee0. But, if you remember, this
is the address occupied by variable i. <o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.0pt;
mso-bidi-font-size:12.0pt;font-family:"Trebuchet MS";color:#000066'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.0pt;
mso-bidi-font-size:12.0pt;font-family:"Trebuchet MS";color:#000066'>Further,
using the features of pointers, a value of 8 is written to this location,
thereupon actually changing the value of variable i. This is the power of pointers.
One pointer variable, if it wants can overwrite the value of a variable in
another function indirectly. Since, all local data is stored on the stack, it
is susceptible to being overwritten.<span style="mso-spacerun: yes"> 
</span>Therefore, call someone else’s function with care.<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.0pt;
mso-bidi-font-size:12.0pt;font-family:"Trebuchet MS";color:#000066'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=MsoNormal><span style='font-size:11.0pt;mso-bidi-font-size:12.0pt;
color:#000066'>Assembler code in C programs<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.0pt;
mso-bidi-font-size:12.0pt;font-family:"Trebuchet MS";color:#000066'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.0pt;
mso-bidi-font-size:12.0pt;font-family:"Trebuchet MS";color:#000066'>The next
series of programs explain assembler programming. We believe that every
programmer in the world should understand assembler. Unfortunately, our view is
not held by the majority. It does not matter which language you use to write
your code in, when it finally executes, it will be assembler code and not your
favorite language code that executes. We are not suggesting that you write your
code in assembler, all that we are saying is using assembler helps in
understand the internals of computing better. <o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.0pt;
mso-bidi-font-size:12.0pt;font-family:"Trebuchet MS";color:#000066'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.0pt;
mso-bidi-font-size:12.0pt;font-family:"Trebuchet MS";color:#000066'>A
microprocessor or a computer is made up of entities or memory called registers.
These registers are the basic building blocks that any assembler programmer
works with and they are given names like eax, ebx etc. <o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.0pt;
mso-bidi-font-size:12.0pt;font-family:"Trebuchet MS";color:#000066'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.0pt;
mso-bidi-font-size:12.0pt;font-family:"Trebuchet MS";color:#000066'>Whenever we
encounter the return instruction in C like ‘return 100’, two things happen.
One, the value 100 is placed in the eax register and two, the function ends
thus control goes back to the function that called it. It is assumed here that
any value returned by the called function will be found in the eax register. <o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.0pt;
mso-bidi-font-size:12.0pt;font-family:"Trebuchet MS";color:#000066'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.0pt;
mso-bidi-font-size:12.0pt;font-family:"Trebuchet MS";color:#000066'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.0pt;
mso-bidi-font-size:12.0pt;font-family:"Trebuchet MS";color:#000066'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><u><span style='font-size:10.0pt;
mso-bidi-font-size:12.0pt;font-family:"Trebuchet MS";color:#000066'>A6.c<o:p></o:p></span></u></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.0pt;
mso-bidi-font-size:12.0pt;font-family:"Trebuchet MS";color:#000066'>main()<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.0pt;
mso-bidi-font-size:12.0pt;font-family:"Trebuchet MS";color:#000066'>{<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.0pt;
mso-bidi-font-size:12.0pt;font-family:"Trebuchet MS";color:#000066'>int i;<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.0pt;
mso-bidi-font-size:12.0pt;font-family:"Trebuchet MS";color:#000066'>i=abc();<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.0pt;
mso-bidi-font-size:12.0pt;font-family:"Trebuchet MS";color:#000066'>printf(“%d\n”,i);<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.0pt;
mso-bidi-font-size:12.0pt;font-family:"Trebuchet MS";color:#000066'>}<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.0pt;
mso-bidi-font-size:12.0pt;font-family:"Trebuchet MS";color:#000066'>int abc()<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.0pt;
mso-bidi-font-size:12.0pt;font-family:"Trebuchet MS";color:#000066'>{<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.0pt;
mso-bidi-font-size:12.0pt;font-family:"Trebuchet MS";color:#000066'>return 100;<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.0pt;
mso-bidi-font-size:12.0pt;font-family:"Trebuchet MS";color:#000066'>}<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.0pt;
mso-bidi-font-size:12.0pt;font-family:"Trebuchet MS";color:#000066'>-------<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.0pt;
mso-bidi-font-size:12.0pt;font-family:"Trebuchet MS";color:#000066'>main()<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.0pt;
mso-bidi-font-size:12.0pt;font-family:"Trebuchet MS";color:#000066'>{<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.0pt;
mso-bidi-font-size:12.0pt;font-family:"Trebuchet MS";color:#000066'>int i;<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.0pt;
mso-bidi-font-size:12.0pt;font-family:"Trebuchet MS";color:#000066'>i = abc();<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.0pt;
mso-bidi-font-size:12.0pt;font-family:"Trebuchet MS";color:#000066'>printf(&quot;%d\n&quot;,i);<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.0pt;
mso-bidi-font-size:12.0pt;font-family:"Trebuchet MS";color:#000066'>}<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.0pt;
mso-bidi-font-size:12.0pt;font-family:"Trebuchet MS";color:#000066'>int abc()<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.0pt;
mso-bidi-font-size:12.0pt;font-family:"Trebuchet MS";color:#000066'>{<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.0pt;
mso-bidi-font-size:12.0pt;font-family:"Trebuchet MS";color:#000066'>__asm<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.0pt;
mso-bidi-font-size:12.0pt;font-family:"Trebuchet MS";color:#000066'>{<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.0pt;
mso-bidi-font-size:12.0pt;font-family:"Trebuchet MS";color:#000066'>mov eax,100<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.0pt;
mso-bidi-font-size:12.0pt;font-family:"Trebuchet MS";color:#000066'>}<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.0pt;
mso-bidi-font-size:12.0pt;font-family:"Trebuchet MS";color:#000066'>}<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.0pt;
mso-bidi-font-size:12.0pt;font-family:"Trebuchet MS";color:#000066'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.0pt;
mso-bidi-font-size:12.0pt;font-family:"Trebuchet MS";color:#000066'>&gt;cl a.c<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.0pt;
mso-bidi-font-size:12.0pt;font-family:"Trebuchet MS";color:#000066'>&gt;a<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.0pt;
mso-bidi-font-size:12.0pt;font-family:"Trebuchet MS";color:#000066'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<h1><span style='color:#000066'>Output<o:p></o:p></span></h1>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.0pt;
mso-bidi-font-size:12.0pt;font-family:"Trebuchet MS";color:#000066'>100<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.0pt;
mso-bidi-font-size:12.0pt;font-family:"Trebuchet MS";color:#000066'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.0pt;
mso-bidi-font-size:12.0pt;font-family:"Trebuchet MS";color:#000066'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.0pt;
mso-bidi-font-size:12.0pt;font-family:"Trebuchet MS";color:#000066'>The above
program simulates the return instruction by simply placing a value in a
register. The most common instruction is the mov instruction, which normally
makes up over 25% of any assembler program. The syntax demands first the
destination register, then a comma and then the entity that is to be placed in
the destination register. Thus the instruction mov eax,100 will place the value
100 in the eax register. <o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.0pt;
mso-bidi-font-size:12.0pt;font-family:"Trebuchet MS";color:#000066'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.0pt;
mso-bidi-font-size:12.0pt;font-family:"Trebuchet MS";color:#000066'>To place
the assembler instruction in a C program, we enclose the instructions within
the keyword __asm with the normal curly braces. In the above program the
instruction set is placed in function abc. When the function executes, it
simply moves/copies the value 100 in the eax register and then quits. <o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.0pt;
mso-bidi-font-size:12.0pt;font-family:"Trebuchet MS";color:#000066'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.0pt;
mso-bidi-font-size:12.0pt;font-family:"Trebuchet MS";color:#000066'>Coming back
to function main, the value placed in the eax register is given to variable i.
Thus, there is no way that the program knows or cares whether it is the return
statement or a manual insertion of a value in the eax register that has done
the job. <o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.0pt;
mso-bidi-font-size:12.0pt;font-family:"Trebuchet MS";color:#000066'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><u><span style='font-size:10.0pt;
mso-bidi-font-size:12.0pt;font-family:"Trebuchet MS";color:#000066'>A7.c<o:p></o:p></span></u></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.0pt;
mso-bidi-font-size:12.0pt;font-family:"Trebuchet MS";color:#000066'>main()<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.0pt;
mso-bidi-font-size:12.0pt;font-family:"Trebuchet MS";color:#000066'>{<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.0pt;
mso-bidi-font-size:12.0pt;font-family:"Trebuchet MS";color:#000066'>__asm<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.0pt;
mso-bidi-font-size:12.0pt;font-family:"Trebuchet MS";color:#000066'>{<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.0pt;
mso-bidi-font-size:12.0pt;font-family:"Trebuchet MS";color:#000066'>push 10<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.0pt;
mso-bidi-font-size:12.0pt;font-family:"Trebuchet MS";color:#000066'>push 20<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.0pt;
mso-bidi-font-size:12.0pt;font-family:"Trebuchet MS";color:#000066'>}<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.0pt;
mso-bidi-font-size:12.0pt;font-family:"Trebuchet MS";color:#000066'>abc();<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.0pt;
mso-bidi-font-size:12.0pt;font-family:"Trebuchet MS";color:#000066'>}<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.0pt;
mso-bidi-font-size:12.0pt;font-family:"Trebuchet MS";color:#000066'>int abc(int
i , int j)<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.0pt;
mso-bidi-font-size:12.0pt;font-family:"Trebuchet MS";color:#000066'>{<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.0pt;
mso-bidi-font-size:12.0pt;font-family:"Trebuchet MS";color:#000066'>printf(&quot;%d
%d\n&quot;, i , j);<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.0pt;
mso-bidi-font-size:12.0pt;font-family:"Trebuchet MS";color:#000066'>}<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.0pt;
mso-bidi-font-size:12.0pt;font-family:"Trebuchet MS";color:#000066'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<h1><span style='color:#000066'>Output<o:p></o:p></span></h1>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.0pt;
mso-bidi-font-size:12.0pt;font-family:"Trebuchet MS";color:#000066'>20 10<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.0pt;
mso-bidi-font-size:12.0pt;font-family:"Trebuchet MS";color:#000066'>error<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.0pt;
mso-bidi-font-size:12.0pt;font-family:"Trebuchet MS";color:#000066'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.0pt;
mso-bidi-font-size:12.0pt;font-family:"Trebuchet MS";color:#000066'>The next
series of programs show how a function call in C is converted to assembler
code. When there is a call to a function, first, the parameters get pushed on
the stack in the reverse order. In assembler, it is the push instruction that
is used to push anything on the stack. <o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.0pt;
mso-bidi-font-size:12.0pt;font-family:"Trebuchet MS";color:#000066'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.0pt;
mso-bidi-font-size:12.0pt;font-family:"Trebuchet MS";color:#000066'>As a
result, a call to abc function in C which is abc(20,10); will first push 10 on the
stack using the push 10 instruction, which is then followed by the push 20
instruction . The stack will now look like figure 4. <o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.0pt;
mso-bidi-font-size:12.0pt;font-family:"Trebuchet MS";color:#000066'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.0pt;
mso-bidi-font-size:12.0pt;font-family:"Trebuchet MS";color:#000066'>Thereafter
the abc function is called in the normal C way but with no parameters.<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.0pt;
mso-bidi-font-size:12.0pt;font-family:"Trebuchet MS";color:#000066'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.0pt;
mso-bidi-font-size:12.0pt;font-family:"Trebuchet MS";color:#000066'>Function
abc is oblivious to the number of parameters it gets called with. All that it
assumes is that it is called with the parameters present on the stack. It
displays their values and then returns to main. However, an error results. This
is because the stack is not restored back to where it should be. We moved it
down 8 bytes while supplying parameters, so once the function call ends, it has
to be restored back.<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.0pt;
mso-bidi-font-size:12.0pt;font-family:"Trebuchet MS";color:#000066'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.0pt;
mso-bidi-font-size:12.0pt;font-family:"Trebuchet MS";color:#000066'>The next
program repairs this glitch.<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.0pt;
mso-bidi-font-size:12.0pt;font-family:"Trebuchet MS";color:#000066'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><u><span style='font-size:10.0pt;
mso-bidi-font-size:12.0pt;font-family:"Trebuchet MS";color:#000066'>A8.c</span></u><span
style='font-size:10.0pt;mso-bidi-font-size:12.0pt;font-family:"Trebuchet MS";
color:#000066'><o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.0pt;
mso-bidi-font-size:12.0pt;font-family:"Trebuchet MS";color:#000066'>main()<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.0pt;
mso-bidi-font-size:12.0pt;font-family:"Trebuchet MS";color:#000066'>{<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.0pt;
mso-bidi-font-size:12.0pt;font-family:"Trebuchet MS";color:#000066'>__asm<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.0pt;
mso-bidi-font-size:12.0pt;font-family:"Trebuchet MS";color:#000066'>{<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.0pt;
mso-bidi-font-size:12.0pt;font-family:"Trebuchet MS";color:#000066'>push 10<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.0pt;
mso-bidi-font-size:12.0pt;font-family:"Trebuchet MS";color:#000066'>push 20<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.0pt;
mso-bidi-font-size:12.0pt;font-family:"Trebuchet MS";color:#000066'>}<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.0pt;
mso-bidi-font-size:12.0pt;font-family:"Trebuchet MS";color:#000066'>abc();<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.0pt;
mso-bidi-font-size:12.0pt;font-family:"Trebuchet MS";color:#000066'>__asm<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.0pt;
mso-bidi-font-size:12.0pt;font-family:"Trebuchet MS";color:#000066'>{<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.0pt;
mso-bidi-font-size:12.0pt;font-family:"Trebuchet MS";color:#000066'>add esp,8<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.0pt;
mso-bidi-font-size:12.0pt;font-family:"Trebuchet MS";color:#000066'>}<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.0pt;
mso-bidi-font-size:12.0pt;font-family:"Trebuchet MS";color:#000066'>}<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.0pt;
mso-bidi-font-size:12.0pt;font-family:"Trebuchet MS";color:#000066'>int abc(int
i , int j)<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.0pt;
mso-bidi-font-size:12.0pt;font-family:"Trebuchet MS";color:#000066'>{<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.0pt;
mso-bidi-font-size:12.0pt;font-family:"Trebuchet MS";color:#000066'>printf(&quot;%d
%d\n&quot;, i , j);<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.0pt;
mso-bidi-font-size:12.0pt;font-family:"Trebuchet MS";color:#000066'>}<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.0pt;
mso-bidi-font-size:12.0pt;font-family:"Trebuchet MS";color:#000066'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<h1><span style='color:#000066'>Output<o:p></o:p></span></h1>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.0pt;
mso-bidi-font-size:12.0pt;font-family:"Trebuchet MS";color:#000066'>20 10<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.0pt;
mso-bidi-font-size:12.0pt;font-family:"Trebuchet MS";color:#000066'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.0pt;
mso-bidi-font-size:12.0pt;font-family:"Trebuchet MS";color:#000066'>The program
amends the error by adding 8 to the stack pointer using the esp register. It is
the esp register which decides where the stack starts in memory. If its value is
100, the stack is said to start at memory location 100. With every push
instruction, the stack moves down 4 bytes or goes 4 less. <o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.0pt;
mso-bidi-font-size:12.0pt;font-family:"Trebuchet MS";color:#000066'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.0pt;
mso-bidi-font-size:12.0pt;font-family:"Trebuchet MS";color:#000066'>The add
instruction takes a register as the first parameter followed by the incremental
value hence ‘add esp,8’. Since the stack is restored back to its original
position as before the function call, no errors are seen anymore.<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.0pt;
mso-bidi-font-size:12.0pt;font-family:"Trebuchet MS";color:#000066'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><u><span style='font-size:10.0pt;
mso-bidi-font-size:12.0pt;font-family:"Trebuchet MS";color:#000066'>A9.c</span></u><span
style='font-size:10.0pt;mso-bidi-font-size:12.0pt;font-family:"Trebuchet MS";
color:#000066'><o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.0pt;
mso-bidi-font-size:12.0pt;font-family:"Trebuchet MS";color:#000066'>main()<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.0pt;
mso-bidi-font-size:12.0pt;font-family:"Trebuchet MS";color:#000066'>{<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.0pt;
mso-bidi-font-size:12.0pt;font-family:"Trebuchet MS";color:#000066'>printf(&quot;esp=%x\n&quot;,esp());<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.0pt;
mso-bidi-font-size:12.0pt;font-family:"Trebuchet MS";color:#000066'>__asm<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.0pt;
mso-bidi-font-size:12.0pt;font-family:"Trebuchet MS";color:#000066'>{<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.0pt;
mso-bidi-font-size:12.0pt;font-family:"Trebuchet MS";color:#000066'>push 10<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.0pt;
mso-bidi-font-size:12.0pt;font-family:"Trebuchet MS";color:#000066'>}<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.0pt;
mso-bidi-font-size:12.0pt;font-family:"Trebuchet MS";color:#000066'>printf(&quot;esp=%x\n&quot;,esp());<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.0pt;
mso-bidi-font-size:12.0pt;font-family:"Trebuchet MS";color:#000066'>__asm<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.0pt;
mso-bidi-font-size:12.0pt;font-family:"Trebuchet MS";color:#000066'>{<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.0pt;
mso-bidi-font-size:12.0pt;font-family:"Trebuchet MS";color:#000066'>push 20<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.0pt;
mso-bidi-font-size:12.0pt;font-family:"Trebuchet MS";color:#000066'>}<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.0pt;
mso-bidi-font-size:12.0pt;font-family:"Trebuchet MS";color:#000066'>printf(&quot;esp=%x\n&quot;,esp());<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.0pt;
mso-bidi-font-size:12.0pt;font-family:"Trebuchet MS";color:#000066'>abc();<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.0pt;
mso-bidi-font-size:12.0pt;font-family:"Trebuchet MS";color:#000066'>printf(&quot;esp=%x\n&quot;,esp());<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.0pt;
mso-bidi-font-size:12.0pt;font-family:"Trebuchet MS";color:#000066'>__asm<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.0pt;
mso-bidi-font-size:12.0pt;font-family:"Trebuchet MS";color:#000066'>{<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.0pt;
mso-bidi-font-size:12.0pt;font-family:"Trebuchet MS";color:#000066'>add esp,8<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.0pt;
mso-bidi-font-size:12.0pt;font-family:"Trebuchet MS";color:#000066'>}<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.0pt;
mso-bidi-font-size:12.0pt;font-family:"Trebuchet MS";color:#000066'>printf(&quot;esp=%x\n&quot;,esp());<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.0pt;
mso-bidi-font-size:12.0pt;font-family:"Trebuchet MS";color:#000066'>}<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.0pt;
mso-bidi-font-size:12.0pt;font-family:"Trebuchet MS";color:#000066'>int abc(int
i , int j)<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.0pt;
mso-bidi-font-size:12.0pt;font-family:"Trebuchet MS";color:#000066'>{<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.0pt;
mso-bidi-font-size:12.0pt;font-family:"Trebuchet MS";color:#000066'>printf(&quot;%d
%d\n&quot;, i , j);<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.0pt;
mso-bidi-font-size:12.0pt;font-family:"Trebuchet MS";color:#000066'>}<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.0pt;
mso-bidi-font-size:12.0pt;font-family:"Trebuchet MS";color:#000066'>int esp()<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.0pt;
mso-bidi-font-size:12.0pt;font-family:"Trebuchet MS";color:#000066'>{<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.0pt;
mso-bidi-font-size:12.0pt;font-family:"Trebuchet MS";color:#000066'>__asm<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.0pt;
mso-bidi-font-size:12.0pt;font-family:"Trebuchet MS";color:#000066'>{<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.0pt;
mso-bidi-font-size:12.0pt;font-family:"Trebuchet MS";color:#000066'>mov eax,esp<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.0pt;
mso-bidi-font-size:12.0pt;font-family:"Trebuchet MS";color:#000066'>}<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.0pt;
mso-bidi-font-size:12.0pt;font-family:"Trebuchet MS";color:#000066'>}<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.0pt;
mso-bidi-font-size:12.0pt;font-family:"Trebuchet MS";color:#000066'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<h1><span style='color:#000066'>Output<o:p></o:p></span></h1>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.0pt;
mso-bidi-font-size:12.0pt;font-family:"Trebuchet MS";color:#000066'>esp=12fedc<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.0pt;
mso-bidi-font-size:12.0pt;font-family:"Trebuchet MS";color:#000066'>esp=12fed8<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.0pt;
mso-bidi-font-size:12.0pt;font-family:"Trebuchet MS";color:#000066'>esp=12fed4<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.0pt;
mso-bidi-font-size:12.0pt;font-family:"Trebuchet MS";color:#000066'>20 10<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.0pt;
mso-bidi-font-size:12.0pt;font-family:"Trebuchet MS";color:#000066'>esp=12fed4<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.0pt;
mso-bidi-font-size:12.0pt;font-family:"Trebuchet MS";color:#000066'>esp=12fedc<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.0pt;
mso-bidi-font-size:12.0pt;font-family:"Trebuchet MS";color:#000066'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.0pt;
mso-bidi-font-size:12.0pt;font-family:"Trebuchet MS";color:#000066'>The above program
shows a newly added function called esp. This function simply copies the value
in the esp register to eax. This means that the return value of the function is
now the stack position. As a result, before the first push, the stack position
is seen at 12fedc and after the push 10 instruction, the stack shows a value of
12fed8 which is 4 less. Thus the stack has moved down 4 bytes. <o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.0pt;
mso-bidi-font-size:12.0pt;font-family:"Trebuchet MS";color:#000066'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.0pt;
mso-bidi-font-size:12.0pt;font-family:"Trebuchet MS";color:#000066'>The second
push 20 instruction moves the stack further down to12fed4. When function abc
ends, the stack is at the same position of 12fed4, which is what it was before
the function call. And before winding up, 8 is added to the stack position to
move it up to 12fedc. These numbers re-confirm our explanation. <o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.0pt;
mso-bidi-font-size:12.0pt;font-family:"Trebuchet MS";color:#000066'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><u><span style='font-size:10.0pt;
mso-bidi-font-size:12.0pt;font-family:"Trebuchet MS";color:#000066'>A10.c</span></u><span
style='font-size:10.0pt;mso-bidi-font-size:12.0pt;font-family:"Trebuchet MS";
color:#000066'><o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.0pt;
mso-bidi-font-size:12.0pt;font-family:"Trebuchet MS";color:#000066'>int abc(int
i , int j)<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.0pt;
mso-bidi-font-size:12.0pt;font-family:"Trebuchet MS";color:#000066'>{<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.0pt;
mso-bidi-font-size:12.0pt;font-family:"Trebuchet MS";color:#000066'>printf(&quot;%d
%d\n&quot;, i , j);<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.0pt;
mso-bidi-font-size:12.0pt;font-family:"Trebuchet MS";color:#000066'>}<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.0pt;
mso-bidi-font-size:12.0pt;font-family:"Trebuchet MS";color:#000066'>main()<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.0pt;
mso-bidi-font-size:12.0pt;font-family:"Trebuchet MS";color:#000066'>{<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.0pt;
mso-bidi-font-size:12.0pt;font-family:"Trebuchet MS";color:#000066'>__asm<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.0pt;
mso-bidi-font-size:12.0pt;font-family:"Trebuchet MS";color:#000066'>{<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.0pt;
mso-bidi-font-size:12.0pt;font-family:"Trebuchet MS";color:#000066'>push 10<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.0pt;
mso-bidi-font-size:12.0pt;font-family:"Trebuchet MS";color:#000066'>push 20<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.0pt;
mso-bidi-font-size:12.0pt;font-family:"Trebuchet MS";color:#000066'>call abc<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.0pt;
mso-bidi-font-size:12.0pt;font-family:"Trebuchet MS";color:#000066'>add esp,8<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.0pt;
mso-bidi-font-size:12.0pt;font-family:"Trebuchet MS";color:#000066'>}<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.0pt;
mso-bidi-font-size:12.0pt;font-family:"Trebuchet MS";color:#000066'>}<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.0pt;
mso-bidi-font-size:12.0pt;font-family:"Trebuchet MS";color:#000066'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<h1><span style='color:#000066'>Output<o:p></o:p></span></h1>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.0pt;
mso-bidi-font-size:12.0pt;font-family:"Trebuchet MS";color:#000066'>20 10<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.0pt;
mso-bidi-font-size:12.0pt;font-family:"Trebuchet MS";color:#000066'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.0pt;
mso-bidi-font-size:12.0pt;font-family:"Trebuchet MS";color:#000066'>A function
call in C has its equivalent in assembler; it is the call instruction. This
instruction only requires the actual physical address of the function to be
called. In this program, instead of giving the address of the function, we have
given it the function name. The system internally replaces the name of the
function with its address.<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.0pt;
mso-bidi-font-size:12.0pt;font-family:"Trebuchet MS";color:#000066'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.0pt;
mso-bidi-font-size:12.0pt;font-family:"Trebuchet MS";color:#000066'>The only
rationale in placing the function abc before main is that the compiler reads
the entire file only once. It is a single pass one, therefore it does not
reread the c file. Hence, it needs all function names to be created first
before they can be used.<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.0pt;
mso-bidi-font-size:12.0pt;font-family:"Trebuchet MS";color:#000066'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><u><span style='font-size:10.0pt;
mso-bidi-font-size:12.0pt;font-family:"Trebuchet MS";color:#000066'>A11.c</span></u><span
style='font-size:10.0pt;mso-bidi-font-size:12.0pt;font-family:"Trebuchet MS";
color:#000066'><o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.0pt;
mso-bidi-font-size:12.0pt;font-family:"Trebuchet MS";color:#000066'>int abc(int
i , int j)<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.0pt;
mso-bidi-font-size:12.0pt;font-family:"Trebuchet MS";color:#000066'>{<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.0pt;
mso-bidi-font-size:12.0pt;font-family:"Trebuchet MS";color:#000066'>printf(&quot;%d
%d\n&quot;, i , j);<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.0pt;
mso-bidi-font-size:12.0pt;font-family:"Trebuchet MS";color:#000066'>}<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.0pt;
mso-bidi-font-size:12.0pt;font-family:"Trebuchet MS";color:#000066'>main()<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.0pt;
mso-bidi-font-size:12.0pt;font-family:"Trebuchet MS";color:#000066'>{<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.0pt;
mso-bidi-font-size:12.0pt;font-family:"Trebuchet MS";color:#000066'>printf(&quot;%p\n&quot;,abc);<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.0pt;
mso-bidi-font-size:12.0pt;font-family:"Trebuchet MS";color:#000066'>}<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.0pt;
mso-bidi-font-size:12.0pt;font-family:"Trebuchet MS";color:#000066'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<h1><span style='color:#000066'>Output<o:p></o:p></span></h1>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.0pt;
mso-bidi-font-size:12.0pt;font-family:"Trebuchet MS";color:#000066'>00401000<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.0pt;
mso-bidi-font-size:12.0pt;font-family:"Trebuchet MS";color:#000066'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.0pt;
mso-bidi-font-size:12.0pt;font-family:"Trebuchet MS";color:#000066'>The name of
a function in C represents the address of the function. Therefore, the address
of abc function when displayed shows 401000 (on our machine).<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.0pt;
mso-bidi-font-size:12.0pt;font-family:"Trebuchet MS";color:#000066'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><u><span style='font-size:10.0pt;
mso-bidi-font-size:12.0pt;font-family:"Trebuchet MS";color:#000066'>A12.c<o:p></o:p></span></u></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.0pt;
mso-bidi-font-size:12.0pt;font-family:"Trebuchet MS";color:#000066'>int abc(int
i , int j)<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.0pt;
mso-bidi-font-size:12.0pt;font-family:"Trebuchet MS";color:#000066'>{<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.0pt;
mso-bidi-font-size:12.0pt;font-family:"Trebuchet MS";color:#000066'>printf(&quot;%d
%d\n&quot;, i , j);<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.0pt;
mso-bidi-font-size:12.0pt;font-family:"Trebuchet MS";color:#000066'>}<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.0pt;
mso-bidi-font-size:12.0pt;font-family:"Trebuchet MS";color:#000066'>main()<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.0pt;
mso-bidi-font-size:12.0pt;font-family:"Trebuchet MS";color:#000066'>{<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.0pt;
mso-bidi-font-size:12.0pt;font-family:"Trebuchet MS";color:#000066'>__asm<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.0pt;
mso-bidi-font-size:12.0pt;font-family:"Trebuchet MS";color:#000066'>{<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.0pt;
mso-bidi-font-size:12.0pt;font-family:"Trebuchet MS";color:#000066'>push 10<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.0pt;
mso-bidi-font-size:12.0pt;font-family:"Trebuchet MS";color:#000066'>push 20<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.0pt;
mso-bidi-font-size:12.0pt;font-family:"Trebuchet MS";color:#000066'>mov
eax,401000h<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.0pt;
mso-bidi-font-size:12.0pt;font-family:"Trebuchet MS";color:#000066'>call eax<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.0pt;
mso-bidi-font-size:12.0pt;font-family:"Trebuchet MS";color:#000066'>add esp,8<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.0pt;
mso-bidi-font-size:12.0pt;font-family:"Trebuchet MS";color:#000066'>}<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.0pt;
mso-bidi-font-size:12.0pt;font-family:"Trebuchet MS";color:#000066'>}<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.0pt;
mso-bidi-font-size:12.0pt;font-family:"Trebuchet MS";color:#000066'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<h1><span style='color:#000066'>Output<o:p></o:p></span></h1>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.0pt;
mso-bidi-font-size:12.0pt;font-family:"Trebuchet MS";color:#000066'>20 10<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.0pt;
mso-bidi-font-size:12.0pt;font-family:"Trebuchet MS";color:#000066'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.0pt;
mso-bidi-font-size:12.0pt;font-family:"Trebuchet MS";color:#000066'>Once we
know the address of function abc as 401000, we place this value in the eax
register. The call instruction is then given the address or the function name
through this eax register. <o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.0pt;
mso-bidi-font-size:12.0pt;font-family:"Trebuchet MS";color:#000066'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.0pt;
mso-bidi-font-size:12.0pt;font-family:"Trebuchet MS";color:#000066'>For the call
instruction, the value given to it is where it assumes some program resides.
Hence, it starts treating the bytes at that location as program code and starts
executing them. <o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.0pt;
mso-bidi-font-size:12.0pt;font-family:"Trebuchet MS";color:#000066'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.0pt;
mso-bidi-font-size:12.0pt;font-family:"Trebuchet MS";color:#000066'>Just for
your information, it is the job of the compiler/linker to replace function
names with actual addresses. <o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.0pt;
mso-bidi-font-size:12.0pt;font-family:"Trebuchet MS";color:#000066'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><u><span style='font-size:10.0pt;
mso-bidi-font-size:12.0pt;font-family:"Trebuchet MS";color:#000066'>A13.c</span></u><span
style='font-size:10.0pt;mso-bidi-font-size:12.0pt;font-family:"Trebuchet MS";
color:#000066'><o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.0pt;
mso-bidi-font-size:12.0pt;font-family:"Trebuchet MS";color:#000066'>#include
&lt;windows.h&gt;<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.0pt;
mso-bidi-font-size:12.0pt;font-family:"Trebuchet MS";color:#000066'>main()<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.0pt;
mso-bidi-font-size:12.0pt;font-family:"Trebuchet MS";color:#000066'>{<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.0pt;
mso-bidi-font-size:12.0pt;font-family:"Trebuchet MS";color:#000066'>char *p =
&quot;hi&quot;;<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.0pt;
mso-bidi-font-size:12.0pt;font-family:"Trebuchet MS";color:#000066'>char *q =
&quot;bye&quot;;<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.0pt;
mso-bidi-font-size:12.0pt;font-family:"Trebuchet MS";color:#000066'>printf(&quot;p=%p
q=%p\n&quot;,p,q);<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.0pt;
mso-bidi-font-size:12.0pt;font-family:"Trebuchet MS";color:#000066'>MessageBox(0,p,q,0);<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.0pt;
mso-bidi-font-size:12.0pt;font-family:"Trebuchet MS";color:#000066'>}<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.0pt;
mso-bidi-font-size:12.0pt;font-family:"Trebuchet MS";color:#000066'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.0pt;
mso-bidi-font-size:12.0pt;font-family:"Trebuchet MS";color:#000066'>&gt;cl a.c
user32.lib<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.0pt;
mso-bidi-font-size:12.0pt;font-family:"Trebuchet MS";color:#000066'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<h1><span style='color:#000066'>Output<o:p></o:p></span></h1>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.0pt;
mso-bidi-font-size:12.0pt;font-family:"Trebuchet MS";color:#000066'>p=00408040
q=00408044<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.0pt;
mso-bidi-font-size:12.0pt;font-family:"Trebuchet MS";color:#000066'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.0pt;
mso-bidi-font-size:12.0pt;font-family:"Trebuchet MS";color:#000066'>In all our
earlier programs, the code of the function, i.e. abc resided in the same file
with main. In this program, we have attempted to call the MessageBox function
whose code lies in a dll, user32.dll. This dll is copied by the system while
installing windows. Since the code lies in an external file, the
complier/linker, the cl command must have the lib file user32.lib explicitly
added. <o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.0pt;
mso-bidi-font-size:12.0pt;font-family:"Trebuchet MS";color:#000066'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.0pt;
mso-bidi-font-size:12.0pt;font-family:"Trebuchet MS";color:#000066'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.0pt;
mso-bidi-font-size:12.0pt;font-family:"Trebuchet MS";color:#000066'>A lib or a
library refers to the dll in which the code of a function resides. In the same
manner, file user32.lib identifies the dll in which the code of the MessageBox
function resides, which is user32.dll.<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.0pt;
mso-bidi-font-size:12.0pt;font-family:"Trebuchet MS";color:#000066'>Besides,
the above program also gives the address locations of the two strings p and q
in the data section of the exe file, which is at 00408040 and 00408044. <o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.0pt;
mso-bidi-font-size:12.0pt;font-family:"Trebuchet MS";color:#000066'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.0pt;
mso-bidi-font-size:12.0pt;font-family:"Trebuchet MS";color:#000066'>The
MessageBox function takes two strings as parameters as well as two zeroes,
where the first zero stands for the parent window handle and the last zero is
the type of message box that is to be displayed.<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.0pt;
mso-bidi-font-size:12.0pt;font-family:"Trebuchet MS";color:#000066'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><u><span style='font-size:10.0pt;
mso-bidi-font-size:12.0pt;font-family:"Trebuchet MS";color:#000066'>A14.c</span></u><span
style='font-size:10.0pt;mso-bidi-font-size:12.0pt;font-family:"Trebuchet MS";
color:#000066'><o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.0pt;
mso-bidi-font-size:12.0pt;font-family:"Trebuchet MS";color:#000066'>#include
&lt;windows.h&gt;<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.0pt;
mso-bidi-font-size:12.0pt;font-family:"Trebuchet MS";color:#000066'>main()<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.0pt;
mso-bidi-font-size:12.0pt;font-family:"Trebuchet MS";color:#000066'>{<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.0pt;
mso-bidi-font-size:12.0pt;font-family:"Trebuchet MS";color:#000066'>char *p =
&quot;hi&quot;;<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.0pt;
mso-bidi-font-size:12.0pt;font-family:"Trebuchet MS";color:#000066'>char *q =
&quot;bye&quot;;<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.0pt;
mso-bidi-font-size:12.0pt;font-family:"Trebuchet MS";color:#000066'>printf(&quot;%p
%p\n&quot;,p,q);<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.0pt;
mso-bidi-font-size:12.0pt;font-family:"Trebuchet MS";color:#000066'>__asm<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.0pt;
mso-bidi-font-size:12.0pt;font-family:"Trebuchet MS";color:#000066'>{<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.0pt;
mso-bidi-font-size:12.0pt;font-family:"Trebuchet MS";color:#000066'>push 0<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.0pt;
mso-bidi-font-size:12.0pt;font-family:"Trebuchet MS";color:#000066'>push
0x00408040<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.0pt;
mso-bidi-font-size:12.0pt;font-family:"Trebuchet MS";color:#000066'>push
0x00408044<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.0pt;
mso-bidi-font-size:12.0pt;font-family:"Trebuchet MS";color:#000066'>push 0<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.0pt;
mso-bidi-font-size:12.0pt;font-family:"Trebuchet MS";color:#000066'>call DWORD
PTR MessageBox<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.0pt;
mso-bidi-font-size:12.0pt;font-family:"Trebuchet MS";color:#000066'>}<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.0pt;
mso-bidi-font-size:12.0pt;font-family:"Trebuchet MS";color:#000066'>}<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.0pt;
mso-bidi-font-size:12.0pt;font-family:"Trebuchet MS";color:#000066'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.0pt;
mso-bidi-font-size:12.0pt;font-family:"Trebuchet MS";color:#000066'>This
program attempts at convert the call of the MessageBox function into assembler.
Bearing in mind that the parameters are pushed in the reverse order, first the
type of MessageBox is pushed, followed by the memory address of the two strings
and finally the window handle is placed on the stack. <o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.0pt;
mso-bidi-font-size:12.0pt;font-family:"Trebuchet MS";color:#000066'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.0pt;
mso-bidi-font-size:12.0pt;font-family:"Trebuchet MS";color:#000066'>While
calling the MessageBox function, the DWORD PTR is a ‘necessary-evil’, which we
will explain later. Further, all function in windows use the standard calling
convention that requires the called function and not the callee to restore the
stack to its original position. As a result, the function MessageBox before
quitting, would be adding 16 bytes to the stack.<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.0pt;
mso-bidi-font-size:12.0pt;font-family:"Trebuchet MS";color:#000066'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.0pt;
mso-bidi-font-size:12.0pt;font-family:"Trebuchet MS";color:#000066'>Due to
this, the stack is not restored in the program for it is the job of the
MessageBox function to clean up its mess. The advantage in having standard
calling function is that there is less code regardless of which, calling the
MessageBox function 10 times, would ask for 10 add instructions, in contrast to
one add instruction in the function itself.<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.0pt;
mso-bidi-font-size:12.0pt;font-family:"Trebuchet MS";color:#000066'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><u><span style='font-size:10.0pt;
mso-bidi-font-size:12.0pt;font-family:"Trebuchet MS";color:#000066'>A15.c</span></u><span
style='font-size:10.0pt;mso-bidi-font-size:12.0pt;font-family:"Trebuchet MS";
color:#000066'><o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.0pt;
mso-bidi-font-size:12.0pt;font-family:"Trebuchet MS";color:#000066'>#include
&lt;windows.h&gt;<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.0pt;
mso-bidi-font-size:12.0pt;font-family:"Trebuchet MS";color:#000066'>main()<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.0pt;
mso-bidi-font-size:12.0pt;font-family:"Trebuchet MS";color:#000066'>{<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.0pt;
mso-bidi-font-size:12.0pt;font-family:"Trebuchet MS";color:#000066'>HANDLE h;<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.0pt;
mso-bidi-font-size:12.0pt;font-family:"Trebuchet MS";color:#000066'>char *p;<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.0pt;
mso-bidi-font-size:12.0pt;font-family:"Trebuchet MS";color:#000066'>printf(&quot;%p\n&quot;,MessageBox);<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.0pt;
mso-bidi-font-size:12.0pt;font-family:"Trebuchet MS";color:#000066'>h =
LoadLibrary(&quot;user32.dll&quot;);<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.0pt;
mso-bidi-font-size:12.0pt;font-family:"Trebuchet MS";color:#000066'>p =
GetProcAddress(h,&quot;MessageBoxA&quot;);<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.0pt;
mso-bidi-font-size:12.0pt;font-family:"Trebuchet MS";color:#000066'>printf(&quot;h=%p
p=%p\n&quot;,h,p);<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.0pt;
mso-bidi-font-size:12.0pt;font-family:"Trebuchet MS";color:#000066'>}<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.0pt;
mso-bidi-font-size:12.0pt;font-family:"Trebuchet MS";color:#000066'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<h1><span style='color:#000066'>Output<o:p></o:p></span></h1>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.0pt;
mso-bidi-font-size:12.0pt;font-family:"Trebuchet MS";color:#000066'>77E375D5<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.0pt;
mso-bidi-font-size:12.0pt;font-family:"Trebuchet MS";color:#000066'>h=77E10000
p=77E375D5<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.0pt;
mso-bidi-font-size:12.0pt;font-family:"Trebuchet MS";color:#000066'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.0pt;
mso-bidi-font-size:12.0pt;font-family:"Trebuchet MS";color:#000066'>The name of
a function gives the address location of its code in memory. This had been
showcased using the abc function, in one of the above programs. This concept is
reused here to find out the address of the MessageBox function. <o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.0pt;
mso-bidi-font-size:12.0pt;font-family:"Trebuchet MS";color:#000066'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.0pt;
mso-bidi-font-size:12.0pt;font-family:"Trebuchet MS";color:#000066'>There are
two ways to it. The first is the easiest one, i.e. using the printf function.
The value is given as 77E375D5. <o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.0pt;
mso-bidi-font-size:12.0pt;font-family:"Trebuchet MS";color:#000066'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.0pt;
mso-bidi-font-size:12.0pt;font-family:"Trebuchet MS";color:#000066'>There is
very much a possibility that you may see a different value on your machine as
this value depends on where user32.dll is loaded in memory and where this
function resides in this dll. The value also depends on the version of Windows
and the service pack installed. Each version of windows may load user32.dll in
a different memory location. Besides, since the code of user32.dll is written
by Microsoft, it is their prerogative to decide where MessageBox function
resides in the dll. <o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.0pt;
mso-bidi-font-size:12.0pt;font-family:"Trebuchet MS";color:#000066'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.0pt;
mso-bidi-font-size:12.0pt;font-family:"Trebuchet MS";color:#000066'>The second
alternative is to use a function called LoadLibrary. The sole task of this
function is to load the dll user32.dll into memory. If the dll is already
present in memory, it is not loaded again. The return value of this function is
the memory location of the loaded dll. The value given is 77E10000. Thereafter,
using the GetProcAddress function, the actual address of the function within
this dll is achieved. <o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.0pt;
mso-bidi-font-size:12.0pt;font-family:"Trebuchet MS";color:#000066'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.0pt;
mso-bidi-font-size:12.0pt;font-family:"Trebuchet MS";color:#000066'>You may
notice that we have given the function name as MessageBoxA. The reason behind
it is that MessageBox in user32.dll has two names, MessageBoxA and MessageBoxW.
If it is the ascii version then MessageBoxA is to be used whereas if it is the
Unicode version then MessageBoxW is to be used. Since we are following the
ascii method, MessageBox internally boils down to MessageBoxA. There is a
#define in windows.h that converts the name MessageBox either to MessageBoxW or
MessageBoxA. <o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.0pt;
mso-bidi-font-size:12.0pt;font-family:"Trebuchet MS";color:#000066'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.0pt;
mso-bidi-font-size:12.0pt;font-family:"Trebuchet MS";color:#000066'>The
function GetProcAddress gives the same value of 77E375D5 as seen with the
printf function. <o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.0pt;
mso-bidi-font-size:12.0pt;font-family:"Trebuchet MS";color:#000066'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><u><span style='font-size:10.0pt;
mso-bidi-font-size:12.0pt;font-family:"Trebuchet MS";color:#000066'>A16.c</span></u><span
style='font-size:10.0pt;mso-bidi-font-size:12.0pt;font-family:"Trebuchet MS";
color:#000066'><o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.0pt;
mso-bidi-font-size:12.0pt;font-family:"Trebuchet MS";color:#000066'>#include
&lt;windows.h&gt;<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.0pt;
mso-bidi-font-size:12.0pt;font-family:"Trebuchet MS";color:#000066'>main()<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.0pt;
mso-bidi-font-size:12.0pt;font-family:"Trebuchet MS";color:#000066'>{<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.0pt;
mso-bidi-font-size:12.0pt;font-family:"Trebuchet MS";color:#000066'>char *p =
&quot;hi&quot;;<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.0pt;
mso-bidi-font-size:12.0pt;font-family:"Trebuchet MS";color:#000066'>char *q =
&quot;bye&quot;;<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.0pt;
mso-bidi-font-size:12.0pt;font-family:"Trebuchet MS";color:#000066'>LoadLibrary(&quot;user32.dll&quot;);<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.0pt;
mso-bidi-font-size:12.0pt;font-family:"Trebuchet MS";color:#000066'>printf(&quot;%x
%x\n&quot;,p,q);<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.0pt;
mso-bidi-font-size:12.0pt;font-family:"Trebuchet MS";color:#000066'>__asm<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.0pt;
mso-bidi-font-size:12.0pt;font-family:"Trebuchet MS";color:#000066'>{<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.0pt;
mso-bidi-font-size:12.0pt;font-family:"Trebuchet MS";color:#000066'>push 0<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.0pt;
mso-bidi-font-size:12.0pt;font-family:"Trebuchet MS";color:#000066'>push
0x00408040<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.0pt;
mso-bidi-font-size:12.0pt;font-family:"Trebuchet MS";color:#000066'>push
0x00408044<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.0pt;
mso-bidi-font-size:12.0pt;font-family:"Trebuchet MS";color:#000066'>push 0<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.0pt;
mso-bidi-font-size:12.0pt;font-family:"Trebuchet MS";color:#000066'>mov eax ,
0x77E375D5<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.0pt;
mso-bidi-font-size:12.0pt;font-family:"Trebuchet MS";color:#000066'>call eax<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.0pt;
mso-bidi-font-size:12.0pt;font-family:"Trebuchet MS";color:#000066'>}<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.0pt;
mso-bidi-font-size:12.0pt;font-family:"Trebuchet MS";color:#000066'>}<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.0pt;
mso-bidi-font-size:12.0pt;font-family:"Trebuchet MS";color:#000066'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.0pt;
mso-bidi-font-size:12.0pt;font-family:"Trebuchet MS";color:#000066'>Using the
same principles learned earlier, the address value of the MessageBoxA function
0x77E375D5 is placed in the register eax and then the call instruction is
called. We do have to specify the library user32.lib as we are making an
explicit call to the MessageBoxA function. <o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.0pt;
mso-bidi-font-size:12.0pt;font-family:"Trebuchet MS";color:#000066'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><u><span style='font-size:10.0pt;
mso-bidi-font-size:12.0pt;font-family:"Trebuchet MS";color:#000066'>A17.c</span></u><span
style='font-size:10.0pt;mso-bidi-font-size:12.0pt;font-family:"Trebuchet MS";
color:#000066'><o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.0pt;
mso-bidi-font-size:12.0pt;font-family:"Trebuchet MS";color:#000066'>#include
&lt;windows.h&gt;<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.0pt;
mso-bidi-font-size:12.0pt;font-family:"Trebuchet MS";color:#000066'>main()<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.0pt;
mso-bidi-font-size:12.0pt;font-family:"Trebuchet MS";color:#000066'>{<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.0pt;
mso-bidi-font-size:12.0pt;font-family:"Trebuchet MS";color:#000066'>char *p =
&quot;hi&quot;;<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.0pt;
mso-bidi-font-size:12.0pt;font-family:"Trebuchet MS";color:#000066'>char *q =
&quot;bye&quot;;<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.0pt;
mso-bidi-font-size:12.0pt;font-family:"Trebuchet MS";color:#000066'>LoadLibrary(&quot;user32.dll&quot;);<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.0pt;
mso-bidi-font-size:12.0pt;font-family:"Trebuchet MS";color:#000066'>printf(&quot;%x
%x\n&quot;,p,q);<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.0pt;
mso-bidi-font-size:12.0pt;font-family:"Trebuchet MS";color:#000066'>__asm<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.0pt;
mso-bidi-font-size:12.0pt;font-family:"Trebuchet MS";color:#000066'>{<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.0pt;
mso-bidi-font-size:12.0pt;font-family:"Trebuchet MS";color:#000066'>push 0<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.0pt;
mso-bidi-font-size:12.0pt;font-family:"Trebuchet MS";color:#000066'>push
0x00408040<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.0pt;
mso-bidi-font-size:12.0pt;font-family:"Trebuchet MS";color:#000066'>push
0x00408044<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.0pt;
mso-bidi-font-size:12.0pt;font-family:"Trebuchet MS";color:#000066'>push 0<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.0pt;
mso-bidi-font-size:12.0pt;font-family:"Trebuchet MS";color:#000066'>push
0x77E375D5<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.0pt;
mso-bidi-font-size:12.0pt;font-family:"Trebuchet MS";color:#000066'>add esp,4<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.0pt;
mso-bidi-font-size:12.0pt;font-family:"Trebuchet MS";color:#000066'>call DWORD
PTR [esp-4]<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.0pt;
mso-bidi-font-size:12.0pt;font-family:"Trebuchet MS";color:#000066'>}<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.0pt;
mso-bidi-font-size:12.0pt;font-family:"Trebuchet MS";color:#000066'>}<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.0pt;
mso-bidi-font-size:12.0pt;font-family:"Trebuchet MS";color:#000066'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.0pt;
mso-bidi-font-size:12.0pt;font-family:"Trebuchet MS";color:#000066'>There are
different ways of giving the call instruction with the address of the function.
One of the many ways is by pushing the address of the function, in our case 0x77E375D5
on the stack. But this moves the stack down by 5 and not four. <o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.0pt;
mso-bidi-font-size:12.0pt;font-family:"Trebuchet MS";color:#000066'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.0pt;
mso-bidi-font-size:12.0pt;font-family:"Trebuchet MS";color:#000066'>A value of
four is added to esp so that the stack points to the last parameter value 0 and
then the call instruction is given. Along with it, instead of specifying esp by
itself, we put square brackets around it. This indicates that the value of esp
is not to be taken as is, instead it must behave like a pointer. So, once the
value of esp is figured out, next 4 bytes at that memory location are to be
picked up. But since the stack has moved up by 4, which means that the stack is
at parameter value 0, an expression of esp – 4 is given, as the address of
function MessageBoxA is stored at this location. <o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.0pt;
mso-bidi-font-size:12.0pt;font-family:"Trebuchet MS";color:#000066'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><u><span style='font-size:10.0pt;
mso-bidi-font-size:12.0pt;font-family:"Trebuchet MS";color:#000066'>A18.c</span></u><span
style='font-size:10.0pt;mso-bidi-font-size:12.0pt;font-family:"Trebuchet MS";
color:#000066'><o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.0pt;
mso-bidi-font-size:12.0pt;font-family:"Trebuchet MS";color:#000066'>main()<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.0pt;
mso-bidi-font-size:12.0pt;font-family:"Trebuchet MS";color:#000066'>{<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.0pt;
mso-bidi-font-size:12.0pt;font-family:"Trebuchet MS";color:#000066'>int p = 6;<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.0pt;
mso-bidi-font-size:12.0pt;font-family:"Trebuchet MS";color:#000066'>int q = 7;<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.0pt;
mso-bidi-font-size:12.0pt;font-family:"Trebuchet MS";color:#000066'>printf(&quot;p=%p
q=%p\n&quot;,</span><span style='font-size:10.0pt;mso-bidi-font-size:12.0pt;
font-family:Tahoma;mso-bidi-font-family:"Times New Roman";color:#000066'>&amp;</span><span
style='font-size:10.0pt;mso-bidi-font-size:12.0pt;font-family:"Trebuchet MS";
color:#000066'>p,</span><span style='font-size:10.0pt;mso-bidi-font-size:12.0pt;
font-family:Tahoma;mso-bidi-font-family:"Times New Roman";color:#000066'>&amp;</span><span
style='font-size:10.0pt;mso-bidi-font-size:12.0pt;font-family:"Trebuchet MS";
color:#000066'>q);<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.0pt;
mso-bidi-font-size:12.0pt;font-family:"Trebuchet MS";color:#000066'>abc(3,4);<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.0pt;
mso-bidi-font-size:12.0pt;font-family:"Trebuchet MS";color:#000066'>pqr();<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.0pt;
mso-bidi-font-size:12.0pt;font-family:"Trebuchet MS";color:#000066'>}<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.0pt;
mso-bidi-font-size:12.0pt;font-family:"Trebuchet MS";color:#000066'>int abc(int
i , int j)<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.0pt;
mso-bidi-font-size:12.0pt;font-family:"Trebuchet MS";color:#000066'>{<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.0pt;
mso-bidi-font-size:12.0pt;font-family:"Trebuchet MS";color:#000066'>int x = 1;<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.0pt;
mso-bidi-font-size:12.0pt;font-family:"Trebuchet MS";color:#000066'>int y = 2;<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.0pt;
mso-bidi-font-size:12.0pt;font-family:"Trebuchet MS";color:#000066'>printf(&quot;i=%p
j=%p\n&quot;,</span><span style='font-size:10.0pt;mso-bidi-font-size:12.0pt;
font-family:Tahoma;mso-bidi-font-family:"Times New Roman";color:#000066'>&amp;</span><span
style='font-size:10.0pt;mso-bidi-font-size:12.0pt;font-family:"Trebuchet MS";
color:#000066'>i,</span><span style='font-size:10.0pt;mso-bidi-font-size:12.0pt;
font-family:Tahoma;mso-bidi-font-family:"Times New Roman";color:#000066'>&amp;</span><span
style='font-size:10.0pt;mso-bidi-font-size:12.0pt;font-family:"Trebuchet MS";
color:#000066'>j);<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.0pt;
mso-bidi-font-size:12.0pt;font-family:"Trebuchet MS";color:#000066'>printf(&quot;x=%p
y=%p\n&quot;,</span><span style='font-size:10.0pt;mso-bidi-font-size:12.0pt;
font-family:Tahoma;mso-bidi-font-family:"Times New Roman";color:#000066'>&amp;</span><span
style='font-size:10.0pt;mso-bidi-font-size:12.0pt;font-family:"Trebuchet MS";
color:#000066'>x,</span><span style='font-size:10.0pt;mso-bidi-font-size:12.0pt;
font-family:Tahoma;mso-bidi-font-family:"Times New Roman";color:#000066'>&amp;</span><span
style='font-size:10.0pt;mso-bidi-font-size:12.0pt;font-family:"Trebuchet MS";
color:#000066'>y);<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.0pt;
mso-bidi-font-size:12.0pt;font-family:"Trebuchet MS";color:#000066'>printf(&quot;abc
%x %x %x %x %x %x %x\n&quot;);<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.0pt;
mso-bidi-font-size:12.0pt;font-family:"Trebuchet MS";color:#000066'>}<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.0pt;
mso-bidi-font-size:12.0pt;font-family:"Trebuchet MS";color:#000066'>int pqr()<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.0pt;
mso-bidi-font-size:12.0pt;font-family:"Trebuchet MS";color:#000066'>{<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.0pt;
mso-bidi-font-size:12.0pt;font-family:"Trebuchet MS";color:#000066'>printf(&quot;pqr
%x %x %x %x %x %x %x\n&quot;);<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.0pt;
mso-bidi-font-size:12.0pt;font-family:"Trebuchet MS";color:#000066'>}<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.0pt;
mso-bidi-font-size:12.0pt;font-family:"Trebuchet MS";color:#000066'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<h1><span style='color:#000066'>Output<o:p></o:p></span></h1>

<p class=MsoListBullet style='margin-left:0in;text-align:justify;text-indent:
0in;mso-list:none;tab-stops:.5in'><span style='font-size:10.0pt;mso-bidi-font-size:
12.0pt;font-family:"Trebuchet MS";color:#000066'>p=0012FEE0 q=0012FEDC<o:p></o:p></span></p>

<p class=MsoListBullet style='margin-left:0in;text-align:justify;text-indent:
0in;mso-list:none;tab-stops:.5in'><span style='font-size:10.0pt;mso-bidi-font-size:
12.0pt;font-family:"Trebuchet MS";color:#000066'>i=0012FED4 j=0012FED8<o:p></o:p></span></p>

<p class=MsoListBullet style='margin-left:0in;text-align:justify;text-indent:
0in;mso-list:none;tab-stops:.5in'><span style='font-size:10.0pt;mso-bidi-font-size:
12.0pt;font-family:"Trebuchet MS";color:#000066'>x=0012FEC4 y=0012FEC8<o:p></o:p></span></p>

<p class=MsoListBullet style='margin-left:0in;text-align:justify;text-indent:
0in;mso-list:none;tab-stops:.5in'><span style='font-size:10.0pt;mso-bidi-font-size:
12.0pt;font-family:"Trebuchet MS";color:#000066'>abc 1 2 12fee4 401031 3 4 7<o:p></o:p></span></p>

<p class=MsoListBullet style='margin-left:0in;text-align:justify;text-indent:
0in;mso-list:none;tab-stops:.5in'><span style='font-size:10.0pt;mso-bidi-font-size:
12.0pt;font-family:"Trebuchet MS";color:#000066'>pqr 12fee4 401038 7 6 12ffc0
40125c 1<o:p></o:p></span></p>

<p class=MsoListBullet style='margin-left:0in;text-align:justify;text-indent:
0in;mso-list:none;tab-stops:.5in'><span style='font-size:10.0pt;mso-bidi-font-size:
12.0pt;font-family:"Trebuchet MS";color:#000066'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=MsoListBullet style='margin-left:0in;text-align:justify;text-indent:
0in;mso-list:none;tab-stops:.5in'><span style='font-size:10.0pt;mso-bidi-font-size:
12.0pt;font-family:"Trebuchet MS";color:#000066'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=MsoListBullet style='margin-left:0in;text-align:justify;text-indent:
0in;mso-list:none;tab-stops:.5in'><span style='font-size:10.0pt;mso-bidi-font-size:
12.0pt;font-family:"Trebuchet MS";color:#000066'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=MsoListBullet style='margin-left:0in;text-align:justify;text-indent:
0in;mso-list:none;tab-stops:.5in'><span style='font-size:10.0pt;mso-bidi-font-size:
12.0pt;font-family:"Trebuchet MS";color:#000066'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=MsoListBullet style='margin-left:0in;text-align:justify;text-indent:
0in;mso-list:none;tab-stops:.5in'><span style='font-size:10.0pt;mso-bidi-font-size:
12.0pt;font-family:"Trebuchet MS";color:#000066'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=MsoListBullet style='margin-left:0in;text-align:justify;text-indent:
0in;mso-list:none;tab-stops:.5in'><span style='font-size:10.0pt;mso-bidi-font-size:
12.0pt;font-family:"Trebuchet MS";color:#000066'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=MsoListBullet style='margin-left:0in;text-align:justify;text-indent:
0in;mso-list:none;tab-stops:.5in'><span style='font-size:10.0pt;mso-bidi-font-size:
12.0pt;font-family:"Trebuchet MS";color:#000066'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=MsoListBullet style='margin-left:0in;text-align:justify;text-indent:
0in;mso-list:none;tab-stops:.5in'><span style='font-size:10.0pt;mso-bidi-font-size:
12.0pt;font-family:"Trebuchet MS";color:#000066'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=MsoListBullet style='margin-left:0in;text-align:justify;text-indent:
0in;mso-list:none;tab-stops:.5in'><span style='font-size:10.0pt;mso-bidi-font-size:
12.0pt;font-family:"Trebuchet MS";color:#000066'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=MsoListBullet style='margin-left:0in;text-align:justify;text-indent:
0in;mso-list:none;tab-stops:.5in'><span style='font-size:10.0pt;mso-bidi-font-size:
12.0pt;font-family:"Trebuchet MS";color:#000066'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=MsoListBullet style='margin-left:0in;text-align:justify;text-indent:
0in;mso-list:none;tab-stops:.5in'><span style='font-size:10.0pt;mso-bidi-font-size:
12.0pt;font-family:"Trebuchet MS";color:#000066'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=MsoListBullet style='margin-left:0in;text-align:justify;text-indent:
0in;mso-list:none;tab-stops:.5in'><span style='font-size:10.0pt;mso-bidi-font-size:
12.0pt;font-family:"Trebuchet MS";color:#000066'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=MsoListBullet style='margin-left:0in;text-align:justify;text-indent:
0in;mso-list:none;tab-stops:.5in'><span style='font-size:10.0pt;mso-bidi-font-size:
12.0pt;font-family:"Trebuchet MS";color:#000066'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=MsoListBullet style='margin-left:0in;text-align:justify;text-indent:
0in;mso-list:none;tab-stops:.5in'><!--[if gte vml 1]><v:line id="_x0000_s1180"
 style='position:absolute;left:0;text-align:left;z-index:59' from="0,-58.6pt"
 to="0,40.4pt">
 <v:stroke endarrow="block"/>
 <w:wrap anchorx="page"/>
</v:line><v:rect id="_x0000_s1155" style='position:absolute;left:0;
 text-align:left;margin-left:9pt;margin-top:-112.6pt;width:90pt;height:3in;
 z-index:34'>
 <w:wrap anchorx="page"/>
</v:rect><v:line id="_x0000_s1156" style='position:absolute;left:0;
 text-align:left;z-index:35' from="9pt,22.4pt" to="99pt,22.4pt">
 <w:wrap anchorx="page"/>
</v:line><v:shape id="_x0000_s1157" type="#_x0000_t202" style='position:absolute;
 left:0;text-align:left;margin-left:126pt;margin-top:13.4pt;width:117pt;
 height:18pt;z-index:36' filled="f" stroked="f">
 <v:textbox style='mso-next-textbox:#_x0000_s1157'>
  <![if !mso]>
  <table cellpadding=0 cellspacing=0 width="100%">
   <tr>
    <td><![endif]>
    <div>
    <p class=MsoNormal>0x0012fed0</p>
    </div>
    <![if !mso]></td>
   </tr>
  </table>
  <![endif]></v:textbox>
 <w:wrap anchorx="page"/>
</v:shape><v:line id="_x0000_s1158" style='position:absolute;left:0;
 text-align:left;z-index:37' from="99pt,22.4pt" to="117pt,22.4pt">
 <v:stroke endarrow="block"/>
 <w:wrap anchorx="page"/>
</v:line><v:line id="_x0000_s1159" style='position:absolute;left:0;
 text-align:left;z-index:38' from="9pt,-4.6pt" to="99pt,-4.6pt">
 <w:wrap anchorx="page"/>
</v:line><v:shape id="_x0000_s1160" type="#_x0000_t202" style='position:absolute;
 left:0;text-align:left;margin-left:126pt;margin-top:-13.6pt;width:117pt;
 height:18pt;z-index:39' filled="f" stroked="f">
 <v:textbox style='mso-next-textbox:#_x0000_s1160'>
  <![if !mso]>
  <table cellpadding=0 cellspacing=0 width="100%">
   <tr>
    <td><![endif]>
    <div>
    <p class=MsoNormal>0x0012fed4</p>
    </div>
    <![if !mso]></td>
   </tr>
  </table>
  <![endif]></v:textbox>
 <w:wrap anchorx="page"/>
</v:shape><v:line id="_x0000_s1161" style='position:absolute;left:0;
 text-align:left;z-index:40' from="99pt,-4.6pt" to="117pt,-4.6pt">
 <v:stroke endarrow="block"/>
 <w:wrap anchorx="page"/>
</v:line><v:line id="_x0000_s1162" style='position:absolute;left:0;
 text-align:left;z-index:41' from="9pt,-31.6pt" to="99pt,-31.6pt">
 <w:wrap anchorx="page"/>
</v:line><v:shape id="_x0000_s1163" type="#_x0000_t202" style='position:absolute;
 left:0;text-align:left;margin-left:126pt;margin-top:-40.6pt;width:117pt;
 height:18pt;z-index:42' filled="f" stroked="f">
 <v:textbox style='mso-next-textbox:#_x0000_s1163'>
  <![if !mso]>
  <table cellpadding=0 cellspacing=0 width="100%">
   <tr>
    <td><![endif]>
    <div>
    <p class=MsoNormal>0x0012fed8</p>
    </div>
    <![if !mso]></td>
   </tr>
  </table>
  <![endif]></v:textbox>
 <w:wrap anchorx="page"/>
</v:shape><v:shape id="_x0000_s1164" type="#_x0000_t202" style='position:absolute;
 left:0;text-align:left;margin-left:45pt;margin-top:-31.6pt;width:27pt;
 height:18pt;z-index:43' filled="f" stroked="f">
 <v:textbox style='mso-next-textbox:#_x0000_s1164'>
  <![if !mso]>
  <table cellpadding=0 cellspacing=0 width="100%">
   <tr>
    <td><![endif]>
    <div>
    <p class=MsoNormal><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>
    </div>
    <![if !mso]></td>
   </tr>
  </table>
  <![endif]></v:textbox>
 <w:wrap anchorx="page"/>
</v:shape><v:line id="_x0000_s1165" style='position:absolute;left:0;
 text-align:left;z-index:44' from="99pt,-31.6pt" to="117pt,-31.6pt">
 <v:stroke endarrow="block"/>
 <w:wrap anchorx="page"/>
</v:line><v:line id="_x0000_s1166" style='position:absolute;left:0;
 text-align:left;z-index:45' from="9pt,-58.6pt" to="99pt,-58.6pt">
 <w:wrap anchorx="page"/>
</v:line><v:shape id="_x0000_s1167" type="#_x0000_t202" style='position:absolute;
 left:0;text-align:left;margin-left:126pt;margin-top:-67.6pt;width:90pt;
 height:18pt;z-index:46' filled="f" stroked="f">
 <v:textbox style='mso-next-textbox:#_x0000_s1167'>
  <![if !mso]>
  <table cellpadding=0 cellspacing=0 width="100%">
   <tr>
    <td><![endif]>
    <div>
    <p class=MsoNormal>0x0012fedc</p>
    </div>
    <![if !mso]></td>
   </tr>
  </table>
  <![endif]></v:textbox>
 <w:wrap anchorx="page"/>
</v:shape><v:line id="_x0000_s1168" style='position:absolute;left:0;
 text-align:left;z-index:47' from="99pt,-58.6pt" to="117pt,-58.6pt">
 <v:stroke endarrow="block"/>
 <w:wrap anchorx="page"/>
</v:line><v:line id="_x0000_s1169" style='position:absolute;left:0;
 text-align:left;z-index:48' from="9pt,-85.6pt" to="99pt,-85.6pt">
 <w:wrap anchorx="page"/>
</v:line><v:shape id="_x0000_s1170" type="#_x0000_t202" style='position:absolute;
 left:0;text-align:left;margin-left:126pt;margin-top:-94.6pt;width:117pt;
 height:18pt;z-index:49' filled="f" stroked="f">
 <v:textbox style='mso-next-textbox:#_x0000_s1170'>
  <![if !mso]>
  <table cellpadding=0 cellspacing=0 width="100%">
   <tr>
    <td><![endif]>
    <div>
    <p class=MsoNormal>0x0012fee0</p>
    </div>
    <![if !mso]></td>
   </tr>
  </table>
  <![endif]></v:textbox>
 <w:wrap anchorx="page"/>
</v:shape><v:shape id="_x0000_s1171" type="#_x0000_t202" style='position:absolute;
 left:0;text-align:left;margin-left:36pt;margin-top:-85.6pt;width:45pt;
 height:27pt;z-index:50' filled="f" stroked="f">
 <v:textbox style='mso-next-textbox:#_x0000_s1171'>
  <![if !mso]>
  <table cellpadding=0 cellspacing=0 width="100%">
   <tr>
    <td><![endif]>
    <div>
    <p class=MsoNormal><span style='font-family:"Courier New"'>q=7<o:p></o:p></span></p>
    </div>
    <![if !mso]></td>
   </tr>
  </table>
  <![endif]></v:textbox>
 <w:wrap anchorx="page"/>
</v:shape><v:line id="_x0000_s1172" style='position:absolute;left:0;
 text-align:left;z-index:51' from="99pt,-85.6pt" to="117pt,-85.6pt">
 <v:stroke endarrow="block"/>
 <w:wrap anchorx="page"/>
</v:line><v:line id="_x0000_s1173" style='position:absolute;left:0;
 text-align:left;z-index:52' from="9pt,-112.6pt" to="99pt,-112.6pt">
 <w:wrap anchorx="page"/>
</v:line><v:shape id="_x0000_s1174" type="#_x0000_t202" style='position:absolute;
 left:0;text-align:left;margin-left:126pt;margin-top:-121.6pt;width:90pt;
 height:18pt;z-index:53' filled="f" stroked="f">
 <v:textbox style='mso-next-textbox:#_x0000_s1174'>
  <![if !mso]>
  <table cellpadding=0 cellspacing=0 width="100%">
   <tr>
    <td><![endif]>
    <div>
    <p class=MsoNormal>0x0012fee4</p>
    </div>
    <![if !mso]></td>
   </tr>
  </table>
  <![endif]></v:textbox>
 <w:wrap anchorx="page"/>
</v:shape><v:line id="_x0000_s1175" style='position:absolute;left:0;
 text-align:left;z-index:54' from="99pt,-112.6pt" to="117pt,-112.6pt">
 <v:stroke endarrow="block"/>
 <w:wrap anchorx="page"/>
</v:line><v:line id="_x0000_s1176" style='position:absolute;left:0;
 text-align:left;z-index:55' from="9pt,49.4pt" to="99pt,49.4pt">
 <w:wrap anchorx="page"/>
</v:line><v:shape id="_x0000_s1177" type="#_x0000_t202" style='position:absolute;
 left:0;text-align:left;margin-left:126pt;margin-top:40.4pt;width:117pt;
 height:18pt;z-index:56' filled="f" stroked="f">
 <v:textbox style='mso-next-textbox:#_x0000_s1177'>
  <![if !mso]>
  <table cellpadding=0 cellspacing=0 width="100%">
   <tr>
    <td><![endif]>
    <div>
    <p class=MsoNormal>0x0012fecc</p>
    </div>
    <![if !mso]></td>
   </tr>
  </table>
  <![endif]></v:textbox>
 <w:wrap anchorx="page"/>
</v:shape><v:line id="_x0000_s1178" style='position:absolute;left:0;
 text-align:left;z-index:57' from="99pt,49.4pt" to="117pt,49.4pt">
 <v:stroke endarrow="block"/>
 <w:wrap anchorx="page"/>
</v:line><v:shape id="_x0000_s1179" type="#_x0000_t202" style='position:absolute;
 left:0;text-align:left;margin-left:36pt;margin-top:-112.6pt;width:45pt;
 height:27pt;z-index:58' filled="f" stroked="f">
 <v:textbox style='mso-next-textbox:#_x0000_s1179'>
  <![if !mso]>
  <table cellpadding=0 cellspacing=0 width="100%">
   <tr>
    <td><![endif]>
    <div>
    <p class=MsoNormal><span style='font-family:"Courier New"'>p=6<o:p></o:p></span></p>
    </div>
    <![if !mso]></td>
   </tr>
  </table>
  <![endif]></v:textbox>
 <w:wrap anchorx="page"/>
</v:shape><v:shape id="_x0000_s1181" type="#_x0000_t202" style='position:absolute;
 left:0;text-align:left;margin-left:36pt;margin-top:-58.6pt;width:45pt;
 height:27pt;z-index:60' filled="f" stroked="f">
 <v:textbox style='mso-next-textbox:#_x0000_s1181'>
  <![if !mso]>
  <table cellpadding=0 cellspacing=0 width="100%">
   <tr>
    <td><![endif]>
    <div>
    <p class=MsoNormal><span style='font-family:"Courier New"'>j=4<o:p></o:p></span></p>
    </div>
    <![if !mso]></td>
   </tr>
  </table>
  <![endif]></v:textbox>
 <w:wrap anchorx="page"/>
</v:shape><v:shape id="_x0000_s1182" type="#_x0000_t202" style='position:absolute;
 left:0;text-align:left;margin-left:36pt;margin-top:-31.6pt;width:45pt;
 height:27pt;z-index:61' filled="f" stroked="f">
 <v:textbox style='mso-next-textbox:#_x0000_s1182'>
  <![if !mso]>
  <table cellpadding=0 cellspacing=0 width="100%">
   <tr>
    <td><![endif]>
    <div>
    <p class=MsoNormal><span style='font-family:"Courier New"'>i=3<o:p></o:p></span></p>
    </div>
    <![if !mso]></td>
   </tr>
  </table>
  <![endif]></v:textbox>
 <w:wrap anchorx="page"/>
</v:shape><v:line id="_x0000_s1183" style='position:absolute;left:0;
 text-align:left;z-index:62' from="9pt,76.4pt" to="99pt,76.4pt">
 <w:wrap anchorx="page"/>
</v:line><v:line id="_x0000_s1184" style='position:absolute;left:0;
 text-align:left;z-index:63' from="99pt,76.4pt" to="117pt,76.4pt">
 <v:stroke endarrow="block"/>
 <w:wrap anchorx="page"/>
</v:line><v:line id="_x0000_s1185" style='position:absolute;left:0;
 text-align:left;z-index:64' from="99pt,103.4pt" to="117pt,103.4pt">
 <v:stroke endarrow="block"/>
 <w:wrap anchorx="page"/>
</v:line><v:shape id="_x0000_s1186" type="#_x0000_t202" style='position:absolute;
 left:0;text-align:left;margin-left:126pt;margin-top:67.4pt;width:117pt;
 height:18pt;z-index:65' filled="f" stroked="f">
 <v:textbox style='mso-next-textbox:#_x0000_s1186'>
  <![if !mso]>
  <table cellpadding=0 cellspacing=0 width="100%">
   <tr>
    <td><![endif]>
    <div>
    <p class=MsoNormal>0x0012fec8</p>
    </div>
    <![if !mso]></td>
   </tr>
  </table>
  <![endif]></v:textbox>
 <w:wrap anchorx="page"/>
</v:shape><v:shape id="_x0000_s1187" type="#_x0000_t202" style='position:absolute;
 left:0;text-align:left;margin-left:126pt;margin-top:94.4pt;width:117pt;
 height:18pt;z-index:66' filled="f" stroked="f">
 <v:textbox style='mso-next-textbox:#_x0000_s1187'>
  <![if !mso]>
  <table cellpadding=0 cellspacing=0 width="100%">
   <tr>
    <td><![endif]>
    <div>
    <p class=MsoNormal>0x0012fec4</p>
    </div>
    <![if !mso]></td>
   </tr>
  </table>
  <![endif]></v:textbox>
 <w:wrap anchorx="page"/>
</v:shape><v:shape id="_x0000_s1188" type="#_x0000_t202" style='position:absolute;
 left:0;text-align:left;margin-left:36pt;margin-top:49.4pt;width:45pt;height:27pt;
 z-index:67' filled="f" stroked="f">
 <v:textbox style='mso-next-textbox:#_x0000_s1188'>
  <![if !mso]>
  <table cellpadding=0 cellspacing=0 width="100%">
   <tr>
    <td><![endif]>
    <div>
    <p class=MsoNormal><span style='font-family:"Courier New"'>y=2<o:p></o:p></span></p>
    </div>
    <![if !mso]></td>
   </tr>
  </table>
  <![endif]></v:textbox>
 <w:wrap anchorx="page"/>
</v:shape><v:shape id="_x0000_s1189" type="#_x0000_t202" style='position:absolute;
 left:0;text-align:left;margin-left:36pt;margin-top:76.4pt;width:45pt;height:27pt;
 z-index:68' filled="f" stroked="f">
 <v:textbox style='mso-next-textbox:#_x0000_s1189'>
  <![if !mso]>
  <table cellpadding=0 cellspacing=0 width="100%">
   <tr>
    <td><![endif]>
    <div>
    <p class=MsoNormal><span style='font-family:"Courier New"'>x=1<o:p></o:p></span></p>
    </div>
    <![if !mso]></td>
   </tr>
  </table>
  <![endif]></v:textbox>
 <w:wrap anchorx="page"/>
</v:shape><v:shape id="_x0000_s1190" type="#_x0000_t202" style='position:absolute;
 left:0;text-align:left;margin-left:261pt;margin-top:-31.6pt;width:27pt;
 height:18pt;z-index:69' filled="f" stroked="f">
 <v:textbox style='mso-next-textbox:#_x0000_s1190'>
  <![if !mso]>
  <table cellpadding=0 cellspacing=0 width="100%">
   <tr>
    <td><![endif]>
    <div>
    <p class=MsoNormal><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>
    </div>
    <![if !mso]></td>
   </tr>
  </table>
  <![endif]></v:textbox>
 <w:wrap anchorx="page"/>
</v:shape><v:rect id="_x0000_s1191" style='position:absolute;left:0;
 text-align:left;margin-left:4in;margin-top:-112.6pt;width:90pt;height:3in;
 z-index:70'>
 <w:wrap anchorx="page"/>
</v:rect><v:line id="_x0000_s1192" style='position:absolute;left:0;
 text-align:left;z-index:71' from="4in,22.4pt" to="378pt,22.4pt">
 <w:wrap anchorx="page"/>
</v:line><v:line id="_x0000_s1193" style='position:absolute;left:0;
 text-align:left;z-index:72' from="4in,-4.6pt" to="378pt,-4.6pt">
 <w:wrap anchorx="page"/>
</v:line><v:line id="_x0000_s1194" style='position:absolute;left:0;
 text-align:left;z-index:73' from="4in,-31.6pt" to="378pt,-31.6pt">
 <w:wrap anchorx="page"/>
</v:line><v:shape id="_x0000_s1195" type="#_x0000_t202" style='position:absolute;
 left:0;text-align:left;margin-left:324pt;margin-top:-31.6pt;width:27pt;
 height:18pt;z-index:74' filled="f" stroked="f">
 <v:textbox style='mso-next-textbox:#_x0000_s1195'>
  <![if !mso]>
  <table cellpadding=0 cellspacing=0 width="100%">
   <tr>
    <td><![endif]>
    <div>
    <p class=MsoNormal><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>
    </div>
    <![if !mso]></td>
   </tr>
  </table>
  <![endif]></v:textbox>
 <w:wrap anchorx="page"/>
</v:shape><v:line id="_x0000_s1196" style='position:absolute;left:0;
 text-align:left;z-index:75' from="4in,-58.6pt" to="378pt,-58.6pt">
 <w:wrap anchorx="page"/>
</v:line><v:line id="_x0000_s1197" style='position:absolute;left:0;
 text-align:left;z-index:76' from="4in,-85.6pt" to="378pt,-85.6pt">
 <w:wrap anchorx="page"/>
</v:line><v:line id="_x0000_s1198" style='position:absolute;left:0;
 text-align:left;z-index:77' from="4in,-112.6pt" to="378pt,-112.6pt">
 <w:wrap anchorx="page"/>
</v:line><v:line id="_x0000_s1199" style='position:absolute;left:0;
 text-align:left;z-index:78' from="4in,49.4pt" to="378pt,49.4pt">
 <w:wrap anchorx="page"/>
</v:line><v:line id="_x0000_s1200" style='position:absolute;left:0;
 text-align:left;z-index:79' from="4in,76.4pt" to="378pt,76.4pt">
 <w:wrap anchorx="page"/>
</v:line><v:shape id="_x0000_s1201" type="#_x0000_t202" style='position:absolute;
 left:0;text-align:left;margin-left:306pt;margin-top:-139.6pt;width:45pt;
 height:18pt;z-index:80'>
 <v:textbox style='mso-next-textbox:#_x0000_s1201'>
  <![if !mso]>
  <table cellpadding=0 cellspacing=0 width="100%">
   <tr>
    <td><![endif]>
    <div>
    <p class=MsoNormal>EBP</p>
    </div>
    <![if !mso]></td>
   </tr>
  </table>
  <![endif]></v:textbox>
 <w:wrap anchorx="page"/>
</v:shape><v:shape id="_x0000_s1202" type="#_x0000_t202" style='position:absolute;
 left:0;text-align:left;margin-left:36pt;margin-top:-139.6pt;width:45pt;
 height:18pt;z-index:81'>
 <v:textbox style='mso-next-textbox:#_x0000_s1202'>
  <![if !mso]>
  <table cellpadding=0 cellspacing=0 width="100%">
   <tr>
    <td><![endif]>
    <div>
    <p class=MsoNormal>ESP</p>
    </div>
    <![if !mso]></td>
   </tr>
  </table>
  <![endif]></v:textbox>
 <w:wrap anchorx="page"/>
</v:shape><v:shape id="_x0000_s1203" type="#_x0000_t202" style='position:absolute;
 left:0;text-align:left;margin-left:4in;margin-top:-4.6pt;width:90pt;height:18pt;
 z-index:82' filled="f" stroked="f">
 <v:textbox style='mso-next-textbox:#_x0000_s1203'>
  <![if !mso]>
  <table cellpadding=0 cellspacing=0 width="100%">
   <tr>
    <td><![endif]>
    <div>
    <p class=MsoNormal>0x0012fee4</p>
    </div>
    <![if !mso]></td>
   </tr>
  </table>
  <![endif]></v:textbox>
 <w:wrap anchorx="page"/>
</v:shape><v:shape id="_x0000_s1204" type="#_x0000_t202" style='position:absolute;
 left:0;text-align:left;margin-left:18pt;margin-top:22.4pt;width:81pt;height:18pt;
 z-index:83' filled="f" stroked="f">
 <v:textbox style='mso-next-textbox:#_x0000_s1204'>
  <![if !mso]>
  <table cellpadding=0 cellspacing=0 width="100%">
   <tr>
    <td><![endif]>
    <div>
    <p class=MsoNormal>0x0012fee4</p>
    </div>
    <![if !mso]></td>
   </tr>
  </table>
  <![endif]></v:textbox>
 <w:wrap anchorx="page"/>
</v:shape><v:shape id="_x0000_s1205" type="#_x0000_t202" style='position:absolute;
 left:0;text-align:left;margin-left:4in;margin-top:-103.6pt;width:90pt;
 height:18pt;z-index:84' filled="f" stroked="f">
 <v:textbox style='mso-next-textbox:#_x0000_s1205'>
  <![if !mso]>
  <table cellpadding=0 cellspacing=0 width="100%">
   <tr>
    <td><![endif]>
    <div>
    <p class=MsoNormal>0x0012fee4</p>
    </div>
    <![if !mso]></td>
   </tr>
  </table>
  <![endif]></v:textbox>
 <w:wrap anchorx="page"/>
</v:shape><v:shape id="_x0000_s1206" type="#_x0000_t202" style='position:absolute;
 left:0;text-align:left;margin-left:27pt;margin-top:4.4pt;width:1in;height:18pt;
 z-index:85' filled="f" stroked="f">
 <v:textbox style='mso-next-textbox:#_x0000_s1206'>
  <![if !mso]>
  <table cellpadding=0 cellspacing=0 width="100%">
   <tr>
    <td><![endif]>
    <div>
    <p class=MsoNormal>401031</p>
    </div>
    <![if !mso]></td>
   </tr>
  </table>
  <![endif]></v:textbox>
 <w:wrap anchorx="page"/>
</v:shape><v:shape id="_x0000_s1207" type="#_x0000_t202" style='position:absolute;
 left:0;text-align:left;margin-left:4in;margin-top:31.4pt;width:90pt;height:18pt;
 z-index:86' filled="f" stroked="f">
 <v:textbox style='mso-next-textbox:#_x0000_s1207'>
  <![if !mso]>
  <table cellpadding=0 cellspacing=0 width="100%">
   <tr>
    <td><![endif]>
    <div>
    <p class=MsoNormal>0x0012fecc</p>
    </div>
    <![if !mso]></td>
   </tr>
  </table>
  <![endif]></v:textbox>
 <w:wrap anchorx="page"/>
</v:shape><v:shape id="_x0000_s1208" type="#_x0000_t202" style='position:absolute;
 left:0;text-align:left;margin-left:4in;margin-top:-76.6pt;width:90pt;height:18pt;
 z-index:87' filled="f" stroked="f">
 <v:textbox style='mso-next-textbox:#_x0000_s1208'>
  <![if !mso]>
  <table cellpadding=0 cellspacing=0 width="100%">
   <tr>
    <td><![endif]>
    <div>
    <p class=MsoNormal>0x0012fee4</p>
    </div>
    <![if !mso]></td>
   </tr>
  </table>
  <![endif]></v:textbox>
 <w:wrap anchorx="page"/>
</v:shape><v:line id="_x0000_s1209" style='position:absolute;left:0;
 text-align:left;flip:x;z-index:88' from="117pt,13.4pt" to="279pt,31.4pt">
 <v:stroke endarrow="block"/>
 <w:wrap anchorx="page"/>
</v:line><v:line id="_x0000_s1210" style='position:absolute;left:0;
 text-align:left;flip:y;z-index:89' from="198pt,40.4pt" to="279pt,49.4pt">
 <v:stroke endarrow="block"/>
 <w:wrap anchorx="page"/>
</v:line><![endif]--><![if !vml]><span style='mso-ignore:vglayout;position:
relative;z-index:58'><span style='left:0px;position:absolute;left:-6px;
top:-186px;width:512px;height:338px'>

<table cellpadding=0 cellspacing=0 align=left>
 <tr>
  <td width=0 height=0></td>
  <td width=14></td>
  <td width=3></td>
  <td width=495></td>
 </tr>
 <tr>
  <td height=107></td>
  <td colspan=2></td>
  <td rowspan=3 align=left valign=top><img width=495 height=338
  src="bufferoverfloww_files/image005.gif" v:shapes="_x0000_s1155 _x0000_s1156 _x0000_s1157 _x0000_s1158 _x0000_s1159 _x0000_s1160 _x0000_s1161 _x0000_s1162 _x0000_s1163 _x0000_s1164 _x0000_s1165 _x0000_s1166 _x0000_s1167 _x0000_s1168 _x0000_s1169 _x0000_s1170 _x0000_s1171 _x0000_s1172 _x0000_s1173 _x0000_s1174 _x0000_s1175 _x0000_s1176 _x0000_s1177 _x0000_s1178 _x0000_s1179 _x0000_s1181 _x0000_s1182 _x0000_s1183 _x0000_s1184 _x0000_s1185 _x0000_s1186 _x0000_s1187 _x0000_s1188 _x0000_s1189 _x0000_s1190 _x0000_s1191 _x0000_s1192 _x0000_s1193 _x0000_s1194 _x0000_s1195 _x0000_s1196 _x0000_s1197 _x0000_s1198 _x0000_s1199 _x0000_s1200 _x0000_s1201 _x0000_s1202 _x0000_s1203 _x0000_s1204 _x0000_s1205 _x0000_s1206 _x0000_s1207 _x0000_s1208 _x0000_s1209 _x0000_s1210"></td>
 </tr>
 <tr>
  <td height=135></td>
  <td align=left valign=top><img width=14 height=135
  src="bufferoverfloww_files/image006.gif" v:shapes="_x0000_s1180"></td>
 </tr>
 <tr>
  <td height=96></td>
 </tr>
</table>

</span></span><![endif]><span style='font-size:10.0pt;mso-bidi-font-size:12.0pt;
font-family:"Trebuchet MS";color:#000066'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=MsoListBullet style='margin-left:0in;text-align:justify;text-indent:
0in;mso-list:none;tab-stops:.5in'><span style='font-size:10.0pt;mso-bidi-font-size:
12.0pt;font-family:"Trebuchet MS";color:#000066'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=MsoListBullet style='margin-left:0in;text-align:justify;text-indent:
0in;mso-list:none;tab-stops:.5in'><span style='font-size:10.0pt;mso-bidi-font-size:
12.0pt;font-family:"Trebuchet MS";color:#000066'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=MsoListBullet style='margin-left:0in;text-align:justify;text-indent:
0in;mso-list:none;tab-stops:.5in'><span style='font-size:10.0pt;mso-bidi-font-size:
12.0pt;font-family:"Trebuchet MS";color:#000066'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=MsoListBullet style='margin-left:0in;text-align:justify;text-indent:
0in;mso-list:none;tab-stops:.5in'><span style='font-size:10.0pt;mso-bidi-font-size:
12.0pt;font-family:"Trebuchet MS";color:#000066'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=MsoListBullet style='margin-left:0in;text-align:justify;text-indent:
0in;mso-list:none;tab-stops:.5in'><span style='font-size:10.0pt;mso-bidi-font-size:
12.0pt;font-family:"Trebuchet MS";color:#000066'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=MsoListBullet style='margin-left:0in;text-align:justify;text-indent:
0in;mso-list:none;tab-stops:.5in'><span style='font-size:10.0pt;mso-bidi-font-size:
12.0pt;font-family:"Trebuchet MS";color:#000066'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=MsoListBullet style='margin-left:0in;text-align:justify;text-indent:
0in;mso-list:none;tab-stops:.5in'><span style='font-size:10.0pt;mso-bidi-font-size:
12.0pt;font-family:"Trebuchet MS";color:#000066'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=MsoListBullet style='margin-left:0in;text-align:justify;text-indent:
0in;mso-list:none;tab-stops:.5in'><span style='font-size:10.0pt;mso-bidi-font-size:
12.0pt;font-family:"Trebuchet MS";color:#000066'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=MsoListBullet style='margin-left:0in;text-align:justify;text-indent:
0in;mso-list:none;tab-stops:.5in'><span style='font-size:10.0pt;mso-bidi-font-size:
12.0pt;font-family:"Trebuchet MS";color:#000066'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<br style='mso-ignore:vglayout' clear=ALL>

<p class=MsoListBullet style='margin-left:0in;text-align:justify;text-indent:
0in;mso-list:none;tab-stops:.5in'><span style='font-size:10.0pt;mso-bidi-font-size:
12.0pt;font-family:"Trebuchet MS";color:#000066'>Figure 2<o:p></o:p></span></p>

<p class=MsoListBullet style='margin-left:0in;text-align:justify;text-indent:
0in;mso-list:none;tab-stops:.5in'><span style='font-size:10.0pt;mso-bidi-font-size:
12.0pt;font-family:"Trebuchet MS";color:#000066'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=MsoListBullet style='margin-left:0in;text-align:justify;text-indent:
0in;mso-list:none;tab-stops:.5in'><span style='font-size:10.0pt;mso-bidi-font-size:
12.0pt;font-family:"Trebuchet MS";color:#000066'>Lets take a good look at Figure
2. Here first, variables p and q first are created on the stack at locations
0012fee0 and 0012fedc and then their values 6 and 7 are placed in there. The
abc function is called with parameters 3 and 4 which get placed on the stack at
0012fed4 and 0012fed8 and stored in variables called i and j. Thereafter, two
variables x and y are created on the stack at 0012fec4 and 0012fec8 with values
of 1 and 2 respectively. <o:p></o:p></span></p>

<p class=MsoListBullet style='margin-left:0in;text-align:justify;text-indent:
0in;mso-list:none;tab-stops:.5in'><span style='font-size:10.0pt;mso-bidi-font-size:
12.0pt;font-family:"Trebuchet MS";color:#000066'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=MsoListBullet style='margin-left:0in;text-align:justify;text-indent:
0in;mso-list:none;tab-stops:.5in'><span style='font-size:10.0pt;mso-bidi-font-size:
12.0pt;font-family:"Trebuchet MS";color:#000066'>The abc function simply prints
out the next 7 values on the stack, not considering the printf string. The
output shows two local variables x and y whose values are 1 and 2. Then the two
numbers placed by the call instruction for function abc, 0012fee4 and 401031
are seen followed by the two parameters i and j with values 3 and 4. Finally,
the value of variable q in main at 7 is displayed. <o:p></o:p></span></p>

<p class=MsoListBullet style='margin-left:0in;text-align:justify;text-indent:
0in;mso-list:none;tab-stops:.5in'><span style='font-size:10.0pt;mso-bidi-font-size:
12.0pt;font-family:"Trebuchet MS";color:#000066'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=MsoListBullet style='margin-left:0in;text-align:justify;text-indent:
0in;mso-list:none;tab-stops:.5in'><span style='font-size:10.0pt;mso-bidi-font-size:
12.0pt;font-family:"Trebuchet MS";color:#000066'>Now lets understand what the
call instruction does. This call instruction takes up 5 bytes in memory and
hands over control to another function, which may be anywhere in memory. In
short, the call instruction actually transfers control to another memory
location. This called function will execute the code it caries and when it
ends, control should now go back to the next line following the call instruction.
The point here is that the address of this next instruction must be saved
somewhere. The call instruction is known to use the stack extensively. <o:p></o:p></span></p>

<p class=MsoListBullet style='margin-left:0in;text-align:justify;text-indent:
0in;mso-list:none;tab-stops:.5in'><span style='font-size:10.0pt;mso-bidi-font-size:
12.0pt;font-family:"Trebuchet MS";color:#000066'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=MsoListBullet style='margin-left:0in;text-align:justify;text-indent:
0in;mso-list:none;tab-stops:.5in'><span style='font-size:10.0pt;mso-bidi-font-size:
12.0pt;font-family:"Trebuchet MS";color:#000066'>For instance, if the call
instruction begins at memory location 100, the next instruction to be executed
would begin at location 105. Now, this value 105 must be saved so that it
becomes the next instruction to be executed when the called function ends. The
eip register holds address of the next instruction to be executed. <o:p></o:p></span></p>

<p class=MsoListBullet style='margin-left:0in;text-align:justify;text-indent:
0in;mso-list:none;tab-stops:.5in'><span style='font-size:10.0pt;mso-bidi-font-size:
12.0pt;font-family:"Trebuchet MS";color:#000066'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=MsoListBullet style='margin-left:0in;text-align:justify;text-indent:
0in;mso-list:none;tab-stops:.5in'><span style='font-size:10.0pt;mso-bidi-font-size:
12.0pt;font-family:"Trebuchet MS";color:#000066'>If a chunk of code placed at a
certain memory location is to be executed, its address is first to be placed in
the eip register. The call instruction is then used to transfer control to this
area. However, before it passes on control, it adds 5 to its current location
and stores the value on the stack. So if the call instruction is at 100, 105
gets stored on the stack. This address is that of the next statement after
call. Meaning to say that once the function returns control back, it will start
execution at 105. <o:p></o:p></span></p>

<p class=MsoListBullet style='margin-left:0in;text-align:justify;text-indent:
0in;mso-list:none;tab-stops:.5in'><span style='font-size:10.0pt;mso-bidi-font-size:
12.0pt;font-family:"Trebuchet MS";color:#000066'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=MsoListBullet style='margin-left:0in;text-align:justify;text-indent:
0in;mso-list:none;tab-stops:.5in'><span style='font-size:10.0pt;mso-bidi-font-size:
12.0pt;font-family:"Trebuchet MS";color:#000066'>This sustains the fact that a
function has to take care of the stack memory it uses since the return address,
when the function ends, can be found only on the stack. Thus, if the function
moves the stack 12 down, as in our case, it has to move the stack up by 12
bytes. For these reasons, the last line of every function is the ret
instruction. <o:p></o:p></span></p>

<p class=MsoListBullet style='margin-left:0in;text-align:justify;text-indent:
0in;mso-list:none;tab-stops:.5in'><span style='font-size:10.0pt;mso-bidi-font-size:
12.0pt;font-family:"Trebuchet MS";color:#000066'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=MsoListBullet style='margin-left:0in;text-align:justify;text-indent:
0in;mso-list:none;tab-stops:.5in'><span style='font-size:10.0pt;mso-bidi-font-size:
12.0pt;font-family:"Trebuchet MS";color:#000066'>This instruction looks at the
restored stack position and the value it finds there, places it in the eip
register. Moreover, as learnt earlier, the eip always stores the address of the
code that is to be executed. Thus, control is transferred back to the
instruction placed after call.<o:p></o:p></span></p>

<p class=MsoListBullet style='margin-left:0in;text-align:justify;text-indent:
0in;mso-list:none;tab-stops:.5in'><span style='font-size:10.0pt;mso-bidi-font-size:
12.0pt;font-family:"Trebuchet MS";color:#000066'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=MsoListBullet style='margin-left:0in;text-align:justify;text-indent:
0in;mso-list:none;tab-stops:.5in'><span style='font-size:10.0pt;mso-bidi-font-size:
12.0pt;font-family:"Trebuchet MS";color:#000066'>As per our program, the
function abc, when it returns, will execute code at 401031 as this value is
found on the stack. Here, we can safely assume that at memory location 401031-5
i.e. 40102c is the call instruction for abc. Similarly, when function pqr
returns, code at memory location 401038 is called. <o:p></o:p></span></p>

<p class=MsoListBullet style='margin-left:0in;text-align:justify;text-indent:
0in;mso-list:none;tab-stops:.5in'><span style='font-size:10.0pt;mso-bidi-font-size:
12.0pt;font-family:"Trebuchet MS";color:#000066'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=MsoListBullet style='margin-left:0in;text-align:justify;text-indent:
0in;mso-list:none;tab-stops:.5in'><span style='font-size:10.0pt;mso-bidi-font-size:
12.0pt;font-family:"Trebuchet MS";color:#000066'>Now lets understand the four
bytes that get pushed on the stack. These bytes are placed by the compiler and
come into picture after the return address. <o:p></o:p></span></p>

<p class=MsoListBullet style='margin-left:0in;text-align:justify;text-indent:
0in;mso-list:none;tab-stops:.5in'><span style='font-size:10.0pt;mso-bidi-font-size:
12.0pt;font-family:"Trebuchet MS";color:#000066'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=MsoListBullet style='margin-left:0in;text-align:justify;text-indent:
0in;mso-list:none;tab-stops:.5in'><span style='font-size:10.0pt;mso-bidi-font-size:
12.0pt;font-family:"Trebuchet MS";color:#000066'>The job of the compiler is to
generate machine-language instructions. In our function, we have parameters and
local variables. These parameters come before the return address and after the
local variables; thus it keeps the stack moving up and down. <o:p></o:p></span></p>

<p class=MsoListBullet style='margin-left:0in;text-align:justify;text-indent:
0in;mso-list:none;tab-stops:.5in'><span style='font-size:10.0pt;mso-bidi-font-size:
12.0pt;font-family:"Trebuchet MS";color:#000066'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=MsoListBullet style='margin-left:0in;text-align:justify;text-indent:
0in;mso-list:none;tab-stops:.5in'><span style='font-size:10.0pt;mso-bidi-font-size:
12.0pt;font-family:"Trebuchet MS";color:#000066'>The parameters and variables
are all with respect to the stack and they are in reference constantly. Thus,
at the start of every function, some standard code is placed called by the
function prolog. This code first pushes the value in the ebp register on the
stack. Bear in mind, that a register value is placed on the stack so that its
value is saved since the register will be overwritten by other value. Any
register value that would be overwritten must be saved first. <o:p></o:p></span></p>

<p class=MsoListBullet style='margin-left:0in;text-align:justify;text-indent:
0in;mso-list:none;tab-stops:.5in'><span style='font-size:10.0pt;mso-bidi-font-size:
12.0pt;font-family:"Trebuchet MS";color:#000066'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=MsoListBullet style='margin-left:0in;text-align:justify;text-indent:
0in;mso-list:none;tab-stops:.5in'><span style='font-size:10.0pt;mso-bidi-font-size:
12.0pt;font-family:"Trebuchet MS";color:#000066'>Accordingly, when a function
ends and returns control back to the calling program, all the registers must
carry the same values that it held when the function was called. The called
functions are also known to erase the values they have placed on the stack. <o:p></o:p></span></p>

<p class=MsoListBullet style='margin-left:0in;text-align:justify;text-indent:
0in;mso-list:none;tab-stops:.5in'><span style='font-size:10.0pt;mso-bidi-font-size:
12.0pt;font-family:"Trebuchet MS";color:#000066'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=MsoListBullet style='margin-left:0in;text-align:justify;text-indent:
0in;mso-list:none;tab-stops:.5in'><span style='font-size:10.0pt;mso-bidi-font-size:
12.0pt;font-family:"Trebuchet MS";color:#000066'>The value of the esp register
is moved into ebp. All positive offsets from ebp refer to parameters whereas
all negative ones refer to local variables. Therefore, ebp is termed to be the
base pointer and is very useful when designing the stack frame. When function
abc ends, the stack is moved up by 8 to erase the 2 variables created on the
stack. <o:p></o:p></span></p>

<p class=MsoListBullet style='margin-left:0in;text-align:justify;text-indent:
0in;mso-list:none;tab-stops:.5in'><span style='font-size:10.0pt;mso-bidi-font-size:
12.0pt;font-family:"Trebuchet MS";color:#000066'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=MsoListBullet style='margin-left:0in;text-align:justify;text-indent:
0in;mso-list:none;tab-stops:.5in'><span style='font-size:10.0pt;mso-bidi-font-size:
12.0pt;font-family:"Trebuchet MS";color:#000066'>The epilogue function does the
reverse of the prolog. It pops the value of ebp off the stack into the ebp
register thus bringing the stack to the position where the call stored the next
executable instruction. The ret instruction finally pops this value into the
eip register. <o:p></o:p></span></p>

<p class=MsoListBullet style='margin-left:0in;text-align:justify;text-indent:
0in;mso-list:none;tab-stops:.5in'><span style='font-size:10.0pt;mso-bidi-font-size:
12.0pt;font-family:"Trebuchet MS";color:#000066'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=MsoListBullet style='margin-left:0in;text-align:justify;text-indent:
0in;mso-list:none;tab-stops:.5in'><span style='font-size:10.0pt;mso-bidi-font-size:
12.0pt;font-family:"Trebuchet MS";color:#000066'>To sum up the earlier works,
when a function is called, the call instruction places the address of the next
immediate instruction on the stack. Then the function prolog places the value
of ebp on the stack and points ebp to esp in order to refer to variables and
parameters. The function may create local variables on the stack but eventually
cleans it up too. The epilogue function then pops ebp off the stack and the ret
instruction transfers control to the instruction after call. <o:p></o:p></span></p>

<p class=MsoListBullet style='margin-left:0in;text-align:justify;text-indent:
0in;mso-list:none;tab-stops:.5in'><span style='font-size:10.0pt;mso-bidi-font-size:
12.0pt;font-family:"Trebuchet MS";color:#000066'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=MsoListBullet style='margin-left:0in;text-align:justify;text-indent:
0in;mso-list:none;tab-stops:.5in'><span style='font-size:10.0pt;mso-bidi-font-size:
12.0pt;font-family:"Trebuchet MS";color:#000066'>In this manner, functions
placed anywhere in memory return control back to the executing code, all with
heavy usage of stack.<o:p></o:p></span></p>

<p class=MsoListBullet style='margin-left:0in;text-align:justify;text-indent:
0in;mso-list:none;tab-stops:.5in'><span style='font-size:10.0pt;mso-bidi-font-size:
12.0pt;font-family:"Trebuchet MS";color:#000066'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><u><span style='font-size:10.0pt;
mso-bidi-font-size:12.0pt;font-family:"Trebuchet MS";color:#000066'>A19.c</span></u><span
style='font-size:10.0pt;mso-bidi-font-size:12.0pt;font-family:"Trebuchet MS";
color:#000066'><o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.0pt;
mso-bidi-font-size:12.0pt;font-family:"Trebuchet MS";color:#000066'>main()<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.0pt;
mso-bidi-font-size:12.0pt;font-family:"Trebuchet MS";color:#000066'>{<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.0pt;
mso-bidi-font-size:12.0pt;font-family:"Trebuchet MS";color:#000066'>abc(10,20);<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.0pt;
mso-bidi-font-size:12.0pt;font-family:"Trebuchet MS";color:#000066'>}<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.0pt;
mso-bidi-font-size:12.0pt;font-family:"Trebuchet MS";color:#000066'>abc(int i ,
int j)<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.0pt;
mso-bidi-font-size:12.0pt;font-family:"Trebuchet MS";color:#000066'>{<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.0pt;
mso-bidi-font-size:12.0pt;font-family:"Trebuchet MS";color:#000066'>int p =
100;<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.0pt;
mso-bidi-font-size:12.0pt;font-family:"Trebuchet MS";color:#000066'>int q =
200;<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.0pt;
mso-bidi-font-size:12.0pt;font-family:"Trebuchet MS";color:#000066'>printf(&quot;i=%p
j=%p p=%p q=%p\n&quot;,</span><span style='font-size:10.0pt;mso-bidi-font-size:
12.0pt;font-family:Tahoma;mso-bidi-font-family:"Times New Roman";color:#000066'>&amp;</span><span
style='font-size:10.0pt;mso-bidi-font-size:12.0pt;font-family:"Trebuchet MS";
color:#000066'>i,</span><span style='font-size:10.0pt;mso-bidi-font-size:12.0pt;
font-family:Tahoma;mso-bidi-font-family:"Times New Roman";color:#000066'>&amp;</span><span
style='font-size:10.0pt;mso-bidi-font-size:12.0pt;font-family:"Trebuchet MS";
color:#000066'>j,</span><span style='font-size:10.0pt;mso-bidi-font-size:12.0pt;
font-family:Tahoma;mso-bidi-font-family:"Times New Roman";color:#000066'>&amp;</span><span
style='font-size:10.0pt;mso-bidi-font-size:12.0pt;font-family:"Trebuchet MS";
color:#000066'>p,</span><span style='font-size:10.0pt;mso-bidi-font-size:12.0pt;
font-family:Tahoma;mso-bidi-font-family:"Times New Roman";color:#000066'>&amp;</span><span
style='font-size:10.0pt;mso-bidi-font-size:12.0pt;font-family:"Trebuchet MS";
color:#000066'>q);<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.0pt;
mso-bidi-font-size:12.0pt;font-family:"Trebuchet MS";color:#000066'>__asm<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.0pt;
mso-bidi-font-size:12.0pt;font-family:"Trebuchet MS";color:#000066'>{<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.0pt;
mso-bidi-font-size:12.0pt;font-family:"Trebuchet MS";color:#000066'>mov [ebp-4]
, 4<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.0pt;
mso-bidi-font-size:12.0pt;font-family:"Trebuchet MS";color:#000066'>mov DWORD
PTR [ebp-8] , 3<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.0pt;
mso-bidi-font-size:12.0pt;font-family:"Trebuchet MS";color:#000066'>mov 8[ebp]
, 2<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.0pt;
mso-bidi-font-size:12.0pt;font-family:"Trebuchet MS";color:#000066'>mov DWORD
PTR 12[ebp] ,1<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.0pt;
mso-bidi-font-size:12.0pt;font-family:"Trebuchet MS";color:#000066'>}<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.0pt;
mso-bidi-font-size:12.0pt;font-family:"Trebuchet MS";color:#000066'>printf(&quot;p=%d
q=%d i=%d j=%d\n&quot;,p,q,i,j);<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.0pt;
mso-bidi-font-size:12.0pt;font-family:"Trebuchet MS";color:#000066'>}<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.0pt;
mso-bidi-font-size:12.0pt;font-family:"Trebuchet MS";color:#000066'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<h1><span style='color:#000066'>Output<o:p></o:p></span></h1>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.0pt;
mso-bidi-font-size:12.0pt;font-family:"Trebuchet MS";color:#000066'>i=0012FEDC
j=0012FEE0 p=0012FED0 q=0012FECC<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.0pt;
mso-bidi-font-size:12.0pt;font-family:"Trebuchet MS";color:#000066'>p=4 q=3 i=2
j=1<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.0pt;
mso-bidi-font-size:12.0pt;font-family:"Trebuchet MS";color:#000066'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.0pt;
mso-bidi-font-size:12.0pt;font-family:"Trebuchet MS";color:#000066'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.0pt;
mso-bidi-font-size:12.0pt;font-family:"Trebuchet MS";color:#000066'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><!--[if gte vml 1]><v:line id="_x0000_s1236"
 style='position:absolute;left:0;text-align:left;z-index:115' from="0,56.65pt"
 to="0,155.65pt">
 <v:stroke endarrow="block"/>
 <w:wrap anchorx="page"/>
</v:line><v:rect id="_x0000_s1211" style='position:absolute;left:0;
 text-align:left;margin-left:9pt;margin-top:2.65pt;width:90pt;height:162pt;
 z-index:90'>
 <w:wrap anchorx="page"/>
</v:rect><v:line id="_x0000_s1212" style='position:absolute;left:0;
 text-align:left;z-index:91' from="9pt,137.65pt" to="99pt,137.65pt">
 <w:wrap anchorx="page"/>
</v:line><v:shape id="_x0000_s1213" type="#_x0000_t202" style='position:absolute;
 left:0;text-align:left;margin-left:126pt;margin-top:128.65pt;width:117pt;
 height:18pt;z-index:92' filled="f" stroked="f">
 <v:textbox style='mso-next-textbox:#_x0000_s1213'>
  <![if !mso]>
  <table cellpadding=0 cellspacing=0 width="100%">
   <tr>
    <td><![endif]>
    <div>
    <p class=MsoNormal>0x0012fed0</p>
    </div>
    <![if !mso]></td>
   </tr>
  </table>
  <![endif]></v:textbox>
 <w:wrap anchorx="page"/>
</v:shape><v:line id="_x0000_s1214" style='position:absolute;left:0;
 text-align:left;z-index:93' from="99pt,137.65pt" to="117pt,137.65pt">
 <v:stroke endarrow="block"/>
 <w:wrap anchorx="page"/>
</v:line><v:line id="_x0000_s1215" style='position:absolute;left:0;
 text-align:left;z-index:94' from="9pt,110.65pt" to="99pt,110.65pt">
 <w:wrap anchorx="page"/>
</v:line><v:shape id="_x0000_s1216" type="#_x0000_t202" style='position:absolute;
 left:0;text-align:left;margin-left:126pt;margin-top:101.65pt;width:117pt;
 height:18pt;z-index:95' filled="f" stroked="f">
 <v:textbox style='mso-next-textbox:#_x0000_s1216'>
  <![if !mso]>
  <table cellpadding=0 cellspacing=0 width="100%">
   <tr>
    <td><![endif]>
    <div>
    <p class=MsoNormal>0x0012fed4</p>
    </div>
    <![if !mso]></td>
   </tr>
  </table>
  <![endif]></v:textbox>
 <w:wrap anchorx="page"/>
</v:shape><v:line id="_x0000_s1217" style='position:absolute;left:0;
 text-align:left;z-index:96' from="99pt,110.65pt" to="117pt,110.65pt">
 <v:stroke endarrow="block"/>
 <w:wrap anchorx="page"/>
</v:line><v:line id="_x0000_s1218" style='position:absolute;left:0;
 text-align:left;z-index:97' from="9pt,83.65pt" to="99pt,83.65pt">
 <w:wrap anchorx="page"/>
</v:line><v:shape id="_x0000_s1219" type="#_x0000_t202" style='position:absolute;
 left:0;text-align:left;margin-left:126pt;margin-top:74.65pt;width:117pt;
 height:18pt;z-index:98' filled="f" stroked="f">
 <v:textbox style='mso-next-textbox:#_x0000_s1219'>
  <![if !mso]>
  <table cellpadding=0 cellspacing=0 width="100%">
   <tr>
    <td><![endif]>
    <div>
    <p class=MsoNormal>0x0012fed8</p>
    </div>
    <![if !mso]></td>
   </tr>
  </table>
  <![endif]></v:textbox>
 <w:wrap anchorx="page"/>
</v:shape><v:shape id="_x0000_s1220" type="#_x0000_t202" style='position:absolute;
 left:0;text-align:left;margin-left:45pt;margin-top:83.65pt;width:27pt;
 height:18pt;z-index:99' filled="f" stroked="f">
 <v:textbox style='mso-next-textbox:#_x0000_s1220'>
  <![if !mso]>
  <table cellpadding=0 cellspacing=0 width="100%">
   <tr>
    <td><![endif]>
    <div>
    <p class=MsoNormal><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>
    </div>
    <![if !mso]></td>
   </tr>
  </table>
  <![endif]></v:textbox>
 <w:wrap anchorx="page"/>
</v:shape><v:line id="_x0000_s1221" style='position:absolute;left:0;
 text-align:left;z-index:100' from="99pt,83.65pt" to="117pt,83.65pt">
 <v:stroke endarrow="block"/>
 <w:wrap anchorx="page"/>
</v:line><v:line id="_x0000_s1222" style='position:absolute;left:0;
 text-align:left;z-index:101' from="9pt,56.65pt" to="99pt,56.65pt">
 <w:wrap anchorx="page"/>
</v:line><v:shape id="_x0000_s1223" type="#_x0000_t202" style='position:absolute;
 left:0;text-align:left;margin-left:126pt;margin-top:47.65pt;width:90pt;
 height:18pt;z-index:102' filled="f" stroked="f">
 <v:textbox style='mso-next-textbox:#_x0000_s1223'>
  <![if !mso]>
  <table cellpadding=0 cellspacing=0 width="100%">
   <tr>
    <td><![endif]>
    <div>
    <p class=MsoNormal>0x0012fedc</p>
    </div>
    <![if !mso]></td>
   </tr>
  </table>
  <![endif]></v:textbox>
 <w:wrap anchorx="page"/>
</v:shape><v:line id="_x0000_s1224" style='position:absolute;left:0;
 text-align:left;z-index:103' from="99pt,56.65pt" to="117pt,56.65pt">
 <v:stroke endarrow="block"/>
 <w:wrap anchorx="page"/>
</v:line><v:line id="_x0000_s1225" style='position:absolute;left:0;
 text-align:left;z-index:104' from="9pt,29.65pt" to="99pt,29.65pt">
 <w:wrap anchorx="page"/>
</v:line><v:shape id="_x0000_s1226" type="#_x0000_t202" style='position:absolute;
 left:0;text-align:left;margin-left:126pt;margin-top:20.65pt;width:117pt;
 height:18pt;z-index:105' filled="f" stroked="f">
 <v:textbox style='mso-next-textbox:#_x0000_s1226'>
  <![if !mso]>
  <table cellpadding=0 cellspacing=0 width="100%">
   <tr>
    <td><![endif]>
    <div>
    <p class=MsoNormal>0x0012fee0</p>
    </div>
    <![if !mso]></td>
   </tr>
  </table>
  <![endif]></v:textbox>
 <w:wrap anchorx="page"/>
</v:shape><v:shape id="_x0000_s1227" type="#_x0000_t202" style='position:absolute;
 left:0;text-align:left;margin-left:36pt;margin-top:29.65pt;width:45pt;
 height:27pt;z-index:106' filled="f" stroked="f">
 <v:textbox style='mso-next-textbox:#_x0000_s1227'>
  <![if !mso]>
  <table cellpadding=0 cellspacing=0 width="100%">
   <tr>
    <td><![endif]>
    <div>
    <p class=MsoNormal><span style='font-family:"Courier New"'>i=10<o:p></o:p></span></p>
    </div>
    <![if !mso]></td>
   </tr>
  </table>
  <![endif]></v:textbox>
 <w:wrap anchorx="page"/>
</v:shape><v:line id="_x0000_s1228" style='position:absolute;left:0;
 text-align:left;z-index:107' from="99pt,29.65pt" to="117pt,29.65pt">
 <v:stroke endarrow="block"/>
 <w:wrap anchorx="page"/>
</v:line><v:line id="_x0000_s1229" style='position:absolute;left:0;
 text-align:left;z-index:108' from="9pt,2.65pt" to="99pt,2.65pt">
 <w:wrap anchorx="page"/>
</v:line><v:shape id="_x0000_s1230" type="#_x0000_t202" style='position:absolute;
 left:0;text-align:left;margin-left:126pt;margin-top:-6.35pt;width:90pt;
 height:18pt;z-index:109' filled="f" stroked="f">
 <v:textbox style='mso-next-textbox:#_x0000_s1230'>
  <![if !mso]>
  <table cellpadding=0 cellspacing=0 width="100%">
   <tr>
    <td><![endif]>
    <div>
    <p class=MsoNormal>0x0012fee4</p>
    </div>
    <![if !mso]></td>
   </tr>
  </table>
  <![endif]></v:textbox>
 <w:wrap anchorx="page"/>
</v:shape><v:line id="_x0000_s1231" style='position:absolute;left:0;
 text-align:left;z-index:110' from="99pt,2.65pt" to="117pt,2.65pt">
 <v:stroke endarrow="block"/>
 <w:wrap anchorx="page"/>
</v:line><v:line id="_x0000_s1232" style='position:absolute;left:0;
 text-align:left;z-index:111' from="9pt,164.65pt" to="99pt,164.65pt">
 <w:wrap anchorx="page"/>
</v:line><v:shape id="_x0000_s1233" type="#_x0000_t202" style='position:absolute;
 left:0;text-align:left;margin-left:126pt;margin-top:155.65pt;width:117pt;
 height:18pt;z-index:112' filled="f" stroked="f">
 <v:textbox style='mso-next-textbox:#_x0000_s1233'>
  <![if !mso]>
  <table cellpadding=0 cellspacing=0 width="100%">
   <tr>
    <td><![endif]>
    <div>
    <p class=MsoNormal>0x0012fecc</p>
    </div>
    <![if !mso]></td>
   </tr>
  </table>
  <![endif]></v:textbox>
 <w:wrap anchorx="page"/>
</v:shape><v:line id="_x0000_s1234" style='position:absolute;left:0;
 text-align:left;z-index:113' from="99pt,164.65pt" to="117pt,164.65pt">
 <v:stroke endarrow="block"/>
 <w:wrap anchorx="page"/>
</v:line><v:shape id="_x0000_s1235" type="#_x0000_t202" style='position:absolute;
 left:0;text-align:left;margin-left:36pt;margin-top:2.65pt;width:45pt;height:27pt;
 z-index:114' filled="f" stroked="f">
 <v:textbox style='mso-next-textbox:#_x0000_s1235'>
  <![if !mso]>
  <table cellpadding=0 cellspacing=0 width="100%">
   <tr>
    <td><![endif]>
    <div>
    <p class=MsoNormal><span style='font-family:"Courier New"'>j=20<o:p></o:p></span></p>
    </div>
    <![if !mso]></td>
   </tr>
  </table>
  <![endif]></v:textbox>
 <w:wrap anchorx="page"/>
</v:shape><v:shape id="_x0000_s1237" type="#_x0000_t202" style='position:absolute;
 left:0;text-align:left;margin-left:36pt;margin-top:83.65pt;width:45pt;
 height:27pt;z-index:116' filled="f" stroked="f">
 <v:textbox style='mso-next-textbox:#_x0000_s1237'>
  <![if !mso]>
  <table cellpadding=0 cellspacing=0 width="100%">
   <tr>
    <td><![endif]>
    <div>
    <p class=MsoNormal><span style='font-family:"Courier New"'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>
    </div>
    <![if !mso]></td>
   </tr>
  </table>
  <![endif]></v:textbox>
 <w:wrap anchorx="page"/>
</v:shape><v:shape id="_x0000_s1238" type="#_x0000_t202" style='position:absolute;
 left:0;text-align:left;margin-left:225pt;margin-top:83.65pt;width:27pt;
 height:18pt;z-index:117' filled="f" stroked="f">
 <v:textbox style='mso-next-textbox:#_x0000_s1238'>
  <![if !mso]>
  <table cellpadding=0 cellspacing=0 width="100%">
   <tr>
    <td><![endif]>
    <div>
    <p class=MsoNormal><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>
    </div>
    <![if !mso]></td>
   </tr>
  </table>
  <![endif]></v:textbox>
 <w:wrap anchorx="page"/>
</v:shape><v:rect id="_x0000_s1239" style='position:absolute;left:0;
 text-align:left;margin-left:252pt;margin-top:2.65pt;width:90pt;height:135pt;
 z-index:118'>
 <w:wrap anchorx="page"/>
</v:rect><v:line id="_x0000_s1240" style='position:absolute;left:0;
 text-align:left;z-index:119' from="252pt,110.65pt" to="342pt,110.65pt">
 <w:wrap anchorx="page"/>
</v:line><v:line id="_x0000_s1241" style='position:absolute;left:0;
 text-align:left;z-index:120' from="252pt,83.65pt" to="342pt,83.65pt">
 <w:wrap anchorx="page"/>
</v:line><v:shape id="_x0000_s1242" type="#_x0000_t202" style='position:absolute;
 left:0;text-align:left;margin-left:4in;margin-top:83.65pt;width:27pt;height:18pt;
 z-index:121' filled="f" stroked="f">
 <v:textbox style='mso-next-textbox:#_x0000_s1242'>
  <![if !mso]>
  <table cellpadding=0 cellspacing=0 width="100%">
   <tr>
    <td><![endif]>
    <div>
    <p class=MsoNormal><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>
    </div>
    <![if !mso]></td>
   </tr>
  </table>
  <![endif]></v:textbox>
 <w:wrap anchorx="page"/>
</v:shape><v:line id="_x0000_s1243" style='position:absolute;left:0;
 text-align:left;z-index:122' from="252pt,56.65pt" to="342pt,56.65pt">
 <w:wrap anchorx="page"/>
</v:line><v:line id="_x0000_s1244" style='position:absolute;left:0;
 text-align:left;z-index:123' from="252pt,29.65pt" to="342pt,29.65pt">
 <w:wrap anchorx="page"/>
</v:line><v:line id="_x0000_s1245" style='position:absolute;left:0;
 text-align:left;z-index:124' from="252pt,2.65pt" to="342pt,2.65pt">
 <w:wrap anchorx="page"/>
</v:line><v:shape id="_x0000_s1246" type="#_x0000_t202" style='position:absolute;
 left:0;text-align:left;margin-left:270pt;margin-top:-24.35pt;width:45pt;
 height:18pt;z-index:125'>
 <v:textbox style='mso-next-textbox:#_x0000_s1246'>
  <![if !mso]>
  <table cellpadding=0 cellspacing=0 width="100%">
   <tr>
    <td><![endif]>
    <div>
    <p class=MsoNormal>EBP</p>
    </div>
    <![if !mso]></td>
   </tr>
  </table>
  <![endif]></v:textbox>
 <w:wrap anchorx="page"/>
</v:shape><v:shape id="_x0000_s1247" type="#_x0000_t202" style='position:absolute;
 left:0;text-align:left;margin-left:36pt;margin-top:-24.35pt;width:45pt;
 height:18pt;z-index:126'>
 <v:textbox style='mso-next-textbox:#_x0000_s1247'>
  <![if !mso]>
  <table cellpadding=0 cellspacing=0 width="100%">
   <tr>
    <td><![endif]>
    <div>
    <p class=MsoNormal>ESP</p>
    </div>
    <![if !mso]></td>
   </tr>
  </table>
  <![endif]></v:textbox>
 <w:wrap anchorx="page"/>
</v:shape><v:shape id="_x0000_s1248" type="#_x0000_t202" style='position:absolute;
 left:0;text-align:left;margin-left:252pt;margin-top:65.65pt;width:90pt;
 height:18pt;z-index:127' filled="f" stroked="f">
 <v:textbox style='mso-next-textbox:#_x0000_s1248'>
  <![if !mso]>
  <table cellpadding=0 cellspacing=0 width="100%">
   <tr>
    <td><![endif]>
    <div>
    <p class=MsoNormal>0x0012fee4</p>
    </div>
    <![if !mso]></td>
   </tr>
  </table>
  <![endif]></v:textbox>
 <w:wrap anchorx="page"/>
</v:shape><v:shape id="_x0000_s1249" type="#_x0000_t202" style='position:absolute;
 left:0;text-align:left;margin-left:18pt;margin-top:137.65pt;width:81pt;
 height:27pt;z-index:128' filled="f" stroked="f">
 <v:textbox style='mso-next-textbox:#_x0000_s1249'>
  <![if !mso]>
  <table cellpadding=0 cellspacing=0 width="100%">
   <tr>
    <td><![endif]>
    <div>
    <p class=MsoNormal><span style="mso-spacerun: yes">  </span>q=200</p>
    </div>
    <![if !mso]></td>
   </tr>
  </table>
  <![endif]></v:textbox>
 <w:wrap anchorx="page"/>
</v:shape><v:shape id="_x0000_s1250" type="#_x0000_t202" style='position:absolute;
 left:0;text-align:left;margin-left:252pt;margin-top:11.65pt;width:90pt;
 height:18pt;z-index:129' filled="f" stroked="f">
 <v:textbox style='mso-next-textbox:#_x0000_s1250'>
  <![if !mso]>
  <table cellpadding=0 cellspacing=0 width="100%">
   <tr>
    <td><![endif]>
    <div>
    <p class=MsoNormal>0x0012fee4</p>
    </div>
    <![if !mso]></td>
   </tr>
  </table>
  <![endif]></v:textbox>
 <w:wrap anchorx="page"/>
</v:shape><v:shape id="_x0000_s1251" type="#_x0000_t202" style='position:absolute;
 left:0;text-align:left;margin-left:27pt;margin-top:119.65pt;width:1in;
 height:18pt;z-index:130' filled="f" stroked="f">
 <v:textbox style='mso-next-textbox:#_x0000_s1251'>
  <![if !mso]>
  <table cellpadding=0 cellspacing=0 width="100%">
   <tr>
    <td><![endif]>
    <div>
    <p class=MsoNormal>p=100</p>
    </div>
    <![if !mso]></td>
   </tr>
  </table>
  <![endif]></v:textbox>
 <w:wrap anchorx="page"/>
</v:shape><v:shape id="_x0000_s1252" type="#_x0000_t202" style='position:absolute;
 left:0;text-align:left;margin-left:252pt;margin-top:92.65pt;width:90pt;
 height:18pt;z-index:131' filled="f" stroked="f">
 <v:textbox style='mso-next-textbox:#_x0000_s1252'>
  <![if !mso]>
  <table cellpadding=0 cellspacing=0 width="100%">
   <tr>
    <td><![endif]>
    <div>
    <p class=MsoNormal>0x0012fed4</p>
    </div>
    <![if !mso]></td>
   </tr>
  </table>
  <![endif]></v:textbox>
 <w:wrap anchorx="page"/>
</v:shape><v:shape id="_x0000_s1253" type="#_x0000_t202" style='position:absolute;
 left:0;text-align:left;margin-left:252pt;margin-top:38.65pt;width:90pt;
 height:18pt;z-index:132' filled="f" stroked="f">
 <v:textbox style='mso-next-textbox:#_x0000_s1253'>
  <![if !mso]>
  <table cellpadding=0 cellspacing=0 width="100%">
   <tr>
    <td><![endif]>
    <div>
    <p class=MsoNormal>0x0012fee4</p>
    </div>
    <![if !mso]></td>
   </tr>
  </table>
  <![endif]></v:textbox>
 <w:wrap anchorx="page"/>
</v:shape><v:shape id="_x0000_s1254" type="#_x0000_t202" style='position:absolute;
 left:0;text-align:left;margin-left:9pt;margin-top:83.65pt;width:90pt;height:18pt;
 z-index:133' filled="f" stroked="f">
 <v:textbox style='mso-next-textbox:#_x0000_s1254'>
  <![if !mso]>
  <table cellpadding=0 cellspacing=0 width="100%">
   <tr>
    <td><![endif]>
    <div>
    <p class=MsoNormal>0x0012fee4</p>
    </div>
    <![if !mso]></td>
   </tr>
  </table>
  <![endif]></v:textbox>
 <w:wrap anchorx="page"/>
</v:shape><v:line id="_x0000_s1255" style='position:absolute;left:0;
 text-align:left;flip:x;z-index:134' from="108pt,74.65pt" to="243pt,101.65pt">
 <v:stroke endarrow="block"/>
 <w:wrap anchorx="page"/>
</v:line><v:line id="_x0000_s1256" style='position:absolute;left:0;
 text-align:left;flip:y;z-index:135' from="126pt,92.65pt" to="243pt,110.65pt">
 <v:stroke endarrow="block"/>
 <w:wrap anchorx="page"/>
</v:line><![endif]--><![if !vml]><span style='mso-ignore:vglayout;position:
relative;z-index:114'><span style='left:0px;position:absolute;left:-6px;
top:-32px;width:464px;height:266px'>

<table cellpadding=0 cellspacing=0 align=left>
 <tr>
  <td width=0 height=0></td>
  <td width=14></td>
  <td width=3></td>
  <td width=447></td>
 </tr>
 <tr>
  <td height=107></td>
  <td colspan=2></td>
  <td rowspan=3 align=left valign=top><img width=447 height=266
  src="bufferoverfloww_files/image007.gif" v:shapes="_x0000_s1211 _x0000_s1212 _x0000_s1213 _x0000_s1214 _x0000_s1215 _x0000_s1216 _x0000_s1217 _x0000_s1218 _x0000_s1219 _x0000_s1220 _x0000_s1221 _x0000_s1222 _x0000_s1223 _x0000_s1224 _x0000_s1225 _x0000_s1226 _x0000_s1227 _x0000_s1228 _x0000_s1229 _x0000_s1230 _x0000_s1231 _x0000_s1232 _x0000_s1233 _x0000_s1234 _x0000_s1235 _x0000_s1237 _x0000_s1238 _x0000_s1239 _x0000_s1240 _x0000_s1241 _x0000_s1242 _x0000_s1243 _x0000_s1244 _x0000_s1245 _x0000_s1246 _x0000_s1247 _x0000_s1248 _x0000_s1249 _x0000_s1250 _x0000_s1251 _x0000_s1252 _x0000_s1253 _x0000_s1254 _x0000_s1255 _x0000_s1256"></td>
 </tr>
 <tr>
  <td height=135></td>
  <td align=left valign=top><img width=14 height=135
  src="bufferoverfloww_files/image008.gif" v:shapes="_x0000_s1236"></td>
 </tr>
 <tr>
  <td height=24></td>
 </tr>
</table>

</span></span><![endif]><span style='font-size:10.0pt;mso-bidi-font-size:12.0pt;
font-family:"Trebuchet MS";color:#000066'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.0pt;
mso-bidi-font-size:12.0pt;font-family:"Trebuchet MS";color:#000066'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.0pt;
mso-bidi-font-size:12.0pt;font-family:"Trebuchet MS";color:#000066'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.0pt;
mso-bidi-font-size:12.0pt;font-family:"Trebuchet MS";color:#000066'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.0pt;
mso-bidi-font-size:12.0pt;font-family:"Trebuchet MS";color:#000066'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.0pt;
mso-bidi-font-size:12.0pt;font-family:"Trebuchet MS";color:#000066'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.0pt;
mso-bidi-font-size:12.0pt;font-family:"Trebuchet MS";color:#000066'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.0pt;
mso-bidi-font-size:12.0pt;font-family:"Trebuchet MS";color:#000066'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.0pt;
mso-bidi-font-size:12.0pt;font-family:"Trebuchet MS";color:#000066'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.0pt;
mso-bidi-font-size:12.0pt;font-family:"Trebuchet MS";color:#000066'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.0pt;
mso-bidi-font-size:12.0pt;font-family:"Trebuchet MS";color:#000066'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.0pt;
mso-bidi-font-size:12.0pt;font-family:"Trebuchet MS";color:#000066'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.0pt;
mso-bidi-font-size:12.0pt;font-family:"Trebuchet MS";color:#000066'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.0pt;
mso-bidi-font-size:12.0pt;font-family:"Trebuchet MS";color:#000066'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.0pt;
mso-bidi-font-size:12.0pt;font-family:"Trebuchet MS";color:#000066'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<br style='mso-ignore:vglayout' clear=ALL>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.0pt;
mso-bidi-font-size:12.0pt;font-family:"Trebuchet MS";color:#000066'>Figure 3<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.0pt;
mso-bidi-font-size:12.0pt;font-family:"Trebuchet MS";color:#000066'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.0pt;
mso-bidi-font-size:12.0pt;font-family:"Trebuchet MS";color:#000066'>Figure 3 is
almost the same diagram as seen before. But, for one last time we will repeat
the workings. <o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.0pt;
mso-bidi-font-size:12.0pt;font-family:"Trebuchet MS";color:#000066'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.0pt;
mso-bidi-font-size:12.0pt;font-family:"Trebuchet MS";color:#000066'>The two values
20 and 10 are assigned to parameters i and j starting at stack position
0x0012fee0 and 0x0012fedc. The call instruction pushes the next instruction
address of 0x0012fed8 on the stack before the function prologue pushes the
value of ebp on the stack. At this point, the stack pointer or esp has a value
of 0x0012fed4 which is then moved into the ebp register. <o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.0pt;
mso-bidi-font-size:12.0pt;font-family:"Trebuchet MS";color:#000066'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.0pt;
mso-bidi-font-size:12.0pt;font-family:"Trebuchet MS";color:#000066'>The
variables p and q are then created at 0x0012fed0 and 0x0012fecc. In the
assembler code, by moving 4 into the memory denoted by ebp-4 becomes
0x0012fed4-4 or 0x0012fed0 which is also the address of variable p. Thus, ebp-8
or 0x0012fecc becomes the address of variable q. The local variables are
created after the function prolog and therefore have a negative offset visa v
the constant value of ebp. Moreover, by adding 8 to the ebp register is where
parameter i is located, and adding 12 takes to j. <o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.0pt;
mso-bidi-font-size:12.0pt;font-family:"Trebuchet MS";color:#000066'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.0pt;
mso-bidi-font-size:12.0pt;font-family:"Trebuchet MS";color:#000066'>Like a
pointer reference the reference can be written as [ebp+8] as well as 8[ebp].
Thus, a compiler while generating assembler code uses similar rules while
referring to parameters and local variables. <o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.0pt;
mso-bidi-font-size:12.0pt;font-family:"Trebuchet MS";color:#000066'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.0pt;
mso-bidi-font-size:12.0pt;font-family:"Trebuchet MS";color:#000066'>It is
preferred using the ebp value to refer to variables and parameters instead of
esp as the value of esp changes constantly.<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.0pt;
mso-bidi-font-size:12.0pt;font-family:"Trebuchet MS";color:#000066'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><u><span style='font-size:10.0pt;
mso-bidi-font-size:12.0pt;font-family:"Trebuchet MS";color:#000066'>A20.c</span></u><span
style='font-size:10.0pt;mso-bidi-font-size:12.0pt;font-family:"Trebuchet MS";
color:#000066'><o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.0pt;
mso-bidi-font-size:12.0pt;font-family:"Trebuchet MS";color:#000066'>main()<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.0pt;
mso-bidi-font-size:12.0pt;font-family:"Trebuchet MS";color:#000066'>{<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.0pt;
mso-bidi-font-size:12.0pt;font-family:"Trebuchet MS";color:#000066'>printf(&quot;Main
%p\n&quot;,main);<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.0pt;
mso-bidi-font-size:12.0pt;font-family:"Trebuchet MS";color:#000066'>__asm<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.0pt;
mso-bidi-font-size:12.0pt;font-family:"Trebuchet MS";color:#000066'>{<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.0pt;
mso-bidi-font-size:12.0pt;font-family:"Trebuchet MS";color:#000066'>push
0x00401000<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.0pt;
mso-bidi-font-size:12.0pt;font-family:"Trebuchet MS";color:#000066'>ret<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.0pt;
mso-bidi-font-size:12.0pt;font-family:"Trebuchet MS";color:#000066'>}<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.0pt;
mso-bidi-font-size:12.0pt;font-family:"Trebuchet MS";color:#000066'>}<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.0pt;
mso-bidi-font-size:12.0pt;font-family:"Trebuchet MS";color:#000066'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<h1><span style='color:#000066'>Output<o:p></o:p></span></h1>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.0pt;
mso-bidi-font-size:12.0pt;font-family:"Trebuchet MS";color:#000066'>Main<span
style="mso-spacerun: yes">  </span>00401000<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.0pt;
mso-bidi-font-size:12.0pt;font-family:"Trebuchet MS";color:#000066'>Main<span
style="mso-spacerun: yes">  </span>00401000<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.0pt;
mso-bidi-font-size:12.0pt;font-family:"Trebuchet MS";color:#000066'>Main<span
style="mso-spacerun: yes">  </span>00401000<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.0pt;
mso-bidi-font-size:12.0pt;font-family:"Trebuchet MS";color:#000066'>…<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.0pt;
mso-bidi-font-size:12.0pt;font-family:"Trebuchet MS";color:#000066'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.0pt;
mso-bidi-font-size:12.0pt;font-family:"Trebuchet MS";color:#000066'>The above
program goes into an infinite loop thereby explaining the importance of the ret
keyword. <o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.0pt;
mso-bidi-font-size:12.0pt;font-family:"Trebuchet MS";color:#000066'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.0pt;
mso-bidi-font-size:12.0pt;font-family:"Trebuchet MS";color:#000066'>The
function Main starts in memory at 0x00401000. The push instruction pushes the same
value on the stack, thus the stack now contains the address of function main. <o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.0pt;
mso-bidi-font-size:12.0pt;font-family:"Trebuchet MS";color:#000066'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.0pt;
mso-bidi-font-size:12.0pt;font-family:"Trebuchet MS";color:#000066'>When the
ret instruction is executed, it sees 0x00401000 on the stack. So, it moves the
stack up by 4 and puts this value in the eip register. As we remember, the eip
register holds the address of the next executable code, thus control passes on
to this address. This, in effect, being the address of function Main executes
the function and thus becomes an endless loop.<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.0pt;
mso-bidi-font-size:12.0pt;font-family:"Trebuchet MS";color:#000066'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><u><span style='font-size:10.0pt;
mso-bidi-font-size:12.0pt;font-family:"Trebuchet MS";color:#000066'>A21.c</span></u><span
style='font-size:10.0pt;mso-bidi-font-size:12.0pt;font-family:"Trebuchet MS";
color:#000066'><o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.0pt;
mso-bidi-font-size:12.0pt;font-family:"Trebuchet MS";color:#000066'>main()<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.0pt;
mso-bidi-font-size:12.0pt;font-family:"Trebuchet MS";color:#000066'>{<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.0pt;
mso-bidi-font-size:12.0pt;font-family:"Trebuchet MS";color:#000066'>int x = 11;<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.0pt;
mso-bidi-font-size:12.0pt;font-family:"Trebuchet MS";color:#000066'>abc();<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.0pt;
mso-bidi-font-size:12.0pt;font-family:"Trebuchet MS";color:#000066'>x = 4;<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.0pt;
mso-bidi-font-size:12.0pt;font-family:"Trebuchet MS";color:#000066'>printf(&quot;x=%d\n&quot;,x);<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.0pt;
mso-bidi-font-size:12.0pt;font-family:"Trebuchet MS";color:#000066'>}<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.0pt;
mso-bidi-font-size:12.0pt;font-family:"Trebuchet MS";color:#000066'>abc()<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.0pt;
mso-bidi-font-size:12.0pt;font-family:"Trebuchet MS";color:#000066'>{<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.0pt;
mso-bidi-font-size:12.0pt;font-family:"Trebuchet MS";color:#000066'>int a;<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.0pt;
mso-bidi-font-size:12.0pt;font-family:"Trebuchet MS";color:#000066'>int *p;<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.0pt;
mso-bidi-font-size:12.0pt;font-family:"Trebuchet MS";color:#000066'>printf(&quot;a=%p
p=%p \n&quot;,</span><span style='font-size:10.0pt;mso-bidi-font-size:12.0pt;
font-family:Tahoma;mso-bidi-font-family:"Times New Roman";color:#000066'>&amp;</span><span
style='font-size:10.0pt;mso-bidi-font-size:12.0pt;font-family:"Trebuchet MS";
color:#000066'>a, </span><span style='font-size:10.0pt;mso-bidi-font-size:12.0pt;
font-family:Tahoma;mso-bidi-font-family:"Times New Roman";color:#000066'>&amp;</span><span
style='font-size:10.0pt;mso-bidi-font-size:12.0pt;font-family:"Trebuchet MS";
color:#000066'>p);<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.0pt;
mso-bidi-font-size:12.0pt;font-family:"Trebuchet MS";color:#000066'>p = </span><span
style='font-size:10.0pt;mso-bidi-font-size:12.0pt;font-family:Tahoma;
mso-bidi-font-family:"Times New Roman";color:#000066'>&amp;</span><span
style='font-size:10.0pt;mso-bidi-font-size:12.0pt;font-family:"Trebuchet MS";
color:#000066'>a ;<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.0pt;
mso-bidi-font-size:12.0pt;font-family:"Trebuchet MS";color:#000066'>p = p + 3;<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.0pt;
mso-bidi-font-size:12.0pt;font-family:"Trebuchet MS";color:#000066'>printf(&quot;%p\n&quot;,p);<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.0pt;
mso-bidi-font-size:12.0pt;font-family:"Trebuchet MS";color:#000066'>*p = *p +
7;<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.0pt;
mso-bidi-font-size:12.0pt;font-family:"Trebuchet MS";color:#000066'>}<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.0pt;
mso-bidi-font-size:12.0pt;font-family:"Trebuchet MS";color:#000066'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<h1><span style='color:#000066'>Output<o:p></o:p></span></h1>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.0pt;
mso-bidi-font-size:12.0pt;font-family:"Trebuchet MS";color:#000066'>a=0012FED0
p=0012FED4<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.0pt;
mso-bidi-font-size:12.0pt;font-family:"Trebuchet MS";color:#000066'>0012FEDC<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.0pt;
mso-bidi-font-size:12.0pt;font-family:"Trebuchet MS";color:#000066'>x=11<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.0pt;
mso-bidi-font-size:12.0pt;font-family:"Trebuchet MS";color:#000066'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.0pt;
mso-bidi-font-size:12.0pt;font-family:"Trebuchet MS";color:#000066'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.0pt;
mso-bidi-font-size:12.0pt;font-family:"Trebuchet MS";color:#000066'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.0pt;
mso-bidi-font-size:12.0pt;font-family:"Trebuchet MS";color:#000066'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.0pt;
mso-bidi-font-size:12.0pt;font-family:"Trebuchet MS";color:#000066'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><!--[if gte vml 1]><v:line id="_x0000_s1302"
 style='position:absolute;left:0;text-align:left;z-index:159' from="27pt,30.2pt"
 to="27pt,129.2pt">
 <v:stroke endarrow="block"/>
 <w:wrap anchorx="page"/>
</v:line><v:shape id="_x0000_s1306" type="#_x0000_t202" style='position:absolute;
 left:0;text-align:left;margin-left:54pt;margin-top:156.2pt;width:45pt;
 height:27pt;z-index:163' filled="f" stroked="f">
 <v:textbox style='mso-next-textbox:#_x0000_s1306'/>
 <w:wrap anchorx="page"/>
</v:shape><v:rect id="_x0000_s1279" style='position:absolute;left:0;
 text-align:left;margin-left:36pt;margin-top:-23.8pt;width:90pt;height:162pt;
 z-index:136'>
 <w:wrap anchorx="page"/>
</v:rect><v:line id="_x0000_s1280" style='position:absolute;left:0;
 text-align:left;z-index:137' from="36pt,111.2pt" to="126pt,111.2pt">
 <w:wrap anchorx="page"/>
</v:line><v:shape id="_x0000_s1281" type="#_x0000_t202" style='position:absolute;
 left:0;text-align:left;margin-left:153pt;margin-top:102.2pt;width:117pt;
 height:18pt;z-index:138' filled="f" stroked="f">
 <v:textbox style='mso-next-textbox:#_x0000_s1281'>
  <![if !mso]>
  <table cellpadding=0 cellspacing=0 width="100%">
   <tr>
    <td><![endif]>
    <div>
    <p class=MsoNormal>0x0012fed0</p>
    </div>
    <![if !mso]></td>
   </tr>
  </table>
  <![endif]></v:textbox>
 <w:wrap anchorx="page"/>
</v:shape><v:line id="_x0000_s1282" style='position:absolute;left:0;
 text-align:left;z-index:139' from="126pt,111.2pt" to="2in,111.2pt">
 <v:stroke endarrow="block"/>
 <w:wrap anchorx="page"/>
</v:line><v:line id="_x0000_s1283" style='position:absolute;left:0;
 text-align:left;z-index:140' from="36pt,84.2pt" to="126pt,84.2pt">
 <w:wrap anchorx="page"/>
</v:line><v:shape id="_x0000_s1284" type="#_x0000_t202" style='position:absolute;
 left:0;text-align:left;margin-left:153pt;margin-top:75.2pt;width:117pt;
 height:18pt;z-index:141' filled="f" stroked="f">
 <v:textbox style='mso-next-textbox:#_x0000_s1284'>
  <![if !mso]>
  <table cellpadding=0 cellspacing=0 width="100%">
   <tr>
    <td><![endif]>
    <div>
    <p class=MsoNormal>0x0012fed4</p>
    </div>
    <![if !mso]></td>
   </tr>
  </table>
  <![endif]></v:textbox>
 <w:wrap anchorx="page"/>
</v:shape><v:line id="_x0000_s1285" style='position:absolute;left:0;
 text-align:left;z-index:142' from="126pt,84.2pt" to="2in,84.2pt">
 <v:stroke endarrow="block"/>
 <w:wrap anchorx="page"/>
</v:line><v:line id="_x0000_s1286" style='position:absolute;left:0;
 text-align:left;z-index:143' from="36pt,57.2pt" to="126pt,57.2pt">
 <w:wrap anchorx="page"/>
</v:line><v:shape id="_x0000_s1287" type="#_x0000_t202" style='position:absolute;
 left:0;text-align:left;margin-left:153pt;margin-top:48.2pt;width:117pt;
 height:18pt;z-index:144' filled="f" stroked="f">
 <v:textbox style='mso-next-textbox:#_x0000_s1287'>
  <![if !mso]>
  <table cellpadding=0 cellspacing=0 width="100%">
   <tr>
    <td><![endif]>
    <div>
    <p class=MsoNormal>0x0012fed8</p>
    </div>
    <![if !mso]></td>
   </tr>
  </table>
  <![endif]></v:textbox>
 <w:wrap anchorx="page"/>
</v:shape><v:shape id="_x0000_s1288" type="#_x0000_t202" style='position:absolute;
 left:0;text-align:left;margin-left:1in;margin-top:57.2pt;width:27pt;height:18pt;
 z-index:145' filled="f" stroked="f">
 <v:textbox style='mso-next-textbox:#_x0000_s1288'>
  <![if !mso]>
  <table cellpadding=0 cellspacing=0 width="100%">
   <tr>
    <td><![endif]>
    <div>
    <p class=MsoNormal><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>
    </div>
    <![if !mso]></td>
   </tr>
  </table>
  <![endif]></v:textbox>
 <w:wrap anchorx="page"/>
</v:shape><v:line id="_x0000_s1289" style='position:absolute;left:0;
 text-align:left;z-index:146' from="126pt,57.2pt" to="2in,57.2pt">
 <v:stroke endarrow="block"/>
 <w:wrap anchorx="page"/>
</v:line><v:line id="_x0000_s1290" style='position:absolute;left:0;
 text-align:left;z-index:147' from="36pt,30.2pt" to="126pt,30.2pt">
 <w:wrap anchorx="page"/>
</v:line><v:shape id="_x0000_s1291" type="#_x0000_t202" style='position:absolute;
 left:0;text-align:left;margin-left:153pt;margin-top:21.2pt;width:90pt;
 height:18pt;z-index:148' filled="f" stroked="f">
 <v:textbox style='mso-next-textbox:#_x0000_s1291'>
  <![if !mso]>
  <table cellpadding=0 cellspacing=0 width="100%">
   <tr>
    <td><![endif]>
    <div>
    <p class=MsoNormal>0x0012fedc</p>
    </div>
    <![if !mso]></td>
   </tr>
  </table>
  <![endif]></v:textbox>
 <w:wrap anchorx="page"/>
</v:shape><v:line id="_x0000_s1292" style='position:absolute;left:0;
 text-align:left;z-index:149' from="126pt,30.2pt" to="2in,30.2pt">
 <v:stroke endarrow="block"/>
 <w:wrap anchorx="page"/>
</v:line><v:line id="_x0000_s1293" style='position:absolute;left:0;
 text-align:left;z-index:150' from="36pt,3.2pt" to="126pt,3.2pt">
 <w:wrap anchorx="page"/>
</v:line><v:shape id="_x0000_s1294" type="#_x0000_t202" style='position:absolute;
 left:0;text-align:left;margin-left:153pt;margin-top:-5.8pt;width:117pt;
 height:18pt;z-index:151' filled="f" stroked="f">
 <v:textbox style='mso-next-textbox:#_x0000_s1294'>
  <![if !mso]>
  <table cellpadding=0 cellspacing=0 width="100%">
   <tr>
    <td><![endif]>
    <div>
    <p class=MsoNormal>0x0012fee0</p>
    </div>
    <![if !mso]></td>
   </tr>
  </table>
  <![endif]></v:textbox>
 <w:wrap anchorx="page"/>
</v:shape><v:line id="_x0000_s1295" style='position:absolute;left:0;
 text-align:left;z-index:152' from="126pt,3.2pt" to="2in,3.2pt">
 <v:stroke endarrow="block"/>
 <w:wrap anchorx="page"/>
</v:line><v:line id="_x0000_s1296" style='position:absolute;left:0;
 text-align:left;z-index:153' from="36pt,-23.8pt" to="126pt,-23.8pt">
 <w:wrap anchorx="page"/>
</v:line><v:shape id="_x0000_s1297" type="#_x0000_t202" style='position:absolute;
 left:0;text-align:left;margin-left:153pt;margin-top:-32.8pt;width:90pt;
 height:18pt;z-index:154' filled="f" stroked="f">
 <v:textbox style='mso-next-textbox:#_x0000_s1297'>
  <![if !mso]>
  <table cellpadding=0 cellspacing=0 width="100%">
   <tr>
    <td><![endif]>
    <div>
    <p class=MsoNormal>0x0012fee4</p>
    </div>
    <![if !mso]></td>
   </tr>
  </table>
  <![endif]></v:textbox>
 <w:wrap anchorx="page"/>
</v:shape><v:line id="_x0000_s1298" style='position:absolute;left:0;
 text-align:left;z-index:155' from="126pt,-23.8pt" to="2in,-23.8pt">
 <v:stroke endarrow="block"/>
 <w:wrap anchorx="page"/>
</v:line><v:line id="_x0000_s1299" style='position:absolute;left:0;
 text-align:left;z-index:156' from="36pt,138.2pt" to="126pt,138.2pt">
 <w:wrap anchorx="page"/>
</v:line><v:shape id="_x0000_s1300" type="#_x0000_t202" style='position:absolute;
 left:0;text-align:left;margin-left:153pt;margin-top:129.2pt;width:117pt;
 height:18pt;z-index:157' filled="f" stroked="f">
 <v:textbox style='mso-next-textbox:#_x0000_s1300'>
  <![if !mso]>
  <table cellpadding=0 cellspacing=0 width="100%">
   <tr>
    <td><![endif]>
    <div>
    <p class=MsoNormal>0x0012fecc</p>
    </div>
    <![if !mso]></td>
   </tr>
  </table>
  <![endif]></v:textbox>
 <w:wrap anchorx="page"/>
</v:shape><v:line id="_x0000_s1301" style='position:absolute;left:0;
 text-align:left;z-index:158' from="126pt,138.2pt" to="2in,138.2pt">
 <v:stroke endarrow="block"/>
 <w:wrap anchorx="page"/>
</v:line><v:shape id="_x0000_s1303" type="#_x0000_t202" style='position:absolute;
 left:0;text-align:left;margin-left:36pt;margin-top:57.2pt;width:90pt;height:27pt;
 z-index:160' filled="f" stroked="f">
 <v:textbox style='mso-next-textbox:#_x0000_s1303'>
  <![if !mso]>
  <table cellpadding=0 cellspacing=0 width="100%">
   <tr>
    <td><![endif]>
    <div>
    <p class=MsoNormal><span style='font-family:"Courier New"'>p=0012fed0<o:p></o:p></span></p>
    </div>
    <![if !mso]></td>
   </tr>
  </table>
  <![endif]></v:textbox>
 <w:wrap anchorx="page"/>
</v:shape><v:shape id="_x0000_s1305" type="#_x0000_t202" style='position:absolute;
 left:0;text-align:left;margin-left:63pt;margin-top:84.2pt;width:36pt;height:18pt;
 z-index:162' filled="f" stroked="f">
 <v:textbox style='mso-next-textbox:#_x0000_s1305'>
  <![if !mso]>
  <table cellpadding=0 cellspacing=0 width="100%">
   <tr>
    <td><![endif]>
    <div>
    <p class=MsoNormal>a</p>
    </div>
    <![if !mso]></td>
   </tr>
  </table>
  <![endif]></v:textbox>
 <w:wrap anchorx="page"/>
</v:shape><v:line id="_x0000_s1307" style='position:absolute;left:0;
 text-align:left;z-index:164' from="135pt,66.2pt" to="153pt,66.2pt">
 <w:wrap anchorx="page"/>
</v:line><v:line id="_x0000_s1308" style='position:absolute;left:0;
 text-align:left;z-index:165' from="153pt,66.2pt" to="153pt,102.2pt">
 <w:wrap anchorx="page"/>
</v:line><v:line id="_x0000_s1309" style='position:absolute;left:0;
 text-align:left;flip:x;z-index:166' from="135pt,102.2pt" to="153pt,102.2pt">
 <v:stroke endarrow="block"/>
 <w:wrap anchorx="page"/>
</v:line><v:rect id="_x0000_s1310" style='position:absolute;left:0;
 text-align:left;margin-left:234pt;margin-top:-23.8pt;width:90pt;height:162pt;
 z-index:167'>
 <w:wrap anchorx="page"/>
</v:rect><v:line id="_x0000_s1311" style='position:absolute;left:0;
 text-align:left;z-index:168' from="234pt,111.2pt" to="324pt,111.2pt">
 <w:wrap anchorx="page"/>
</v:line><v:line id="_x0000_s1312" style='position:absolute;left:0;
 text-align:left;z-index:169' from="234pt,84.2pt" to="324pt,84.2pt">
 <w:wrap anchorx="page"/>
</v:line><v:line id="_x0000_s1313" style='position:absolute;left:0;
 text-align:left;z-index:170' from="234pt,57.2pt" to="324pt,57.2pt">
 <w:wrap anchorx="page"/>
</v:line><v:shape id="_x0000_s1314" type="#_x0000_t202" style='position:absolute;
 left:0;text-align:left;margin-left:270pt;margin-top:57.2pt;width:27pt;
 height:18pt;z-index:171' filled="f" stroked="f">
 <v:textbox style='mso-next-textbox:#_x0000_s1314'>
  <![if !mso]>
  <table cellpadding=0 cellspacing=0 width="100%">
   <tr>
    <td><![endif]>
    <div>
    <p class=MsoNormal><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>
    </div>
    <![if !mso]></td>
   </tr>
  </table>
  <![endif]></v:textbox>
 <w:wrap anchorx="page"/>
</v:shape><v:line id="_x0000_s1315" style='position:absolute;left:0;
 text-align:left;z-index:172' from="234pt,30.2pt" to="324pt,30.2pt">
 <w:wrap anchorx="page"/>
</v:line><v:line id="_x0000_s1316" style='position:absolute;left:0;
 text-align:left;z-index:173' from="234pt,3.2pt" to="324pt,3.2pt">
 <w:wrap anchorx="page"/>
</v:line><v:line id="_x0000_s1317" style='position:absolute;left:0;
 text-align:left;z-index:174' from="234pt,-23.8pt" to="324pt,-23.8pt">
 <w:wrap anchorx="page"/>
</v:line><v:line id="_x0000_s1318" style='position:absolute;left:0;
 text-align:left;z-index:175' from="234pt,138.2pt" to="324pt,138.2pt">
 <w:wrap anchorx="page"/>
</v:line><v:shape id="_x0000_s1319" type="#_x0000_t202" style='position:absolute;
 left:0;text-align:left;margin-left:234pt;margin-top:57.2pt;width:90pt;
 height:27pt;z-index:176' filled="f" stroked="f">
 <v:textbox style='mso-next-textbox:#_x0000_s1319'>
  <![if !mso]>
  <table cellpadding=0 cellspacing=0 width="100%">
   <tr>
    <td><![endif]>
    <div>
    <p class=MsoNormal><span style='font-family:"Courier New"'>P=0012fedc<o:p></o:p></span></p>
    </div>
    <![if !mso]></td>
   </tr>
  </table>
  <![endif]></v:textbox>
 <w:wrap anchorx="page"/>
</v:shape><v:shape id="_x0000_s1320" type="#_x0000_t202" style='position:absolute;
 left:0;text-align:left;margin-left:261pt;margin-top:84.2pt;width:36pt;
 height:18pt;z-index:177' filled="f" stroked="f">
 <v:textbox style='mso-next-textbox:#_x0000_s1320'>
  <![if !mso]>
  <table cellpadding=0 cellspacing=0 width="100%">
   <tr>
    <td><![endif]>
    <div>
    <p class=MsoNormal>a</p>
    </div>
    <![if !mso]></td>
   </tr>
  </table>
  <![endif]></v:textbox>
 <w:wrap anchorx="page"/>
</v:shape><v:line id="_x0000_s1322" style='position:absolute;left:0;
 text-align:left;z-index:179' from="324pt,75.2pt" to="351pt,75.2pt">
 <w:wrap anchorx="page"/>
</v:line><v:line id="_x0000_s1323" style='position:absolute;left:0;
 text-align:left;flip:y;z-index:180' from="351pt,12.2pt" to="351pt,75.2pt">
 <w:wrap anchorx="page"/>
</v:line><v:line id="_x0000_s1324" style='position:absolute;left:0;
 text-align:left;flip:x;z-index:181' from="324pt,12.2pt" to="351pt,12.2pt">
 <v:stroke endarrow="block"/>
 <w:wrap anchorx="page"/>
</v:line><v:shape id="_x0000_s1325" type="#_x0000_t202" style='position:absolute;
 left:0;text-align:left;margin-left:63pt;margin-top:30.2pt;width:45pt;height:27pt;
 z-index:182' filled="f" stroked="f">
 <v:textbox style='mso-next-textbox:#_x0000_s1325'>
  <![if !mso]>
  <table cellpadding=0 cellspacing=0 width="100%">
   <tr>
    <td><![endif]>
    <div>
    <p class=MsoNormal>ebp</p>
    </div>
    <![if !mso]></td>
   </tr>
  </table>
  <![endif]></v:textbox>
 <w:wrap anchorx="page"/>
</v:shape><v:shape id="_x0000_s1326" type="#_x0000_t202" style='position:absolute;
 left:0;text-align:left;margin-left:36pt;margin-top:3.2pt;width:90pt;height:27pt;
 z-index:183' filled="f" stroked="f">
 <v:textbox style='mso-next-textbox:#_x0000_s1326'>
  <![if !mso]>
  <table cellpadding=0 cellspacing=0 width="100%">
   <tr>
    <td><![endif]>
    <div>
    <p class=MsoNormal><span style='font-size:13.0pt;mso-bidi-font-size:12.0pt'>eip
    :<span style="mso-spacerun: yes">  </span>x=4</span><span style='font-size:
    10.0pt;mso-bidi-font-size:12.0pt'><o:p></o:p></span></p>
    </div>
    <![if !mso]></td>
   </tr>
  </table>
  <![endif]></v:textbox>
 <w:wrap anchorx="page"/>
</v:shape><v:shape id="_x0000_s1327" type="#_x0000_t202" style='position:absolute;
 left:0;text-align:left;margin-left:243pt;margin-top:3.2pt;width:1in;height:36pt;
 z-index:184' filled="f" stroked="f">
 <v:textbox style='mso-next-textbox:#_x0000_s1327'>
  <![if !mso]>
  <table cellpadding=0 cellspacing=0 width="100%">
   <tr>
    <td><![endif]>
    <div>
    <p class=MsoNormal><span style='font-size:11.0pt;mso-bidi-font-size:12.0pt'>*p=*p+7<o:p></o:p></span></p>
    <p class=MsoNormal><span style='font-size:11.0pt;mso-bidi-font-size:12.0pt'>eip:
    printf<o:p></o:p></span></p>
    </div>
    <![if !mso]></td>
   </tr>
  </table>
  <![endif]></v:textbox>
 <w:wrap anchorx="page"/>
</v:shape><v:shape id="_x0000_s1321" type="#_x0000_t202" style='position:absolute;
 left:0;text-align:left;margin-left:243pt;margin-top:156.2pt;width:1in;
 height:36pt;z-index:178' filled="f" stroked="f">
 <v:textbox style='mso-next-textbox:#_x0000_s1321'/>
 <w:wrap anchorx="page"/>
</v:shape><v:shape id="_x0000_s1304" type="#_x0000_t202" style='position:absolute;
 left:0;text-align:left;margin-left:162pt;margin-top:-59.8pt;width:45pt;
 height:18pt;z-index:161'>
 <v:textbox style='mso-next-textbox:#_x0000_s1304'/>
 <w:wrap anchorx="page"/>
</v:shape><![endif]--><![if !vml]><span style='mso-ignore:vglayout;position:
relative;z-index:158'><span style='left:0px;position:absolute;left:30px;
top:-80px;width:440px;height:338px'>

<table cellpadding=0 cellspacing=0 align=left>
 <tr>
  <td width=0 height=0></td>
  <td width=14></td>
  <td width=3></td>
  <td width=25></td>
  <td width=62></td>
  <td width=82></td>
  <td width=63></td>
  <td width=45></td>
  <td width=98></td>
  <td width=48></td>
 </tr>
 <tr>
  <td height=27></td>
  <td colspan=5></td>
  <td width=63 height=27 align=left valign=top bgcolor=white style='border:
  .75pt solid black;vertical-align:top;background:white'><![endif]><![if !mso]><span
  style='position:absolute;left:0pt;z-index:161'>
  <table cellpadding=0 cellspacing=0 width="100%">
   <tr>
    <td><![endif]>
    <div v:shape="_x0000_s1304" style='padding:3.6pt 7.2pt 3.6pt 7.2pt'
    class=shape>
    <p class=MsoNormal>ESP</p>
    </div>
    <![if !mso]></td>
   </tr>
  </table>
  </span><![endif]><![if !mso & !vml]>&nbsp;<![endif]><![if !vml]></td>
 </tr>
 <tr>
  <td height=9></td>
 </tr>
 <tr>
  <td height=83></td>
  <td colspan=2></td>
  <td colspan=7 rowspan=3 align=left valign=top><img width=423 height=242
  src="bufferoverfloww_files/image009.gif" v:shapes="_x0000_s1279 _x0000_s1280 _x0000_s1281 _x0000_s1282 _x0000_s1283 _x0000_s1284 _x0000_s1285 _x0000_s1286 _x0000_s1287 _x0000_s1288 _x0000_s1289 _x0000_s1290 _x0000_s1291 _x0000_s1292 _x0000_s1293 _x0000_s1294 _x0000_s1295 _x0000_s1296 _x0000_s1297 _x0000_s1298 _x0000_s1299 _x0000_s1300 _x0000_s1301 _x0000_s1303 _x0000_s1305 _x0000_s1307 _x0000_s1308 _x0000_s1309 _x0000_s1310 _x0000_s1311 _x0000_s1312 _x0000_s1313 _x0000_s1314 _x0000_s1315 _x0000_s1316 _x0000_s1317 _x0000_s1318 _x0000_s1319 _x0000_s1320 _x0000_s1322 _x0000_s1323 _x0000_s1324 _x0000_s1325 _x0000_s1326 _x0000_s1327"></td>
 </tr>
 <tr>
  <td height=135></td>
  <td align=left valign=top><img width=14 height=135
  src="bufferoverfloww_files/image010.gif" v:shapes="_x0000_s1302"></td>
 </tr>
 <tr>
  <td height=24></td>
 </tr>
 <tr>
  <td height=10></td>
 </tr>
 <tr>
  <td height=38></td>
  <td colspan=3></td>
  <td width=62 height=38 align=left valign=top style='vertical-align:top'><![endif]><![if !mso]><span
  style='position:absolute;z-index:163'>
  <table cellpadding=0 cellspacing=0 width="100%">
   <tr>
    <td><![endif]>
    <div v:shape="_x0000_s1306" style='padding:3.6pt 7.2pt 3.6pt 7.2pt'
    class=shape>
    <p class=MsoNormal>p=&amp;a</p>
    </div>
    <![if !mso]></td>
   </tr>
  </table>
  </span><![endif]><![if !mso & !vml]>&nbsp;<![endif]><![if !vml]></td>
  <td colspan=3></td>
  <td rowspan=2 width=98 height=50 align=left valign=top style='vertical-align:
  top'><![endif]><![if !mso]><span style='position:absolute;z-index:178'>
  <table cellpadding=0 cellspacing=0 width="100%">
   <tr>
    <td><![endif]>
    <div v:shape="_x0000_s1321" style='padding:3.6pt 7.2pt 3.6pt 7.2pt'
    class=shape>
    <p class=MsoNormal>p=p+3</p>
    <p class=MsoNormal>*p <b>= *</b>p+7</p>
    <p class=MsoNormal><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>
    </div>
    <![if !mso]></td>
   </tr>
  </table>
  </span><![endif]><![if !mso & !vml]>&nbsp;<![endif]><![if !vml]></td>
 </tr>
 <tr>
  <td height=12></td>
 </tr>
</table>

</span></span><![endif]><span style='font-size:10.0pt;mso-bidi-font-size:12.0pt;
font-family:"Trebuchet MS";color:#000066'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.0pt;
mso-bidi-font-size:12.0pt;font-family:"Trebuchet MS";color:#000066'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.0pt;
mso-bidi-font-size:12.0pt;font-family:"Trebuchet MS";color:#000066'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.0pt;
mso-bidi-font-size:12.0pt;font-family:"Trebuchet MS";color:#000066'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.0pt;
mso-bidi-font-size:12.0pt;font-family:"Trebuchet MS";color:#000066'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.0pt;
mso-bidi-font-size:12.0pt;font-family:"Trebuchet MS";color:#000066'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.0pt;
mso-bidi-font-size:12.0pt;font-family:"Trebuchet MS";color:#000066'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.0pt;
mso-bidi-font-size:12.0pt;font-family:"Trebuchet MS";color:#000066'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.0pt;
mso-bidi-font-size:12.0pt;font-family:"Trebuchet MS";color:#000066'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.0pt;
mso-bidi-font-size:12.0pt;font-family:"Trebuchet MS";color:#000066'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.0pt;
mso-bidi-font-size:12.0pt;font-family:"Trebuchet MS";color:#000066'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.0pt;
mso-bidi-font-size:12.0pt;font-family:"Trebuchet MS";color:#000066'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.0pt;
mso-bidi-font-size:12.0pt;font-family:"Trebuchet MS";color:#000066'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.0pt;
mso-bidi-font-size:12.0pt;font-family:"Trebuchet MS";color:#000066'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.0pt;
mso-bidi-font-size:12.0pt;font-family:"Trebuchet MS";color:#000066'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.0pt;
mso-bidi-font-size:12.0pt;font-family:"Trebuchet MS";color:#000066'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<br style='mso-ignore:vglayout' clear=ALL>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.0pt;
mso-bidi-font-size:12.0pt;font-family:"Trebuchet MS";color:#000066'>Figure 4<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.0pt;
mso-bidi-font-size:12.0pt;font-family:"Trebuchet MS";color:#000066'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.0pt;
mso-bidi-font-size:12.0pt;font-family:"Trebuchet MS";color:#000066'>The above program
maneuvers the code execution by changing the return address. The workings are
explained below<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.0pt;
mso-bidi-font-size:12.0pt;font-family:"Trebuchet MS";color:#000066'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.0pt;
mso-bidi-font-size:12.0pt;font-family:"Trebuchet MS";color:#000066'>No values
are pushed on the stack other than the call to the abc function, which places
the address of the next executable instruction on the stack. As you see, the
instruction simply sets the value of variable x to 4. On printing the value,
the address seen is 0x0012fedc. Besides, the function prolog puts ebp on the
stack at 0x0012fed8. <o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.0pt;
mso-bidi-font-size:12.0pt;font-family:"Trebuchet MS";color:#000066'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.0pt;
mso-bidi-font-size:12.0pt;font-family:"Trebuchet MS";color:#000066'>Now within the
abc function, local variable a is created at 0x0012FED0 and p at 0x0012fed4.
Also, the pointer p is set to the address of a i.e. 0x0012FED0. An increase of
3 or 12 bytes sets the variable p to 0x0012fedc. However, this location is the
address of the next executable instruction, which sets the variable x to 4 and
it is 5 bytes after the ‘call’ instruction. <o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.0pt;
mso-bidi-font-size:12.0pt;font-family:"Trebuchet MS";color:#000066'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.0pt;
mso-bidi-font-size:12.0pt;font-family:"Trebuchet MS";color:#000066'>A mov
instruction takes up 7 bytes and a little later, we will display its relevance.
As of now, we set the return address on the stack to a value 7 larger than what
it is. This, in effect, bypasses the code statement x = 4, as a result of which
the program on execution ignores this line completely. The line x = 4 does not
get called and hence x retains the value of 11. <o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.0pt;
mso-bidi-font-size:12.0pt;font-family:"Trebuchet MS";color:#000066'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.0pt;
mso-bidi-font-size:12.0pt;font-family:"Trebuchet MS";color:#000066'>Thus, by
changing the return address on the stack, we can manipulate the next
instruction to be called. This theory is particularly emphasized in the buffer
overflow exploit.<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.0pt;
mso-bidi-font-size:12.0pt;font-family:"Trebuchet MS";color:#000066'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><u><span style='font-size:10.0pt;
mso-bidi-font-size:12.0pt;font-family:"Trebuchet MS";color:#000066'>A22.c<o:p></o:p></span></u></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.0pt;
mso-bidi-font-size:12.0pt;font-family:"Trebuchet MS";color:#000066'>char
buf[20];<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.0pt;
mso-bidi-font-size:12.0pt;font-family:"Trebuchet MS";color:#000066'>main()<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.0pt;
mso-bidi-font-size:12.0pt;font-family:"Trebuchet MS";color:#000066'>{<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.0pt;
mso-bidi-font-size:12.0pt;font-family:"Trebuchet MS";color:#000066'>int *p;<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.0pt;
mso-bidi-font-size:12.0pt;font-family:"Trebuchet MS";color:#000066'>buf[0] =
0xcc;<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.0pt;
mso-bidi-font-size:12.0pt;font-family:"Trebuchet MS";color:#000066'>printf(&quot;p=%p
buf=%p\n&quot;,</span><span style='font-size:10.0pt;mso-bidi-font-size:12.0pt;
font-family:Tahoma;mso-bidi-font-family:"Times New Roman";color:#000066'>&amp;</span><span
style='font-size:10.0pt;mso-bidi-font-size:12.0pt;font-family:"Trebuchet MS";
color:#000066'>p,</span><span style='font-size:10.0pt;mso-bidi-font-size:12.0pt;
font-family:Tahoma;mso-bidi-font-family:"Times New Roman";color:#000066'>&amp;</span><span
style='font-size:10.0pt;mso-bidi-font-size:12.0pt;font-family:"Trebuchet MS";
color:#000066'>buf);<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.0pt;
mso-bidi-font-size:12.0pt;font-family:"Trebuchet MS";color:#000066'>p = </span><span
style='font-size:10.0pt;mso-bidi-font-size:12.0pt;font-family:Tahoma;
mso-bidi-font-family:"Times New Roman";color:#000066'>&amp;</span><span
style='font-size:10.0pt;mso-bidi-font-size:12.0pt;font-family:"Trebuchet MS";
color:#000066'>p;<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.0pt;
mso-bidi-font-size:12.0pt;font-family:"Trebuchet MS";color:#000066'>p = p + 2;<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.0pt;
mso-bidi-font-size:12.0pt;font-family:"Trebuchet MS";color:#000066'>*p = </span><span
style='font-size:10.0pt;mso-bidi-font-size:12.0pt;font-family:Tahoma;
mso-bidi-font-family:"Times New Roman";color:#000066'>&amp;</span><span
style='font-size:10.0pt;mso-bidi-font-size:12.0pt;font-family:"Trebuchet MS";
color:#000066'>buf;<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.0pt;
mso-bidi-font-size:12.0pt;font-family:"Trebuchet MS";color:#000066'>}<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.0pt;
mso-bidi-font-size:12.0pt;font-family:"Trebuchet MS";color:#000066'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.0pt;
mso-bidi-font-size:12.0pt;font-family:"Trebuchet MS";color:#000066'>The pointer
p is created on the stack and under normal circumstances, two words above would
be stored the return address of the caller to the main function. This address
can be rewritten on incrementing pointer p by 2 or 8 bytes. At this position is
the address of the array buf instead. As a result, when main completes its
routine, the ret instruction will place the address of buf into eip. <o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.0pt;
mso-bidi-font-size:12.0pt;font-family:"Trebuchet MS";color:#000066'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=MsoBodyText2>So the code encapsulated in buf will be activated. The
assembly instruction given here starts is CC, which denotes the breakpoint
interrupt. For that reason, a MessageBox will show up with the options of
cancel or ok. Clicking on the cancel button moves into the debugger mode, which
is what we will study next.</p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.0pt;
mso-bidi-font-size:12.0pt;font-family:"Trebuchet MS";color:#000066'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=MsoNormal><u><span style='color:#000066'>Using a Debugger<o:p></o:p></span></u></p>

<p class=MsoNormal style='text-align:justify'><u><span style='font-size:10.0pt;
mso-bidi-font-size:12.0pt;font-family:"Trebuchet MS";color:#000066'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></u></p>

<p class=MsoNormal style='text-align:justify'><u><span style='font-size:10.0pt;
mso-bidi-font-size:12.0pt;font-family:"Trebuchet MS";color:#000066'>A23.c<o:p></o:p></span></u></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.0pt;
mso-bidi-font-size:12.0pt;font-family:"Trebuchet MS";color:#000066'>main()<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.0pt;
mso-bidi-font-size:12.0pt;font-family:"Trebuchet MS";color:#000066'>{<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.0pt;
mso-bidi-font-size:12.0pt;font-family:"Trebuchet MS";color:#000066'>__asm<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.0pt;
mso-bidi-font-size:12.0pt;font-family:"Trebuchet MS";color:#000066'>{<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.0pt;
mso-bidi-font-size:12.0pt;font-family:"Trebuchet MS";color:#000066'>int 3<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.0pt;
mso-bidi-font-size:12.0pt;font-family:"Trebuchet MS";color:#000066'>}<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.0pt;
mso-bidi-font-size:12.0pt;font-family:"Trebuchet MS";color:#000066'>abc(3,4);<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.0pt;
mso-bidi-font-size:12.0pt;font-family:"Trebuchet MS";color:#000066'>}<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.0pt;
mso-bidi-font-size:12.0pt;font-family:"Trebuchet MS";color:#000066'>int abc(int
i , int j)<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.0pt;
mso-bidi-font-size:12.0pt;font-family:"Trebuchet MS";color:#000066'>{<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.0pt;
mso-bidi-font-size:12.0pt;font-family:"Trebuchet MS";color:#000066'>pqr();<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.0pt;
mso-bidi-font-size:12.0pt;font-family:"Trebuchet MS";color:#000066'>return 5;<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.0pt;
mso-bidi-font-size:12.0pt;font-family:"Trebuchet MS";color:#000066'>}<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.0pt;
mso-bidi-font-size:12.0pt;font-family:"Trebuchet MS";color:#000066'>int pqr()<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.0pt;
mso-bidi-font-size:12.0pt;font-family:"Trebuchet MS";color:#000066'>{<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.0pt;
mso-bidi-font-size:12.0pt;font-family:"Trebuchet MS";color:#000066'>}<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.0pt;
mso-bidi-font-size:12.0pt;font-family:"Trebuchet MS";color:#000066'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.0pt;
mso-bidi-font-size:12.0pt;font-family:"Trebuchet MS";color:#000066'>This
program is given to understand the workings of a debugger with the framework of
Visual C++ 7.0 as it is the easiest debugger we have come across. <o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.0pt;
mso-bidi-font-size:12.0pt;font-family:"Trebuchet MS";color:#000066'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.0pt;
mso-bidi-font-size:12.0pt;font-family:"Trebuchet MS";color:#000066'>The program
starts with the execution of the instruction int 3 which calls interrupt 3.
This in turn prompts the operating system to display a MessageBox stating that
a breakpoint exception had been reached as seen in figure 8. <o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><!--[if gte vml 1]><o:wrapblock><v:shapetype
  id="_x0000_t75" coordsize="21600,21600" o:spt="75" o:preferrelative="t"
  path="m@4@5l@4@11@9@11@9@5xe" filled="f" stroked="f">
  <v:stroke joinstyle="miter"/>
  <v:formulas>
   <v:f eqn="if lineDrawn pixelLineWidth 0"/>
   <v:f eqn="sum @0 1 0"/>
   <v:f eqn="sum 0 0 @1"/>
   <v:f eqn="prod @2 1 2"/>
   <v:f eqn="prod @3 21600 pixelWidth"/>
   <v:f eqn="prod @3 21600 pixelHeight"/>
   <v:f eqn="sum @0 0 1"/>
   <v:f eqn="prod @6 1 2"/>
   <v:f eqn="prod @7 21600 pixelWidth"/>
   <v:f eqn="sum @8 21600 0"/>
   <v:f eqn="prod @7 21600 pixelHeight"/>
   <v:f eqn="sum @10 21600 0"/>
  </v:formulas>
  <v:path o:extrusionok="f" gradientshapeok="t" o:connecttype="rect"/>
  <o:lock v:ext="edit" aspectratio="t"/>
 </v:shapetype><v:shape id="_x0000_s1328" type="#_x0000_t75" style='position:absolute;
  left:0;text-align:left;margin-left:0;margin-top:0;width:6in;height:324pt;
  z-index:185'>
  <v:imagedata src="./bufferoverfloww_files/image011.png" o:title=""/>
  <w:wrap type="topAndBottom" anchorx="page"/>
 </v:shape><![endif]--><![if !vml]><img width=576 height=432
 src="bufferoverfloww_files/image012.jpg" v:shapes="_x0000_s1328"><![endif]><!--[if gte vml 1]></o:wrapblock><![endif]--><br
style='mso-ignore:vglayout' clear=ALL>
<span style='font-size:10.0pt;mso-bidi-font-size:12.0pt;font-family:"Trebuchet MS";
color:#000066'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<br style='mso-ignore:vglayout' clear=ALL>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.0pt;
mso-bidi-font-size:12.0pt;font-family:"Trebuchet MS";color:#000066'>Figure 8<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.0pt;
mso-bidi-font-size:12.0pt;font-family:"Trebuchet MS";color:#000066'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.0pt;
mso-bidi-font-size:12.0pt;font-family:"Trebuchet MS";color:#000066'>Clicking on
the Cancel button switches on to the debugger mode whereas Clicking on the OK
button quits out of the program. Here we click on the yes button and the screen
that comes about is shown in figure 9. It is that of Visual C++ debugger. Your
mileage will vary. <o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.0pt;
mso-bidi-font-size:12.0pt;font-family:"Trebuchet MS";color:#000066'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.0pt;
mso-bidi-font-size:12.0pt;font-family:"Trebuchet MS";color:#000066'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><!--[if gte vml 1]><o:wrapblock><v:shape
  id="_x0000_s1329" type="#_x0000_t75" style='position:absolute;left:0;
  text-align:left;margin-left:0;margin-top:0;width:6in;height:324pt;z-index:186'>
  <v:imagedata src="./bufferoverfloww_files/image013.png" o:title=""/>
  <w:wrap type="topAndBottom" anchorx="page"/>
 </v:shape><![endif]--><![if !vml]><img width=576 height=432
 src="bufferoverfloww_files/image014.jpg" v:shapes="_x0000_s1329"><![endif]><!--[if gte vml 1]></o:wrapblock><![endif]--><br
style='mso-ignore:vglayout' clear=ALL>
<span style='font-size:10.0pt;mso-bidi-font-size:12.0pt;font-family:"Trebuchet MS";
color:#000066'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<br style='mso-ignore:vglayout' clear=ALL>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.0pt;
mso-bidi-font-size:12.0pt;font-family:"Trebuchet MS";color:#000066'>Figure 9<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.0pt;
mso-bidi-font-size:12.0pt;font-family:"Trebuchet MS";color:#000066'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><!--[if gte vml 1]><o:wrapblock><v:shape
  id="_x0000_s1330" type="#_x0000_t75" style='position:absolute;left:0;
  text-align:left;margin-left:0;margin-top:0;width:6in;height:324pt;z-index:187'>
  <v:imagedata src="./bufferoverfloww_files/image015.png" o:title=""/>
  <w:wrap type="topAndBottom" anchorx="page"/>
 </v:shape><![endif]--><![if !vml]><img width=576 height=432
 src="bufferoverfloww_files/image016.jpg" v:shapes="_x0000_s1330"><![endif]><!--[if gte vml 1]></o:wrapblock><![endif]--><br
style='mso-ignore:vglayout' clear=ALL>
<span style='font-size:10.0pt;mso-bidi-font-size:12.0pt;font-family:"Trebuchet MS";
color:#000066'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<br style='mso-ignore:vglayout' clear=ALL>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.0pt;
mso-bidi-font-size:12.0pt;font-family:"Trebuchet MS";color:#000066'>Figure 10<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.0pt;
mso-bidi-font-size:12.0pt;font-family:"Trebuchet MS";color:#000066'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.0pt;
mso-bidi-font-size:12.0pt;font-family:"Trebuchet MS";color:#000066'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><!--[if gte vml 1]><o:wrapblock><v:shape
  id="_x0000_s1331" type="#_x0000_t75" style='position:absolute;left:0;
  text-align:left;margin-left:0;margin-top:0;width:6in;height:324pt;z-index:188'>
  <v:imagedata src="./bufferoverfloww_files/image017.png" o:title=""/>
  <w:wrap type="topAndBottom" anchorx="page"/>
 </v:shape><![endif]--><![if !vml]><img width=576 height=432
 src="bufferoverfloww_files/image018.jpg" v:shapes="_x0000_s1331"><![endif]><!--[if gte vml 1]></o:wrapblock><![endif]--><br
style='mso-ignore:vglayout' clear=ALL>
<span style='font-size:10.0pt;mso-bidi-font-size:12.0pt;font-family:"Trebuchet MS";
color:#000066'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<br style='mso-ignore:vglayout' clear=ALL>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.0pt;
mso-bidi-font-size:12.0pt;font-family:"Trebuchet MS";color:#000066'>Figure 11<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.0pt;
mso-bidi-font-size:12.0pt;font-family:"Trebuchet MS";color:#000066'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.0pt;
mso-bidi-font-size:12.0pt;font-family:"Trebuchet MS";color:#000066'>On our
screen, there are three windows namely Memory 1, Register and Disassembly. Now
close all the other windows leaving the above three windows displayed. You can
arrive at the same by clicking on the Debug menu, then windows and thereafter
selecting the above options. The Memory windows seen at the very end in the
Windows option display the contents of any memory location. We will use this
window to see the contents of the stack memory. The stack is nothing but an
area of memory used for a special purpose. <o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.0pt;
mso-bidi-font-size:12.0pt;font-family:"Trebuchet MS";color:#000066'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.0pt;
mso-bidi-font-size:12.0pt;font-family:"Trebuchet MS";color:#000066'>The last
window is the register window that displays the contents of each and every
register. <o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.0pt;
mso-bidi-font-size:12.0pt;font-family:"Trebuchet MS";color:#000066'>The good
part of this window is that every register that is changed by an instruction is
reflected in red, thus there is no need of a magnifying glass. <o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.0pt;
mso-bidi-font-size:12.0pt;font-family:"Trebuchet MS";color:#000066'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.0pt;
mso-bidi-font-size:12.0pt;font-family:"Trebuchet MS";color:#000066'>Finally,
the window in between is the one that is called Disassembly. This window
displays the actual assembly code that is generated and executed along with the
memory locations the code resides in. right click in the disassembly window and
select the option of ‘Show code bytes’<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.0pt;
mso-bidi-font-size:12.0pt;font-family:"Trebuchet MS";color:#000066'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.0pt;
mso-bidi-font-size:12.0pt;font-family:"Trebuchet MS";color:#000066'>The above
program boils down to the following bytes.<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.0pt;
mso-bidi-font-size:12.0pt;font-family:"Trebuchet MS";color:#000066'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.0pt;
mso-bidi-font-size:12.0pt;font-family:"Trebuchet MS";color:#000066'><span
style="mso-spacerun: yes">  </span>00401000: 55<span style="mso-spacerun:
yes">                     </span>push<span style="mso-spacerun: yes">       
</span>ebp<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.0pt;
mso-bidi-font-size:12.0pt;font-family:"Trebuchet MS";color:#000066'><span
style="mso-spacerun: yes">  </span>00401001: 8B EC<span style="mso-spacerun:
yes">                 </span>mov<span style="mso-spacerun: yes">        
</span>ebp,esp<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.0pt;
mso-bidi-font-size:12.0pt;font-family:"Trebuchet MS";color:#000066'><span
style="mso-spacerun: yes">  </span>00401003: CC<span style="mso-spacerun:
yes">                     </span>int<span style="mso-spacerun: yes">        
</span>3<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.0pt;
mso-bidi-font-size:12.0pt;font-family:"Trebuchet MS";color:#000066'><span
style="mso-spacerun: yes">  </span>00401004: 6A 04<span style="mso-spacerun:
yes">                 </span>push<span style="mso-spacerun: yes">       
</span>4<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.0pt;
mso-bidi-font-size:12.0pt;font-family:"Trebuchet MS";color:#000066'><span
style="mso-spacerun: yes">  </span>00401006: 6A 03<span style="mso-spacerun:
yes">                 </span>push<span style="mso-spacerun: yes">       
</span>3<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.0pt;
mso-bidi-font-size:12.0pt;font-family:"Trebuchet MS";color:#000066'><span
style="mso-spacerun: yes">  </span>00401008: E8 04 00 00 00<span
style="mso-spacerun: yes">    </span>call<span style="mso-spacerun:
yes">        </span>00401011<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.0pt;
mso-bidi-font-size:12.0pt;font-family:"Trebuchet MS";color:#000066'><span
style="mso-spacerun: yes">  </span>0040100D: 59<span style="mso-spacerun:
yes">                      </span>pop<span style="mso-spacerun: yes">        
</span>ecx<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.0pt;
mso-bidi-font-size:12.0pt;font-family:"Trebuchet MS";color:#000066'><span
style="mso-spacerun: yes">  </span>0040100E: 59<span style="mso-spacerun:
yes">                      </span>pop<span style="mso-spacerun: yes">        
</span>ecx<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.0pt;
mso-bidi-font-size:12.0pt;font-family:"Trebuchet MS";color:#000066'><span
style="mso-spacerun: yes">  </span>0040100F: 5D<span style="mso-spacerun:
yes">    </span><span style="mso-spacerun:
yes">                  </span>pop<span style="mso-spacerun: yes">        
</span>ebp<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.0pt;
mso-bidi-font-size:12.0pt;font-family:"Trebuchet MS";color:#000066'><span
style="mso-spacerun: yes">  </span>00401010: C3<span style="mso-spacerun:
yes">                      </span>ret<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.0pt;
mso-bidi-font-size:12.0pt;font-family:"Trebuchet MS";color:#000066'><span
style="mso-spacerun: yes">  </span>00401011: 55<span style="mso-spacerun:
yes">                      </span>push<span style="mso-spacerun: yes">       
</span>ebp<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.0pt;
mso-bidi-font-size:12.0pt;font-family:"Trebuchet MS";color:#000066'><span
style="mso-spacerun: yes">  </span>00401012: 8B EC<span style="mso-spacerun:
yes">                 </span>mov<span style="mso-spacerun: yes">        
</span>ebp,esp<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.0pt;
mso-bidi-font-size:12.0pt;font-family:"Trebuchet MS";color:#000066'><span
style="mso-spacerun: yes">  </span>00401014: E8 05 00 00 00<span
style="mso-spacerun: yes">    </span>call<span style="mso-spacerun:
yes">        </span>0040101E<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.0pt;
mso-bidi-font-size:12.0pt;font-family:"Trebuchet MS";color:#000066'><span
style="mso-spacerun: yes">  </span>00401019: 6A 05<span style="mso-spacerun:
yes">        </span><span style="mso-spacerun: yes">         </span>push<span
style="mso-spacerun: yes">        </span>5<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.0pt;
mso-bidi-font-size:12.0pt;font-family:"Trebuchet MS";color:#000066'><span
style="mso-spacerun: yes">  </span>0040101B: 58<span style="mso-spacerun:
yes">                     </span>pop<span style="mso-spacerun: yes">        
</span>eax<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.0pt;
mso-bidi-font-size:12.0pt;font-family:"Trebuchet MS";color:#000066'><span
style="mso-spacerun: yes">  </span>0040101C: 5D<span style="mso-spacerun:
yes">                     </span>pop<span style="mso-spacerun: yes">        
</span>ebp<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.0pt;
mso-bidi-font-size:12.0pt;font-family:"Trebuchet MS";color:#000066'><span
style="mso-spacerun: yes">  </span>0040101D: C3<span style="mso-spacerun:
yes">                     </span>ret<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.0pt;
mso-bidi-font-size:12.0pt;font-family:"Trebuchet MS";color:#000066'><span
style="mso-spacerun: yes">  </span>0040101E: 55<span style="mso-spacerun:
yes">                     </span>push<span style="mso-spacerun: yes">       
</span>ebp<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.0pt;
mso-bidi-font-size:12.0pt;font-family:"Trebuchet MS";color:#000066'><span
style="mso-spacerun: yes">  </span>0040101F: 8B EC<span style="mso-spacerun:
yes">                </span>mov<span style="mso-spacerun: yes">     </span><span
style="mso-spacerun: yes">    </span>ebp,esp<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.0pt;
mso-bidi-font-size:12.0pt;font-family:"Trebuchet MS";color:#000066'><span
style="mso-spacerun: yes">  </span>00401021: 5D<span style="mso-spacerun:
yes">                    </span>pop<span style="mso-spacerun: yes">        
</span>ebp<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.0pt;
mso-bidi-font-size:12.0pt;font-family:"Trebuchet MS";color:#000066'><span
style="mso-spacerun: yes">  </span>00401022: C3<span style="mso-spacerun:
yes">                    </span>ret<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.0pt;
mso-bidi-font-size:12.0pt;font-family:"Trebuchet MS";color:#000066'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.0pt;
mso-bidi-font-size:12.0pt;font-family:"Trebuchet MS";color:#000066'>The
instruction at memory 00401003 is the int 3 instruction, which switches the
program execution into the debug mode. The machine language equivalent op code
for the int 3 instruction is CC. Note that the registers window shows eip
having the address of 401003 at the int 3 instruction. <o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.0pt;
mso-bidi-font-size:12.0pt;font-family:"Trebuchet MS";color:#000066'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.0pt;
mso-bidi-font-size:12.0pt;font-family:"Trebuchet MS";color:#000066'>After this
breakpoint is the call to function abc which takes two parameters, 3 and 4. As
a result, these two values are pushed on the stack, first the value of 4 is
pushed and then 3. <o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.0pt;
mso-bidi-font-size:12.0pt;font-family:"Trebuchet MS";color:#000066'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.0pt;
mso-bidi-font-size:12.0pt;font-family:"Trebuchet MS";color:#000066'>The
function key F11 on the keyboard executes a line of code at a time or single
steps the program. On pressing the F11 key, the eip register shows a change, it
now has the value of 00410004 thus indicating that the next instruction to be
executed will be the push 4. It will take a while, but very soon you will
remember that 6a is the op code for a push instruction which is always followed
by the value to be pushed on the stack. <o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.0pt;
mso-bidi-font-size:12.0pt;font-family:"Trebuchet MS";color:#000066'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.0pt;
mso-bidi-font-size:12.0pt;font-family:"Trebuchet MS";color:#000066'>Before we press
F11 to single step and execute this instruction, lets look at the next task
that will be performed. <o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.0pt;
mso-bidi-font-size:12.0pt;font-family:"Trebuchet MS";color:#000066'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.0pt;
mso-bidi-font-size:12.0pt;font-family:"Trebuchet MS";color:#000066'>The value
of the esp register or the stack pointer is initially at 0x0012fee4. As per our
knowledge, this will reduce by 4 and become 12fee0. Write the words esp in the
memory window so that we explicitly see the stack position and the bytes
contained therein. Also, the number 4 will be on the stack. <o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.0pt;
mso-bidi-font-size:12.0pt;font-family:"Trebuchet MS";color:#000066'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.0pt;
mso-bidi-font-size:12.0pt;font-family:"Trebuchet MS";color:#000066'>On pressing
F11, three things happen. Register eip becomes 401006 thus indicating that the
push 3 will be called next. Register esp becomes 12fee0, 4 less as the stack
moves down and at 12fee0 the values 4 0 0 0 is sited. The stack window must be
scrolled up to see the values. <o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.0pt;
mso-bidi-font-size:12.0pt;font-family:"Trebuchet MS";color:#000066'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.0pt;
mso-bidi-font-size:12.0pt;font-family:"Trebuchet MS";color:#000066'>Press F11
again and the eip register increases by 2 to 401008. The stack reduces by 4 to
12FEDC and the values 3 0 0 0 are placed at stack location 12fedc. <o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.0pt;
mso-bidi-font-size:12.0pt;font-family:"Trebuchet MS";color:#000066'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.0pt;
mso-bidi-font-size:12.0pt;font-family:"Trebuchet MS";color:#000066'>The call
instruction is the next to be called as the eip now has the value of 401008.
Bear in mind that the call op code is E8 followed by the address of the next
instruction to go to.<span style="mso-spacerun: yes">  </span>At this point,
the call is relative as the value of 8 specifies 8 bytes from the current
address. The call instruction located at 401008 itself takes up 5 bytes, hence
the code beginning at 40100d will be called. The gap between them is 13 bytes,
8 bytes specified by the call offset and 5 taken up by the call. <o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.0pt;
mso-bidi-font-size:12.0pt;font-family:"Trebuchet MS";color:#000066'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.0pt;
mso-bidi-font-size:12.0pt;font-family:"Trebuchet MS";color:#000066'>The call
instruction also decreases esp by 4 from 12FEDc to 12fed8. Further on, it
places the value 40100d on the stack at position 12fed8. The value found at
this position is 0d 10 40 00 (behavior of a little endian machine) as the lower
bytes are stored first. <o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.0pt;
mso-bidi-font-size:12.0pt;font-family:"Trebuchet MS";color:#000066'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.0pt;
mso-bidi-font-size:12.0pt;font-family:"Trebuchet MS";color:#000066'>The eip
register holds a value of 401011 as the prolog of the function abc is now being
executed. Note that the register ebp has a value of 12fee4, therefore the push
ebp instruction will push this value on the stack apart from reducing the stack
position value by 4 to 12fed4. Pressing F11 gives the stack a new value of
12fed4 and the stack memory contains e4 fe 12 00. <o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.0pt;
mso-bidi-font-size:12.0pt;font-family:"Trebuchet MS";color:#000066'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.0pt;
mso-bidi-font-size:12.0pt;font-family:"Trebuchet MS";color:#000066'>The
following instruction moves the value of esp into ebp, resulting into giving
ebp a value 12fed4. <o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.0pt;
mso-bidi-font-size:12.0pt;font-family:"Trebuchet MS";color:#000066'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.0pt;
mso-bidi-font-size:12.0pt;font-family:"Trebuchet MS";color:#000066'>The pqr
function called from abc lies 8+5 bytes away from the call instruction. Thus,
the call instruction will reduce the stack by 4 to 12fed0 and place the address
401019 on the stack. This is placed as 19 10 40 00. Function pqr again starts
with the instruction of push ebp on the stack and then replaces its value with
esp.<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.0pt;
mso-bidi-font-size:12.0pt;font-family:"Trebuchet MS";color:#000066'><span
style="mso-spacerun: yes"> </span><o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.0pt;
mso-bidi-font-size:12.0pt;font-family:"Trebuchet MS";color:#000066'>The pop ebp
is part of the function epilogue. This instruction is required to pop the value
of the stack as the value of ebp has been changed in the function routine. The
stack now at 12fed0 will facilitate two things on popping the value. The stack
will be restored to 12fed4 and the ebp register will now contain 12fed4. The
bytes at the current stack position are 19 10 40 00. <o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.0pt;
mso-bidi-font-size:12.0pt;font-family:"Trebuchet MS";color:#000066'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.0pt;
mso-bidi-font-size:12.0pt;font-family:"Trebuchet MS";color:#000066'>The ret
instruction moves the stack up by 4 to 12fed0 and the eip register will contain
0040101B. Also the control comes back to function abc. Thereafter, the return 5
simply moves the value to eax register and the pop ebp restores the value of
ebp register. The stack at 12fed8 now contains the address to jump back to main
0d 10 40 00. <o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.0pt;
mso-bidi-font-size:12.0pt;font-family:"Trebuchet MS";color:#000066'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.0pt;
mso-bidi-font-size:12.0pt;font-family:"Trebuchet MS";color:#000066'>Pressing
F11 then returns control back to function main and 8 added to the stack move it
back to its original position before the function call, 12FED8. The stack on
ret becomes 12fedc.<span style="mso-spacerun: yes">  </span><o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.0pt;
mso-bidi-font-size:12.0pt;font-family:"Trebuchet MS";color:#000066'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.0pt;
mso-bidi-font-size:12.0pt;font-family:"Trebuchet MS";color:#000066'>The 4 pops
are visible as the compiler had generated code to save the 4 registers on the
stack and finally the ret instruction will call the code that called main.
Whew.<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.0pt;
mso-bidi-font-size:12.0pt;font-family:"Trebuchet MS";color:#000066'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=MsoNormal><span style='color:#000066'>Buffer Overflow.<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.0pt;
mso-bidi-font-size:12.0pt;font-family:"Trebuchet MS";color:#000066'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><u><span style='font-size:10.0pt;
mso-bidi-font-size:12.0pt;font-family:"Trebuchet MS";color:#000066'>A24.c<o:p></o:p></span></u></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.0pt;
mso-bidi-font-size:12.0pt;font-family:"Trebuchet MS";color:#000066'>main()<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.0pt;
mso-bidi-font-size:12.0pt;font-family:"Trebuchet MS";color:#000066'>{<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.0pt;
mso-bidi-font-size:12.0pt;font-family:"Trebuchet MS";color:#000066'>char a[6];<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.0pt;
mso-bidi-font-size:12.0pt;font-family:"Trebuchet MS";color:#000066'>a[12]='A';<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.0pt;
mso-bidi-font-size:12.0pt;font-family:"Trebuchet MS";color:#000066'>a[13]='B';<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.0pt;
mso-bidi-font-size:12.0pt;font-family:"Trebuchet MS";color:#000066'>a[14]='C';<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.0pt;
mso-bidi-font-size:12.0pt;font-family:"Trebuchet MS";color:#000066'>a[15]='D';<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.0pt;
mso-bidi-font-size:12.0pt;font-family:"Trebuchet MS";color:#000066'>}<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.0pt;
mso-bidi-font-size:12.0pt;font-family:"Trebuchet MS";color:#000066'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.0pt;
mso-bidi-font-size:12.0pt;font-family:"Trebuchet MS";color:#000066'>The array a
is created with a size of 6 on the stack. Though the size is 6, it is allocated
8 bytes. Also, four bytes above this array i.e. a[8] to a[11] is the ebp
register and above these 4 bytes will be the return address. <o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.0pt;
mso-bidi-font-size:12.0pt;font-family:"Trebuchet MS";color:#000066'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.0pt;
mso-bidi-font-size:12.0pt;font-family:"Trebuchet MS";color:#000066'>The program
overwrites the return value with the hex values 0x41 to 0x44. As a result, when
function main returns, it pops the value 0x44434241 into eip and the system
mechanically tries to execute the code present at this location. <o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.0pt;
mso-bidi-font-size:12.0pt;font-family:"Trebuchet MS";color:#000066'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.0pt;
mso-bidi-font-size:12.0pt;font-family:"Trebuchet MS";color:#000066'>There is
obviously no valid code present there and thus an Application error showing bad
memory location is emitted. Windows does not permit anyone to reference memory
that is not assigned to it. <o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.0pt;
mso-bidi-font-size:12.0pt;font-family:"Trebuchet MS";color:#000066'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.0pt;
mso-bidi-font-size:12.0pt;font-family:"Trebuchet MS";color:#000066'>The main objective
of this program is to emphasis the fact that the return address is susceptible
to a hijack.<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.0pt;
mso-bidi-font-size:12.0pt;font-family:"Trebuchet MS";color:#000066'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><u><span style='font-size:10.0pt;
mso-bidi-font-size:12.0pt;font-family:"Trebuchet MS";color:#000066'>A25.c<o:p></o:p></span></u></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.0pt;
mso-bidi-font-size:12.0pt;font-family:"Trebuchet MS";color:#000066'>main()<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.0pt;
mso-bidi-font-size:12.0pt;font-family:"Trebuchet MS";color:#000066'>{<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.0pt;
mso-bidi-font-size:12.0pt;font-family:"Trebuchet MS";color:#000066'>char a[3];<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.0pt;
mso-bidi-font-size:12.0pt;font-family:"Trebuchet MS";color:#000066'>strcpy(a,&quot;AAAAAAAABCDE&quot;);<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.0pt;
mso-bidi-font-size:12.0pt;font-family:"Trebuchet MS";color:#000066'>}<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.0pt;
mso-bidi-font-size:12.0pt;font-family:"Trebuchet MS";color:#000066'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.0pt;
mso-bidi-font-size:12.0pt;font-family:"Trebuchet MS";color:#000066'>There is
not one way to skin a cat. This program takes a different approach to overwrite
the return address. As the array a is the first and only variable, 8 bytes
above it is the return address. The strcpy function does no bounds checking on
the size of the array, thus using this function, the return address is
overwritten with 0x45444342. What follows next is already seen in the previous
program.<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.0pt;
mso-bidi-font-size:12.0pt;font-family:"Trebuchet MS";color:#000066'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><u><span style='font-size:10.0pt;
mso-bidi-font-size:12.0pt;font-family:"Trebuchet MS";color:#000066'>A26.c<o:p></o:p></span></u></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.0pt;
mso-bidi-font-size:12.0pt;font-family:"Trebuchet MS";color:#000066'>#include
&lt;windows.h&gt;<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.0pt;
mso-bidi-font-size:12.0pt;font-family:"Trebuchet MS";color:#000066'>main()<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.0pt;
mso-bidi-font-size:12.0pt;font-family:"Trebuchet MS";color:#000066'>{<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.0pt;
mso-bidi-font-size:12.0pt;font-family:"Trebuchet MS";color:#000066'>unsigned
char *p ;<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.0pt;
mso-bidi-font-size:12.0pt;font-family:"Trebuchet MS";color:#000066'>//p =
LoadLibrary(&quot;kernel32.dll&quot;);<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.0pt;
mso-bidi-font-size:12.0pt;font-family:"Trebuchet MS";color:#000066'>p =
LoadLibrary(&quot;user32.dll&quot;);<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.0pt;
mso-bidi-font-size:12.0pt;font-family:"Trebuchet MS";color:#000066'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.0pt;
mso-bidi-font-size:12.0pt;font-family:"Trebuchet MS";color:#000066'>printf(&quot;Dll
Loaded at %p\n&quot;,p);<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.0pt;
mso-bidi-font-size:12.0pt;font-family:"Trebuchet MS";color:#000066'>while ( 1 )<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.0pt;
mso-bidi-font-size:12.0pt;font-family:"Trebuchet MS";color:#000066'>{<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.0pt;
mso-bidi-font-size:12.0pt;font-family:"Trebuchet MS";color:#000066'>if ( p[0]
== 0xff &amp;&amp; p[1] == 0xe4)<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.0pt;
mso-bidi-font-size:12.0pt;font-family:"Trebuchet MS";color:#000066'>printf(&quot;Found
opcode jmp at %p\n&quot;,p);<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.0pt;
mso-bidi-font-size:12.0pt;font-family:"Trebuchet MS";color:#000066'>if ( p[0]
== 0xff &amp;&amp; p[1] == 0xD4)<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.0pt;
mso-bidi-font-size:12.0pt;font-family:"Trebuchet MS";color:#000066'>printf(&quot;Found
opcode call at %p\n&quot;,p);<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.0pt;
mso-bidi-font-size:12.0pt;font-family:"Trebuchet MS";color:#000066'>p++;<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.0pt;
mso-bidi-font-size:12.0pt;font-family:"Trebuchet MS";color:#000066'>}<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.0pt;
mso-bidi-font-size:12.0pt;font-family:"Trebuchet MS";color:#000066'>}<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.0pt;
mso-bidi-font-size:12.0pt;font-family:"Trebuchet MS";color:#000066'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<h1><span style='color:#000066'>Output<o:p></o:p></span></h1>

<p class=MsoNormal><span style='color:#000066'>Kernel32.dll<o:p></o:p></span></p>

<p class=MsoNormal><span style='color:#000066'>Dll Loaded at 77E80000<o:p></o:p></span></p>

<p class=MsoNormal><span style='color:#000066'>Found opcode call at 77E8250A<o:p></o:p></span></p>

<p class=MsoNormal><span style='color:#000066'>Error box<o:p></o:p></span></p>

<p class=MsoNormal><span style='color:#000066'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.0pt;
mso-bidi-font-size:12.0pt;font-family:"Trebuchet MS";color:#000066'>User32.dll<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.0pt;
mso-bidi-font-size:12.0pt;font-family:"Trebuchet MS";color:#000066'>Dll Loaded
at 77E10000<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.0pt;
mso-bidi-font-size:12.0pt;font-family:"Trebuchet MS";color:#000066'>Found opcode
jmp at 77E2492B<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.0pt;
mso-bidi-font-size:12.0pt;font-family:"Trebuchet MS";color:#000066'>Found
opcode call at 77E27741<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.0pt;
mso-bidi-font-size:12.0pt;font-family:"Trebuchet MS";color:#000066'>Found
opcode jmp at 77E3AF64<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.0pt;
mso-bidi-font-size:12.0pt;font-family:"Trebuchet MS";color:#000066'>Error box<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.0pt;
mso-bidi-font-size:12.0pt;font-family:"Trebuchet MS";color:#000066'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.0pt;
mso-bidi-font-size:12.0pt;font-family:"Trebuchet MS";color:#000066'>The
LoadLibrary function loads the dll in memory. Since this dll is already loaded,
it does not get reloaded but its address in memory is returned. Windows 2000 with
service pack 2 gives a value of 77e10000 whereas for kernel32 it gives an
address of 77e80000. <o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.0pt;
mso-bidi-font-size:12.0pt;font-family:"Trebuchet MS";color:#000066'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.0pt;
mso-bidi-font-size:12.0pt;font-family:"Trebuchet MS";color:#000066'>Once the
dll is present in memory, the program now attempts to locate the bytes ff e4 or
ff d4 in this area. These bytes for the intel assembler represent jump esp and
call esp. Both these instruction run code at the address specified by the esp
register. Thus, code present at the address on the stack is executed. <o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.0pt;
mso-bidi-font-size:12.0pt;font-family:"Trebuchet MS";color:#000066'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.0pt;
mso-bidi-font-size:12.0pt;font-family:"Trebuchet MS";color:#000066'>If you wish
to see the program in its disassembled mode, give the command as <o:p></o:p></span></p>

<p class=MsoNormal><span style='color:#000066'>&gt;cl /FAcs a.c &gt; zz.txt<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.0pt;
mso-bidi-font-size:12.0pt;font-family:"Trebuchet MS";color:#000066'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.0pt;
mso-bidi-font-size:12.0pt;font-family:"Trebuchet MS";color:#000066'>This
program is a further improvement on the above one where the system runs our
code. <o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.0pt;
mso-bidi-font-size:12.0pt;font-family:"Trebuchet MS";color:#000066'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><u><span style='font-size:10.0pt;
mso-bidi-font-size:12.0pt;font-family:"Trebuchet MS";color:#000066'>A27.c<o:p></o:p></span></u></p>

<p class=MsoPlainText style='text-align:justify'><span style='font-family:"Trebuchet MS";
mso-fareast-font-family:"MS Mincho";color:#000066'>#include &lt;stdio.h&gt;<o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span style='font-family:"Trebuchet MS";
mso-fareast-font-family:"MS Mincho";color:#000066'>main()<o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span style='font-family:"Trebuchet MS";
mso-fareast-font-family:"MS Mincho";color:#000066'>{<o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span style='font-family:"Trebuchet MS";
mso-fareast-font-family:"MS Mincho";color:#000066'>FILE *fp;<o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span style='font-family:"Trebuchet MS";
mso-fareast-font-family:"MS Mincho";color:#000066'>fp =
fopen(&quot;q10.txt&quot;,&quot;wb&quot;);<o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span style='font-family:"Trebuchet MS";
mso-fareast-font-family:"MS Mincho";color:#000066'>fputc('A',fp);<o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span style='font-family:"Trebuchet MS";
mso-fareast-font-family:"MS Mincho";color:#000066'>fputc('A',fp);<o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span style='font-family:"Trebuchet MS";
mso-fareast-font-family:"MS Mincho";color:#000066'>fputc('A',fp);<o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span style='font-family:"Trebuchet MS";
mso-fareast-font-family:"MS Mincho";color:#000066'>fputc('A',fp);<o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span style='font-family:"Trebuchet MS";
mso-fareast-font-family:"MS Mincho";color:#000066'>fputc('A',fp);<o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span style='font-family:"Trebuchet MS";
mso-fareast-font-family:"MS Mincho";color:#000066'>fputc('A',fp);<o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span style='font-family:"Trebuchet MS";
mso-fareast-font-family:"MS Mincho";color:#000066'>fputc('A',fp);<o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span style='font-family:"Trebuchet MS";
mso-fareast-font-family:"MS Mincho";color:#000066'>fputc('A',fp);<o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span style='font-family:"Trebuchet MS";
mso-fareast-font-family:"MS Mincho";color:#000066'>fputc(0x0a,fp);<o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span style='font-family:"Trebuchet MS";
mso-fareast-font-family:"MS Mincho";color:#000066'>fputc(0x25,fp);<o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span style='font-family:"Trebuchet MS";
mso-fareast-font-family:"MS Mincho";color:#000066'>fputc(0xe8,fp);<o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span style='font-family:"Trebuchet MS";
mso-fareast-font-family:"MS Mincho";color:#000066'>fputc(0x77,fp);</span><span
style='font-family:"Trebuchet MS";color:#000066'> </span><span
style='font-family:"Trebuchet MS";mso-fareast-font-family:"MS Mincho";
color:#000066'><o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span style='font-family:"Trebuchet MS";
mso-fareast-font-family:"MS Mincho";color:#000066'>fputc(0xcc,fp);<o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span style='font-family:"Trebuchet MS";
mso-fareast-font-family:"MS Mincho";color:#000066'>fclose(fp);<o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span style='font-family:"Trebuchet MS";
mso-fareast-font-family:"MS Mincho";color:#000066'>}<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.0pt;
mso-bidi-font-size:12.0pt;font-family:"Trebuchet MS";color:#000066'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span style='font-family:"Trebuchet MS";
mso-fareast-font-family:"MS Mincho";color:#000066'>A file called q10.txt is
opened in binary mode for writing. The mode is set to binary in order to avoid
any special interpretation of numbers while writing to the file. Using the
function fputc, which takes a character and the file pointer, 8 A’s are written
on to disk. <o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span style='font-family:"Trebuchet MS";
mso-fareast-font-family:"MS Mincho";color:#000066'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span style='font-family:"Trebuchet MS";
mso-fareast-font-family:"MS Mincho";color:#000066'>Once the characters are
written, some hex characters are inserted. If you watch closely, it is the
address found in user32.dll from the earlier program wherein the bytes
represent the jump esp instruction. Since ours is an intel machine, the address
is written with the smallest bytes first. Once done, the op code 0xcc for the
int 3 breakpoint instruction is inserted.<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.0pt;
mso-bidi-font-size:12.0pt;font-family:"Trebuchet MS";color:#000066'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><u><span style='font-size:10.0pt;
mso-bidi-font-size:12.0pt;font-family:"Trebuchet MS";color:#000066'>A28.c<o:p></o:p></span></u></p>

<p class=MsoPlainText style='text-align:justify'><span style='font-family:"Trebuchet MS";
mso-fareast-font-family:"MS Mincho";color:#000066'>#include &lt;stdio.h&gt;<o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span style='font-family:"Trebuchet MS";
mso-fareast-font-family:"MS Mincho";color:#000066'>FILE *fp;<o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span style='font-family:"Trebuchet MS";
mso-fareast-font-family:"MS Mincho";color:#000066'>main()<o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span style='font-family:"Trebuchet MS";
mso-fareast-font-family:"MS Mincho";color:#000066'>{<o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span style='font-family:"Trebuchet MS";
mso-fareast-font-family:"MS Mincho";color:#000066'>char a[4];<o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span style='font-family:"Trebuchet MS";
mso-fareast-font-family:"MS Mincho";color:#000066'>fp =
fopen(&quot;q10.txt&quot;,&quot;rb&quot;);<o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span style='font-family:"Trebuchet MS";
mso-fareast-font-family:"MS Mincho";color:#000066'>fread(a,100,1,fp);<o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span style='font-family:"Trebuchet MS";
mso-fareast-font-family:"MS Mincho";color:#000066'>__asm<o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span style='font-family:"Trebuchet MS";
mso-fareast-font-family:"MS Mincho";color:#000066'>{<o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span style='font-family:"Trebuchet MS";
mso-fareast-font-family:"MS Mincho";color:#000066'>int 3<o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span style='font-family:"Trebuchet MS";
mso-fareast-font-family:"MS Mincho";color:#000066'>}<o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span style='font-family:"Trebuchet MS";
mso-fareast-font-family:"MS Mincho";color:#000066'>}</span><span
style='font-family:"Trebuchet MS";color:#000066'><o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.0pt;
mso-bidi-font-size:12.0pt;font-family:"Trebuchet MS";color:#000066'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.0pt;
mso-bidi-font-size:12.0pt;font-family:"Trebuchet MS";color:#000066'>The above
program is a sequel to the previous one. It opens the file q10.txt and then reads
the next 100 bytes into an array a. However, since the array is only 4 bytes
large only 4 bytes are allocated to the array. Thus the first 4 A’s will be
saved in the allocated array memory and thereafter the saved value of register
ebp gets overwritten by the next 4 A’s. <o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.0pt;
mso-bidi-font-size:12.0pt;font-family:"Trebuchet MS";color:#000066'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.0pt;
mso-bidi-font-size:12.0pt;font-family:"Trebuchet MS";color:#000066'>After the 8
bytes is the address of the call esp op code which will overwrite the saved eip
on the stack. Lastly, the op code CC is put on the stack. The fread function in
one go places all these bytes on the stack without realizing that it is
overwriting the existing instruction<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.0pt;
mso-bidi-font-size:12.0pt;font-family:"Trebuchet MS";color:#000066'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.0pt;
mso-bidi-font-size:12.0pt;font-family:"Trebuchet MS";color:#000066'>As per the
stack, when the main function returns, the value pushed into eip will be that
of kernel32.dll i.e. 77e8250a. Due to this, the system jump to this location to
execute instructions. What it finds here is the op codes ff d4. These op codes
get interpreted as call esp. The stack however is now pointing to op code cc.
Thus, the system jumps back to the stack and executes the break point
interrupt. <o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.0pt;
mso-bidi-font-size:12.0pt;font-family:"Trebuchet MS";color:#000066'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.0pt;
mso-bidi-font-size:12.0pt;font-family:"Trebuchet MS";color:#000066'>We have
deliberately placed the int 3 instruction after the fread function but before
the closing brace. The end-result is that the above program, on executing moves
into the debugging mode. <o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.0pt;
mso-bidi-font-size:12.0pt;font-family:"Trebuchet MS";color:#000066'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.0pt;
mso-bidi-font-size:12.0pt;font-family:"Trebuchet MS";color:#000066'>The
compiler at the start pushes the registers edi, esi and ebx on the stack, thus
they are being popped off. Then the stack is restored back in esp and ebp is
popped off the stack. The contents of the stack at the pop ebp instruction look
like.<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.0pt;
mso-bidi-font-size:12.0pt;font-family:"Trebuchet MS";color:#000066'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.0pt;
mso-bidi-font-size:12.0pt;font-family:"Trebuchet MS";color:#000066'>Before
stack 41 41 41 41<span style="mso-spacerun: yes">  </span><o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.0pt;
mso-bidi-font-size:12.0pt;font-family:"Trebuchet MS";color:#000066'>Stack
Value<span style="mso-spacerun: yes">  </span>41 41 41 41 0A 25 E8 77 CC <o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.0pt;
mso-bidi-font-size:12.0pt;font-family:"Trebuchet MS";color:#000066'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.0pt;
mso-bidi-font-size:12.0pt;font-family:"Trebuchet MS";color:#000066'>The values
41 41 41 41 get placed into ebp and at the ret the stack is pointing to the
address 0a 25 e8 77.<span style="mso-spacerun: yes">  </span><o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.0pt;
mso-bidi-font-size:12.0pt;font-family:"Trebuchet MS";color:#000066'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.0pt;
mso-bidi-font-size:12.0pt;font-family:"Trebuchet MS";color:#000066'>77E8250A FF
D4<span style="mso-spacerun: yes">                </span>call<span
style="mso-spacerun: yes">        </span>esp<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.0pt;
mso-bidi-font-size:12.0pt;font-family:"Trebuchet MS";color:#000066'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><!--[if gte vml 1]><o:wrapblock><v:shape
  id="_x0000_s1332" type="#_x0000_t75" style='position:absolute;left:0;
  text-align:left;margin-left:0;margin-top:0;width:6in;height:324pt;z-index:189'>
  <v:imagedata src="./bufferoverfloww_files/image019.png" o:title=""/>
  <w:wrap type="topAndBottom" anchorx="page"/>
 </v:shape><![endif]--><![if !vml]><img width=576 height=432
 src="bufferoverfloww_files/image020.jpg" v:shapes="_x0000_s1332"><![endif]><!--[if gte vml 1]></o:wrapblock><![endif]--><br
style='mso-ignore:vglayout' clear=ALL>
<span style='font-size:10.0pt;mso-bidi-font-size:12.0pt;font-family:"Trebuchet MS";
color:#000066'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<br style='mso-ignore:vglayout' clear=ALL>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.0pt;
mso-bidi-font-size:12.0pt;font-family:"Trebuchet MS";color:#000066'>On pressing
F10, the code in kernel32.dll gets executed where the call esp instruction is
clearly visible. The stack pointer has a value 0012feec. At this address, the
value present is 0xcc, which is clearly visible in the stack window. Pressing
F10 places this value 0012feec into the eip register and the breakpoint
interrupt gets called. <o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.0pt;
mso-bidi-font-size:12.0pt;font-family:"Trebuchet MS";color:#000066'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.0pt;
mso-bidi-font-size:12.0pt;font-family:"Trebuchet MS";color:#000066'>Let’s
understand the significance of the above code.<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.0pt;
mso-bidi-font-size:12.0pt;font-family:"Trebuchet MS";color:#000066'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.0pt;
mso-bidi-font-size:12.0pt;font-family:"Trebuchet MS";color:#000066'>All programs
read from a file on disk into a buffer in memory. This file redirects the eip
register to hold an address in memory that contains the call esp instruction.
The execution of this code, on the other hand, jumps back to the stack where it
executes code that comes from the disk file. In short, by causing a buffer
overflow, the stack has been manipulated to execute code from a file on disk.
At present, this code is simply an int 3 instruction.<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.0pt;
mso-bidi-font-size:12.0pt;font-family:"Trebuchet MS";color:#000066'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.0pt;
mso-bidi-font-size:12.0pt;font-family:"Trebuchet MS";color:#000066'>d.c<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.0pt;
mso-bidi-font-size:12.0pt;font-family:"Trebuchet MS";color:#000066'>#include
&lt;stdio.h&gt;<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.0pt;
mso-bidi-font-size:12.0pt;font-family:"Trebuchet MS";color:#000066'>main()<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.0pt;
mso-bidi-font-size:12.0pt;font-family:"Trebuchet MS";color:#000066'>{<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.0pt;
mso-bidi-font-size:12.0pt;font-family:"Trebuchet MS";color:#000066'>FILE *fp;<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.0pt;
mso-bidi-font-size:12.0pt;font-family:"Trebuchet MS";color:#000066'>fp =
fopen(&quot;q10.txt&quot;,&quot;wb&quot;);<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.0pt;
mso-bidi-font-size:12.0pt;font-family:"Trebuchet MS";color:#000066'>fputc('A',fp);<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.0pt;
mso-bidi-font-size:12.0pt;font-family:"Trebuchet MS";color:#000066'>fputc('A',fp);<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.0pt;
mso-bidi-font-size:12.0pt;font-family:"Trebuchet MS";color:#000066'>fputc('A',fp);<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.0pt;
mso-bidi-font-size:12.0pt;font-family:"Trebuchet MS";color:#000066'>fputc('A',fp);<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.0pt;
mso-bidi-font-size:12.0pt;font-family:"Trebuchet MS";color:#000066'>fputc('A',fp);<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.0pt;
mso-bidi-font-size:12.0pt;font-family:"Trebuchet MS";color:#000066'>fputc('A',fp);<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.0pt;
mso-bidi-font-size:12.0pt;font-family:"Trebuchet MS";color:#000066'>fputc('A',fp);<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.0pt;
mso-bidi-font-size:12.0pt;font-family:"Trebuchet MS";color:#000066'>fputc('A',fp);<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.0pt;
mso-bidi-font-size:12.0pt;font-family:"Trebuchet MS";color:#000066'>fputc(0x0a,fp);<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.0pt;
mso-bidi-font-size:12.0pt;font-family:"Trebuchet MS";color:#000066'>fputc(0x25,fp);<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.0pt;
mso-bidi-font-size:12.0pt;font-family:"Trebuchet MS";color:#000066'>fputc(0xe8,fp);<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.0pt;
mso-bidi-font-size:12.0pt;font-family:"Trebuchet MS";color:#000066'>fputc(0x77,fp);<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.0pt;
mso-bidi-font-size:12.0pt;font-family:"Trebuchet MS";color:#000066'>fputc(0x55,fp);<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.0pt;
mso-bidi-font-size:12.0pt;font-family:"Trebuchet MS";color:#000066'>fputc(0x8b,fp);<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.0pt;
mso-bidi-font-size:12.0pt;font-family:"Trebuchet MS";color:#000066'>fputc(0xec,fp);<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.0pt;
mso-bidi-font-size:12.0pt;font-family:"Trebuchet MS";color:#000066'>fputc(0x51,fp);<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.0pt;
mso-bidi-font-size:12.0pt;font-family:"Trebuchet MS";color:#000066'>fputc(0xc7,fp);<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.0pt;
mso-bidi-font-size:12.0pt;font-family:"Trebuchet MS";color:#000066'>fputc(0x45,fp);<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.0pt;
mso-bidi-font-size:12.0pt;font-family:"Trebuchet MS";color:#000066'>fputc(0xfc,fp);<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.0pt;
mso-bidi-font-size:12.0pt;font-family:"Trebuchet MS";color:#000066'>fputc(0x63,fp);<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.0pt;
mso-bidi-font-size:12.0pt;font-family:"Trebuchet MS";color:#000066'>fputc(0x6d,fp);<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.0pt;
mso-bidi-font-size:12.0pt;font-family:"Trebuchet MS";color:#000066'>fputc(0x64,fp);<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.0pt;
mso-bidi-font-size:12.0pt;font-family:"Trebuchet MS";color:#000066'>fputc(0x00,fp);<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.0pt;
mso-bidi-font-size:12.0pt;font-family:"Trebuchet MS";color:#000066'>fputc(0x6a,fp);<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.0pt;
mso-bidi-font-size:12.0pt;font-family:"Trebuchet MS";color:#000066'>fputc(0x05,fp);<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.0pt;
mso-bidi-font-size:12.0pt;font-family:"Trebuchet MS";color:#000066'>fputc(0x8b,fp);<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.0pt;
mso-bidi-font-size:12.0pt;font-family:"Trebuchet MS";color:#000066'>fputc(0xc5,fp);<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.0pt;
mso-bidi-font-size:12.0pt;font-family:"Trebuchet MS";color:#000066'>fputc(0x83,fp);<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.0pt;
mso-bidi-font-size:12.0pt;font-family:"Trebuchet MS";color:#000066'>fputc(0xe8,fp);<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.0pt;
mso-bidi-font-size:12.0pt;font-family:"Trebuchet MS";color:#000066'>fputc(0x04,fp);<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.0pt;
mso-bidi-font-size:12.0pt;font-family:"Trebuchet MS";color:#000066'>fputc(0x50,fp);<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.0pt;
mso-bidi-font-size:12.0pt;font-family:"Trebuchet MS";color:#000066'>fputc(0xb8,fp);<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.0pt;
mso-bidi-font-size:12.0pt;font-family:"Trebuchet MS";color:#000066'>fputc(0xAF,fp);<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.0pt;
mso-bidi-font-size:12.0pt;font-family:"Trebuchet MS";color:#000066'>fputc(0xA7,fp);<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.0pt;
mso-bidi-font-size:12.0pt;font-family:"Trebuchet MS";color:#000066'>fputc(0xE9,fp);<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.0pt;
mso-bidi-font-size:12.0pt;font-family:"Trebuchet MS";color:#000066'>fputc(0x77,fp);<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.0pt;
mso-bidi-font-size:12.0pt;font-family:"Trebuchet MS";color:#000066'>fputc(0xff,fp);<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.0pt;
mso-bidi-font-size:12.0pt;font-family:"Trebuchet MS";color:#000066'>fputc(0xd0,fp);<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.0pt;
mso-bidi-font-size:12.0pt;font-family:"Trebuchet MS";color:#000066'>fputc(0x6a,fp);<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.0pt;
mso-bidi-font-size:12.0pt;font-family:"Trebuchet MS";color:#000066'>fputc(0x00,fp);<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.0pt;
mso-bidi-font-size:12.0pt;font-family:"Trebuchet MS";color:#000066'>fputc(0xb8,fp);<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.0pt;
mso-bidi-font-size:12.0pt;font-family:"Trebuchet MS";color:#000066'>fputc(0x94,fp);<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.0pt;
mso-bidi-font-size:12.0pt;font-family:"Trebuchet MS";color:#000066'>fputc(0x8f,fp);<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.0pt;
mso-bidi-font-size:12.0pt;font-family:"Trebuchet MS";color:#000066'>fputc(0xE9,fp);<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.0pt;
mso-bidi-font-size:12.0pt;font-family:"Trebuchet MS";color:#000066'>fputc(0x77,fp);<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.0pt;
mso-bidi-font-size:12.0pt;font-family:"Trebuchet MS";color:#000066'>fputc(0xff,fp);<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.0pt;
mso-bidi-font-size:12.0pt;font-family:"Trebuchet MS";color:#000066'>fputc(0xd0,fp);<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.0pt;
mso-bidi-font-size:12.0pt;font-family:"Trebuchet MS";color:#000066'>fclose(fp);<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.0pt;
mso-bidi-font-size:12.0pt;font-family:"Trebuchet MS";color:#000066'>}<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.0pt;
mso-bidi-font-size:12.0pt;font-family:"Trebuchet MS";color:#000066'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.0pt;
mso-bidi-font-size:12.0pt;font-family:"Trebuchet MS";color:#000066'>d1.c<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.0pt;
mso-bidi-font-size:12.0pt;font-family:"Trebuchet MS";color:#000066'>#include
&lt;windows.h&gt;<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.0pt;
mso-bidi-font-size:12.0pt;font-family:"Trebuchet MS";color:#000066'>#include
&lt;stdio.h&gt;<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.0pt;
mso-bidi-font-size:12.0pt;font-family:"Trebuchet MS";color:#000066'>FILE *fp;<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.0pt;
mso-bidi-font-size:12.0pt;font-family:"Trebuchet MS";color:#000066'>int
_stdcall WinMain(HINSTANCE<span style="mso-spacerun: yes">  </span>i ,
HINSTANCE<span style="mso-spacerun: yes">  </span>j , char *k, int l)<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.0pt;
mso-bidi-font-size:12.0pt;font-family:"Trebuchet MS";color:#000066'>{<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.0pt;
mso-bidi-font-size:12.0pt;font-family:"Trebuchet MS";color:#000066'>abc();<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.0pt;
mso-bidi-font-size:12.0pt;font-family:"Trebuchet MS";color:#000066'>}<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.0pt;
mso-bidi-font-size:12.0pt;font-family:"Trebuchet MS";color:#000066'>int abc()<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.0pt;
mso-bidi-font-size:12.0pt;font-family:"Trebuchet MS";color:#000066'>{<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.0pt;
mso-bidi-font-size:12.0pt;font-family:"Trebuchet MS";color:#000066'>char
a[4];int i1;<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.0pt;
mso-bidi-font-size:12.0pt;font-family:"Trebuchet MS";color:#000066'>fp =
fopen(&quot;q10.txt&quot;,&quot;rb&quot;);<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.0pt;
mso-bidi-font-size:12.0pt;font-family:"Trebuchet MS";color:#000066'>fread(a,100,1,fp);<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.0pt;
mso-bidi-font-size:12.0pt;font-family:"Trebuchet MS";color:#000066'>__asm<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.0pt;
mso-bidi-font-size:12.0pt;font-family:"Trebuchet MS";color:#000066'>{<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.0pt;
mso-bidi-font-size:12.0pt;font-family:"Trebuchet MS";color:#000066'>int 3<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.0pt;
mso-bidi-font-size:12.0pt;font-family:"Trebuchet MS";color:#000066'>}<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.0pt;
mso-bidi-font-size:12.0pt;font-family:"Trebuchet MS";color:#000066'>}<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.0pt;
mso-bidi-font-size:12.0pt;font-family:"Trebuchet MS";color:#000066'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.0pt;
mso-bidi-font-size:12.0pt;font-family:"Trebuchet MS";color:#000066'>d3.c<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.0pt;
mso-bidi-font-size:12.0pt;font-family:"Trebuchet MS";color:#000066'>#include
&lt;windows.h&gt;<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.0pt;
mso-bidi-font-size:12.0pt;font-family:"Trebuchet MS";color:#000066'>main()<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.0pt;
mso-bidi-font-size:12.0pt;font-family:"Trebuchet MS";color:#000066'>{<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.0pt;
mso-bidi-font-size:12.0pt;font-family:"Trebuchet MS";color:#000066'>HANDLE h;<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.0pt;
mso-bidi-font-size:12.0pt;font-family:"Trebuchet MS";color:#000066'>void *p;<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.0pt;
mso-bidi-font-size:12.0pt;font-family:"Trebuchet MS";color:#000066'>h =
LoadLibrary(&quot;kernel32.dll&quot;);<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.0pt;
mso-bidi-font-size:12.0pt;font-family:"Trebuchet MS";color:#000066'>p =
GetProcAddress(h,&quot;WinExec&quot;);<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.0pt;
mso-bidi-font-size:12.0pt;font-family:"Trebuchet MS";color:#000066'>printf(&quot;WinExec
%x\n&quot;,p);<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.0pt;
mso-bidi-font-size:12.0pt;font-family:"Trebuchet MS";color:#000066'>p =
GetProcAddress(h,&quot;ExitProcess&quot;);<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.0pt;
mso-bidi-font-size:12.0pt;font-family:"Trebuchet MS";color:#000066'>printf(&quot;ExitProcess
%x\n&quot;,p);<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.0pt;
mso-bidi-font-size:12.0pt;font-family:"Trebuchet MS";color:#000066'>}<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.0pt;
mso-bidi-font-size:12.0pt;font-family:"Trebuchet MS";color:#000066'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<h1><span style='color:#000066'>Output<o:p></o:p></span></h1>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.0pt;
mso-bidi-font-size:12.0pt;font-family:"Trebuchet MS";color:#000066'>&gt; d3<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.0pt;
mso-bidi-font-size:12.0pt;font-family:"Trebuchet MS";color:#000066'>WinExec
77e9a7af<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.0pt;
mso-bidi-font-size:12.0pt;font-family:"Trebuchet MS";color:#000066'>ExitProcess
77e98f94<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.0pt;
mso-bidi-font-size:12.0pt;font-family:"Trebuchet MS";color:#000066'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.0pt;
mso-bidi-font-size:12.0pt;font-family:"Trebuchet MS";color:#000066'>&gt;cl d.c<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.0pt;
mso-bidi-font-size:12.0pt;font-family:"Trebuchet MS";color:#000066'>&gt;d<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.0pt;
mso-bidi-font-size:12.0pt;font-family:"Trebuchet MS";color:#000066'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.0pt;
mso-bidi-font-size:12.0pt;font-family:"Trebuchet MS";color:#000066'>&gt;cl d1.c
<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.0pt;
mso-bidi-font-size:12.0pt;font-family:"Trebuchet MS";color:#000066'>&gt;d1<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.0pt;
mso-bidi-font-size:12.0pt;font-family:"Trebuchet MS";color:#000066'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.0pt;
mso-bidi-font-size:12.0pt;font-family:"Trebuchet MS";color:#000066'>0012FF34
55<span style="mso-spacerun: yes">                   </span>push<span
style="mso-spacerun: yes">        </span>ebp<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.0pt;
mso-bidi-font-size:12.0pt;font-family:"Trebuchet MS";color:#000066'>0012FF35 8B
EC<span style="mso-spacerun: yes">                </span>mov<span
style="mso-spacerun: yes">         </span>ebp,esp<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.0pt;
mso-bidi-font-size:12.0pt;font-family:"Trebuchet MS";color:#000066'>0012FF37
51<span style="mso-spacerun: yes">                   </span>push<span
style="mso-spacerun: yes">        </span>ecx<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.0pt;
mso-bidi-font-size:12.0pt;font-family:"Trebuchet MS";color:#000066'>0012FF38 C7
45 FC 63 6D 64 00 mov<span style="mso-spacerun: yes">         </span>dword ptr
[ebp-4],646D63h<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.0pt;
mso-bidi-font-size:12.0pt;font-family:"Trebuchet MS";color:#000066'>0012FF3F 6A
05<span style="mso-spacerun: yes">                </span>push<span
style="mso-spacerun: yes">        </span>5<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.0pt;
mso-bidi-font-size:12.0pt;font-family:"Trebuchet MS";color:#000066'>0012FF41 8B
C5<span style="mso-spacerun: yes">                </span>mov<span
style="mso-spacerun: yes">         </span>eax,ebp<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.0pt;
mso-bidi-font-size:12.0pt;font-family:"Trebuchet MS";color:#000066'>0012FF43 83
E8 04<span style="mso-spacerun: yes">             </span>sub<span
style="mso-spacerun: yes">         </span>eax,4<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.0pt;
mso-bidi-font-size:12.0pt;font-family:"Trebuchet MS";color:#000066'>0012FF46
50<span style="mso-spacerun: yes">                   </span>push<span
style="mso-spacerun: yes">        </span>eax<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.0pt;
mso-bidi-font-size:12.0pt;font-family:"Trebuchet MS";color:#000066'>0012FF47 B8
AF A7 E9 77<span style="mso-spacerun: yes">       </span>mov<span
style="mso-spacerun: yes">         </span>eax,77E9A7AFh<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.0pt;
mso-bidi-font-size:12.0pt;font-family:"Trebuchet MS";color:#000066'>0012FF4C FF
D0<span style="mso-spacerun: yes">       </span><span style="mso-spacerun:
yes">         </span>call<span style="mso-spacerun: yes">        </span>eax<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.0pt;
mso-bidi-font-size:12.0pt;font-family:"Trebuchet MS";color:#000066'>0012FF4E 6A
00<span style="mso-spacerun: yes">                </span>push<span
style="mso-spacerun: yes">        </span>0<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.0pt;
mso-bidi-font-size:12.0pt;font-family:"Trebuchet MS";color:#000066'>0012FF50 B8
94 8F E9 77<span style="mso-spacerun: yes">       </span>mov<span
style="mso-spacerun: yes">         </span>eax,77E98F94h<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.0pt;
mso-bidi-font-size:12.0pt;font-family:"Trebuchet MS";color:#000066'>0012FF55 FF
D0<span style="mso-spacerun: yes">                </span>call<span
style="mso-spacerun: yes">        </span>eax<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.0pt;
mso-bidi-font-size:12.0pt;font-family:"Trebuchet MS";color:#000066'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.0pt;
mso-bidi-font-size:12.0pt;font-family:"Trebuchet MS";color:#000066'>The first instruction
visible on the screen is the breakpoint interrupt CC. Then either you see a
leave instruction or the op code 55 which is push ebp. One of the many reasons
of pushing a register on the stack is to restore the original value at the end
of the code because the value in it is likely to change. A simple rule in
assembler is to restore all the changed registers to their original value. The
next instruction as per the output replaces the contents of the ebp register
with that of esp. Since esp is the stack indicator, each time a value is pushed
or popped on the stack, its value changes . Thus by saving a copy of esp in ebp
(ebp remains unchanged), we now have a reference to the original stack position
before the code is called.<span style="mso-spacerun: yes">  </span>The leave
instruction does the same job internally. <o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.0pt;
mso-bidi-font-size:12.0pt;font-family:"Trebuchet MS";color:#000066'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.0pt;
mso-bidi-font-size:12.0pt;font-family:"Trebuchet MS";color:#000066'>These
instructions thus give a fixed reference point of the stack in order to
reference values on it. Also, when the code ends, the stack can be restored to
its original value by simply popping the ebp register,<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.0pt;
mso-bidi-font-size:12.0pt;font-family:"Trebuchet MS";color:#000066'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.0pt;
mso-bidi-font-size:12.0pt;font-family:"Trebuchet MS";color:#000066'>First, the
value in ecx register is pushed on the stack. At present, the value is of no
importance so we safely ignore it. Since the value is pushed on the stack, 4
memory locations have been allocated as well as the stack moves down by 4. Thus
to reference this value, we have to use ebp-4. Then, the string cmd is to be
placed on the stack. For this purpose, the mov instruction is used which copies
the ASCII values of c, m and d 63,6d and 64 on the stack at ebp-4. Being a
little endian machine, the 63h or c comes last. <o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.0pt;
mso-bidi-font-size:12.0pt;font-family:"Trebuchet MS";color:#000066'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.0pt;
mso-bidi-font-size:12.0pt;font-family:"Trebuchet MS";color:#000066'>The square
brackets in assembler represent a pointer. For eg, if ebp had a value 100, then
cmd would be stored at locations 96 onwards. It for these reasons, the 4 bytes
were allocated on the stack cause, in assembler one is not allowed to write
anywhere, it must be the memory that has been previously allocated. <o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.0pt;
mso-bidi-font-size:12.0pt;font-family:"Trebuchet MS";color:#000066'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.0pt;
mso-bidi-font-size:12.0pt;font-family:"Trebuchet MS";color:#000066'>The WinExec
function takes two parameters, the name of the program to be executed and the
initial mode the window should be opened in, A value of 5 means normal. So,
first 5 is pushed on the stack as the parameters go in the reverse way and then
the address of where the string cmd in memory is given. In our case, it is
ebp-4. <o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.0pt;
mso-bidi-font-size:12.0pt;font-family:"Trebuchet MS";color:#000066'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.0pt;
mso-bidi-font-size:12.0pt;font-family:"Trebuchet MS";color:#000066'>To simplify
this task, first ebp is moved into eax, then 4 is subtracted from it. This
value is the pushed on the stack. Finally the function WinExec is to be called
which will execute the program. <o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.0pt;
mso-bidi-font-size:12.0pt;font-family:"Trebuchet MS";color:#000066'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.0pt;
mso-bidi-font-size:12.0pt;font-family:"Trebuchet MS";color:#000066'>This
function is present in kernel32.dll and since the dll is already in memory, we
simply need to find the location of the function code in memory. However, first
function LoadLibrary is used to find the address of kernel32.dll, and then
using GetProcAddress, the address of WinExec functions in memory is obtained.<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.0pt;
mso-bidi-font-size:12.0pt;font-family:"Trebuchet MS";color:#000066'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.0pt;
mso-bidi-font-size:12.0pt;font-family:"Trebuchet MS";color:#000066'>Once the
value is obtained, using the mov instruction, the value is moved into the eax
register. The call has the op code B8 followed by the address in memory of our
function. <o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.0pt;
mso-bidi-font-size:12.0pt;font-family:"Trebuchet MS";color:#000066'><span
style="mso-spacerun: yes"> </span><o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.0pt;
mso-bidi-font-size:12.0pt;font-family:"Trebuchet MS";color:#000066'>The address
of function WinExec is 77e9a7af as displayed by program d3. This value of
WinExec may change with every new version of Windows and with every new release
of service pack that’s why it is advisable not to hard code it. Here however
while we are learning, we move this address into the eax register and then use
the instruction call eax to call the code of WinExec. This creates a new copy
of the DOS console. <o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.0pt;
mso-bidi-font-size:12.0pt;font-family:"Trebuchet MS";color:#000066'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.0pt;
mso-bidi-font-size:12.0pt;font-family:"Trebuchet MS";color:#000066'>Once done,
its time to clean the mess. Every program under Windows calls the function
ExitProcess whenever it quits out. This address is again retrieved in the same
manner as Winexec and program d3 displays its value. A value of 0 is first
placed on the stack, and then address of ExitProcess is placed in eax. Finally
the op code for call eax is given. <o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.0pt;
mso-bidi-font-size:12.0pt;font-family:"Trebuchet MS";color:#000066'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=MsoNormal><span style='color:#000066'>The above program for some
reason does not work on all machines, therefore a similar logic has been used
with user32.dll. However, since the dll does not get loaded by default, we use
one of the functions, ‘MessageBox’ from the dll. Once done, the address of the
jmp esp instruction is feeded in the text file in place of call esp. Other than
these modifications, the program remains just about the same.<o:p></o:p></span></p>

<p class=MsoNormal><span style='color:#000066'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=MsoNormal><span style='color:#000066'>d.c<o:p></o:p></span></p>

<p class=MsoNormal><span style='color:#000066'>#include &lt;stdio.h&gt;<o:p></o:p></span></p>

<p class=MsoNormal><span style='color:#000066'>main()<o:p></o:p></span></p>

<p class=MsoNormal><span style='color:#000066'>{<o:p></o:p></span></p>

<p class=MsoNormal><span style='color:#000066'>FILE *fp;<o:p></o:p></span></p>

<p class=MsoNormal><span style='color:#000066'>fp =
fopen(&quot;q10.txt&quot;,&quot;wb&quot;);<o:p></o:p></span></p>

<p class=MsoNormal><span style='color:#000066'>fputc('A',fp);<o:p></o:p></span></p>

<p class=MsoNormal><span style='color:#000066'>fputc('A',fp);<o:p></o:p></span></p>

<p class=MsoNormal><span style='color:#000066'>fputc('A',fp);<o:p></o:p></span></p>

<p class=MsoNormal><span style='color:#000066'>fputc('A',fp);<o:p></o:p></span></p>

<p class=MsoNormal><span style='color:#000066'>fputc('A',fp);<o:p></o:p></span></p>

<p class=MsoNormal><span style='color:#000066'>fputc('A',fp);<o:p></o:p></span></p>

<p class=MsoNormal><span style='color:#000066'>fputc('A',fp);<o:p></o:p></span></p>

<p class=MsoNormal><span style='color:#000066'>fputc('A',fp);<o:p></o:p></span></p>

<p class=MsoNormal><span style='color:#000066'>fputc(0x0b,fp);<o:p></o:p></span></p>

<p class=MsoNormal><span style='color:#000066'>fputc(0xa9,fp);<o:p></o:p></span></p>

<p class=MsoNormal><span style='color:#000066'>fputc(0xf5,fp);<o:p></o:p></span></p>

<p class=MsoNormal><span style='color:#000066'>fputc(0x77,fp);<o:p></o:p></span></p>

<p class=MsoNormal><span style='color:#000066'>fputc(0x55,fp);<o:p></o:p></span></p>

<p class=MsoNormal><span style='color:#000066'>fputc(0x8b,fp);<o:p></o:p></span></p>

<p class=MsoNormal><span style='color:#000066'>fputc(0xec,fp);<o:p></o:p></span></p>

<p class=MsoNormal><span style='color:#000066'>fputc(0x51,fp);<o:p></o:p></span></p>

<p class=MsoNormal><span style='color:#000066'>fputc(0xc7,fp);<o:p></o:p></span></p>

<p class=MsoNormal><span style='color:#000066'>fputc(0x45,fp);<o:p></o:p></span></p>

<p class=MsoNormal><span style='color:#000066'>fputc(0xfc,fp);<o:p></o:p></span></p>

<p class=MsoNormal><span style='color:#000066'>fputc(0x63,fp);<o:p></o:p></span></p>

<p class=MsoNormal><span style='color:#000066'>fputc(0x6d,fp);<o:p></o:p></span></p>

<p class=MsoNormal><span style='color:#000066'>fputc(0x64,fp);<o:p></o:p></span></p>

<p class=MsoNormal><span style='color:#000066'>fputc(0x00,fp);<o:p></o:p></span></p>

<p class=MsoNormal><span style='color:#000066'>fputc(0x6a,fp);<o:p></o:p></span></p>

<p class=MsoNormal><span style='color:#000066'>fputc(0x05,fp);<o:p></o:p></span></p>

<p class=MsoNormal><span style='color:#000066'>fputc(0x8b,fp);<o:p></o:p></span></p>

<p class=MsoNormal><span style='color:#000066'>fputc(0xc5,fp);<o:p></o:p></span></p>

<p class=MsoNormal><span style='color:#000066'>fputc(0x83,fp);<o:p></o:p></span></p>

<p class=MsoNormal><span style='color:#000066'>fputc(0xe8,fp);<o:p></o:p></span></p>

<p class=MsoNormal><span style='color:#000066'>fputc(0x04,fp);<o:p></o:p></span></p>

<p class=MsoNormal><span style='color:#000066'>fputc(0x50,fp);<o:p></o:p></span></p>

<p class=MsoNormal><span style='color:#000066'>fputc(0xb8,fp);<o:p></o:p></span></p>

<p class=MsoNormal><span style='color:#000066'>fputc(0xAF,fp);<o:p></o:p></span></p>

<p class=MsoNormal><span style='color:#000066'>fputc(0xA7,fp);<o:p></o:p></span></p>

<p class=MsoNormal><span style='color:#000066'>fputc(0xE9,fp);<o:p></o:p></span></p>

<p class=MsoNormal><span style='color:#000066'>fputc(0x77,fp);<o:p></o:p></span></p>

<p class=MsoNormal><span style='color:#000066'>fputc(0xff,fp);<o:p></o:p></span></p>

<p class=MsoNormal><span style='color:#000066'>fputc(0xd0,fp);<o:p></o:p></span></p>

<p class=MsoNormal><span style='color:#000066'>fputc(0x6a,fp);<o:p></o:p></span></p>

<p class=MsoNormal><span style='color:#000066'>fputc(0x00,fp);<o:p></o:p></span></p>

<p class=MsoNormal><span style='color:#000066'>fputc(0xb8,fp);<o:p></o:p></span></p>

<p class=MsoNormal><span style='color:#000066'>fputc(0x94,fp);<o:p></o:p></span></p>

<p class=MsoNormal><span style='color:#000066'>fputc(0x8f,fp);<o:p></o:p></span></p>

<p class=MsoNormal><span style='color:#000066'>fputc(0xE9,fp);<o:p></o:p></span></p>

<p class=MsoNormal><span style='color:#000066'>fputc(0x77,fp);<o:p></o:p></span></p>

<p class=MsoNormal><span style='color:#000066'>fputc(0xff,fp);<o:p></o:p></span></p>

<p class=MsoNormal><span style='color:#000066'>fputc(0xd0,fp);<o:p></o:p></span></p>

<p class=MsoNormal><span style='color:#000066'>fclose(fp);<o:p></o:p></span></p>

<p class=MsoNormal><span style='color:#000066'>}<o:p></o:p></span></p>

<p class=MsoNormal><span style='color:#000066'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.0pt;
mso-bidi-font-size:12.0pt;font-family:"Trebuchet MS";color:#000066'>d1.c<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.0pt;
mso-bidi-font-size:12.0pt;font-family:"Trebuchet MS";color:#000066'>#include
&lt;windows.h&gt;<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.0pt;
mso-bidi-font-size:12.0pt;font-family:"Trebuchet MS";color:#000066'>#include
&lt;stdio.h&gt;<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.0pt;
mso-bidi-font-size:12.0pt;font-family:"Trebuchet MS";color:#000066'>FILE *fp;<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.0pt;
mso-bidi-font-size:12.0pt;font-family:"Trebuchet MS";color:#000066'>main()<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.0pt;
mso-bidi-font-size:12.0pt;font-family:"Trebuchet MS";color:#000066'>{<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.0pt;
mso-bidi-font-size:12.0pt;font-family:"Trebuchet MS";color:#000066'>abc();<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.0pt;
mso-bidi-font-size:12.0pt;font-family:"Trebuchet MS";color:#000066'>}<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.0pt;
mso-bidi-font-size:12.0pt;font-family:"Trebuchet MS";color:#000066'>int abc()<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.0pt;
mso-bidi-font-size:12.0pt;font-family:"Trebuchet MS";color:#000066'>{<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.0pt;
mso-bidi-font-size:12.0pt;font-family:"Trebuchet MS";color:#000066'>char
a[4];int i1;<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.0pt;
mso-bidi-font-size:12.0pt;font-family:"Trebuchet MS";color:#000066'>MessageBox(0,&quot;hi&quot;,&quot;hi&quot;,0);<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.0pt;
mso-bidi-font-size:12.0pt;font-family:"Trebuchet MS";color:#000066'>fp =
fopen(&quot;q10.txt&quot;,&quot;rb&quot;);<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.0pt;
mso-bidi-font-size:12.0pt;font-family:"Trebuchet MS";color:#000066'>fread(a,100,1,fp);<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.0pt;
mso-bidi-font-size:12.0pt;font-family:"Trebuchet MS";color:#000066'>__asm<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.0pt;
mso-bidi-font-size:12.0pt;font-family:"Trebuchet MS";color:#000066'>{<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.0pt;
mso-bidi-font-size:12.0pt;font-family:"Trebuchet MS";color:#000066'>int 3<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.0pt;
mso-bidi-font-size:12.0pt;font-family:"Trebuchet MS";color:#000066'>}<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.0pt;
mso-bidi-font-size:12.0pt;font-family:"Trebuchet MS";color:#000066'>}<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.0pt;
mso-bidi-font-size:12.0pt;font-family:"Trebuchet MS";color:#000066'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.0pt;
mso-bidi-font-size:12.0pt;font-family:"Trebuchet MS";color:#000066'>&gt;cl d.c<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.0pt;
mso-bidi-font-size:12.0pt;font-family:"Trebuchet MS";color:#000066'>&gt;d<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.0pt;
mso-bidi-font-size:12.0pt;font-family:"Trebuchet MS";color:#000066'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.0pt;
mso-bidi-font-size:12.0pt;font-family:"Trebuchet MS";color:#000066'>&gt;cl d1.c
user32.lib<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.0pt;
mso-bidi-font-size:12.0pt;font-family:"Trebuchet MS";color:#000066'>&gt;d1<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.0pt;
mso-bidi-font-size:12.0pt;font-family:"Trebuchet MS";color:#000066'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.0pt;
mso-bidi-font-size:12.0pt;font-family:"Trebuchet MS";color:#000066'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><a href="../../security.html"><b>Back
to the main page</b></a><span style='font-size:10.0pt;mso-bidi-font-size:12.0pt;
font-family:"Trebuchet MS";color:#000066'><o:p></o:p></span></p>

</div>

</body>


<!-- Mirrored from www.vijaymukhi.com/security/windows/bufferoverfloww.htm by HTTrack Website Copier/3.x [XR&CO'2014], Fri, 11 Oct 2024 14:40:07 GMT -->
</html>
