<html xmlns:o="urn:schemas-microsoft-com:office:office"
xmlns:w="urn:schemas-microsoft-com:office:word"
xmlns="http://www.w3.org/TR/REC-html40">


<!-- Mirrored from www.vijaymukhi.com/security/windows/cddrive.htm by HTTrack Website Copier/3.x [XR&CO'2014], Fri, 11 Oct 2024 14:40:21 GMT -->
<head>
<meta http-equiv=Content-Type content="text/html; charset=windows-1252">
<meta name=ProgId content=Word.Document>
<meta name=Generator content="Microsoft Word 9">
<meta name=Originator content="Microsoft Word 9">
<link rel=File-List href="cddrive_files/filelist.html">
<title>CD Drive</title>
<!--[if gte mso 9]><xml>
 <o:DocumentProperties>
  <o:Author>Mr. Vijay Mukhi</o:Author>
  <o:LastAuthor>Mr. Vijay Mukhi</o:LastAuthor>
  <o:Revision>4</o:Revision>
  <o:TotalTime>23</o:TotalTime>
  <o:Created>2004-03-29T11:03:00Z</o:Created>
  <o:LastSaved>2004-03-29T11:04:00Z</o:LastSaved>
  <o:Pages>1</o:Pages>
  <o:Words>354</o:Words>
  <o:Characters>2021</o:Characters>
  <o:Company>VMCI</o:Company>
  <o:Lines>16</o:Lines>
  <o:Paragraphs>4</o:Paragraphs>
  <o:CharactersWithSpaces>2481</o:CharactersWithSpaces>
  <o:Version>9.2720</o:Version>
 </o:DocumentProperties>
</xml><![endif]-->
<style>
<!--
 /* Style Definitions */
p.MsoNormal, li.MsoNormal, div.MsoNormal
	{mso-style-parent:"";
	margin:0in;
	margin-bottom:.0001pt;
	mso-pagination:widow-orphan;
	font-size:12.0pt;
	font-family:"Times New Roman";
	mso-fareast-font-family:"Times New Roman";
	color:windowtext;}
h6
	{mso-style-next:Normal;
	margin:0in;
	margin-bottom:.0001pt;
	text-align:center;
	mso-pagination:widow-orphan;
	page-break-after:avoid;
	mso-outline-level:6;
	font-size:12.0pt;
	mso-bidi-font-size:10.0pt;
	font-family:"Times New Roman";
	color:#000066;
	mso-text-raise:3.0pt;
	letter-spacing:1.0pt;
	font-weight:bold;}
a:link, span.MsoHyperlink
	{color:blue;
	text-decoration:underline;
	text-underline:single;}
a:visited, span.MsoHyperlinkFollowed
	{color:purple;
	text-decoration:underline;
	text-underline:single;}
p
	{margin-right:0in;
	mso-margin-top-alt:auto;
	mso-margin-bottom-alt:auto;
	margin-left:0in;
	mso-pagination:widow-orphan;
	font-size:12.0pt;
	font-family:"Times New Roman";
	mso-fareast-font-family:"Times New Roman";
	color:black;}
pre
	{margin:0in;
	margin-bottom:.0001pt;
	mso-pagination:widow-orphan;
	tab-stops:45.8pt 91.6pt 137.4pt 183.2pt 229.0pt 274.8pt 320.6pt 366.4pt 412.2pt 458.0pt 503.8pt 549.6pt 595.4pt 641.2pt 687.0pt 732.8pt;
	font-size:10.0pt;
	font-family:"Courier New";
	mso-fareast-font-family:"Courier New";
	mso-bidi-font-family:"Times New Roman";
	color:windowtext;}
p.dt, li.dt, div.dt
	{mso-style-name:dt;
	margin-top:6.0pt;
	margin-right:0in;
	margin-bottom:12.0pt;
	margin-left:0in;
	line-height:18.0pt;
	mso-pagination:widow-orphan;
	font-size:12.0pt;
	font-family:"Times New Roman";
	mso-fareast-font-family:"Times New Roman";
	color:black;}
p.indent, li.indent, div.indent
	{mso-style-name:indent;
	margin-top:6.0pt;
	margin-right:0in;
	margin-bottom:12.0pt;
	margin-left:0in;
	line-height:18.0pt;
	mso-pagination:widow-orphan;
	font-size:12.0pt;
	font-family:"Times New Roman";
	mso-fareast-font-family:"Times New Roman";
	color:black;}
@page Section1
	{size:8.5in 11.0in;
	margin:1.0in 1.25in 1.0in 1.25in;
	mso-header-margin:.5in;
	mso-footer-margin:.5in;
	mso-paper-source:0;}
div.Section1
	{page:Section1;}
-->
</style>
</head>

<body lang=EN-US link=blue vlink=purple style='tab-interval:.5in'>

<div class=Section1>

<table border=1 cellspacing=0 cellpadding=0 width="94%" bgcolor="#eeeeff"
 style='width:94.8%;background:#EEEEFF;border-collapse:collapse;border:none;
 mso-border-alt:solid windowtext .5pt;mso-padding-alt:0in 5.4pt 0in 5.4pt'>
 <tr style='height:15.1pt'>
  <td width="100%" valign=top style='width:100.0%;border:solid windowtext .5pt;
  padding:0in 5.4pt 0in 5.4pt;height:15.1pt'>
  <h6><span style='font-size:11.0pt;mso-bidi-font-size:10.0pt'>CD Drive</span><sup><span
  style='font-size:11.0pt;mso-bidi-font-size:10.0pt;mso-text-raise:0pt'><o:p></o:p></span></sup></h6>
  </td>
 </tr>
</table>

<p class=MsoNormal><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<pre style='margin-top:0in;margin-right:.5in;margin-bottom:0in;margin-left:
.5in;margin-bottom:.0001pt'><span style='mso-bidi-font-family:"Courier New";
color:#000066'>a.c<o:p></o:p></span></pre><pre style='margin-top:0in;
margin-right:.5in;margin-bottom:0in;margin-left:.5in;margin-bottom:.0001pt'><span
style='mso-bidi-font-family:"Courier New";color:#000066'>#include &lt;windows.h&gt;<o:p></o:p></span></pre><pre
style='margin-top:0in;margin-right:.5in;margin-bottom:0in;margin-left:.5in;
margin-bottom:.0001pt'><span style='mso-bidi-font-family:"Courier New";
color:#000066'>#include &lt;mmsystem.h&gt;<o:p></o:p></span></pre><pre
style='margin-top:0in;margin-right:.5in;margin-bottom:0in;margin-left:.5in;
margin-bottom:.0001pt'><span style='mso-bidi-font-family:"Courier New";
color:#000066'>MCI_OPEN_PARMS op;<o:p></o:p></span></pre><pre style='margin-top:
0in;margin-right:.5in;margin-bottom:0in;margin-left:.5in;margin-bottom:.0001pt'><span
style='mso-bidi-font-family:"Courier New";color:#000066'>int main()<o:p></o:p></span></pre><pre
style='margin-top:0in;margin-right:.5in;margin-bottom:0in;margin-left:.5in;
margin-bottom:.0001pt'><span style='mso-bidi-font-family:"Courier New";
color:#000066'>{<o:p></o:p></span></pre><pre style='margin-top:0in;margin-right:
.5in;margin-bottom:0in;margin-left:.5in;margin-bottom:.0001pt'><span
style='mso-bidi-font-family:"Courier New";color:#000066'>op.lpstrDeviceType = (LPCSTR) MCI_DEVTYPE_CD_AUDIO;<o:p></o:p></span></pre><pre
style='margin-top:0in;margin-right:.5in;margin-bottom:0in;margin-left:.5in;
margin-bottom:.0001pt'><span style='mso-bidi-font-family:"Courier New";
color:#000066'>mciSendCommand (0, MCI_OPEN,MCI_OPEN_TYPE | MCI_OPEN_TYPE_ID,(unsigned long)&amp;op);<o:p></o:p></span></pre><pre
style='margin-top:0in;margin-right:.5in;margin-bottom:0in;margin-left:.5in;
margin-bottom:.0001pt'><span style='mso-bidi-font-family:"Courier New";
color:#000066'>printf(&quot;%d\n&quot;,op.wDeviceID);<o:p></o:p></span></pre><pre
style='margin-top:0in;margin-right:.5in;margin-bottom:0in;margin-left:.5in;
margin-bottom:.0001pt'><span style='mso-bidi-font-family:"Courier New";
color:#000066'>mciSendCommand(op.wDeviceID,MCI_SET, MCI_SET_DOOR_OPEN ,0);<o:p></o:p></span></pre><pre
style='margin-top:0in;margin-right:.5in;margin-bottom:0in;margin-left:.5in;
margin-bottom:.0001pt'><span style='mso-bidi-font-family:"Courier New";
color:#000066'>getch();<o:p></o:p></span></pre><pre style='margin-top:0in;
margin-right:.5in;margin-bottom:0in;margin-left:.5in;margin-bottom:.0001pt'><span
style='mso-bidi-font-family:"Courier New";color:#000066'>mciSendCommand(op.wDeviceID,MCI_SET, MCI_SET_DOOR_CLOSED ,0);<o:p></o:p></span></pre><pre
style='margin-top:0in;margin-right:.5in;margin-bottom:0in;margin-left:.5in;
margin-bottom:.0001pt'><span style='mso-bidi-font-family:"Courier New";
color:#000066'>}<o:p></o:p></span></pre><pre style='margin-top:0in;margin-right:
.5in;margin-bottom:0in;margin-left:.5in;margin-bottom:.0001pt'><span
style='mso-bidi-font-family:"Courier New";color:#000066'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></pre><pre
style='margin-top:0in;margin-right:.5in;margin-bottom:0in;margin-left:.5in;
margin-bottom:.0001pt'><span style='mso-bidi-font-family:"Courier New";
color:#000066'>cl a.c winmm.lib<o:p></o:p></span></pre>

<p style='text-align:justify;tab-stops:45.8pt 91.6pt 137.4pt 183.2pt 229.0pt 274.8pt 320.6pt 366.4pt 412.2pt 458.0pt 503.8pt 549.6pt 595.4pt 641.2pt 687.0pt 732.8pt'><span
style='color:#000066'>When we run the above program, it simply opens the CD
drive door for us. When we press any key, the CD drive door closes on us by
magic.<span style="mso-spacerun: yes">  </span>The mci or Media Control
Interface provides us with a standard way of interacting with any multimedia
device. Some of these devices include waveform and CD audio devices, MIDI
sequencers<span style="mso-spacerun: yes">  </span>and digital-video (video
playback) devices.<o:p></o:p></span></p>

<p style='text-align:justify;tab-stops:45.8pt 91.6pt 137.4pt 183.2pt 229.0pt 274.8pt 320.6pt 366.4pt 412.2pt 458.0pt 503.8pt 549.6pt 595.4pt 641.2pt 687.0pt 732.8pt'><span
style='color:#000066'>We first include the header file windows.h and then
mmsystem.h. This file contains all the macros we need when we work with
multimedia under windows. We use just one function mciSendCommand to
communicate with the CD drive or more specifically any mci device. An mci
device is any device that plays multimedia.<o:p></o:p></span></p>

<p style='text-align:justify;tab-stops:45.8pt 91.6pt 137.4pt 183.2pt 229.0pt 274.8pt 320.6pt 366.4pt 412.2pt 458.0pt 503.8pt 549.6pt 595.4pt 641.2pt 687.0pt 732.8pt'><span
style='color:#000066'>The first parameter is the mci device id which we are not
aware of as yet and<span style="mso-spacerun: yes">  </span>thus we pass zero.
The second parameter is a mci command that we want executed and believe me
there are a large number. The MCI_OPEN command first initializes the device for
us before we can use it. The flags MCI_OPEN_TYPE and ID tells us the system
that the last parameter is a pointer to a structure of type MCI_OPEN_PARMS and
the lpstrDeviceType member contains the device type constant or name. Each
unique device has a know constant and the value of MCI_DEVTYPE_CD_AUDIO is 516
and for a VCR it is 513.<o:p></o:p></span></p>

<p style='text-align:justify;tab-stops:45.8pt 91.6pt 137.4pt 183.2pt 229.0pt 274.8pt 320.6pt 366.4pt 412.2pt 458.0pt 503.8pt 549.6pt 595.4pt 641.2pt 687.0pt 732.8pt'><span
style='color:#000066'>At the end of this device the wDeviceID member of the op
structure contains the value of 1 which we use in subsequent calls to the
mciSendCommand function. Now that we have the device ID we would now like to
programmatically open and close the drive door. We use the same mciSendCommand
with the device Id as 1 and not 0. <o:p></o:p></span></p>

<p style='text-align:justify;tab-stops:45.8pt 91.6pt 137.4pt 183.2pt 229.0pt 274.8pt 320.6pt 366.4pt 412.2pt 458.0pt 503.8pt 549.6pt 595.4pt 641.2pt 687.0pt 732.8pt'><span
style='color:#000066'>We then use the MCI_SET mci command to set device
information. The macro MCI_SET_DOOR_OPEN has<span style="mso-spacerun: yes"> 
</span>a value of 0x00000100. This simple act of ours opens the CD drive door
and a value MCI_SET_DOOR_CLOSED or 0x00000200 closes the drive door when we
press an key. The file mmsystem.h contains a list of all the macros we can use
and there are over a million options.<o:p></o:p></span></p>

<p style='text-align:justify;tab-stops:45.8pt 91.6pt 137.4pt 183.2pt 229.0pt 274.8pt 320.6pt 366.4pt 412.2pt 458.0pt 503.8pt 549.6pt 595.4pt 641.2pt 687.0pt 732.8pt'><span
style='color:#000066'>We have to first open the device and then only are we
allowed to send mci commands to it.<o:p></o:p></span></p>

<p style='text-align:justify;tab-stops:45.8pt 91.6pt 137.4pt 183.2pt 229.0pt 274.8pt 320.6pt 366.4pt 412.2pt 458.0pt 503.8pt 549.6pt 595.4pt 641.2pt 687.0pt 732.8pt'><span
class=MsoHyperlink><b><a href="../../security.html">Back to the main page</a></b></span><span
style='color:#000066'><o:p></o:p></span></p>

</div>

</body>


<!-- Mirrored from www.vijaymukhi.com/security/windows/cddrive.htm by HTTrack Website Copier/3.x [XR&CO'2014], Fri, 11 Oct 2024 14:40:22 GMT -->
</html>
