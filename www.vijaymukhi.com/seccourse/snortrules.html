<html xmlns:o="urn:schemas-microsoft-com:office:office"
xmlns:w="urn:schemas-microsoft-com:office:word"
xmlns="http://www.w3.org/TR/REC-html40">


<!-- Mirrored from www.vijaymukhi.com/seccourse/snortrules.htm by HTTrack Website Copier/3.x [XR&CO'2014], Fri, 11 Oct 2024 14:42:07 GMT -->
<head>
<meta http-equiv=Content-Type content="text/html; charset=windows-1252">
<meta name=ProgId content=Word.Document>
<meta name=Generator content="Microsoft Word 9">
<meta name=Originator content="Microsoft Word 9">
<link rel=File-List href="snortrules_files/filelist.xml">
<title>Nemesis and Snort Rules</title>
<!--[if gte mso 9]><xml>
 <o:DocumentProperties>
  <o:Author>Vijay Mukhi</o:Author>
  <o:Template>Normal</o:Template>
  <o:LastAuthor>Vijay Mukhi</o:LastAuthor>
  <o:Revision>2</o:Revision>
  <o:TotalTime>1</o:TotalTime>
  <o:LastPrinted>2005-07-10T12:40:00Z</o:LastPrinted>
  <o:Created>2005-07-23T12:26:00Z</o:Created>
  <o:LastSaved>2005-07-23T12:26:00Z</o:LastSaved>
  <o:Pages>2</o:Pages>
  <o:Words>8252</o:Words>
  <o:Characters>47041</o:Characters>
  <o:Company>VMCI</o:Company>
  <o:Lines>392</o:Lines>
  <o:Paragraphs>94</o:Paragraphs>
  <o:CharactersWithSpaces>57769</o:CharactersWithSpaces>
  <o:Version>9.2720</o:Version>
 </o:DocumentProperties>
</xml><![endif]--><!--[if gte mso 9]><xml>
 <w:WordDocument>
  <w:DoNotShowRevisions/>
  <w:DoNotPrintRevisions/>
  <w:HyphenationZone>0</w:HyphenationZone>
  <w:DoNotHyphenateCaps/>
  <w:DrawingGridHorizontalSpacing>6 pt</w:DrawingGridHorizontalSpacing>
  <w:DrawingGridVerticalSpacing>6 pt</w:DrawingGridVerticalSpacing>
  <w:DisplayVerticalDrawingGridEvery>0</w:DisplayVerticalDrawingGridEvery>
  <w:UseMarginsForDrawingGridOrigin/>
  <w:DoNotShadeFormData/>
  <w:Compatibility>
   <w:BalanceSingleByteDoubleByteWidth/>
   <w:DoNotLeaveBackslashAlone/>
   <w:ULTrailSpace/>
   <w:DoNotExpandShiftReturn/>
   <w:UsePrinterMetrics/>
   <w:WW6BorderRules/>
   <w:FootnoteLayoutLikeWW8/>
   <w:ShapeLayoutLikeWW8/>
   <w:AlignTablesRowByRow/>
   <w:ForgetLastTabAlignment/>
   <w:AutoSpaceLikeWord95/>
   <w:LayoutRawTableWidth/>
   <w:LayoutTableRowsApart/>
  </w:Compatibility>
 </w:WordDocument>
</xml><![endif]-->
<style>
<!--
 /* Font Definitions */
@font-face
	{font-family:"Trebuchet MS";
	panose-1:2 11 6 3 2 2 2 2 2 4;
	mso-font-charset:0;
	mso-generic-font-family:swiss;
	mso-font-pitch:variable;
	mso-font-signature:7 0 0 0 19 0;}
 /* Style Definitions */
p.MsoNormal, li.MsoNormal, div.MsoNormal
	{mso-style-parent:"";
	margin:0in;
	margin-bottom:.0001pt;
	mso-pagination:widow-orphan;
	mso-layout-grid-align:none;
	punctuation-wrap:simple;
	text-autospace:none;
	font-size:10.0pt;
	font-family:"Times New Roman";
	mso-fareast-font-family:"Times New Roman";}
h1
	{mso-style-next:Normal;
	margin:0in;
	margin-bottom:.0001pt;
	mso-pagination:widow-orphan;
	page-break-after:avoid;
	mso-outline-level:1;
	mso-layout-grid-align:none;
	punctuation-wrap:simple;
	text-autospace:none;
	font-size:18.0pt;
	mso-bidi-font-size:10.0pt;
	font-family:Arial;
	mso-bidi-font-family:"Times New Roman";
	mso-font-kerning:0pt;}
h2
	{mso-style-next:Normal;
	margin:0in;
	margin-bottom:.0001pt;
	text-align:justify;
	mso-pagination:widow-orphan;
	page-break-after:avoid;
	mso-outline-level:2;
	mso-layout-grid-align:none;
	punctuation-wrap:simple;
	text-autospace:none;
	font-size:10.0pt;
	font-family:Arial;}
p.MsoFooter, li.MsoFooter, div.MsoFooter
	{margin:0in;
	margin-bottom:.0001pt;
	mso-pagination:widow-orphan;
	tab-stops:center 3.0in right 6.0in;
	mso-layout-grid-align:none;
	punctuation-wrap:simple;
	text-autospace:none;
	font-size:10.0pt;
	font-family:"Times New Roman";
	mso-fareast-font-family:"Times New Roman";}
p.MsoBodyText, li.MsoBodyText, div.MsoBodyText
	{margin:0in;
	margin-bottom:.0001pt;
	text-align:justify;
	mso-pagination:widow-orphan;
	mso-layout-grid-align:none;
	punctuation-wrap:simple;
	text-autospace:none;
	font-size:10.0pt;
	font-family:"Trebuchet MS";
	mso-fareast-font-family:"Times New Roman";
	mso-bidi-font-family:Arial;}
p.MsoBodyText2, li.MsoBodyText2, div.MsoBodyText2
	{margin:0in;
	margin-bottom:.0001pt;
	text-align:justify;
	mso-pagination:none;
	mso-layout-grid-align:none;
	punctuation-wrap:simple;
	text-autospace:none;
	font-size:10.5pt;
	mso-bidi-font-size:10.0pt;
	font-family:"Trebuchet MS";
	mso-fareast-font-family:"Times New Roman";
	mso-bidi-font-family:"Courier New";}
 /* Page Definitions */
@page
	{mso-footnote-position:end-of-section;
	mso-endnote-position:end-of-section;
	mso-endnote-numbering-style:arabic;
	mso-endnote-numbering-start:0;}
@page Section1
	{size:8.5in 11.0in;
	margin:1.0in 1.25in 1.0in 1.25in;
	mso-header-margin:.5in;
	mso-footer-margin:.5in;
	mso-even-footer:url("snortrules_files/header.html") ef1;
	mso-footer:url("snortrules_files/header.html") f1;
	mso-paper-source:0;}
div.Section1
	{page:Section1;}
-->
</style>
</head>

<body lang=EN-US style='tab-interval:.5in'>

<div class=Section1>

<h2><span style='font-size:10.5pt;mso-bidi-font-size:10.0pt;font-family:"Trebuchet MS";
mso-bidi-font-family:"Courier New"'>Nemesis<o:p></o:p></span></h2>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.5pt;
mso-bidi-font-size:10.0pt;font-family:"Trebuchet MS";mso-bidi-font-family:"Courier New"'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify;mso-pagination:none'><span
style='font-size:10.5pt;mso-bidi-font-size:10.0pt;font-family:"Trebuchet MS";
mso-bidi-font-family:"Courier New"'>Nemesis is a packet generator, which can be
downloaded from the net. It comes in a zip file, nemesis-1.4beta3.zip. Unzip
the file to c:\ and then run the exe file nemesis. <o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify;mso-pagination:none'><span
style='font-size:10.5pt;mso-bidi-font-size:10.0pt;font-family:"Trebuchet MS";
mso-bidi-font-family:"Courier New"'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify;mso-pagination:none'><span
style='font-size:10.5pt;mso-bidi-font-size:10.0pt;font-family:"Trebuchet MS";
mso-bidi-font-family:"Courier New"'>On doing so, it comes back with usage
instructions. So we run it as <o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify;mso-pagination:none'><span
style='font-size:10.5pt;mso-bidi-font-size:10.0pt;font-family:"Trebuchet MS";
mso-bidi-font-family:"Courier New"'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify;mso-pagination:none'><span
style='font-size:10.5pt;mso-bidi-font-size:10.0pt;font-family:"Trebuchet MS";
mso-bidi-font-family:"Courier New"'>nemesis tcp<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify;mso-pagination:none'><span
style='font-size:10.5pt;mso-bidi-font-size:10.0pt;font-family:"Trebuchet MS";
mso-bidi-font-family:"Courier New"'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify;mso-pagination:none'><span
style='font-size:10.5pt;mso-bidi-font-size:10.0pt;font-family:"Trebuchet MS";
mso-bidi-font-family:"Courier New"'>This command creates a tcp packet and then
displays a message, TCP packet injected. However, we are yet ignorant about the
packet this tool creates by default. Hence it is safer to use the -v option or
verbose where nemesis displays the packet it sends across.<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify;mso-pagination:none'><span
style='font-size:10.5pt;mso-bidi-font-size:10.0pt;font-family:"Trebuchet MS";
mso-bidi-font-family:"Courier New"'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify;mso-pagination:none'><span
style='font-size:10.5pt;mso-bidi-font-size:10.0pt;font-family:"Trebuchet MS";
mso-bidi-font-family:"Courier New"'>nemesis tcp -v<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify;mso-pagination:none'><span
style='font-size:10.5pt;mso-bidi-font-size:10.0pt;font-family:"Trebuchet MS";
mso-bidi-font-family:"Courier New"'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify;mso-pagination:none'><span
style='font-size:10.5pt;mso-bidi-font-size:10.0pt;font-family:"Trebuchet MS";
mso-bidi-font-family:"Courier New"'>TCP Packet Injection -=- The NEMESIS
Project Version 1.4beta3 (Build 22)<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify;mso-pagination:none'><span
style='font-size:10.5pt;mso-bidi-font-size:10.0pt;font-family:"Trebuchet MS";
mso-bidi-font-family:"Courier New"'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify;mso-pagination:none'><span
style='font-size:10.5pt;mso-bidi-font-size:10.0pt;font-family:"Trebuchet MS";
mso-bidi-font-family:"Courier New"'><span style="mso-spacerun:
yes">                </span>[IP] 196.254.34.0 &gt; 196.254.34.0<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify;mso-pagination:none'><span
style='font-size:10.5pt;mso-bidi-font-size:10.0pt;font-family:"Trebuchet MS";
mso-bidi-font-family:"Courier New"'><span style="mso-spacerun:
yes">             </span>[IP ID] 65286<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify;mso-pagination:none'><span
style='font-size:10.5pt;mso-bidi-font-size:10.0pt;font-family:"Trebuchet MS";
mso-bidi-font-family:"Courier New"'><span style="mso-spacerun: yes">         
</span>[IP Proto] TCP (6)<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify;mso-pagination:none'><span
style='font-size:10.5pt;mso-bidi-font-size:10.0pt;font-family:"Trebuchet MS";
mso-bidi-font-family:"Courier New"'><span style="mso-spacerun: yes">           
</span>[IP TTL] 255<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify;mso-pagination:none'><span
style='font-size:10.5pt;mso-bidi-font-size:10.0pt;font-family:"Trebuchet MS";
mso-bidi-font-family:"Courier New"'><span style="mso-spacerun: yes">           
</span>[IP TOS] 00<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify;mso-pagination:none'><span
style='font-size:10.5pt;mso-bidi-font-size:10.0pt;font-family:"Trebuchet MS";
mso-bidi-font-family:"Courier New"'><span style="mso-spacerun: yes">   
</span>[IP Frag offset] 0000<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify;mso-pagination:none'><span
style='font-size:10.5pt;mso-bidi-font-size:10.0pt;font-family:"Trebuchet MS";
mso-bidi-font-family:"Courier New"'><span style="mso-spacerun: yes">    
</span>[IP Frag flags] <o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify;mso-pagination:none'><span
style='font-size:10.5pt;mso-bidi-font-size:10.0pt;font-family:"Trebuchet MS";
mso-bidi-font-family:"Courier New"'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify;mso-pagination:none'><span
style='font-size:10.5pt;mso-bidi-font-size:10.0pt;font-family:"Trebuchet MS";
mso-bidi-font-family:"Courier New"'><span style="mso-spacerun: yes">        
</span>[TCP Ports] 65286 &gt; 65286<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify;mso-pagination:none'><span
style='font-size:10.5pt;mso-bidi-font-size:10.0pt;font-family:"Trebuchet MS";
mso-bidi-font-family:"Courier New"'><span style="mso-spacerun: yes">        
</span>[TCP Flags] SYN <o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify;mso-pagination:none'><span
style='font-size:10.5pt;mso-bidi-font-size:10.0pt;font-family:"Trebuchet MS";
mso-bidi-font-family:"Courier New"'>[TCP Urgent Pointer] 0<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify;mso-pagination:none'><span
style='font-size:10.5pt;mso-bidi-font-size:10.0pt;font-family:"Trebuchet MS";
mso-bidi-font-family:"Courier New"'><span style="mso-spacerun: yes">  
</span>[TCP Window Size] 4096<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify;mso-pagination:none'><span
style='font-size:10.5pt;mso-bidi-font-size:10.0pt;font-family:"Trebuchet MS";
mso-bidi-font-family:"Courier New"'><span style="mso-spacerun: yes">   
</span>[TCP Seq number] 2293476<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify;mso-pagination:none'><span
style='font-size:10.5pt;mso-bidi-font-size:10.0pt;font-family:"Trebuchet MS";
mso-bidi-font-family:"Courier New"'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify;mso-pagination:none'><span
style='font-size:10.5pt;mso-bidi-font-size:10.0pt;font-family:"Trebuchet MS";
mso-bidi-font-family:"Courier New"'>Wrote 40 byte TCP packet.<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify;mso-pagination:none'><span
style='font-size:10.5pt;mso-bidi-font-size:10.0pt;font-family:"Trebuchet MS";
mso-bidi-font-family:"Courier New"'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify;mso-pagination:none'><span
style='font-size:10.5pt;mso-bidi-font-size:10.0pt;font-family:"Trebuchet MS";
mso-bidi-font-family:"Courier New"'>TCP Packet Injected<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify;mso-pagination:none'><span
style='font-size:10.5pt;mso-bidi-font-size:10.0pt;font-family:"Trebuchet MS";
mso-bidi-font-family:"Courier New"'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=MsoBodyText2>The output shows that nemesis creates a 40-byte bytes
packet using some random IP addresses. Lets us now change each and every option
in the above packet and<span style="mso-spacerun: yes">  </span>include a
payload too. </p>

<p class=MsoNormal style='text-align:justify;mso-pagination:none'><span
style='font-size:10.5pt;mso-bidi-font-size:10.0pt;font-family:"Trebuchet MS";
mso-bidi-font-family:"Courier New"'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify;mso-pagination:none'><span
style='font-size:10.5pt;mso-bidi-font-size:10.0pt;font-family:"Trebuchet MS";
mso-bidi-font-family:"Courier New"'>C:\nemesis-1.4beta3&gt;nemesis tcp -v<span
style="mso-spacerun: yes">  </span>-s 1 -P vijay.txt -w 2 -u 3 -x 80 -y 6 -fSA
-t 4 -T 5 -I 7 -S 1.1.1.1 -D 70.0.0.3 -a 9 <o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify;mso-pagination:none'><span
style='font-size:10.5pt;mso-bidi-font-size:10.0pt;font-family:"Trebuchet MS";
mso-bidi-font-family:"Courier New"'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify;mso-pagination:none'><span
style='font-size:10.5pt;mso-bidi-font-size:10.0pt;font-family:"Trebuchet MS";
mso-bidi-font-family:"Courier New"'>TCP Packet Injection -=- The NEMESIS
Project Version 1.4beta3 (Build 22)<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify;mso-pagination:none'><span
style='font-size:10.5pt;mso-bidi-font-size:10.0pt;font-family:"Trebuchet MS";
mso-bidi-font-family:"Courier New"'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify;mso-pagination:none'><span
style='font-size:10.5pt;mso-bidi-font-size:10.0pt;font-family:"Trebuchet MS";
mso-bidi-font-family:"Courier New"'><span style="mso-spacerun:
yes">                </span>[IP] 1.1.1.1 &gt; 70.0.0.3<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify;mso-pagination:none'><span
style='font-size:10.5pt;mso-bidi-font-size:10.0pt;font-family:"Trebuchet MS";
mso-bidi-font-family:"Courier New"'><span style="mso-spacerun:
yes">             </span>[IP ID] 7<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify;mso-pagination:none'><span
style='font-size:10.5pt;mso-bidi-font-size:10.0pt;font-family:"Trebuchet MS";
mso-bidi-font-family:"Courier New"'><span style="mso-spacerun: yes">         
</span>[IP Proto] TCP (6)<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify;mso-pagination:none'><span
style='font-size:10.5pt;mso-bidi-font-size:10.0pt;font-family:"Trebuchet MS";
mso-bidi-font-family:"Courier New"'><span style="mso-spacerun: yes">           
</span>[IP TTL] 5<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify;mso-pagination:none'><span
style='font-size:10.5pt;mso-bidi-font-size:10.0pt;font-family:"Trebuchet MS";
mso-bidi-font-family:"Courier New"'><span style="mso-spacerun: yes">           
</span>[IP TOS] 0x04<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify;mso-pagination:none'><span
style='font-size:10.5pt;mso-bidi-font-size:10.0pt;font-family:"Trebuchet MS";
mso-bidi-font-family:"Courier New"'><span style="mso-spacerun: yes">   </span><span
style="mso-spacerun: yes"> </span>[IP Frag offset] 0000<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify;mso-pagination:none'><span
style='font-size:10.5pt;mso-bidi-font-size:10.0pt;font-family:"Trebuchet MS";
mso-bidi-font-family:"Courier New"'><span style="mso-spacerun: yes">    
</span>[IP Frag flags] <o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify;mso-pagination:none'><span
style='font-size:10.5pt;mso-bidi-font-size:10.0pt;font-family:"Trebuchet MS";
mso-bidi-font-family:"Courier New"'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify;mso-pagination:none'><span
style='font-size:10.5pt;mso-bidi-font-size:10.0pt;font-family:"Trebuchet MS";
mso-bidi-font-family:"Courier New"'><span style="mso-spacerun: yes">        
</span>[TCP Ports] 80 &gt; 6<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify;mso-pagination:none'><span
style='font-size:10.5pt;mso-bidi-font-size:10.0pt;font-family:"Trebuchet MS";
mso-bidi-font-family:"Courier New"'><span style="mso-spacerun: yes">        
</span>[TCP Flags] SYN ACK <o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify;mso-pagination:none'><span
style='font-size:10.5pt;mso-bidi-font-size:10.0pt;font-family:"Trebuchet MS";
mso-bidi-font-family:"Courier New"'>[TCP Urgent Pointer] 3<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify;mso-pagination:none'><span
style='font-size:10.5pt;mso-bidi-font-size:10.0pt;font-family:"Trebuchet MS";
mso-bidi-font-family:"Courier New"'><span style="mso-spacerun: yes">  
</span>[TCP Window Size] 2<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify;mso-pagination:none'><span
style='font-size:10.5pt;mso-bidi-font-size:10.0pt;font-family:"Trebuchet MS";
mso-bidi-font-family:"Courier New"'><span style="mso-spacerun: yes">   
</span>[TCP Ack number] 9<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify;mso-pagination:none'><span
style='font-size:10.5pt;mso-bidi-font-size:10.0pt;font-family:"Trebuchet MS";
mso-bidi-font-family:"Courier New"'><span style="mso-spacerun: yes">   
</span>[TCP Seq number] 1<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify;mso-pagination:none'><span
style='font-size:10.5pt;mso-bidi-font-size:10.0pt;font-family:"Trebuchet MS";
mso-bidi-font-family:"Courier New"'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify;mso-pagination:none'><span
style='font-size:10.5pt;mso-bidi-font-size:10.0pt;font-family:"Trebuchet MS";
mso-bidi-font-family:"Courier New"'>Wrote 67 byte TCP packet.<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify;mso-pagination:none'><span
style='font-size:10.5pt;mso-bidi-font-size:10.0pt;font-family:"Trebuchet MS";
mso-bidi-font-family:"Courier New"'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify;mso-pagination:none'><span
style='font-size:10.5pt;mso-bidi-font-size:10.0pt;font-family:"Trebuchet MS";
mso-bidi-font-family:"Courier New"'>TCP Packet Injected<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify;mso-pagination:none'><span
style='font-size:10.5pt;mso-bidi-font-size:10.0pt;font-family:"Trebuchet MS";
mso-bidi-font-family:"Courier New"'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify;mso-pagination:none'><span
style='font-size:10.5pt;mso-bidi-font-size:10.0pt;font-family:"Trebuchet MS";
mso-bidi-font-family:"Courier New"'>-s 1 make the sequence number 1 and -a sets
the acknowledgement number.<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify;mso-pagination:none'><span
style='font-size:10.5pt;mso-bidi-font-size:10.0pt;font-family:"Trebuchet MS";
mso-bidi-font-family:"Courier New"'>-P is followed by the payload of the
packet. Vijay.txt contians any arbitrary text that will be send as tcp data. <o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify;mso-pagination:none'><span
style='font-size:10.5pt;mso-bidi-font-size:10.0pt;font-family:"Trebuchet MS";
mso-bidi-font-family:"Courier New"'>-w 2 makes the tcp window size 2<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify;mso-pagination:none'><span
style='font-size:10.5pt;mso-bidi-font-size:10.0pt;font-family:"Trebuchet MS";
mso-bidi-font-family:"Courier New"'>-u 3 set the urgent pointer offset into the
data as 3.<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify;mso-pagination:none'><span
style='font-size:10.5pt;mso-bidi-font-size:10.0pt;font-family:"Trebuchet MS";
mso-bidi-font-family:"Courier New"'>-x 80 sets the source port to 8 and -y set
the destination port to 6. <o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify;mso-pagination:none'><span
style='font-size:10.5pt;mso-bidi-font-size:10.0pt;font-family:"Trebuchet MS";
mso-bidi-font-family:"Courier New"'>-f allows us to set the flags, S for SYN A
for ACK.<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify;mso-pagination:none'><span
style='font-size:10.5pt;mso-bidi-font-size:10.0pt;font-family:"Trebuchet MS";
mso-bidi-font-family:"Courier New"'>-t 4 is for the Type of Service<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify;mso-pagination:none'><span
style='font-size:10.5pt;mso-bidi-font-size:10.0pt;font-family:"Trebuchet MS";
mso-bidi-font-family:"Courier New"'>-T 5 for the Time to live TTL<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify;mso-pagination:none'><span
style='font-size:10.5pt;mso-bidi-font-size:10.0pt;font-family:"Trebuchet MS";
mso-bidi-font-family:"Courier New"'>-I 7 sets the id of the package to 7. <o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify;mso-pagination:none'><span
style='font-size:10.5pt;mso-bidi-font-size:10.0pt;font-family:"Trebuchet MS";
mso-bidi-font-family:"Courier New"'>-S 1.1.1.1 set the source IP address and -D
set the sestination to 70.0.0.3. The machine running sort is on 70.0.0.3. <o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify;mso-pagination:none'><span
style='font-size:10.5pt;mso-bidi-font-size:10.0pt;font-family:"Trebuchet MS";
mso-bidi-font-family:"Courier New"'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify;mso-pagination:none'><span
style='font-size:10.5pt;mso-bidi-font-size:10.0pt;font-family:"Trebuchet MS";
mso-bidi-font-family:"Courier New"'>We can constantly keep making changes to
this packet and then send it across and see how snort responds to it. The above
command line argument can be placed in a.bat so that it is simpler to execute
the command each time.<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify;mso-pagination:none'><span
style='font-size:10.5pt;mso-bidi-font-size:10.0pt;font-family:"Trebuchet MS";
mso-bidi-font-family:"Courier New"'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify;mso-pagination:none'><span
style='font-size:10.5pt;mso-bidi-font-size:10.0pt;font-family:"Trebuchet MS";
mso-bidi-font-family:"Courier New"'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify;mso-pagination:none'><span
style='font-size:10.5pt;mso-bidi-font-size:10.0pt;font-family:"Trebuchet MS";
mso-bidi-font-family:"Courier New"'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify;mso-pagination:none'><span
style='font-size:10.5pt;mso-bidi-font-size:10.0pt;font-family:"Trebuchet MS";
mso-bidi-font-family:"Courier New"'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.5pt;
mso-bidi-font-size:10.0pt;font-family:"Trebuchet MS";mso-bidi-font-family:"Courier New"'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<b><span style='font-size:10.5pt;mso-bidi-font-size:10.0pt;font-family:"Trebuchet MS";
mso-fareast-font-family:"Times New Roman";mso-bidi-font-family:"Courier New";
mso-ansi-language:EN-US;mso-fareast-language:EN-US;mso-bidi-language:AR-SA'><br
clear=all style='mso-special-character:line-break;page-break-before:always'>
</span></b>

<h1 style='text-align:justify'><![if !supportEmptyParas]>&nbsp;<![endif]><span
style='font-size:10.5pt;mso-bidi-font-size:10.0pt;font-family:"Trebuchet MS";
mso-bidi-font-family:"Courier New"'><o:p></o:p></span></h1>

<h1 style='text-align:justify'><span style='font-size:10.5pt;mso-bidi-font-size:
10.0pt;font-family:"Trebuchet MS";mso-bidi-font-family:"Courier New"'>Snort<o:p></o:p></span></h1>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.5pt;
mso-bidi-font-size:10.0pt;font-family:"Trebuchet MS";mso-bidi-font-family:"Courier New"'>Snort
has been installed into the subdirectory c:\snort by running the installer
snort_233_build14_installer.exe. To run snort we move to directory c:\snort\bin
and simply run it as: <o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.5pt;
mso-bidi-font-size:10.0pt;font-family:"Trebuchet MS";mso-bidi-font-family:"Courier New"'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.5pt;
mso-bidi-font-size:10.0pt;font-family:"Trebuchet MS";mso-bidi-font-family:"Courier New"'>snort<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:8.5pt;
mso-bidi-font-size:10.0pt;font-family:"Trebuchet MS";mso-bidi-font-family:"Courier New"'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=MsoBodyText><span style='font-size:10.5pt;mso-bidi-font-size:10.0pt;
mso-bidi-font-family:"Courier New"'>On doing so, we are presented with a list
of options that can be used besides snort telling us; we quote ' Uh, you need
to tell me<span style="mso-spacerun: yes">  </span>to do something...'<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:8.5pt;
mso-bidi-font-size:10.0pt;font-family:"Trebuchet MS";mso-bidi-font-family:"Courier New"'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.5pt;
mso-bidi-font-size:10.0pt;font-family:"Trebuchet MS";mso-bidi-font-family:"Courier New"'>So,
run snort as <o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:8.5pt;
mso-bidi-font-size:10.0pt;font-family:"Trebuchet MS";mso-bidi-font-family:"Courier New"'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.5pt;
mso-bidi-font-size:10.0pt;font-family:"Trebuchet MS";mso-bidi-font-family:"Courier New"'>&gt;snort
-v<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:8.5pt;
mso-bidi-font-size:10.0pt;font-family:"Trebuchet MS";mso-bidi-font-family:"Courier New"'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.5pt;
mso-bidi-font-size:10.0pt;font-family:"Trebuchet MS";mso-bidi-font-family:"Courier New"'>where
v stands for verbose. Then run our newly created packet from nemesis on IP
address 70.0.0.1 The output we see in snort is shown below.<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.5pt;
mso-bidi-font-size:10.0pt;font-family:"Trebuchet MS";mso-bidi-font-family:"Courier New"'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.5pt;
mso-bidi-font-size:10.0pt;font-family:"Trebuchet MS";mso-bidi-font-family:"Courier New"'>05/25-14:18:56.650926
ARP who-has 70.0.0.3 (FF:FF:FF:FF:FF:FF) tell 70.0.0.1<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.5pt;
mso-bidi-font-size:10.0pt;font-family:"Trebuchet MS";mso-bidi-font-family:"Courier New"'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.5pt;
mso-bidi-font-size:10.0pt;font-family:"Trebuchet MS";mso-bidi-font-family:"Courier New"'>05/25-14:18:56.650997
ARP reply 70.0.0.3 is-at 0:0:E8:DF:60:57<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.5pt;
mso-bidi-font-size:10.0pt;font-family:"Trebuchet MS";mso-bidi-font-family:"Courier New"'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.5pt;
mso-bidi-font-size:10.0pt;font-family:"Trebuchet MS";mso-bidi-font-family:"Courier New"'>05/25-14:18:56.701956
1.1.1.1:80 -&gt; 70.0.0.3:6<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.5pt;
mso-bidi-font-size:10.0pt;font-family:"Trebuchet MS";mso-bidi-font-family:"Courier New"'>TCP
TTL:5 TOS:0x4 ID:7 IpLen:20 DgmLen:67<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.5pt;
mso-bidi-font-size:10.0pt;font-family:"Trebuchet MS";mso-bidi-font-family:"Courier New"'>***A**S*
Seq: 0x1<span style="mso-spacerun: yes">  </span>Ack: 0x9<span
style="mso-spacerun: yes">  </span>Win: 0x2<span style="mso-spacerun: yes"> 
</span>TcpLen: 20<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.5pt;
mso-bidi-font-size:10.0pt;font-family:"Trebuchet MS";mso-bidi-font-family:"Courier New"'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.5pt;
mso-bidi-font-size:10.0pt;font-family:"Trebuchet MS";mso-bidi-font-family:"Courier New"'>The
first two packets are ARP based, the Address Resolution Protocol. This protocol
follows a simple logic. We are asking our machine with the ip address 70.0.0.1
to send a packet to 70.0.0.3. However, the ethernet address of a machine with
the ip address 70.0.0.3 is not known. Thus snort first sends a broadcast packet
from 70.0.0.1 asking for the ethernet address of machine with the IP address
70.0.0.3. <o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:8.5pt;
mso-bidi-font-size:10.0pt;font-family:"Trebuchet MS";mso-bidi-font-family:"Courier New"'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.5pt;
mso-bidi-font-size:10.0pt;font-family:"Trebuchet MS";mso-bidi-font-family:"Courier New"'>If
the computer is on the network, an ARP reply is received form the machine with
IP address 70.0.0.3 giving its ethernet address, i.e 0:0:E8:DF:60:57. Then,
nemesis sends a packet with the source ip as 1.1.1.1 at port 80 to 70.0.0.3 at
port 6. This has a TTL of 5, tos of 4 id 7 and total length 67. The sequence
number is 1, ack 9, window size 2 and flags A And S are on. This newly
generated packet is then sent out. Lets display some more of the packet. <o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:8.5pt;
mso-bidi-font-size:10.0pt;font-family:"Trebuchet MS";mso-bidi-font-family:"Courier New"'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.5pt;
mso-bidi-font-size:10.0pt;font-family:"Trebuchet MS";mso-bidi-font-family:"Courier New"'>snort
-vd<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:8.5pt;
mso-bidi-font-size:10.0pt;font-family:"Trebuchet MS";mso-bidi-font-family:"Courier New"'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.5pt;
mso-bidi-font-size:10.0pt;font-family:"Trebuchet MS";mso-bidi-font-family:"Courier New"'>05/25-14:26:25.940785
1.1.1.1:80 -&gt; 70.0.0.3:6<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.5pt;
mso-bidi-font-size:10.0pt;font-family:"Trebuchet MS";mso-bidi-font-family:"Courier New"'>TCP
TTL:5 TOS:0x4 ID:7 IpLen:20 DgmLen:67<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.5pt;
mso-bidi-font-size:10.0pt;font-family:"Trebuchet MS";mso-bidi-font-family:"Courier New"'>***A**S*
Seq: 0x1<span style="mso-spacerun: yes">  </span>Ack: 0x9<span
style="mso-spacerun: yes">  </span>Win: 0x2<span style="mso-spacerun: yes"> 
</span>TcpLen: 20<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.5pt;
mso-bidi-font-size:10.0pt;font-family:"Trebuchet MS";mso-bidi-font-family:"Courier New"'>56
69 6A 61 79 20 4D 75 6B 68 69 20 69 73 20 61<span style="mso-spacerun: yes"> 
</span>Vijay Mukhi is a<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.5pt;
mso-bidi-font-size:10.0pt;font-family:"Trebuchet MS";mso-bidi-font-family:"Courier New"'>20
67 72 65 61 74 20 67 75 79 0A<span style="mso-spacerun: yes">                 
</span>great guy.<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:8.5pt;
mso-bidi-font-size:10.0pt;font-family:"Trebuchet MS";mso-bidi-font-family:"Courier New"'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.5pt;
mso-bidi-font-size:10.0pt;font-family:"Trebuchet MS";mso-bidi-font-family:"Courier New"'>The
same packet is now sent across but now the -d option is added to snort. The -d
option displays the application layer, as a result we see the payload that is
present in vijay.txt.<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.5pt;
mso-bidi-font-size:10.0pt;font-family:"Trebuchet MS";mso-bidi-font-family:"Courier New"'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.5pt;
mso-bidi-font-size:10.0pt;font-family:"Trebuchet MS";mso-bidi-font-family:"Courier New"'>snort
-vde <o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:8.5pt;
mso-bidi-font-size:10.0pt;font-family:"Trebuchet MS";mso-bidi-font-family:"Courier New"'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.5pt;
mso-bidi-font-size:10.0pt;font-family:"Trebuchet MS";mso-bidi-font-family:"Courier New"'>05/25-14:29:29.228783
0:0:E8:EE:EC:88 -&gt; 0:0:E8:DF:60:57 type:0x800 len:0x51<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.5pt;
mso-bidi-font-size:10.0pt;font-family:"Trebuchet MS";mso-bidi-font-family:"Courier New"'>1.1.1.1:80
-&gt; 70.0.0.3:6 TCP TTL:5 TOS:0x4 ID:7 IpLen:20 DgmLen:67<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.5pt;
mso-bidi-font-size:10.0pt;font-family:"Trebuchet MS";mso-bidi-font-family:"Courier New"'>***A**S*
Seq: 0x1<span style="mso-spacerun: yes">  </span>Ack: 0x9<span
style="mso-spacerun: yes">  </span>Win: 0x2<span style="mso-spacerun: yes"> 
</span>TcpLen: 20<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.5pt;
mso-bidi-font-size:10.0pt;font-family:"Trebuchet MS";mso-bidi-font-family:"Courier New"'>56
69 6A 61 79 20 4D 75 6B 68 69 20 69 73 20 61<span style="mso-spacerun: yes"> 
</span>Vijay Mukhi is a<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.5pt;
mso-bidi-font-size:10.0pt;font-family:"Trebuchet MS";mso-bidi-font-family:"Courier New"'>20
67 72 65 61 74 20 67 75 79 0A<span style="mso-spacerun: yes">                 
</span>great guy.<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:8.5pt;
mso-bidi-font-size:10.0pt;font-family:"Trebuchet MS";mso-bidi-font-family:"Courier New"'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.5pt;
mso-bidi-font-size:10.0pt;font-family:"Trebuchet MS";mso-bidi-font-family:"Courier New"'>The
-e displays, the help calls it, the second layer header info or the data link
layer. In our case, it is the ethernet header. The first is the source ethernet
address of the machine sending the packet, 70.0.0.1 is the machine running
nemesis. The second ethernet address is of the destination which arp receives,
0:0:E8:DF:60:57, the ethernet address of machine 70.0.0.3.<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:8.5pt;
mso-bidi-font-size:10.0pt;font-family:"Trebuchet MS";mso-bidi-font-family:"Courier New"'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.5pt;
mso-bidi-font-size:10.0pt;font-family:"Trebuchet MS";mso-bidi-font-family:"Courier New"'>When
the destination IP address of the packet is changed to 70.0.0.4, snort shows
the following. We changed -D 70.0.0.3 to -D 70.0.0.4.<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:8.5pt;
mso-bidi-font-size:10.0pt;font-family:"Trebuchet MS";mso-bidi-font-family:"Courier New"'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.5pt;
mso-bidi-font-size:10.0pt;font-family:"Trebuchet MS";mso-bidi-font-family:"Courier New"'>05/25-14:34:16.684193
ARP who-has 70.0.0.4 (FF:FF:FF:FF:FF:FF) tell 70.0.0.1<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:8.5pt;
mso-bidi-font-size:10.0pt;font-family:"Trebuchet MS";mso-bidi-font-family:"Courier New"'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.5pt;
mso-bidi-font-size:10.0pt;font-family:"Trebuchet MS";mso-bidi-font-family:"Courier New"'>05/25-14:34:16.789271
ARP who-has 0.0.0.0 (FF:FF:FF:FF:FF:FF) tell 70.0.0.1<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:8.5pt;
mso-bidi-font-size:10.0pt;font-family:"Trebuchet MS";mso-bidi-font-family:"Courier New"'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.5pt;
mso-bidi-font-size:10.0pt;font-family:"Trebuchet MS";mso-bidi-font-family:"Courier New"'>05/25-14:34:16.889793
0:0:E8:EE:EC:88 -&gt; FF:FF:FF:FF:FF:FF type:0x800 len:0x51<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.5pt;
mso-bidi-font-size:10.0pt;font-family:"Trebuchet MS";mso-bidi-font-family:"Courier New"'>1.1.1.1
-&gt; 70.0.0.4 TCP TTL:5 TOS:0x4 ID:7 IpLen:20 DgmLen:67 MF<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.5pt;
mso-bidi-font-size:10.0pt;font-family:"Trebuchet MS";mso-bidi-font-family:"Courier New"'>Frag
Offset: 0x0000<span style="mso-spacerun: yes">   </span>Frag Size: 0x002F<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.5pt;
mso-bidi-font-size:10.0pt;font-family:"Trebuchet MS";mso-bidi-font-family:"Courier New"'>00
50 00 06 00 00 00 01 00 00 00 09 50 12 00 02<span style="mso-spacerun: yes"> 
</span>.P..........P...<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.5pt;
mso-bidi-font-size:10.0pt;font-family:"Trebuchet MS";mso-bidi-font-family:"Courier New"'>EA
70 03 00 56 69 6A 61 79 20 4D 75 6B 68 69 20<span style="mso-spacerun: yes"> 
</span>.p..Vijay Mukhi <o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.5pt;
mso-bidi-font-size:10.0pt;font-family:"Trebuchet MS";mso-bidi-font-family:"Courier New"'>69
73 20 61 20 67 72 65 61 74 20 67 75 79 0A<span style="mso-spacerun: yes">    
</span>is a great guy.<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:8.5pt;
mso-bidi-font-size:10.0pt;font-family:"Trebuchet MS";mso-bidi-font-family:"Courier New"'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.5pt;
mso-bidi-font-size:10.0pt;font-family:"Trebuchet MS";mso-bidi-font-family:"Courier New"'>Firstly,
snort acts like a sniffer. Therefore it sniffs all traffic on a network besides
the ones destined for the machine it is based on. So, when machine 70.0.0.1
sends a packet for 70.0.0.4, snort watches it. The course of events, wherein
first 70.0.0.1 send out an ARP packet for ethernet address 70.0.0.4 is
tracked.<span style="mso-spacerun: yes">  </span>Then when no reply is
received, it asks for IP address 0.0.0.0. Further when there is no response, it
sends out a broadcast packet with IP and TCP so that any machine can pick it
up. <o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:8.5pt;
mso-bidi-font-size:10.0pt;font-family:"Trebuchet MS";mso-bidi-font-family:"Courier New"'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.5pt;
mso-bidi-font-size:10.0pt;font-family:"Trebuchet MS";mso-bidi-font-family:"Courier New"'>It
is safer to use snort with the option -dev.<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:8.5pt;
mso-bidi-font-size:10.0pt;font-family:"Trebuchet MS";mso-bidi-font-family:"Courier New"'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.5pt;
mso-bidi-font-size:10.0pt;font-family:"Trebuchet MS";mso-bidi-font-family:"Courier New"'>The
above is the first mode of snort as a <b>packet sniffer</b>. <o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.5pt;
mso-bidi-font-size:10.0pt;font-family:"Trebuchet MS";mso-bidi-font-family:"Courier New"'>Secondly,
snort acts as a <b>packet logger</b>.<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:8.5pt;
mso-bidi-font-size:10.0pt;font-family:"Trebuchet MS";mso-bidi-font-family:"Courier New"'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.5pt;
mso-bidi-font-size:10.0pt;font-family:"Trebuchet MS";mso-bidi-font-family:"Courier New"'>&gt;snort
-dev -l vijay<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:8.5pt;
mso-bidi-font-size:10.0pt;font-family:"Trebuchet MS";mso-bidi-font-family:"Courier New"'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.5pt;
mso-bidi-font-size:10.0pt;font-family:"Trebuchet MS";mso-bidi-font-family:"Courier New"'>ERROR:
log directory 'vijay' does not exist<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.5pt;
mso-bidi-font-size:10.0pt;font-family:"Trebuchet MS";mso-bidi-font-family:"Courier New"'>Fatal
Error, Quitting..<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:8.5pt;
mso-bidi-font-size:10.0pt;font-family:"Trebuchet MS";mso-bidi-font-family:"Courier New"'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.5pt;
mso-bidi-font-size:10.0pt;font-family:"Trebuchet MS";mso-bidi-font-family:"Courier New"'>The
-l option demands logging of all packets in directory vijay. However, since
directory vijay does not exists it emits an error. We have no choice but to
create vijay in snort\bin.<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.5pt;
mso-bidi-font-size:10.0pt;font-family:"Trebuchet MS";mso-bidi-font-family:"Courier New"'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.5pt;
mso-bidi-font-size:10.0pt;font-family:"Trebuchet MS";mso-bidi-font-family:"Courier New"'>Snort\bin&gt;md
vijay<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.5pt;
mso-bidi-font-size:10.0pt;font-family:"Trebuchet MS";mso-bidi-font-family:"Courier New"'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.5pt;
mso-bidi-font-size:10.0pt;font-family:"Trebuchet MS";mso-bidi-font-family:"Courier New"'>Now
execute the previous snort command and then inject a package from nemesis. You
will see the following. The packets as before get displayed on the screen in
addition to it being logged in the vijay directory. The directory vijay shows
us three entities. First, is ARP.ids which refer to the ARP packets as always.<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:8.5pt;
mso-bidi-font-size:10.0pt;font-family:"Trebuchet MS";mso-bidi-font-family:"Courier New"'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.5pt;
mso-bidi-font-size:10.0pt;font-family:"Trebuchet MS";mso-bidi-font-family:"Courier New"'>ARP.ids<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.5pt;
mso-bidi-font-size:10.0pt;font-family:"Trebuchet MS";mso-bidi-font-family:"Courier New"'>05/25-14:42:57.718056
ARP who-has 70.0.0.4 (FF:FF:FF:FF:FF:FF) tell 70.0.0.1<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:8.5pt;
mso-bidi-font-size:10.0pt;font-family:"Trebuchet MS";mso-bidi-font-family:"Courier New"'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.5pt;
mso-bidi-font-size:10.0pt;font-family:"Trebuchet MS";mso-bidi-font-family:"Courier New"'>05/25-14:42:57.823351
ARP who-has 0.0.0.0 (FF:FF:FF:FF:FF:FF) tell 70.0.0.1<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:8.5pt;
mso-bidi-font-size:10.0pt;font-family:"Trebuchet MS";mso-bidi-font-family:"Courier New"'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.5pt;
mso-bidi-font-size:10.0pt;font-family:"Trebuchet MS";mso-bidi-font-family:"Courier New"'>Then
there is a directory called 1.1.1.1,<span style="mso-spacerun: yes"> 
</span>the source IP address is on our packet. <o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:8.5pt;
mso-bidi-font-size:10.0pt;font-family:"Trebuchet MS";mso-bidi-font-family:"Courier New"'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.5pt;
mso-bidi-font-size:10.0pt;font-family:"Trebuchet MS";mso-bidi-font-family:"Courier New"'>05/25-14:42:57.923964
0:0:E8:EE:EC:88 -&gt; FF:FF:FF:FF:FF:FF type:0x800 len:0x51<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.5pt;
mso-bidi-font-size:10.0pt;font-family:"Trebuchet MS";mso-bidi-font-family:"Courier New"'>1.1.1.1
-&gt; 70.0.0.4 TCP TTL:5 TOS:0x4 ID:7 IpLen:20 DgmLen:67 MF<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.5pt;
mso-bidi-font-size:10.0pt;font-family:"Trebuchet MS";mso-bidi-font-family:"Courier New"'>Frag
Offset: 0x0000<span style="mso-spacerun: yes">   </span>Frag Size: 0x002F<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.5pt;
mso-bidi-font-size:10.0pt;font-family:"Trebuchet MS";mso-bidi-font-family:"Courier New"'>00
50 00 06 00 00 00 01 00 00 00 09 50 12 00 02<span style="mso-spacerun: yes"> 
</span>.P..........P...<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.5pt;
mso-bidi-font-size:10.0pt;font-family:"Trebuchet MS";mso-bidi-font-family:"Courier New"'>EA
70 03 00 56 69 6A 61 79 20 4D 75 6B 68 69 20<span style="mso-spacerun: yes"> 
</span>.p..Vijay Mukhi <o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.5pt;
mso-bidi-font-size:10.0pt;font-family:"Trebuchet MS";mso-bidi-font-family:"Courier New"'>69
73 20 61 20 67 72 65 61 74 20 67 75 79 0A<span style="mso-spacerun: yes">    
</span>is a great guy.<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.5pt;
mso-bidi-font-size:10.0pt;font-family:"Trebuchet MS";mso-bidi-font-family:"Courier New"'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.5pt;
mso-bidi-font-size:10.0pt;font-family:"Trebuchet MS";mso-bidi-font-family:"Courier New"'>This
is the same packet as before. Also there is a third directory 70.0.0.1, that
logs packets from this IP address. <o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:8.5pt;
mso-bidi-font-size:10.0pt;font-family:"Trebuchet MS";mso-bidi-font-family:"Courier New"'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.5pt;
mso-bidi-font-size:10.0pt;font-family:"Trebuchet MS";mso-bidi-font-family:"Courier New"'>Thus
each time a packet comes in, the source ip address decides which directory it
goes under. This is a neat way of cataloging the packets as per the source who
sends it.<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.5pt;
mso-bidi-font-size:10.0pt;font-family:"Trebuchet MS";mso-bidi-font-family:"Courier New"'>---------------------<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:8.5pt;
mso-bidi-font-size:10.0pt;font-family:"Trebuchet MS";mso-bidi-font-family:"Courier New"'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.5pt;
mso-bidi-font-size:10.0pt;font-family:"Trebuchet MS";mso-bidi-font-family:"Courier New"'>Create
a file a.bat as in<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:8.5pt;
mso-bidi-font-size:10.0pt;font-family:"Trebuchet MS";mso-bidi-font-family:"Courier New"'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><u><span style='font-size:10.5pt;
mso-bidi-font-size:10.0pt;font-family:"Trebuchet MS";mso-bidi-font-family:"Courier New"'>a.bat<o:p></o:p></span></u></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.5pt;
mso-bidi-font-size:10.0pt;font-family:"Trebuchet MS";mso-bidi-font-family:"Courier New"'>rd
vijay /s<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.5pt;
mso-bidi-font-size:10.0pt;font-family:"Trebuchet MS";mso-bidi-font-family:"Courier New"'>md
vijay<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.5pt;
mso-bidi-font-size:10.0pt;font-family:"Trebuchet MS";mso-bidi-font-family:"Courier New"'>snort
-dev -l vijay -c a.conf<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:8.5pt;
mso-bidi-font-size:10.0pt;font-family:"Trebuchet MS";mso-bidi-font-family:"Courier New"'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.5pt;
mso-bidi-font-size:10.0pt;font-family:"Trebuchet MS";mso-bidi-font-family:"Courier New"'>The
-c option tells snort to read the rules present in snort.conf and apply these
rules to all packets on the network. We also delete the directory vijay so that
we can start from scratch each time. We also change the -DM flag to -DF which
indicates no fragmentation in nemesis.<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:8.5pt;
mso-bidi-font-size:10.0pt;font-family:"Trebuchet MS";mso-bidi-font-family:"Courier New"'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><u><span style='font-size:10.5pt;
mso-bidi-font-size:10.0pt;font-family:"Trebuchet MS";mso-bidi-font-family:"Courier New"'>a.conf<o:p></o:p></span></u></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.5pt;
mso-bidi-font-size:10.0pt;font-family:"Trebuchet MS";mso-bidi-font-family:"Courier New"'>alert
tcp any any -&gt; any any (msg:&quot;Rule 1&quot;; )<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:8.5pt;
mso-bidi-font-size:10.0pt;font-family:"Trebuchet MS";mso-bidi-font-family:"Courier New"'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.5pt;
mso-bidi-font-size:10.0pt;font-family:"Trebuchet MS";mso-bidi-font-family:"Courier New"'>Run
a.bat and in the vijay directory see the following<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:8.5pt;
mso-bidi-font-size:10.0pt;font-family:"Trebuchet MS";mso-bidi-font-family:"Courier New"'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.5pt;
mso-bidi-font-size:10.0pt;font-family:"Trebuchet MS";mso-bidi-font-family:"Courier New"'>alert.ids<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.5pt;
mso-bidi-font-size:10.0pt;font-family:"Trebuchet MS";mso-bidi-font-family:"Courier New"'>[**]
[1:0:0] Rule 1 [**]<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.5pt;
mso-bidi-font-size:10.0pt;font-family:"Trebuchet MS";mso-bidi-font-family:"Courier New"'>[Priority:
0] <o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.5pt;
mso-bidi-font-size:10.0pt;font-family:"Trebuchet MS";mso-bidi-font-family:"Courier New"'>05/25-14:51:58.819959
0:0:E8:EE:EC:88 -&gt; FF:FF:FF:FF:FF:FF type:0x800 len:0x51<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.5pt;
mso-bidi-font-size:10.0pt;font-family:"Trebuchet MS";mso-bidi-font-family:"Courier New"'>1.1.1.1:80
-&gt; 70.0.0.4:6 TCP TTL:5 TOS:0x4 ID:7 IpLen:20 DgmLen:67 DF<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.5pt;
mso-bidi-font-size:10.0pt;font-family:"Trebuchet MS";mso-bidi-font-family:"Courier New"'>***A**S*
Seq: 0x1<span style="mso-spacerun: yes">  </span>Ack: 0x9<span
style="mso-spacerun: yes">  </span>Win: 0x2<span style="mso-spacerun: yes"> 
</span>TcpLen: 20<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.5pt;
mso-bidi-font-size:10.0pt;font-family:"Trebuchet MS";mso-bidi-font-family:"Courier New"'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.5pt;
mso-bidi-font-size:10.0pt;font-family:"Trebuchet MS";mso-bidi-font-family:"Courier New"'>The
conf file carries snort rules. Each rule starts with the action snort has to
perform. alert means creating an alert . An alert is a notification when
something goes wrong. After tcp, the next two any are the source IP addresses
and port number. any is equivalent to all, which in english means match all
source IP addresses and port numbers on the packet. The -&gt; is a sign towards
destination . The next two any any refer to destination IP address and port. <o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:8.5pt;
mso-bidi-font-size:10.0pt;font-family:"Trebuchet MS";mso-bidi-font-family:"Courier New"'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.5pt;
mso-bidi-font-size:10.0pt;font-family:"Trebuchet MS";mso-bidi-font-family:"Courier New"'>Thus
our rule matches all packets. The () denotes option and the keyword msg
displays a message in the alert file. Thus as any packet matches our rule, we
see Rule 1 in stars. The rest of the packet simply gets repeated. <o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:8.5pt;
mso-bidi-font-size:10.0pt;font-family:"Trebuchet MS";mso-bidi-font-family:"Courier New"'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.5pt;
mso-bidi-font-size:10.0pt;font-family:"Trebuchet MS";mso-bidi-font-family:"Courier New"'>a.conf<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.5pt;
mso-bidi-font-size:10.0pt;font-family:"Trebuchet MS";mso-bidi-font-family:"Courier New"'>alert
tcp any any -&gt; any any (msg:&quot;Rule 1&quot;; )<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.5pt;
mso-bidi-font-size:10.0pt;font-family:"Trebuchet MS";mso-bidi-font-family:"Courier New"'>alert
tcp any any -&gt; any any (msg:&quot;Rule 2&quot;; )<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:8.5pt;
mso-bidi-font-size:10.0pt;font-family:"Trebuchet MS";mso-bidi-font-family:"Courier New"'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.5pt;
mso-bidi-font-size:10.0pt;font-family:"Trebuchet MS";mso-bidi-font-family:"Courier New"'>alert.ids<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.5pt;
mso-bidi-font-size:10.0pt;font-family:"Trebuchet MS";mso-bidi-font-family:"Courier New"'>[**]
[1:0:0] Rule 1 [**]<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.5pt;
mso-bidi-font-size:10.0pt;font-family:"Trebuchet MS";mso-bidi-font-family:"Courier New"'>[Priority:
0] <o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.5pt;
mso-bidi-font-size:10.0pt;font-family:"Trebuchet MS";mso-bidi-font-family:"Courier New"'>05/25-14:58:14.634010
0:0:E8:EE:EC:88 -&gt; FF:FF:FF:FF:FF:FF type:0x800 len:0x51<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.5pt;
mso-bidi-font-size:10.0pt;font-family:"Trebuchet MS";mso-bidi-font-family:"Courier New"'>1.1.1.1:80
-&gt; 70.0.0.4:6 TCP TTL:5 TOS:0x4 ID:7 IpLen:20 DgmLen:67 DF<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.5pt;
mso-bidi-font-size:10.0pt;font-family:"Trebuchet MS";mso-bidi-font-family:"Courier New"'>***A**S*
Seq: 0x1<span style="mso-spacerun: yes">  </span>Ack: 0x9<span
style="mso-spacerun: yes">  </span>Win: 0x2<span style="mso-spacerun: yes"> 
</span>TcpLen: 20<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:8.5pt;
mso-bidi-font-size:10.0pt;font-family:"Trebuchet MS";mso-bidi-font-family:"Courier New"'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.5pt;
mso-bidi-font-size:10.0pt;font-family:"Trebuchet MS";mso-bidi-font-family:"Courier New"'>[**]
[1:0:0] Rule 2 [**]<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.5pt;
mso-bidi-font-size:10.0pt;font-family:"Trebuchet MS";mso-bidi-font-family:"Courier New"'>[Priority:
0] <o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.5pt;
mso-bidi-font-size:10.0pt;font-family:"Trebuchet MS";mso-bidi-font-family:"Courier New"'>05/25-14:58:14.634010
0:0:E8:EE:EC:88 -&gt; FF:FF:FF:FF:FF:FF type:0x800 len:0x51<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.5pt;
mso-bidi-font-size:10.0pt;font-family:"Trebuchet MS";mso-bidi-font-family:"Courier New"'>1.1.1.1:80
-&gt; 70.0.0.4:6 TCP TTL:5 TOS:0x4 ID:7 IpLen:20 DgmLen:67 DF<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.5pt;
mso-bidi-font-size:10.0pt;font-family:"Trebuchet MS";mso-bidi-font-family:"Courier New"'>***A**S*
Seq: 0x1<span style="mso-spacerun: yes">  </span>Ack: 0x9<span
style="mso-spacerun: yes">  </span>Win: 0x2<span style="mso-spacerun: yes"> 
</span>TcpLen: 20<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:8.5pt;
mso-bidi-font-size:10.0pt;font-family:"Trebuchet MS";mso-bidi-font-family:"Courier New"'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.5pt;
mso-bidi-font-size:10.0pt;font-family:"Trebuchet MS";mso-bidi-font-family:"Courier New"'>One
more rule is added but with changes in the msg. Thus we get two alerts for the
one packet saying Rule 1 and Rule 2. We can raise as many alerts we want for a
rule. The syntax for any option is keyword colon ending in a ;. <o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:8.5pt;
mso-bidi-font-size:10.0pt;font-family:"Trebuchet MS";mso-bidi-font-family:"Courier New"'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.5pt;
mso-bidi-font-size:10.0pt;font-family:"Trebuchet MS";mso-bidi-font-family:"Courier New"'>a.conf<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.5pt;
mso-bidi-font-size:10.0pt;font-family:"Trebuchet MS";mso-bidi-font-family:"Courier New"'>alert
tcp any any -&gt; any any (msg:&quot;Rule 1&quot;;content:&quot;Vijay&quot;; )<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.5pt;
mso-bidi-font-size:10.0pt;font-family:"Trebuchet MS";mso-bidi-font-family:"Courier New"'>alert
tcp any any -&gt; any any (msg:&quot;Rule 2&quot;;content:&quot;sonal&quot;; )<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:8.5pt;
mso-bidi-font-size:10.0pt;font-family:"Trebuchet MS";mso-bidi-font-family:"Courier New"'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.5pt;
mso-bidi-font-size:10.0pt;font-family:"Trebuchet MS";mso-bidi-font-family:"Courier New"'>alert.ids<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.5pt;
mso-bidi-font-size:10.0pt;font-family:"Trebuchet MS";mso-bidi-font-family:"Courier New"'>[**]
[1:0:0] Rule 1 [**]<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.5pt;
mso-bidi-font-size:10.0pt;font-family:"Trebuchet MS";mso-bidi-font-family:"Courier New"'>[Priority:
0] <o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.5pt;
mso-bidi-font-size:10.0pt;font-family:"Trebuchet MS";mso-bidi-font-family:"Courier New"'>05/25-15:01:59.298876
0:0:E8:EE:EC:88 -&gt; FF:FF:FF:FF:FF:FF type:0x800 len:0x51<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.5pt;
mso-bidi-font-size:10.0pt;font-family:"Trebuchet MS";mso-bidi-font-family:"Courier New"'>1.1.1.1:80
-&gt; 70.0.0.4:6 TCP TTL:5 TOS:0x4 ID:7 IpLen:20 DgmLen:67 DF<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.5pt;
mso-bidi-font-size:10.0pt;font-family:"Trebuchet MS";mso-bidi-font-family:"Courier New"'>***A**S*
Seq: 0x1<span style="mso-spacerun: yes">  </span>Ack: 0x9<span
style="mso-spacerun: yes">  </span>Win: 0x2<span style="mso-spacerun: yes"> 
</span>TcpLen: 20<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:8.5pt;
mso-bidi-font-size:10.0pt;font-family:"Trebuchet MS";mso-bidi-font-family:"Courier New"'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.5pt;
mso-bidi-font-size:10.0pt;font-family:"Trebuchet MS";mso-bidi-font-family:"Courier New"'>We
now add a new option, content. This matches content of the packet. It is case
sensitive and as our payload carries Vijay Rule 1 matches but Rule 2 does not.
This is how an IDS can test for shellcode, viruses etc by looking at the
content that is flowing though. <o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.5pt;
mso-bidi-font-size:10.0pt;font-family:"Trebuchet MS";mso-bidi-font-family:"Courier New"'>We
change our payload file Vijay.txt to Vijay and sonal and get.<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:3.5pt;
mso-bidi-font-size:10.0pt;font-family:"Trebuchet MS";mso-bidi-font-family:"Courier New"'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.5pt;
mso-bidi-font-size:10.0pt;font-family:"Trebuchet MS";mso-bidi-font-family:"Courier New"'>a.conf
<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.5pt;
mso-bidi-font-size:10.0pt;font-family:"Trebuchet MS";mso-bidi-font-family:"Courier New"'>alert
tcp any any -&gt; any any (msg:&quot;Rule 1&quot;;content:&quot;Vijay&quot;; )<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.5pt;
mso-bidi-font-size:10.0pt;font-family:"Trebuchet MS";mso-bidi-font-family:"Courier New"'>alert
tcp any any -&gt; any any (msg:&quot;Rule 2&quot;;content:&quot;sonal&quot;; )<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.5pt;
mso-bidi-font-size:10.0pt;font-family:"Trebuchet MS";mso-bidi-font-family:"Courier New"'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.5pt;
mso-bidi-font-size:10.0pt;font-family:"Trebuchet MS";mso-bidi-font-family:"Courier New"'>alert.ids.<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.5pt;
mso-bidi-font-size:10.0pt;font-family:"Trebuchet MS";mso-bidi-font-family:"Courier New"'>[**]
[1:0:0] Rule 2 [**]<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.5pt;
mso-bidi-font-size:10.0pt;font-family:"Trebuchet MS";mso-bidi-font-family:"Courier New"'>[Priority:
0] <o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.5pt;
mso-bidi-font-size:10.0pt;font-family:"Trebuchet MS";mso-bidi-font-family:"Courier New"'>05/25-15:05:51.710700
0:0:E8:EE:EC:88 -&gt; FF:FF:FF:FF:FF:FF type:0x800 len:0x46<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.5pt;
mso-bidi-font-size:10.0pt;font-family:"Trebuchet MS";mso-bidi-font-family:"Courier New"'>1.1.1.1:80
-&gt; 70.0.0.4:6 TCP TTL:5 TOS:0x4 ID:7 IpLen:20 DgmLen:56 DF<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.5pt;
mso-bidi-font-size:10.0pt;font-family:"Trebuchet MS";mso-bidi-font-family:"Courier New"'>***A**S*
Seq: 0x1<span style="mso-spacerun: yes">  </span>Ack: 0x9<span
style="mso-spacerun: yes">  </span>Win: 0x2<span style="mso-spacerun: yes"> 
</span>TcpLen: 20<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:8.5pt;
mso-bidi-font-size:10.0pt;font-family:"Trebuchet MS";mso-bidi-font-family:"Courier New"'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.5pt;
mso-bidi-font-size:10.0pt;font-family:"Trebuchet MS";mso-bidi-font-family:"Courier New"'>[**]
[1:0:0] Rule 1 [**]<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.5pt;
mso-bidi-font-size:10.0pt;font-family:"Trebuchet MS";mso-bidi-font-family:"Courier New"'>[Priority:
0] <o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.5pt;
mso-bidi-font-size:10.0pt;font-family:"Trebuchet MS";mso-bidi-font-family:"Courier New"'>05/25-15:05:51.710700
0:0:E8:EE:EC:88 -&gt; FF:FF:FF:FF:FF:FF type:0x800 len:0x46<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.5pt;
mso-bidi-font-size:10.0pt;font-family:"Trebuchet MS";mso-bidi-font-family:"Courier New"'>1.1.1.1:80
-&gt; 70.0.0.4:6 TCP TTL:5 TOS:0x4 ID:7 IpLen:20 DgmLen:56 DF<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.5pt;
mso-bidi-font-size:10.0pt;font-family:"Trebuchet MS";mso-bidi-font-family:"Courier New"'>***A**S*
Seq: 0x1<span style="mso-spacerun: yes">  </span>Ack: 0x9<span
style="mso-spacerun: yes">  </span>Win: 0x2<span style="mso-spacerun: yes"> 
</span>TcpLen: 20<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:8.5pt;
mso-bidi-font-size:10.0pt;font-family:"Trebuchet MS";mso-bidi-font-family:"Courier New"'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.5pt;
mso-bidi-font-size:10.0pt;font-family:"Trebuchet MS";mso-bidi-font-family:"Courier New"'>The
above payload matches both the rules and therefore we get two alerts. Thus as
many alerts that match will get displayed. <o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:8.5pt;
mso-bidi-font-size:10.0pt;font-family:"Trebuchet MS";mso-bidi-font-family:"Courier New"'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.5pt;
mso-bidi-font-size:10.0pt;font-family:"Trebuchet MS";mso-bidi-font-family:"Courier New"'>nemesis
tcp -v<span style="mso-spacerun: yes">  </span>-P vijay.txt<span
style="mso-spacerun: yes">  </span>-S 1.1.1.1 -D 1.1.1.2<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.5pt;
mso-bidi-font-size:10.0pt;font-family:"Trebuchet MS";mso-bidi-font-family:"Courier New"'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.5pt;
mso-bidi-font-size:10.0pt;font-family:"Trebuchet MS";mso-bidi-font-family:"Courier New"'>vijay.txt<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.5pt;
mso-bidi-font-size:10.0pt;font-family:"Trebuchet MS";mso-bidi-font-family:"Courier New"'>vijay
and sonal<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.5pt;
mso-bidi-font-size:10.0pt;font-family:"Trebuchet MS";mso-bidi-font-family:"Courier New"'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.5pt;
mso-bidi-font-size:10.0pt;font-family:"Trebuchet MS";mso-bidi-font-family:"Courier New"'>alert
tcp any any -&gt; any any<span style="mso-spacerun: yes"> 
</span>(msg:&quot;Rule 1&quot;; content: &quot;VIJAY&quot;; )<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.5pt;
mso-bidi-font-size:10.0pt;font-family:"Trebuchet MS";mso-bidi-font-family:"Courier New"'>alert
tcp any any -&gt; any any<span style="mso-spacerun: yes"> 
</span>(msg:&quot;Rule 2&quot;; content: &quot;VIJAY&quot;; nocase;)<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.5pt;
mso-bidi-font-size:10.0pt;font-family:"Trebuchet MS";mso-bidi-font-family:"Courier New"'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.5pt;
mso-bidi-font-size:10.0pt;font-family:"Trebuchet MS";mso-bidi-font-family:"Courier New"'>[**]
[1:0:0] Rule 2 [**]<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.5pt;
mso-bidi-font-size:10.0pt;font-family:"Trebuchet MS";mso-bidi-font-family:"Courier New"'>[Priority:
0] <o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.5pt;
mso-bidi-font-size:10.0pt;font-family:"Trebuchet MS";mso-bidi-font-family:"Courier New"'>05/27-10:47:30.727080
0:0:E8:EE:EC:88 -&gt; FF:FF:FF:FF:FF:FF type:0x800 len:0x46<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.5pt;
mso-bidi-font-size:10.0pt;font-family:"Trebuchet MS";mso-bidi-font-family:"Courier New"'>1.1.1.1:65286
-&gt; 1.1.1.2:65286 TCP TTL:255 TOS:0x0 ID:65286 IpLen:20 DgmLen:56<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.5pt;
mso-bidi-font-size:10.0pt;font-family:"Trebuchet MS";mso-bidi-font-family:"Courier New"'>******S*
Seq: 0x22FEE4<span style="mso-spacerun: yes">  </span>Ack: 0x22FEE4<span
style="mso-spacerun: yes">  </span>Win: 0x1000<span style="mso-spacerun: yes"> 
</span>TcpLen: 20<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:8.5pt;
mso-bidi-font-size:10.0pt;font-family:"Trebuchet MS";mso-bidi-font-family:"Courier New"'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.5pt;
mso-bidi-font-size:10.0pt;font-family:"Trebuchet MS";mso-bidi-font-family:"Courier New"'>The
content keyword is case sensitive. The file vijay.txt contains vijay in lower
case and the rule contains VIJAY in upper case and hence no match. The second
rule uses the nocase keyword and hence there is a match. In this manner a case
insensitive match can be checked.<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:8.5pt;
mso-bidi-font-size:10.0pt;font-family:"Trebuchet MS";mso-bidi-font-family:"Courier New"'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.5pt;
mso-bidi-font-size:10.0pt;font-family:"Trebuchet MS";mso-bidi-font-family:"Courier New"'>nemessis<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.5pt;
mso-bidi-font-size:10.0pt;font-family:"Trebuchet MS";mso-bidi-font-family:"Courier New"'>nemesis
tcp -v<span style="mso-spacerun: yes">  </span>-P vijay.txt -x 1025 -y 80 -S
1.1.1.1 -D 70.0.0.4<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.5pt;
mso-bidi-font-size:10.0pt;font-family:"Trebuchet MS";mso-bidi-font-family:"Courier New"'>nemesis
tcp -v<span style="mso-spacerun: yes">  </span>-P vijay.txt -x 1025 -y 81 -S
1.1.1.1 -D 70.0.0.5<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:8.5pt;
mso-bidi-font-size:10.0pt;font-family:"Trebuchet MS";mso-bidi-font-family:"Courier New"'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.5pt;
mso-bidi-font-size:10.0pt;font-family:"Trebuchet MS";mso-bidi-font-family:"Courier New"'>a.conf<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.5pt;
mso-bidi-font-size:10.0pt;font-family:"Trebuchet MS";mso-bidi-font-family:"Courier New"'>alert
tcp any any -&gt; any 80 (msg:&quot;Http Packet&quot;; )<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:8.5pt;
mso-bidi-font-size:10.0pt;font-family:"Trebuchet MS";mso-bidi-font-family:"Courier New"'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.5pt;
mso-bidi-font-size:10.0pt;font-family:"Trebuchet MS";mso-bidi-font-family:"Courier New"'>alert.ids<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.5pt;
mso-bidi-font-size:10.0pt;font-family:"Trebuchet MS";mso-bidi-font-family:"Courier New"'>[**]
[1:0:0] Http Packet [**]<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.5pt;
mso-bidi-font-size:10.0pt;font-family:"Trebuchet MS";mso-bidi-font-family:"Courier New"'>[Priority:
0] <o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.5pt;
mso-bidi-font-size:10.0pt;font-family:"Trebuchet MS";mso-bidi-font-family:"Courier New"'>05/26-10:12:17.205436
0:0:E8:EE:EC:88 -&gt; FF:FF:FF:FF:FF:FF type:0x800 len:0x46<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.5pt;
mso-bidi-font-size:10.0pt;font-family:"Trebuchet MS";mso-bidi-font-family:"Courier New"'>1.1.1.1:1025
-&gt; 70.0.0.4:80 TCP TTL:255 TOS:0x0 ID:65286 IpLen:20 DgmLen:56<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.5pt;
mso-bidi-font-size:10.0pt;font-family:"Trebuchet MS";mso-bidi-font-family:"Courier New"'>******S*
Seq: 0x22FEE4<span style="mso-spacerun: yes">  </span>Ack: 0x22FEE4<span
style="mso-spacerun: yes">  </span>Win: 0x1000<span style="mso-spacerun: yes"> 
</span>TcpLen: 20<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.5pt;
mso-bidi-font-size:10.0pt;font-family:"Trebuchet MS";mso-bidi-font-family:"Courier New"'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.5pt;
mso-bidi-font-size:10.0pt;font-family:"Trebuchet MS";mso-bidi-font-family:"Courier New"'>One
of the many things that we may want is an alert on every http packet received.
Nemesis sends two packets: one<span style="mso-spacerun: yes">  </span>http
packet for IP address 70.0.0.4 and the destination port is 80 and the other
destined for port 81 with the IP address 70.0.0.5. The a.conf simply replaces
the word any with 80. This earlier meant that any port number would trigger the
event. Now only packets where the destination port number is 80 will trigger
the alert. Thus even though we have sent two packets and both get seen on the
console, only packet with IP address 70.0.0.4 or port 80 gets seen. Thus shows
how a specific port either source or destination can be filtered. Thus if we
are aware of a certain trojan using port 7777, an alert can be set for it.<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:8.5pt;
mso-bidi-font-size:10.0pt;font-family:"Trebuchet MS";mso-bidi-font-family:"Courier New"'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.5pt;
mso-bidi-font-size:10.0pt;font-family:"Trebuchet MS";mso-bidi-font-family:"Courier New"'>nemesis
tcp -v<span style="mso-spacerun: yes">  </span>-P vijay.txt -x 1025 -y 80 -S
1.1.1.1 -D 70.0.0.4<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.5pt;
mso-bidi-font-size:10.0pt;font-family:"Trebuchet MS";mso-bidi-font-family:"Courier New"'>nemesis
tcp -v<span style="mso-spacerun: yes">  </span>-P vijay.txt -x 1025 -y 1200 -S
1.1.1.1 -D 70.0.0.5<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:8.5pt;
mso-bidi-font-size:10.0pt;font-family:"Trebuchet MS";mso-bidi-font-family:"Courier New"'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.5pt;
mso-bidi-font-size:10.0pt;font-family:"Trebuchet MS";mso-bidi-font-family:"Courier New"'>a.conf<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.5pt;
mso-bidi-font-size:10.0pt;font-family:"Trebuchet MS";mso-bidi-font-family:"Courier New"'>alert
tcp any any -&gt; any 1024: (msg:&quot;Http Packet&quot;; )<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:8.5pt;
mso-bidi-font-size:10.0pt;font-family:"Trebuchet MS";mso-bidi-font-family:"Courier New"'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.5pt;
mso-bidi-font-size:10.0pt;font-family:"Trebuchet MS";mso-bidi-font-family:"Courier New"'>alert.ids<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.5pt;
mso-bidi-font-size:10.0pt;font-family:"Trebuchet MS";mso-bidi-font-family:"Courier New"'>[**]
[1:0:0] Http Packet [**]<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.5pt;
mso-bidi-font-size:10.0pt;font-family:"Trebuchet MS";mso-bidi-font-family:"Courier New"'>[Priority:
0] <o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.5pt;
mso-bidi-font-size:10.0pt;font-family:"Trebuchet MS";mso-bidi-font-family:"Courier New"'>05/26-10:22:46.664743
0:0:E8:EE:EC:88 -&gt; FF:FF:FF:FF:FF:FF type:0x800 len:0x46<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.5pt;
mso-bidi-font-size:10.0pt;font-family:"Trebuchet MS";mso-bidi-font-family:"Courier New"'>1.1.1.1:1025
-&gt; 70.0.0.5:1200 TCP TTL:255 TOS:0x0 ID:65286 IpLen:20 DgmLen:56<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.5pt;
mso-bidi-font-size:10.0pt;font-family:"Trebuchet MS";mso-bidi-font-family:"Courier New"'>******S*
Seq: 0x22FEE4<span style="mso-spacerun: yes">  </span>Ack: 0x22FEE4<span
style="mso-spacerun: yes">  </span>Win: 0x1000<span style="mso-spacerun: yes"> 
</span>TcpLen: 20<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:8.5pt;
mso-bidi-font-size:10.0pt;font-family:"Trebuchet MS";mso-bidi-font-family:"Courier New"'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.5pt;
mso-bidi-font-size:10.0pt;font-family:"Trebuchet MS";mso-bidi-font-family:"Courier New"'>Here
we want to catch any packet with the destination port larger than 1024. IANA
has reserved the first 1024 port for reserved services and hence the source
port should be and must be larger than 1024 but not the destination port.
Normally if the destination port is larger than 1024 we can safely assume that
we are connecting to an unknown service or un-standardized servers.Trojans have
to listen on ports larger than 1024. <o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:8.5pt;
mso-bidi-font-size:10.0pt;font-family:"Trebuchet MS";mso-bidi-font-family:"Courier New"'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.5pt;
mso-bidi-font-size:10.0pt;font-family:"Trebuchet MS";mso-bidi-font-family:"Courier New"'>In
our conf file we simply write the port number as 1024: signifying no upper
limit. This then defaults to 65536 thereby allowing us to capture all packets
which have a destination port number larger than 1024. Thus packet IP dest
70.0.0.4 does not trigger the alert whereas IP packet 70.0.0.5 does. <o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.5pt;
mso-bidi-font-size:10.0pt;font-family:"Trebuchet MS";mso-bidi-font-family:"Courier New"'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.5pt;
mso-bidi-font-size:10.0pt;font-family:"Trebuchet MS";mso-bidi-font-family:"Courier New"'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.5pt;
mso-bidi-font-size:10.0pt;font-family:"Trebuchet MS";mso-bidi-font-family:"Courier New"'>nemesis
tcp -v<span style="mso-spacerun: yes">  </span>-P vijay.txt -x 1025 -y 8000 -S
1.1.1.1 -D 70.0.0.4<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.5pt;
mso-bidi-font-size:10.0pt;font-family:"Trebuchet MS";mso-bidi-font-family:"Courier New"'>nemesis
tcp -v<span style="mso-spacerun: yes">  </span>-P vijay.txt -x 1025 -y 1200 -S
1.1.1.1 -D 70.0.0.5<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.5pt;
mso-bidi-font-size:10.0pt;font-family:"Trebuchet MS";mso-bidi-font-family:"Courier New"'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.5pt;
mso-bidi-font-size:10.0pt;font-family:"Trebuchet MS";mso-bidi-font-family:"Courier New"'>a.conf<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.5pt;
mso-bidi-font-size:10.0pt;font-family:"Trebuchet MS";mso-bidi-font-family:"Courier New"'>alert
tcp any any -&gt; any 1024:2400 (msg:&quot;Http Packet&quot;; )<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.5pt;
mso-bidi-font-size:10.0pt;font-family:"Trebuchet MS";mso-bidi-font-family:"Courier New"'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.5pt;
mso-bidi-font-size:10.0pt;font-family:"Trebuchet MS";mso-bidi-font-family:"Courier New"'>alert.ids<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.5pt;
mso-bidi-font-size:10.0pt;font-family:"Trebuchet MS";mso-bidi-font-family:"Courier New"'>[**]
[1:0:0] Http Packet [**]<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.5pt;
mso-bidi-font-size:10.0pt;font-family:"Trebuchet MS";mso-bidi-font-family:"Courier New"'>[Priority:
0] <o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.5pt;
mso-bidi-font-size:10.0pt;font-family:"Trebuchet MS";mso-bidi-font-family:"Courier New"'>05/26-10:28:48.206324
0:0:E8:EE:EC:88 -&gt; FF:FF:FF:FF:FF:FF type:0x800 len:0x46<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.5pt;
mso-bidi-font-size:10.0pt;font-family:"Trebuchet MS";mso-bidi-font-family:"Courier New"'>1.1.1.1:1025
-&gt; 70.0.0.5:1200 TCP TTL:255 TOS:0x0 ID:65286 IpLen:20 DgmLen:56<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.5pt;
mso-bidi-font-size:10.0pt;font-family:"Trebuchet MS";mso-bidi-font-family:"Courier New"'>******S*
Seq: 0x22FEE4<span style="mso-spacerun: yes">  </span>Ack: 0x22FEE4<span
style="mso-spacerun: yes">  </span>Win: 0x1000<span style="mso-spacerun: yes"> 
</span>TcpLen: 20<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.5pt;
mso-bidi-font-size:10.0pt;font-family:"Trebuchet MS";mso-bidi-font-family:"Courier New"'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.5pt;
mso-bidi-font-size:10.0pt;font-family:"Trebuchet MS";mso-bidi-font-family:"Courier New"'>We
now send two packets, one for port number 8000 the other for port number 1200.
In the conf file we specify a port number from 1024 to 2400. Thus the IP address
70.0.0.5 with port number 1200 triggers the alert. This example is to show you
the setting of maximum and minimum range.<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.5pt;
mso-bidi-font-size:10.0pt;font-family:"Trebuchet MS";mso-bidi-font-family:"Courier New"'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.5pt;
mso-bidi-font-size:10.0pt;font-family:"Trebuchet MS";mso-bidi-font-family:"Courier New"'>nemesis
tcp -v<span style="mso-spacerun: yes">  </span>-P vijay.txt -x 1025 -y 8000 -S
1.1.1.1 -D 70.0.0.4<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.5pt;
mso-bidi-font-size:10.0pt;font-family:"Trebuchet MS";mso-bidi-font-family:"Courier New"'>nemesis
tcp -v<span style="mso-spacerun: yes">  </span>-P vijay.txt -x 1025 -y 12 -S
1.1.1.1 -D 70.0.0.5<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.5pt;
mso-bidi-font-size:10.0pt;font-family:"Trebuchet MS";mso-bidi-font-family:"Courier New"'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.5pt;
mso-bidi-font-size:10.0pt;font-family:"Trebuchet MS";mso-bidi-font-family:"Courier New"'>alert
tcp any any -&gt; any !1024:2400 (msg:&quot;Http Packet&quot;; )<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.5pt;
mso-bidi-font-size:10.0pt;font-family:"Trebuchet MS";mso-bidi-font-family:"Courier New"'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.5pt;
mso-bidi-font-size:10.0pt;font-family:"Trebuchet MS";mso-bidi-font-family:"Courier New"'>[**]
[1:0:0] Http Packet [**]<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.5pt;
mso-bidi-font-size:10.0pt;font-family:"Trebuchet MS";mso-bidi-font-family:"Courier New"'>[Priority:
0] <o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.5pt;
mso-bidi-font-size:10.0pt;font-family:"Trebuchet MS";mso-bidi-font-family:"Courier New"'>05/26-10:32:30.374329
0:0:E8:EE:EC:88 -&gt; FF:FF:FF:FF:FF:FF type:0x800 len:0x46<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.5pt;
mso-bidi-font-size:10.0pt;font-family:"Trebuchet MS";mso-bidi-font-family:"Courier New"'>1.1.1.1:1025
-&gt; 70.0.0.4:8000 TCP TTL:255 TOS:0x0 ID:65286 IpLen:20 DgmLen:56<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.5pt;
mso-bidi-font-size:10.0pt;font-family:"Trebuchet MS";mso-bidi-font-family:"Courier New"'>******S*
Seq: 0x22FEE4<span style="mso-spacerun: yes">  </span>Ack: 0x22FEE4<span
style="mso-spacerun: yes">  </span>Win: 0x1000<span style="mso-spacerun: yes"> 
</span>TcpLen: 20<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.5pt;
mso-bidi-font-size:10.0pt;font-family:"Trebuchet MS";mso-bidi-font-family:"Courier New"'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.5pt;
mso-bidi-font-size:10.0pt;font-family:"Trebuchet MS";mso-bidi-font-family:"Courier New"'>The
! sign reverses the condition and therefore Ip address 70.0.0.4 with port
number 8000 triggers the alert and not ip address 70.0.0.5 with port number
1200. <o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.5pt;
mso-bidi-font-size:10.0pt;font-family:"Trebuchet MS";mso-bidi-font-family:"Courier New"'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.5pt;
mso-bidi-font-size:10.0pt;font-family:"Trebuchet MS";mso-bidi-font-family:"Courier New"'>alert
tcp any any -&gt; any 21,23 (msg:&quot;Services&quot;; )<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.5pt;
mso-bidi-font-size:10.0pt;font-family:"Trebuchet MS";mso-bidi-font-family:"Courier New"'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.5pt;
mso-bidi-font-size:10.0pt;font-family:"Trebuchet MS";mso-bidi-font-family:"Courier New"'>You
cannot specify different port numbers separated by commas.<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.5pt;
mso-bidi-font-size:10.0pt;font-family:"Trebuchet MS";mso-bidi-font-family:"Courier New"'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.5pt;
mso-bidi-font-size:10.0pt;font-family:"Trebuchet MS";mso-bidi-font-family:"Courier New"'>nemesis
tcp -v<span style="mso-spacerun: yes">  </span>-P vijay.txt -x 1025 -y 80 -S
1.1.1.1 -D 70.0.0.4<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.5pt;
mso-bidi-font-size:10.0pt;font-family:"Trebuchet MS";mso-bidi-font-family:"Courier New"'>nemesis
tcp -v<span style="mso-spacerun: yes">  </span>-P vijay.txt -x 10 -y 80 -S
1.1.1.1 -D 70.0.0.5<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.5pt;
mso-bidi-font-size:10.0pt;font-family:"Trebuchet MS";mso-bidi-font-family:"Courier New"'>nemesis
tcp -v<span style="mso-spacerun: yes">  </span>-P vijay.txt -x 1025 -y 1200 -S
1.1.1.1 -D 70.0.0.6<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.5pt;
mso-bidi-font-size:10.0pt;font-family:"Trebuchet MS";mso-bidi-font-family:"Courier New"'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.5pt;
mso-bidi-font-size:10.0pt;font-family:"Trebuchet MS";mso-bidi-font-family:"Courier New"'>alert
tcp any 1024: -&gt; any 80 (msg:&quot;HTTP&quot;; )<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.5pt;
mso-bidi-font-size:10.0pt;font-family:"Trebuchet MS";mso-bidi-font-family:"Courier New"'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.5pt;
mso-bidi-font-size:10.0pt;font-family:"Trebuchet MS";mso-bidi-font-family:"Courier New"'>[**]
[1:0:0] HTTP [**]<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.5pt;
mso-bidi-font-size:10.0pt;font-family:"Trebuchet MS";mso-bidi-font-family:"Courier New"'>[Priority:
0] <o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.5pt;
mso-bidi-font-size:10.0pt;font-family:"Trebuchet MS";mso-bidi-font-family:"Courier New"'>05/26-10:59:13.067022
0:0:E8:EE:EC:88 -&gt; FF:FF:FF:FF:FF:FF type:0x800 len:0x46<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.5pt;
mso-bidi-font-size:10.0pt;font-family:"Trebuchet MS";mso-bidi-font-family:"Courier New"'>1.1.1.1:1025
-&gt; 70.0.0.4:80 TCP TTL:255 TOS:0x0 ID:65286 IpLen:20 DgmLen:56<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.5pt;
mso-bidi-font-size:10.0pt;font-family:"Trebuchet MS";mso-bidi-font-family:"Courier New"'>******S*
Seq: 0x22FEE4<span style="mso-spacerun: yes">  </span>Ack: 0x22FEE4<span
style="mso-spacerun: yes">  </span>Win: 0x1000<span style="mso-spacerun: yes"> 
</span>TcpLen: 20<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.5pt;
mso-bidi-font-size:10.0pt;font-family:"Trebuchet MS";mso-bidi-font-family:"Courier New"'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.5pt;
mso-bidi-font-size:10.0pt;font-family:"Trebuchet MS";mso-bidi-font-family:"Courier New"'>For
an alert to be triggered on a http packet, the source port must be larger than
1024 and the destination port 80. The first IP address 70.0.0.4 matches as its
source port is 1025 larger than 1024 and the destination port 80. However, the
ip address 70.0.0.5 does not match as its source port is less than 1024 10 and
the last ip address 70.0.0.6 has both conditions not matching. <o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.5pt;
mso-bidi-font-size:10.0pt;font-family:"Trebuchet MS";mso-bidi-font-family:"Courier New"'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.5pt;
mso-bidi-font-size:10.0pt;font-family:"Trebuchet MS";mso-bidi-font-family:"Courier New"'>The
approach taken for the http protocol can now be implemented for a protocol that
could be a security risk. HTTP is not a security risk.<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.5pt;
mso-bidi-font-size:10.0pt;font-family:"Trebuchet MS";mso-bidi-font-family:"Courier New"'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.5pt;
mso-bidi-font-size:10.0pt;font-family:"Trebuchet MS";mso-bidi-font-family:"Courier New"'>nemesis
tcp -v<span style="mso-spacerun: yes">  </span>-P vijay.txt<span
style="mso-spacerun: yes">  </span>-S 1.1.1.1 -D 70.0.0.4<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.5pt;
mso-bidi-font-size:10.0pt;font-family:"Trebuchet MS";mso-bidi-font-family:"Courier New"'>nemesis
tcp -v<span style="mso-spacerun: yes">  </span>-P vijay.txt<span
style="mso-spacerun: yes">  </span>-S 2.2.2.2 -D 70.0.0.5<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.5pt;
mso-bidi-font-size:10.0pt;font-family:"Trebuchet MS";mso-bidi-font-family:"Courier New"'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.5pt;
mso-bidi-font-size:10.0pt;font-family:"Trebuchet MS";mso-bidi-font-family:"Courier New"'>alert
tcp 1.1.1.1 any -&gt; any any (msg:&quot;Bad IP found&quot;; )<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.5pt;
mso-bidi-font-size:10.0pt;font-family:"Trebuchet MS";mso-bidi-font-family:"Courier New"'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.5pt;
mso-bidi-font-size:10.0pt;font-family:"Trebuchet MS";mso-bidi-font-family:"Courier New"'>[**]
[1:0:0] Bad IP found [**]<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.5pt;
mso-bidi-font-size:10.0pt;font-family:"Trebuchet MS";mso-bidi-font-family:"Courier New"'>[Priority:
0] <o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.5pt;
mso-bidi-font-size:10.0pt;font-family:"Trebuchet MS";mso-bidi-font-family:"Courier New"'>05/26-11:03:58.737963
0:0:E8:EE:EC:88 -&gt; FF:FF:FF:FF:FF:FF type:0x800 len:0x46<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.5pt;
mso-bidi-font-size:10.0pt;font-family:"Trebuchet MS";mso-bidi-font-family:"Courier New"'>1.1.1.1:65286
-&gt; 70.0.0.4:65286 TCP TTL:255 TOS:0x0 ID:65286 IpLen:20 DgmLen:56<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.5pt;
mso-bidi-font-size:10.0pt;font-family:"Trebuchet MS";mso-bidi-font-family:"Courier New"'>******S*
Seq: 0x22FEE4<span style="mso-spacerun: yes">  </span>Ack: 0x22FEE4<span
style="mso-spacerun: yes">  </span>Win: 0x1000<span style="mso-spacerun: yes"> 
</span>TcpLen: 20<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.5pt;
mso-bidi-font-size:10.0pt;font-family:"Trebuchet MS";mso-bidi-font-family:"Courier New"'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.5pt;
mso-bidi-font-size:10.0pt;font-family:"Trebuchet MS";mso-bidi-font-family:"Courier New"'>Lets
apply the same logic of port numbers to IP addresses. We have identified IP
address 1.1.1.1 as the bad egg. So we alert whenever we get a packet from this
IP address. We send two packets from IP address 1.1.1.1 and 2.2.2.2 and only the
IP address 1.1.1.1 triggers the alert.<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.5pt;
mso-bidi-font-size:10.0pt;font-family:"Trebuchet MS";mso-bidi-font-family:"Courier New"'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.5pt;
mso-bidi-font-size:10.0pt;font-family:"Trebuchet MS";mso-bidi-font-family:"Courier New"'>alert
tcp [1.1.1.1,2.2.2.2]<span style="mso-spacerun: yes">  </span>any -&gt; any any
(msg:&quot;Bad IP found&quot;; )<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.5pt;
mso-bidi-font-size:10.0pt;font-family:"Trebuchet MS";mso-bidi-font-family:"Courier New"'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.5pt;
mso-bidi-font-size:10.0pt;font-family:"Trebuchet MS";mso-bidi-font-family:"Courier New"'>[**]
[1:0:0] Bad IP found [**]<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.5pt;
mso-bidi-font-size:10.0pt;font-family:"Trebuchet MS";mso-bidi-font-family:"Courier New"'>[Priority:
0] <o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.5pt;
mso-bidi-font-size:10.0pt;font-family:"Trebuchet MS";mso-bidi-font-family:"Courier New"'>05/26-11:07:05.538656
0:0:E8:EE:EC:88 -&gt; FF:FF:FF:FF:FF:FF type:0x800 len:0x46<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.5pt;
mso-bidi-font-size:10.0pt;font-family:"Trebuchet MS";mso-bidi-font-family:"Courier New"'>1.1.1.1:65286
-&gt; 70.0.0.4:65286 TCP TTL:255 TOS:0x0 ID:65286 IpLen:20 DgmLen:56<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.5pt;
mso-bidi-font-size:10.0pt;font-family:"Trebuchet MS";mso-bidi-font-family:"Courier New"'>******S*
Seq: 0x22FEE4<span style="mso-spacerun: yes">  </span>Ack: 0x22FEE4<span
style="mso-spacerun: yes">  </span>Win: 0x1000<span style="mso-spacerun: yes"> 
</span>TcpLen: 20<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.5pt;
mso-bidi-font-size:10.0pt;font-family:"Trebuchet MS";mso-bidi-font-family:"Courier New"'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.5pt;
mso-bidi-font-size:10.0pt;font-family:"Trebuchet MS";mso-bidi-font-family:"Courier New"'>[**]
[1:0:0] Bad IP found [**]<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.5pt;
mso-bidi-font-size:10.0pt;font-family:"Trebuchet MS";mso-bidi-font-family:"Courier New"'>[Priority:
0] <o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.5pt;
mso-bidi-font-size:10.0pt;font-family:"Trebuchet MS";mso-bidi-font-family:"Courier New"'>05/26-11:07:06.028921
0:0:E8:EE:EC:88 -&gt; FF:FF:FF:FF:FF:FF type:0x800 len:0x46<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.5pt;
mso-bidi-font-size:10.0pt;font-family:"Trebuchet MS";mso-bidi-font-family:"Courier New"'>2.2.2.2:65286
-&gt; 70.0.0.5:65286 TCP TTL:255 TOS:0x0 ID:65286 IpLen:20 DgmLen:56<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.5pt;
mso-bidi-font-size:10.0pt;font-family:"Trebuchet MS";mso-bidi-font-family:"Courier New"'>******S*
Seq: 0x22FEE4<span style="mso-spacerun: yes">  </span>Ack: 0x22FEE4<span
style="mso-spacerun: yes">  </span>Win: 0x1000<span style="mso-spacerun: yes"> 
</span>TcpLen: 20<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.5pt;
mso-bidi-font-size:10.0pt;font-family:"Trebuchet MS";mso-bidi-font-family:"Courier New"'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.5pt;
mso-bidi-font-size:10.0pt;font-family:"Trebuchet MS";mso-bidi-font-family:"Courier New"'>In
square brackets, two Ip addresses are added, therefore both packets trigger off
an alert. Using square brackets we can string multiple IP's together. Too bad
square brackets do not work with port numbers.<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.5pt;
mso-bidi-font-size:10.0pt;font-family:"Trebuchet MS";mso-bidi-font-family:"Courier New"'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.5pt;
mso-bidi-font-size:10.0pt;font-family:"Trebuchet MS";mso-bidi-font-family:"Courier New"'>nemesis
tcp -v<span style="mso-spacerun: yes">  </span>-P vijay.txt<span
style="mso-spacerun: yes">  </span>-S 1.1.1.0 -D 70.0.0.4<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.5pt;
mso-bidi-font-size:10.0pt;font-family:"Trebuchet MS";mso-bidi-font-family:"Courier New"'>nemesis
tcp -v<span style="mso-spacerun: yes">  </span>-P vijay.txt<span
style="mso-spacerun: yes">  </span>-S 1.1.1.1 -D 70.0.0.5<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.5pt;
mso-bidi-font-size:10.0pt;font-family:"Trebuchet MS";mso-bidi-font-family:"Courier New"'>nemesis
tcp -v<span style="mso-spacerun: yes">  </span>-P vijay.txt<span
style="mso-spacerun: yes">  </span>-S 1.1.1.2 -D 70.0.0.6<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.5pt;
mso-bidi-font-size:10.0pt;font-family:"Trebuchet MS";mso-bidi-font-family:"Courier New"'>nemesis
tcp -v<span style="mso-spacerun: yes">  </span>-P vijay.txt<span
style="mso-spacerun: yes">  </span>-S 1.1.1.3 -D 70.0.0.7<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.5pt;
mso-bidi-font-size:10.0pt;font-family:"Trebuchet MS";mso-bidi-font-family:"Courier New"'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.5pt;
mso-bidi-font-size:10.0pt;font-family:"Trebuchet MS";mso-bidi-font-family:"Courier New"'>alert
tcp 1.1.1.1/32<span style="mso-spacerun: yes">  </span>any -&gt; any any
(msg:&quot;Bad IP found&quot;; )<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.5pt;
mso-bidi-font-size:10.0pt;font-family:"Trebuchet MS";mso-bidi-font-family:"Courier New"'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.5pt;
mso-bidi-font-size:10.0pt;font-family:"Trebuchet MS";mso-bidi-font-family:"Courier New"'>[**]
[1:0:0] Bad IP found [**]<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.5pt;
mso-bidi-font-size:10.0pt;font-family:"Trebuchet MS";mso-bidi-font-family:"Courier New"'>[Priority:
0] <o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.5pt;
mso-bidi-font-size:10.0pt;font-family:"Trebuchet MS";mso-bidi-font-family:"Courier New"'>05/26-11:10:17.446850
0:0:E8:EE:EC:88 -&gt; FF:FF:FF:FF:FF:FF type:0x800 len:0x46<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.5pt;
mso-bidi-font-size:10.0pt;font-family:"Trebuchet MS";mso-bidi-font-family:"Courier New"'>1.1.1.1:65286
-&gt; 70.0.0.5:65286 TCP TTL:255 TOS:0x0 ID:65286 IpLen:20 DgmLen:56<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.5pt;
mso-bidi-font-size:10.0pt;font-family:"Trebuchet MS";mso-bidi-font-family:"Courier New"'>******S*
Seq: 0x22FEE4<span style="mso-spacerun: yes">  </span>Ack: 0x22FEE4<span
style="mso-spacerun: yes">  </span>Win: 0x1000<span style="mso-spacerun: yes"> 
</span>TcpLen: 20<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.5pt;
mso-bidi-font-size:10.0pt;font-family:"Trebuchet MS";mso-bidi-font-family:"Courier New"'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.5pt;
mso-bidi-font-size:10.0pt;font-family:"Trebuchet MS";mso-bidi-font-family:"Courier New"'>We
send 4 packets with IP address 1.1.1.0 to 1.1.1.3 but only one 1.1.1.1 sends
the alert. This is because 1.1.1.1/32 matches one IP address only 1.1.1.1. <o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.5pt;
mso-bidi-font-size:10.0pt;font-family:"Trebuchet MS";mso-bidi-font-family:"Courier New"'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.5pt;
mso-bidi-font-size:10.0pt;font-family:"Trebuchet MS";mso-bidi-font-family:"Courier New"'>alert
tcp 1.1.1.1/31<span style="mso-spacerun: yes">  </span>any -&gt; any any
(msg:&quot;Bad IP found&quot;; )<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.5pt;
mso-bidi-font-size:10.0pt;font-family:"Trebuchet MS";mso-bidi-font-family:"Courier New"'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.5pt;
mso-bidi-font-size:10.0pt;font-family:"Trebuchet MS";mso-bidi-font-family:"Courier New"'>[**]
[1:0:0] Bad IP found [**]<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.5pt;
mso-bidi-font-size:10.0pt;font-family:"Trebuchet MS";mso-bidi-font-family:"Courier New"'>[Priority:
0] <o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.5pt;
mso-bidi-font-size:10.0pt;font-family:"Trebuchet MS";mso-bidi-font-family:"Courier New"'>05/26-11:12:22.433408
0:0:E8:EE:EC:88 -&gt; FF:FF:FF:FF:FF:FF type:0x800 len:0x46<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.5pt;
mso-bidi-font-size:10.0pt;font-family:"Trebuchet MS";mso-bidi-font-family:"Courier New"'>1.1.1.0:65286
-&gt; 70.0.0.4:65286 TCP TTL:255 TOS:0x0 ID:65286 IpLen:20 DgmLen:56<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.5pt;
mso-bidi-font-size:10.0pt;font-family:"Trebuchet MS";mso-bidi-font-family:"Courier New"'>******S*
Seq: 0x22FEE4<span style="mso-spacerun: yes">  </span>Ack: 0x22FEE4<span
style="mso-spacerun: yes">  </span>Win: 0x1000<span style="mso-spacerun: yes"> 
</span>TcpLen: 20<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.5pt;
mso-bidi-font-size:10.0pt;font-family:"Trebuchet MS";mso-bidi-font-family:"Courier New"'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.5pt;
mso-bidi-font-size:10.0pt;font-family:"Trebuchet MS";mso-bidi-font-family:"Courier New"'>[**]
[1:0:0] Bad IP found [**]<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.5pt;
mso-bidi-font-size:10.0pt;font-family:"Trebuchet MS";mso-bidi-font-family:"Courier New"'>[Priority:
0] <o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.5pt;
mso-bidi-font-size:10.0pt;font-family:"Trebuchet MS";mso-bidi-font-family:"Courier New"'>05/26-11:12:22.914141
0:0:E8:EE:EC:88 -&gt; FF:FF:FF:FF:FF:FF type:0x800 len:0x46<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.5pt;
mso-bidi-font-size:10.0pt;font-family:"Trebuchet MS";mso-bidi-font-family:"Courier New"'>1.1.1.1:65286
-&gt; 70.0.0.5:65286 TCP TTL:255 TOS:0x0 ID:65286 IpLen:20 DgmLen:56<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.5pt;
mso-bidi-font-size:10.0pt;font-family:"Trebuchet MS";mso-bidi-font-family:"Courier New"'>******S*
Seq: 0x22FEE4<span style="mso-spacerun: yes">  </span>Ack: 0x22FEE4<span
style="mso-spacerun: yes">  </span>Win: 0x1000<span style="mso-spacerun: yes"> 
</span>TcpLen: 20<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.5pt;
mso-bidi-font-size:10.0pt;font-family:"Trebuchet MS";mso-bidi-font-family:"Courier New"'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.5pt;
mso-bidi-font-size:10.0pt;font-family:"Trebuchet MS";mso-bidi-font-family:"Courier New"'>Now
two packets match as 1.1.1.1/31 stands for 1.1.1.0 and 1.1.1.1. <o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.5pt;
mso-bidi-font-size:10.0pt;font-family:"Trebuchet MS";mso-bidi-font-family:"Courier New"'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.5pt;
mso-bidi-font-size:10.0pt;font-family:"Trebuchet MS";mso-bidi-font-family:"Courier New"'>nemesis
tcp -v<span style="mso-spacerun: yes">  </span>-P vijay.txt<span
style="mso-spacerun: yes">  </span>-S 1.1.1.0 -D 70.0.0.4<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.5pt;
mso-bidi-font-size:10.0pt;font-family:"Trebuchet MS";mso-bidi-font-family:"Courier New"'>nemesis
tcp -v<span style="mso-spacerun: yes">  </span>-P vijay.txt<span
style="mso-spacerun: yes">  </span>-S 1.1.1.1 -D 70.0.0.5<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.5pt;
mso-bidi-font-size:10.0pt;font-family:"Trebuchet MS";mso-bidi-font-family:"Courier New"'>nemesis
tcp -v<span style="mso-spacerun: yes">  </span>-P vijay.txt<span
style="mso-spacerun: yes">  </span>-S 1.1.1.2 -D 70.0.0.6<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.5pt;
mso-bidi-font-size:10.0pt;font-family:"Trebuchet MS";mso-bidi-font-family:"Courier New"'>nemesis
tcp -v<span style="mso-spacerun: yes">  </span>-P vijay.txt<span
style="mso-spacerun: yes">  </span>-S 1.1.1.3 -D 70.0.0.7<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.5pt;
mso-bidi-font-size:10.0pt;font-family:"Trebuchet MS";mso-bidi-font-family:"Courier New"'>nemesis
tcp -v<span style="mso-spacerun: yes">  </span>-P vijay.txt<span
style="mso-spacerun: yes">  </span>-S 1.1.1.4 -D 70.0.0.7<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.5pt;
mso-bidi-font-size:10.0pt;font-family:"Trebuchet MS";mso-bidi-font-family:"Courier New"'>nemesis
tcp -v<span style="mso-spacerun: yes">  </span>-P vijay.txt<span
style="mso-spacerun: yes">  </span>-S 1.1.1.5 -D 70.0.0.7<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.5pt;
mso-bidi-font-size:10.0pt;font-family:"Trebuchet MS";mso-bidi-font-family:"Courier New"'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.5pt;
mso-bidi-font-size:10.0pt;font-family:"Trebuchet MS";mso-bidi-font-family:"Courier New"'>alert
tcp 1.1.1.1/30<span style="mso-spacerun: yes">  </span>any -&gt; any any
(msg:&quot;Bad IP found&quot;; )<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.5pt;
mso-bidi-font-size:10.0pt;font-family:"Trebuchet MS";mso-bidi-font-family:"Courier New"'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.5pt;
mso-bidi-font-size:10.0pt;font-family:"Trebuchet MS";mso-bidi-font-family:"Courier New"'>[**]
[1:0:0] Bad IP found [**]<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.5pt;
mso-bidi-font-size:10.0pt;font-family:"Trebuchet MS";mso-bidi-font-family:"Courier New"'>[Priority:
0] <o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.5pt;
mso-bidi-font-size:10.0pt;font-family:"Trebuchet MS";mso-bidi-font-family:"Courier New"'>05/26-11:14:16.218506
0:0:E8:EE:EC:88 -&gt; FF:FF:FF:FF:FF:FF type:0x800 len:0x46<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.5pt;
mso-bidi-font-size:10.0pt;font-family:"Trebuchet MS";mso-bidi-font-family:"Courier New"'>1.1.1.0:65286
-&gt; 70.0.0.4:65286 TCP TTL:255 TOS:0x0 ID:65286 IpLen:20 DgmLen:56<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.5pt;
mso-bidi-font-size:10.0pt;font-family:"Trebuchet MS";mso-bidi-font-family:"Courier New"'>******S*
Seq: 0x22FEE4<span style="mso-spacerun: yes">  </span>Ack: 0x22FEE4<span
style="mso-spacerun: yes">  </span>Win: 0x1000<span style="mso-spacerun: yes"> 
</span>TcpLen: 20<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.5pt;
mso-bidi-font-size:10.0pt;font-family:"Trebuchet MS";mso-bidi-font-family:"Courier New"'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.5pt;
mso-bidi-font-size:10.0pt;font-family:"Trebuchet MS";mso-bidi-font-family:"Courier New"'>[**]
[1:0:0] Bad IP found [**]<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.5pt;
mso-bidi-font-size:10.0pt;font-family:"Trebuchet MS";mso-bidi-font-family:"Courier New"'>[Priority:
0] <o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.5pt;
mso-bidi-font-size:10.0pt;font-family:"Trebuchet MS";mso-bidi-font-family:"Courier New"'>05/26-11:14:16.699272
0:0:E8:EE:EC:88 -&gt; FF:FF:FF:FF:FF:FF type:0x800 len:0x46<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.5pt;
mso-bidi-font-size:10.0pt;font-family:"Trebuchet MS";mso-bidi-font-family:"Courier New"'>1.1.1.1:65286
-&gt; 70.0.0.5:65286 TCP TTL:255 TOS:0x0 ID:65286 IpLen:20 DgmLen:56<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.5pt;
mso-bidi-font-size:10.0pt;font-family:"Trebuchet MS";mso-bidi-font-family:"Courier New"'>******S*
Seq: 0x22FEE4<span style="mso-spacerun: yes">  </span>Ack: 0x22FEE4<span
style="mso-spacerun: yes">  </span>Win: 0x1000<span style="mso-spacerun: yes"> 
</span>TcpLen: 20<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.5pt;
mso-bidi-font-size:10.0pt;font-family:"Trebuchet MS";mso-bidi-font-family:"Courier New"'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.5pt;
mso-bidi-font-size:10.0pt;font-family:"Trebuchet MS";mso-bidi-font-family:"Courier New"'>[**]
[1:0:0] Bad IP found [**]<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.5pt;
mso-bidi-font-size:10.0pt;font-family:"Trebuchet MS";mso-bidi-font-family:"Courier New"'>[Priority:
0] <o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.5pt;
mso-bidi-font-size:10.0pt;font-family:"Trebuchet MS";mso-bidi-font-family:"Courier New"'>05/26-11:14:17.179932
0:0:E8:EE:EC:88 -&gt; FF:FF:FF:FF:FF:FF type:0x800 len:0x46<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.5pt;
mso-bidi-font-size:10.0pt;font-family:"Trebuchet MS";mso-bidi-font-family:"Courier New"'>1.1.1.2:65286
-&gt; 70.0.0.6:65286 TCP TTL:255 TOS:0x0 ID:65286 IpLen:20 DgmLen:56<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.5pt;
mso-bidi-font-size:10.0pt;font-family:"Trebuchet MS";mso-bidi-font-family:"Courier New"'>******S*
Seq: 0x22FEE4<span style="mso-spacerun: yes">  </span>Ack: 0x22FEE4<span
style="mso-spacerun: yes">  </span>Win: 0x1000<span style="mso-spacerun: yes"> 
</span>TcpLen: 20<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.5pt;
mso-bidi-font-size:10.0pt;font-family:"Trebuchet MS";mso-bidi-font-family:"Courier New"'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.5pt;
mso-bidi-font-size:10.0pt;font-family:"Trebuchet MS";mso-bidi-font-family:"Courier New"'>[**]
[1:0:0] Bad IP found [**]<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.5pt;
mso-bidi-font-size:10.0pt;font-family:"Trebuchet MS";mso-bidi-font-family:"Courier New"'>[Priority:
0] <o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.5pt;
mso-bidi-font-size:10.0pt;font-family:"Trebuchet MS";mso-bidi-font-family:"Courier New"'>05/26-11:14:17.670646
0:0:E8:EE:EC:88 -&gt; FF:FF:FF:FF:FF:FF type:0x800 len:0x46<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.5pt;
mso-bidi-font-size:10.0pt;font-family:"Trebuchet MS";mso-bidi-font-family:"Courier New"'>1.1.1.3:65286
-&gt; 70.0.0.7:65286 TCP TTL:255 TOS:0x0 ID:65286 IpLen:20 DgmLen:56<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.5pt;
mso-bidi-font-size:10.0pt;font-family:"Trebuchet MS";mso-bidi-font-family:"Courier New"'>******S*
Seq: 0x22FEE4<span style="mso-spacerun: yes">  </span>Ack: 0x22FEE4<span
style="mso-spacerun: yes">  </span>Win: 0x1000<span style="mso-spacerun: yes"> 
</span>TcpLen: 20<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.5pt;
mso-bidi-font-size:10.0pt;font-family:"Trebuchet MS";mso-bidi-font-family:"Courier New"'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.5pt;
mso-bidi-font-size:10.0pt;font-family:"Trebuchet MS";mso-bidi-font-family:"Courier New"'>1.1.1.1/30
stands for four IP addresses 1.1.1.10 to 1.1.1.3. The last one 1.1.1.4 does not
match. This is called CIDR or classless Inter Domain Routing. A class C address
is /24, class B /16 and class A /8. This is how internet addresses are given
out these days, you get a number of IP addresses which is a power of 2. <o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.5pt;
mso-bidi-font-size:10.0pt;font-family:"Trebuchet MS";mso-bidi-font-family:"Courier New"'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.5pt;
mso-bidi-font-size:10.0pt;font-family:"Trebuchet MS";mso-bidi-font-family:"Courier New"'>nemesis
tcp -v<span style="mso-spacerun: yes">  </span>-P vijay.txt<span
style="mso-spacerun: yes">  </span>-S 1.1.1.0 -D 70.0.0.4<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.5pt;
mso-bidi-font-size:10.0pt;font-family:"Trebuchet MS";mso-bidi-font-family:"Courier New"'>nemesis
tcp -v<span style="mso-spacerun: yes">  </span>-P vijay.txt<span
style="mso-spacerun: yes">  </span>-S 1.1.2.1 -D 70.0.0.5<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.5pt;
mso-bidi-font-size:10.0pt;font-family:"Trebuchet MS";mso-bidi-font-family:"Courier New"'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.5pt;
mso-bidi-font-size:10.0pt;font-family:"Trebuchet MS";mso-bidi-font-family:"Courier New"'>alert
tcp 1.1.1.1/24<span style="mso-spacerun: yes">  </span>any -&gt; any any
(msg:&quot;Bad IP found&quot;; )<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.5pt;
mso-bidi-font-size:10.0pt;font-family:"Trebuchet MS";mso-bidi-font-family:"Courier New"'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.5pt;
mso-bidi-font-size:10.0pt;font-family:"Trebuchet MS";mso-bidi-font-family:"Courier New"'>[**]
[1:0:0] Bad IP found [**]<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.5pt;
mso-bidi-font-size:10.0pt;font-family:"Trebuchet MS";mso-bidi-font-family:"Courier New"'>[Priority:
0] <o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.5pt;
mso-bidi-font-size:10.0pt;font-family:"Trebuchet MS";mso-bidi-font-family:"Courier New"'>05/26-11:17:31.750052
0:0:E8:EE:EC:88 -&gt; FF:FF:FF:FF:FF:FF type:0x800 len:0x46<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.5pt;
mso-bidi-font-size:10.0pt;font-family:"Trebuchet MS";mso-bidi-font-family:"Courier New"'>1.1.1.0:65286
-&gt; 70.0.0.4:65286 TCP TTL:255 TOS:0x0 ID:65286 IpLen:20 DgmLen:56<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.5pt;
mso-bidi-font-size:10.0pt;font-family:"Trebuchet MS";mso-bidi-font-family:"Courier New"'>******S*
Seq: 0x22FEE4<span style="mso-spacerun: yes">  </span>Ack: 0x22FEE4<span
style="mso-spacerun: yes">  </span>Win: 0x1000<span style="mso-spacerun: yes"> 
</span>TcpLen: 20<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.5pt;
mso-bidi-font-size:10.0pt;font-family:"Trebuchet MS";mso-bidi-font-family:"Courier New"'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.5pt;
mso-bidi-font-size:10.0pt;font-family:"Trebuchet MS";mso-bidi-font-family:"Courier New"'>We
assume that 1.1.1 is a class C address. Thus 1.1.1.1/24 matches any IP address
starting with 1.1.1. Even though we specified 1.1.1.1 and not 1.1.1.0 it
matches 1.1.1.0. The 1.1.2.1 does not match. As a result, an alert can be
triggered off on an entire class of addresses.<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.5pt;
mso-bidi-font-size:10.0pt;font-family:"Trebuchet MS";mso-bidi-font-family:"Courier New"'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.5pt;
mso-bidi-font-size:10.0pt;font-family:"Trebuchet MS";mso-bidi-font-family:"Courier New"'>nemesis
tcp -v<span style="mso-spacerun: yes">  </span>-P vijay.txt<span
style="mso-spacerun: yes">  </span>-S 1.1.1.0 -D 70.0.0.4<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.5pt;
mso-bidi-font-size:10.0pt;font-family:"Trebuchet MS";mso-bidi-font-family:"Courier New"'>nemesis
tcp -v<span style="mso-spacerun: yes">  </span>-P vijay.txt<span
style="mso-spacerun: yes">  </span>-S 2.2.2.2 -D 70.0.0.5<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.5pt;
mso-bidi-font-size:10.0pt;font-family:"Trebuchet MS";mso-bidi-font-family:"Courier New"'>nemesis
tcp -v<span style="mso-spacerun: yes">  </span>-P vijay.txt<span
style="mso-spacerun: yes">  </span>-S 3.2.2.2 -D 70.0.0.5<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.5pt;
mso-bidi-font-size:10.0pt;font-family:"Trebuchet MS";mso-bidi-font-family:"Courier New"'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.5pt;
mso-bidi-font-size:10.0pt;font-family:"Trebuchet MS";mso-bidi-font-family:"Courier New"'>alert
tcp ![1.1.1.1/24,2.2.2.2]<span style="mso-spacerun: yes">  </span>any -&gt; any
any (msg:&quot;Bad IP found&quot;; )<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.5pt;
mso-bidi-font-size:10.0pt;font-family:"Trebuchet MS";mso-bidi-font-family:"Courier New"'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.5pt;
mso-bidi-font-size:10.0pt;font-family:"Trebuchet MS";mso-bidi-font-family:"Courier New"'>[**]
[1:0:0] Bad IP found [**]<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.5pt;
mso-bidi-font-size:10.0pt;font-family:"Trebuchet MS";mso-bidi-font-family:"Courier New"'>[Priority:
0] <o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.5pt;
mso-bidi-font-size:10.0pt;font-family:"Trebuchet MS";mso-bidi-font-family:"Courier New"'>05/26-11:21:19.657660
0:0:E8:EE:EC:88 -&gt; FF:FF:FF:FF:FF:FF type:0x800 len:0x46<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.5pt;
mso-bidi-font-size:10.0pt;font-family:"Trebuchet MS";mso-bidi-font-family:"Courier New"'>3.2.2.2:65286
-&gt; 70.0.0.5:65286 TCP TTL:255 TOS:0x0 ID:65286 IpLen:20 DgmLen:56<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.5pt;
mso-bidi-font-size:10.0pt;font-family:"Trebuchet MS";mso-bidi-font-family:"Courier New"'>******S*
Seq: 0x22FEE4<span style="mso-spacerun: yes">  </span>Ack: 0x22FEE4<span
style="mso-spacerun: yes">  </span>Win: 0x1000<span style="mso-spacerun: yes"> 
</span>TcpLen: 20<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.5pt;
mso-bidi-font-size:10.0pt;font-family:"Trebuchet MS";mso-bidi-font-family:"Courier New"'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.5pt;
mso-bidi-font-size:10.0pt;font-family:"Trebuchet MS";mso-bidi-font-family:"Courier New"'>Our
home network is the C class IP address 1.1.1 and thus we do not want any of our
machines triggering off an alert on them. Also 2.2.2.2 is on our network.<span
style="mso-spacerun: yes">  </span>Since these two blocks are not to be
considered, we use the negation operator to make sure that no machine on our
network triggers off an alert on them.<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.5pt;
mso-bidi-font-size:10.0pt;font-family:"Trebuchet MS";mso-bidi-font-family:"Courier New"'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.5pt;
mso-bidi-font-size:10.0pt;font-family:"Trebuchet MS";mso-bidi-font-family:"Courier New"'>Thus
we have triggered alerts on source and destination ports and IP addresses. Lets
now generate alerts on protocol.<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.5pt;
mso-bidi-font-size:10.0pt;font-family:"Trebuchet MS";mso-bidi-font-family:"Courier New"'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.5pt;
mso-bidi-font-size:10.0pt;font-family:"Trebuchet MS";mso-bidi-font-family:"Courier New"'>alert
icmp<span style="mso-spacerun: yes">  </span>any any -&gt; any any
(msg:&quot;icmp packet detected&quot;; )<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.5pt;
mso-bidi-font-size:10.0pt;font-family:"Trebuchet MS";mso-bidi-font-family:"Courier New"'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.5pt;
mso-bidi-font-size:10.0pt;font-family:"Trebuchet MS";mso-bidi-font-family:"Courier New"'>[**]
[1:0:0] icmp packet detected [**]<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.5pt;
mso-bidi-font-size:10.0pt;font-family:"Trebuchet MS";mso-bidi-font-family:"Courier New"'>[Priority:
0] <o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.5pt;
mso-bidi-font-size:10.0pt;font-family:"Trebuchet MS";mso-bidi-font-family:"Courier New"'>05/26-13:09:38.419103
0:0:E8:EE:EC:88 -&gt; 0:0:E8:DF:60:57 type:0x800 len:0x4A<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.5pt;
mso-bidi-font-size:10.0pt;font-family:"Trebuchet MS";mso-bidi-font-family:"Courier New"'>70.0.0.1
-&gt; 70.0.0.3 ICMP TTL:128 TOS:0x0 ID:3945 IpLen:20 DgmLen:60<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.5pt;
mso-bidi-font-size:10.0pt;font-family:"Trebuchet MS";mso-bidi-font-family:"Courier New"'>Type:8<span
style="mso-spacerun: yes">  </span>Code:0<span style="mso-spacerun: yes"> 
</span>ID:512<span style="mso-spacerun: yes">   </span>Seq:256<span
style="mso-spacerun: yes">  </span>ECHO<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.5pt;
mso-bidi-font-size:10.0pt;font-family:"Trebuchet MS";mso-bidi-font-family:"Courier New"'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.5pt;
mso-bidi-font-size:10.0pt;font-family:"Trebuchet MS";mso-bidi-font-family:"Courier New"'>On
sending the same three packets on the network, we get no alert as we have
changed our protocol to icmp. Thus tcp packets will give us no alerts. We then
run ping on 70.0.0.1 as<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.5pt;
mso-bidi-font-size:10.0pt;font-family:"Trebuchet MS";mso-bidi-font-family:"Courier New"'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.5pt;
mso-bidi-font-size:10.0pt;font-family:"Trebuchet MS";mso-bidi-font-family:"Courier New"'>ping
70.0.0.3<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.5pt;
mso-bidi-font-size:10.0pt;font-family:"Trebuchet MS";mso-bidi-font-family:"Courier New"'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.5pt;
mso-bidi-font-size:10.0pt;font-family:"Trebuchet MS";mso-bidi-font-family:"Courier New"'>This
sends a large number of ping packets on the network thus triggering a large
number of alerts.<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.5pt;
mso-bidi-font-size:10.0pt;font-family:"Trebuchet MS";mso-bidi-font-family:"Courier New"'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.5pt;
mso-bidi-font-size:10.0pt;font-family:"Trebuchet MS";mso-bidi-font-family:"Courier New"'>nemesis
tcp -v<span style="mso-spacerun: yes">  </span>-P vijay.txt<span
style="mso-spacerun: yes">  </span>-S 1.1.1.0 -D 70.0.0.4<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.5pt;
mso-bidi-font-size:10.0pt;font-family:"Trebuchet MS";mso-bidi-font-family:"Courier New"'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.5pt;
mso-bidi-font-size:10.0pt;font-family:"Trebuchet MS";mso-bidi-font-family:"Courier New"'>Vijay.txt<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.5pt;
mso-bidi-font-size:10.0pt;font-family:"Trebuchet MS";mso-bidi-font-family:"Courier New"'>vijay
and sonal<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.5pt;
mso-bidi-font-size:10.0pt;font-family:"Trebuchet MS";mso-bidi-font-family:"Courier New"'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.5pt;
mso-bidi-font-size:10.0pt;font-family:"Trebuchet MS";mso-bidi-font-family:"Courier New"'>alert
tcp any any -&gt; any any (msg:&quot;Rule 1&quot;;content:
&quot;vijay&quot;;offset: 0;)<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.5pt;
mso-bidi-font-size:10.0pt;font-family:"Trebuchet MS";mso-bidi-font-family:"Courier New"'>alert
tcp any any -&gt; any any (msg:&quot;Rule 2&quot;;content: &quot;vijay&quot;;
offset: 1;)<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.5pt;
mso-bidi-font-size:10.0pt;font-family:"Trebuchet MS";mso-bidi-font-family:"Courier New"'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.5pt;
mso-bidi-font-size:10.0pt;font-family:"Trebuchet MS";mso-bidi-font-family:"Courier New"'>[**]
[1:0:0] Rule 1 [**]<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.5pt;
mso-bidi-font-size:10.0pt;font-family:"Trebuchet MS";mso-bidi-font-family:"Courier New"'>[Priority:
0] <o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.5pt;
mso-bidi-font-size:10.0pt;font-family:"Trebuchet MS";mso-bidi-font-family:"Courier New"'>05/26-13:22:46.566844
0:0:E8:EE:EC:88 -&gt; FF:FF:FF:FF:FF:FF type:0x800 len:0x46<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.5pt;
mso-bidi-font-size:10.0pt;font-family:"Trebuchet MS";mso-bidi-font-family:"Courier New"'>1.1.1.0:65286
-&gt; 70.0.0.4:65286 TCP TTL:255 TOS:0x0 ID:65286 IpLen:20 DgmLen:56<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.5pt;
mso-bidi-font-size:10.0pt;font-family:"Trebuchet MS";mso-bidi-font-family:"Courier New"'>******S*
Seq: 0x22FEE4<span style="mso-spacerun: yes">  </span>Ack: 0x22FEE4<span
style="mso-spacerun: yes">  </span>Win: 0x1000<span style="mso-spacerun: yes"> 
</span>TcpLen: 20<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.5pt;
mso-bidi-font-size:10.0pt;font-family:"Trebuchet MS";mso-bidi-font-family:"Courier New"'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.5pt;
mso-bidi-font-size:10.0pt;font-family:"Trebuchet MS";mso-bidi-font-family:"Courier New"'>The
file a.conf has two rules. The offset keyword has a default value of 0 and
specifies the location in the payload the content should be searched.<span
style="mso-spacerun: yes">  </span>In the first rule, we specify that the
search for vijay should start from the beginning and thus we get a match. In
the second rule we start the search from the 1st byte or second byte in the
payload and thus rule 2 does not match. The offset is used to hasten the search
in cases when we are well acquainted that the content never starts from the
beginning.<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.5pt;
mso-bidi-font-size:10.0pt;font-family:"Trebuchet MS";mso-bidi-font-family:"Courier New"'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.5pt;
mso-bidi-font-size:10.0pt;font-family:"Trebuchet MS";mso-bidi-font-family:"Courier New"'>alert
tcp any any -&gt; any any (msg:&quot;Rule 1&quot;;content:
&quot;sonal&quot;;offset: 5; depth: 10;)<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.5pt;
mso-bidi-font-size:10.0pt;font-family:"Trebuchet MS";mso-bidi-font-family:"Courier New"'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.5pt;
mso-bidi-font-size:10.0pt;font-family:"Trebuchet MS";mso-bidi-font-family:"Courier New"'>[**]
[1:0:0] Rule 1 [**]<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.5pt;
mso-bidi-font-size:10.0pt;font-family:"Trebuchet MS";mso-bidi-font-family:"Courier New"'>[Priority:
0] <o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.5pt;
mso-bidi-font-size:10.0pt;font-family:"Trebuchet MS";mso-bidi-font-family:"Courier New"'>05/26-13:32:01.336824
0:0:E8:EE:EC:88 -&gt; FF:FF:FF:FF:FF:FF type:0x800 len:0x46<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.5pt;
mso-bidi-font-size:10.0pt;font-family:"Trebuchet MS";mso-bidi-font-family:"Courier New"'>1.1.1.0:65286
-&gt; 70.0.0.4:65286 TCP TTL:255 TOS:0x0 ID:65286 IpLen:20 DgmLen:56<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.5pt;
mso-bidi-font-size:10.0pt;font-family:"Trebuchet MS";mso-bidi-font-family:"Courier New"'>******S*
Seq: 0x22FEE4<span style="mso-spacerun: yes">  </span>Ack: 0x22FEE4<span
style="mso-spacerun: yes">  </span>Win: 0x1000<span style="mso-spacerun: yes"> 
</span>TcpLen: 20 <o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.5pt;
mso-bidi-font-size:10.0pt;font-family:"Trebuchet MS";mso-bidi-font-family:"Courier New"'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.5pt;
mso-bidi-font-size:10.0pt;font-family:"Trebuchet MS";mso-bidi-font-family:"Courier New"'>The
depth keyword specifies the no. of bytes that should it check. Here above, we
are checking for sonal from bytes 6 to 16 i.e. we are checking from the 6th
byte, 10 more bytes. <o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.5pt;
mso-bidi-font-size:10.0pt;font-family:"Trebuchet MS";mso-bidi-font-family:"Courier New"'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.5pt;
mso-bidi-font-size:10.0pt;font-family:"Trebuchet MS";mso-bidi-font-family:"Courier New"'>alert
tcp any any -&gt; any any (msg:&quot;Rule 1&quot;;content:
&quot;sonal&quot;;offset: 10; depth: 5;)<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.5pt;
mso-bidi-font-size:10.0pt;font-family:"Trebuchet MS";mso-bidi-font-family:"Courier New"'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.5pt;
mso-bidi-font-size:10.0pt;font-family:"Trebuchet MS";mso-bidi-font-family:"Courier New"'>[**]
[1:0:0] Rule 1 [**]<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.5pt;
mso-bidi-font-size:10.0pt;font-family:"Trebuchet MS";mso-bidi-font-family:"Courier New"'>[Priority:
0] <o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.5pt;
mso-bidi-font-size:10.0pt;font-family:"Trebuchet MS";mso-bidi-font-family:"Courier New"'>05/26-13:38:23.893098
0:0:E8:EE:EC:88 -&gt; FF:FF:FF:FF:FF:FF type:0x800 len:0x46<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.5pt;
mso-bidi-font-size:10.0pt;font-family:"Trebuchet MS";mso-bidi-font-family:"Courier New"'>1.1.1.0:65286
-&gt; 70.0.0.4:65286 TCP TTL:255 TOS:0x0 ID:65286 IpLen:20 DgmLen:56<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.5pt;
mso-bidi-font-size:10.0pt;font-family:"Trebuchet MS";mso-bidi-font-family:"Courier New"'>******S*
Seq: 0x22FEE4<span style="mso-spacerun: yes">  </span>Ack: 0x22FEE4<span
style="mso-spacerun: yes">  </span>Win: 0x1000<span style="mso-spacerun: yes"> 
</span>TcpLen: 20<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.5pt;
mso-bidi-font-size:10.0pt;font-family:"Trebuchet MS";mso-bidi-font-family:"Courier New"'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.5pt;
mso-bidi-font-size:10.0pt;font-family:"Trebuchet MS";mso-bidi-font-family:"Courier New"'>Here
a match is met as we are searching for sonal from bytes 5 to 15. The words
vijay and a and take up exactly 10 bytes. <o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.5pt;
mso-bidi-font-size:10.0pt;font-family:"Trebuchet MS";mso-bidi-font-family:"Courier New"'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.5pt;
mso-bidi-font-size:10.0pt;font-family:"Trebuchet MS";mso-bidi-font-family:"Courier New"'>alert
tcp any any -&gt; any any (msg:&quot;Rule 1&quot;;content:
&quot;sonal&quot;;offset: 9; depth: 5;)<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.5pt;
mso-bidi-font-size:10.0pt;font-family:"Trebuchet MS";mso-bidi-font-family:"Courier New"'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.5pt;
mso-bidi-font-size:10.0pt;font-family:"Trebuchet MS";mso-bidi-font-family:"Courier New"'>This
gives us no alert as we have missed the match by 1 byte. We start searching
from the space and not s of sonal. This is how we can search in the content
from a fixed offset and for a certain number of bytes only. If the depth is
less than the size of the string sonal in this case has a length 5, then snort
does a sanity check and gives an error.<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.5pt;
mso-bidi-font-size:10.0pt;font-family:"Trebuchet MS";mso-bidi-font-family:"Courier New"'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.5pt;
mso-bidi-font-size:10.0pt;font-family:"Trebuchet MS";mso-bidi-font-family:"Courier New"'>alert
tcp any any -&gt; any any (msg:&quot;Rule 1&quot;;content: &quot;|76
69|&quot;;)<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.5pt;
mso-bidi-font-size:10.0pt;font-family:"Trebuchet MS";mso-bidi-font-family:"Courier New"'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.5pt;
mso-bidi-font-size:10.0pt;font-family:"Trebuchet MS";mso-bidi-font-family:"Courier New"'>[**]
[1:0:0] Rule 1 [**]<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.5pt;
mso-bidi-font-size:10.0pt;font-family:"Trebuchet MS";mso-bidi-font-family:"Courier New"'>[Priority:
0] <o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.5pt;
mso-bidi-font-size:10.0pt;font-family:"Trebuchet MS";mso-bidi-font-family:"Courier New"'>05/26-13:44:05.156019
0:0:E8:EE:EC:88 -&gt; FF:FF:FF:FF:FF:FF type:0x800 len:0x46<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.5pt;
mso-bidi-font-size:10.0pt;font-family:"Trebuchet MS";mso-bidi-font-family:"Courier New"'>1.1.1.0:65286
-&gt; 70.0.0.4:65286 TCP TTL:255 TOS:0x0 ID:65286 IpLen:20 DgmLen:56<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.5pt;
mso-bidi-font-size:10.0pt;font-family:"Trebuchet MS";mso-bidi-font-family:"Courier New"'>******S*
Seq: 0x22FEE4<span style="mso-spacerun: yes">  </span>Ack: 0x22FEE4<span
style="mso-spacerun: yes">  </span>Win: 0x1000<span style="mso-spacerun: yes"> 
</span>TcpLen: 20<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.5pt;
mso-bidi-font-size:10.0pt;font-family:"Trebuchet MS";mso-bidi-font-family:"Courier New"'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.5pt;
mso-bidi-font-size:10.0pt;font-family:"Trebuchet MS";mso-bidi-font-family:"Courier New"'>Many
a times we prefer testing bytes to string. For this purpose, we place these
bytes in the pipe sign. We trigger an alert as hex 76 and 69 stand for the
ascii characters v and i. <o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.5pt;
mso-bidi-font-size:10.0pt;font-family:"Trebuchet MS";mso-bidi-font-family:"Courier New"'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.5pt;
mso-bidi-font-size:10.0pt;font-family:"Trebuchet MS";mso-bidi-font-family:"Courier New"'>alert
tcp any any -&gt; any any (msg:&quot;Rule 1&quot;;content: &quot;|76
69|ja|79|&quot;;)<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.5pt;
mso-bidi-font-size:10.0pt;font-family:"Trebuchet MS";mso-bidi-font-family:"Courier New"'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.5pt;
mso-bidi-font-size:10.0pt;font-family:"Trebuchet MS";mso-bidi-font-family:"Courier New"'>[**]
[1:0:0] Rule 1 [**]<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.5pt;
mso-bidi-font-size:10.0pt;font-family:"Trebuchet MS";mso-bidi-font-family:"Courier New"'>[Priority:
0] <o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.5pt;
mso-bidi-font-size:10.0pt;font-family:"Trebuchet MS";mso-bidi-font-family:"Courier New"'>05/26-13:46:27.919219
0:0:E8:EE:EC:88 -&gt; FF:FF:FF:FF:FF:FF type:0x800 len:0x46<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.5pt;
mso-bidi-font-size:10.0pt;font-family:"Trebuchet MS";mso-bidi-font-family:"Courier New"'>1.1.1.0:65286
-&gt; 70.0.0.4:65286 TCP TTL:255 TOS:0x0 ID:65286 IpLen:20 DgmLen:56<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.5pt;
mso-bidi-font-size:10.0pt;font-family:"Trebuchet MS";mso-bidi-font-family:"Courier New"'>******S*
Seq: 0x22FEE4<span style="mso-spacerun: yes">  </span>Ack: 0x22FEE4<span
style="mso-spacerun: yes">  </span>Win: 0x1000<span style="mso-spacerun: yes"> 
</span>TcpLen: 20<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.5pt;
mso-bidi-font-size:10.0pt;font-family:"Trebuchet MS";mso-bidi-font-family:"Courier New"'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.5pt;
mso-bidi-font-size:10.0pt;font-family:"Trebuchet MS";mso-bidi-font-family:"Courier New"'><span
style="mso-spacerun: yes"> </span>We can mix and match ascii and binary
content. 79 is the ascii character y. This is very useful for finding certain
patters in shell code. This can also be used in finding out a nop sledge a series
of zeroes or no ops. Also certain assembler opcodes can also be detected. Every
exploit has a signature and we trigger an alert by finding a match of this
signature.<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.5pt;
mso-bidi-font-size:10.0pt;font-family:"Trebuchet MS";mso-bidi-font-family:"Courier New"'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.5pt;
mso-bidi-font-size:10.0pt;font-family:"Trebuchet MS";mso-bidi-font-family:"Courier New"'>nemesis
tcp -v<span style="mso-spacerun: yes">  </span>-P vijay.txt<span
style="mso-spacerun: yes">  </span>-S 1.1.1.1<span style="mso-spacerun: yes"> 
</span>-x 80 -D 70.0.0.4<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.5pt;
mso-bidi-font-size:10.0pt;font-family:"Trebuchet MS";mso-bidi-font-family:"Courier New"'>nemesis
tcp -v<span style="mso-spacerun: yes">  </span>-P vijay.txt<span
style="mso-spacerun: yes">  </span>-S 70.0.0.4 -y 80 -D 1.1.1.1<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.5pt;
mso-bidi-font-size:10.0pt;font-family:"Trebuchet MS";mso-bidi-font-family:"Courier New"'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.5pt;
mso-bidi-font-size:10.0pt;font-family:"Trebuchet MS";mso-bidi-font-family:"Courier New"'>alert
tcp any any &lt;&gt; 1.1.1.1 80 (msg:&quot;Rule 1&quot;;)<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.5pt;
mso-bidi-font-size:10.0pt;font-family:"Trebuchet MS";mso-bidi-font-family:"Courier New"'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.5pt;
mso-bidi-font-size:10.0pt;font-family:"Trebuchet MS";mso-bidi-font-family:"Courier New"'>[**]
[1:0:0] Rule 1 [**]<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.5pt;
mso-bidi-font-size:10.0pt;font-family:"Trebuchet MS";mso-bidi-font-family:"Courier New"'>[Priority:
0] <o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.5pt;
mso-bidi-font-size:10.0pt;font-family:"Trebuchet MS";mso-bidi-font-family:"Courier New"'>05/26-17:17:45.404962
0:0:E8:EE:EC:88 -&gt; FF:FF:FF:FF:FF:FF type:0x800 len:0x46<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.5pt;
mso-bidi-font-size:10.0pt;font-family:"Trebuchet MS";mso-bidi-font-family:"Courier New"'>1.1.1.1:80
-&gt; 70.0.0.4:65286 TCP TTL:255 TOS:0x0 ID:65286 IpLen:20 DgmLen:56<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.5pt;
mso-bidi-font-size:10.0pt;font-family:"Trebuchet MS";mso-bidi-font-family:"Courier New"'>******S*
Seq: 0x22FEE4<span style="mso-spacerun: yes">  </span>Ack: 0x22FEE4<span
style="mso-spacerun: yes">  </span>Win: 0x1000<span style="mso-spacerun: yes"> 
</span>TcpLen: 20<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.5pt;
mso-bidi-font-size:10.0pt;font-family:"Trebuchet MS";mso-bidi-font-family:"Courier New"'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.5pt;
mso-bidi-font-size:10.0pt;font-family:"Trebuchet MS";mso-bidi-font-family:"Courier New"'>[**]
[1:0:0] Rule 1 [**]<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.5pt;
mso-bidi-font-size:10.0pt;font-family:"Trebuchet MS";mso-bidi-font-family:"Courier New"'>[Priority:
0] <o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.5pt;
mso-bidi-font-size:10.0pt;font-family:"Trebuchet MS";mso-bidi-font-family:"Courier New"'>05/26-17:17:45.975667
0:0:E8:EE:EC:88 -&gt; FF:FF:FF:FF:FF:FF type:0x800 len:0x46<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.5pt;
mso-bidi-font-size:10.0pt;font-family:"Trebuchet MS";mso-bidi-font-family:"Courier New"'>70.0.0.4:65286
-&gt; 1.1.1.1:80 TCP TTL:255 TOS:0x0 ID:65286 IpLen:20 DgmLen:56<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.5pt;
mso-bidi-font-size:10.0pt;font-family:"Trebuchet MS";mso-bidi-font-family:"Courier New"'>******S*
Seq: 0x22FEE4<span style="mso-spacerun: yes">  </span>Ack: 0x22FEE4<span
style="mso-spacerun: yes">  </span>Win: 0x1000<span style="mso-spacerun: yes"> 
</span>TcpLen: 20<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.5pt;
mso-bidi-font-size:10.0pt;font-family:"Trebuchet MS";mso-bidi-font-family:"Courier New"'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.5pt;
mso-bidi-font-size:10.0pt;font-family:"Trebuchet MS";mso-bidi-font-family:"Courier New"'>We
have sent two packets one with a Source IP 1.1.1.1 and port number of 80 and
the other with destination port 80 and iP address 1.1.1.1. Both packets trigger
off an alert as the direction &lt;&gt; says that either side can be source or
destination. Thus if either the source or destination IP and port match, an
alert gets triggered. There is, as we have seen before, a -&gt; operator but no
&lt;- operator.<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.5pt;
mso-bidi-font-size:10.0pt;font-family:"Trebuchet MS";mso-bidi-font-family:"Courier New"'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.5pt;
mso-bidi-font-size:10.0pt;font-family:"Trebuchet MS";mso-bidi-font-family:"Courier New"'>config
classification: buffer-overflow,A buffer overflow code was detected,3<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.5pt;
mso-bidi-font-size:10.0pt;font-family:"Trebuchet MS";mso-bidi-font-family:"Courier New"'>alert
tcp any any &lt;&gt; any any<span style="mso-spacerun: yes"> 
</span>(msg:&quot;Rule 1&quot;;sid: 420; rev:6; classtype:
buffer-overflow;priority: 1; reference: bugtraq,120; )<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.5pt;
mso-bidi-font-size:10.0pt;font-family:"Trebuchet MS";mso-bidi-font-family:"Courier New"'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.5pt;
mso-bidi-font-size:10.0pt;font-family:"Trebuchet MS";mso-bidi-font-family:"Courier New"'>[**]
[1:420:6] Rule 1 [**]<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.5pt;
mso-bidi-font-size:10.0pt;font-family:"Trebuchet MS";mso-bidi-font-family:"Courier New"'>[Classification:
A buffer overflow code was detected] [Priority: 1] <o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.5pt;
mso-bidi-font-size:10.0pt;font-family:"Trebuchet MS";mso-bidi-font-family:"Courier New"'>05/26-17:41:25.731519
0:0:E8:EE:EC:88 -&gt; FF:FF:FF:FF:FF:FF type:0x800 len:0x46<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.5pt;
mso-bidi-font-size:10.0pt;font-family:"Trebuchet MS";mso-bidi-font-family:"Courier New"'>1.1.1.1:80
-&gt; 70.0.0.4:65286 TCP TTL:255 TOS:0x0 ID:65286 IpLen:20 DgmLen:56<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.5pt;
mso-bidi-font-size:10.0pt;font-family:"Trebuchet MS";mso-bidi-font-family:"Courier New"'>******S*
Seq: 0x22FEE4<span style="mso-spacerun: yes">  </span>Ack: 0x22FEE4<span
style="mso-spacerun: yes">  </span>Win: 0x1000<span style="mso-spacerun: yes"> 
</span>TcpLen: 20<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.5pt;
mso-bidi-font-size:10.0pt;font-family:"Trebuchet MS";mso-bidi-font-family:"Courier New"'>[Xref
=&gt;<span style="mso-spacerun: yes">  </span>bugtraq 120]<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.5pt;
mso-bidi-font-size:10.0pt;font-family:"Trebuchet MS";mso-bidi-font-family:"Courier New"'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.5pt;
mso-bidi-font-size:10.0pt;font-family:"Trebuchet MS";mso-bidi-font-family:"Courier New"'>Now
that we are a bit comfortable, lets spend some time understanding the alert
output. The first line starts with two stars and ends with two stars basically
for *good luck*. The number refers to the modules within snort who generates
the alert. The number 1 means a general snort alert, 100 means the portscanner
and so on. We have no control on<span style="mso-spacerun: yes"> 
</span>number, it basically helps us to understand what part of snort wrote the
alert. Then comes the sid. This is a number that uniquely identifies snort rules.
There will be some millions of snort rules and each rule is given a number. The
first 100 are reserved, for what nobody knows. 100 to 1,000,000 are reserved
for rules that come with snort, *there are really thinking big here*. Larger
than 1,000,000 are for us lowly mortals. Our sid is 420 which is the second
parameter. <o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.5pt;
mso-bidi-font-size:10.0pt;font-family:"Trebuchet MS";mso-bidi-font-family:"Courier New"'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.5pt;
mso-bidi-font-size:10.0pt;font-family:"Trebuchet MS";mso-bidi-font-family:"Courier New"'>Every
rule can be revised, thus we the rev keyword which speaks about the revision
number. In our case this is the sixth revision. The classtype specifies what
type of event occurred<span style="mso-spacerun: yes">  </span>to trigger this
alert. We use the classtype keyword with a classname. There are a large number
of classname defined along with snort which we will use later. To create a
classname we use the keyword config classification with the classname
buffer-overflow and follow this with a english explanation. The class name will
not be dispalyed but the english expalnation will be. <o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.5pt;
mso-bidi-font-size:10.0pt;font-family:"Trebuchet MS";mso-bidi-font-family:"Courier New"'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.5pt;
mso-bidi-font-size:10.0pt;font-family:"Trebuchet MS";mso-bidi-font-family:"Courier New"'>The
priority keyword is used to figure out how to treat this alert, this overrides
the priority of the classtype. Finally the reference keyword says where to look
to get more information on this exploit. In our case we have specified that
bugtraq archive 120 has more information. <o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.5pt;
mso-bidi-font-size:10.0pt;font-family:"Trebuchet MS";mso-bidi-font-family:"Courier New"'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.5pt;
mso-bidi-font-size:10.0pt;font-family:"Trebuchet MS";mso-bidi-font-family:"Courier New"'>Lots
of people maintain external identification systems where every exploit is given
a unique number basically to identify that we are talking about the samething. <o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.5pt;
mso-bidi-font-size:10.0pt;font-family:"Trebuchet MS";mso-bidi-font-family:"Courier New"'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.5pt;
mso-bidi-font-size:10.0pt;font-family:"Trebuchet MS";mso-bidi-font-family:"Courier New"'>Snort
supports bugtraq, cve, nessus, arachnids, mcafee and the general url. This can
aid us into knowing more about what happened. <o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.5pt;
mso-bidi-font-size:10.0pt;font-family:"Trebuchet MS";mso-bidi-font-family:"Courier New"'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.5pt;
mso-bidi-font-size:10.0pt;font-family:"Trebuchet MS";mso-bidi-font-family:"Courier New"'>nemesis
tcp -v<span style="mso-spacerun: yes">  </span>-P vijay.txt<span
style="mso-spacerun: yes">  </span>-S 1.1.1.1 -T 10<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.5pt;
mso-bidi-font-size:10.0pt;font-family:"Trebuchet MS";mso-bidi-font-family:"Courier New"'>nemesis
tcp -v<span style="mso-spacerun: yes">  </span>-P vijay.txt<span
style="mso-spacerun: yes">  </span>-S 1.1.1.2 -T 4<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.5pt;
mso-bidi-font-size:10.0pt;font-family:"Trebuchet MS";mso-bidi-font-family:"Courier New"'>nemesis
tcp -v<span style="mso-spacerun: yes">  </span>-P vijay.txt<span
style="mso-spacerun: yes">  </span>-S 1.1.1.3 -T 13<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.5pt;
mso-bidi-font-size:10.0pt;font-family:"Trebuchet MS";mso-bidi-font-family:"Courier New"'>nemesis
tcp -v<span style="mso-spacerun: yes">  </span>-P vijay.txt<span
style="mso-spacerun: yes">  </span>-S 1.1.1.4 -T 120<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.5pt;
mso-bidi-font-size:10.0pt;font-family:"Trebuchet MS";mso-bidi-font-family:"Courier New"'>nemesis
tcp -v<span style="mso-spacerun: yes">  </span>-P vijay.txt<span
style="mso-spacerun: yes">  </span>-S 1.1.1.5 -T 40<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.5pt;
mso-bidi-font-size:10.0pt;font-family:"Trebuchet MS";mso-bidi-font-family:"Courier New"'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.5pt;
mso-bidi-font-size:10.0pt;font-family:"Trebuchet MS";mso-bidi-font-family:"Courier New"'>alert
tcp any any &lt;&gt; any any<span style="mso-spacerun: yes"> 
</span>(msg:&quot;Rule 1&quot;; ttl: 10; )<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.5pt;
mso-bidi-font-size:10.0pt;font-family:"Trebuchet MS";mso-bidi-font-family:"Courier New"'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.5pt;
mso-bidi-font-size:10.0pt;font-family:"Trebuchet MS";mso-bidi-font-family:"Courier New"'>[**]
[1:0:0] Rule 1 [**]<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.5pt;
mso-bidi-font-size:10.0pt;font-family:"Trebuchet MS";mso-bidi-font-family:"Courier New"'>[Priority:
0] <o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.5pt;
mso-bidi-font-size:10.0pt;font-family:"Trebuchet MS";mso-bidi-font-family:"Courier New"'>05/26-18:07:13.244019
0:0:E8:EE:EC:88 -&gt; FF:FF:FF:FF:FF:FF type:0x800 len:0x46<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.5pt;
mso-bidi-font-size:10.0pt;font-family:"Trebuchet MS";mso-bidi-font-family:"Courier New"'>1.1.1.1:65286
-&gt; 196.254.34.0:65286 TCP TTL:10 TOS:0x0 ID:65286 IpLen:20 DgmLen:56<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.5pt;
mso-bidi-font-size:10.0pt;font-family:"Trebuchet MS";mso-bidi-font-family:"Courier New"'>******S*
Seq: 0x22FEE4<span style="mso-spacerun: yes">  </span>Ack: 0x22FEE4<span
style="mso-spacerun: yes">  </span>Win: 0x1000<span style="mso-spacerun: yes"> 
</span>TcpLen: 20<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.5pt;
mso-bidi-font-size:10.0pt;font-family:"Trebuchet MS";mso-bidi-font-family:"Courier New"'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.5pt;
mso-bidi-font-size:10.0pt;font-family:"Trebuchet MS";mso-bidi-font-family:"Courier New"'>We
send 5 packets with varying ttl's. The rule signals an alert only on those
packets that have a ttl of 10. Hence one alert is send with IP address 1.1.1.1.<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.5pt;
mso-bidi-font-size:10.0pt;font-family:"Trebuchet MS";mso-bidi-font-family:"Courier New"'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.5pt;
mso-bidi-font-size:10.0pt;font-family:"Trebuchet MS";mso-bidi-font-family:"Courier New"'>alert
tcp any any &lt;&gt; any any<span style="mso-spacerun: yes"> 
</span>(msg:&quot;Rule 1&quot;; ttl:&lt;5; )<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.5pt;
mso-bidi-font-size:10.0pt;font-family:"Trebuchet MS";mso-bidi-font-family:"Courier New"'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.5pt;
mso-bidi-font-size:10.0pt;font-family:"Trebuchet MS";mso-bidi-font-family:"Courier New"'>[**]
[1:0:0] Rule 1 [**]<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.5pt;
mso-bidi-font-size:10.0pt;font-family:"Trebuchet MS";mso-bidi-font-family:"Courier New"'>[Priority:
0] <o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.5pt;
mso-bidi-font-size:10.0pt;font-family:"Trebuchet MS";mso-bidi-font-family:"Courier New"'>05/26-18:10:58.373599
0:0:E8:EE:EC:88 -&gt; FF:FF:FF:FF:FF:FF type:0x800 len:0x46<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.5pt;
mso-bidi-font-size:10.0pt;font-family:"Trebuchet MS";mso-bidi-font-family:"Courier New"'>1.1.1.2:65286
-&gt; 196.254.34.0:65286 TCP TTL:4 TOS:0x0 ID:65286 IpLen:20 DgmLen:56<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.5pt;
mso-bidi-font-size:10.0pt;font-family:"Trebuchet MS";mso-bidi-font-family:"Courier New"'>******S*
Seq: 0x22FEE4<span style="mso-spacerun: yes">  </span>Ack: 0x22FEE4<span
style="mso-spacerun: yes">  </span>Win: 0x1000<span style="mso-spacerun: yes"> 
</span>TcpLen: 20<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.5pt;
mso-bidi-font-size:10.0pt;font-family:"Trebuchet MS";mso-bidi-font-family:"Courier New"'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.5pt;
mso-bidi-font-size:10.0pt;font-family:"Trebuchet MS";mso-bidi-font-family:"Courier New"'>Here
all those packets with a ttl of less than 5 are trapped, 1.1.1.2 sends off the
alert.<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.5pt;
mso-bidi-font-size:10.0pt;font-family:"Trebuchet MS";mso-bidi-font-family:"Courier New"'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.5pt;
mso-bidi-font-size:10.0pt;font-family:"Trebuchet MS";mso-bidi-font-family:"Courier New"'>alert
tcp any any &lt;&gt; any any<span style="mso-spacerun: yes"> 
</span>(msg:&quot;Rule 1&quot;; ttl:10-15; )<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.5pt;
mso-bidi-font-size:10.0pt;font-family:"Trebuchet MS";mso-bidi-font-family:"Courier New"'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.5pt;
mso-bidi-font-size:10.0pt;font-family:"Trebuchet MS";mso-bidi-font-family:"Courier New"'>[**]
[1:0:0] Rule 1 [**]<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.5pt;
mso-bidi-font-size:10.0pt;font-family:"Trebuchet MS";mso-bidi-font-family:"Courier New"'>[Priority:
0] <o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.5pt;
mso-bidi-font-size:10.0pt;font-family:"Trebuchet MS";mso-bidi-font-family:"Courier New"'>05/26-18:12:20.631191
0:0:E8:EE:EC:88 -&gt; FF:FF:FF:FF:FF:FF type:0x800 len:0x46<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.5pt;
mso-bidi-font-size:10.0pt;font-family:"Trebuchet MS";mso-bidi-font-family:"Courier New"'>1.1.1.1:65286
-&gt; 196.254.34.0:65286 TCP TTL:10 TOS:0x0 ID:65286 IpLen:20 DgmLen:56<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.5pt;
mso-bidi-font-size:10.0pt;font-family:"Trebuchet MS";mso-bidi-font-family:"Courier New"'>******S*
Seq: 0x22FEE4<span style="mso-spacerun: yes">  </span>Ack: 0x22FEE4<span
style="mso-spacerun: yes">  </span>Win: 0x1000<span style="mso-spacerun: yes"> 
</span>TcpLen: 20<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.5pt;
mso-bidi-font-size:10.0pt;font-family:"Trebuchet MS";mso-bidi-font-family:"Courier New"'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.5pt;
mso-bidi-font-size:10.0pt;font-family:"Trebuchet MS";mso-bidi-font-family:"Courier New"'>[**]
[1:0:0] Rule 1 [**]<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.5pt;
mso-bidi-font-size:10.0pt;font-family:"Trebuchet MS";mso-bidi-font-family:"Courier New"'>[Priority:
0] <o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.5pt;
mso-bidi-font-size:10.0pt;font-family:"Trebuchet MS";mso-bidi-font-family:"Courier New"'>05/26-18:12:21.802452
0:0:E8:EE:EC:88 -&gt; FF:FF:FF:FF:FF:FF type:0x800 len:0x46<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.5pt;
mso-bidi-font-size:10.0pt;font-family:"Trebuchet MS";mso-bidi-font-family:"Courier New"'>1.1.1.3:65286
-&gt; 196.254.34.0:65286 TCP TTL:13 TOS:0x0 ID:65286 IpLen:20 DgmLen:56<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.5pt;
mso-bidi-font-size:10.0pt;font-family:"Trebuchet MS";mso-bidi-font-family:"Courier New"'>******S*
Seq: 0x22FEE4<span style="mso-spacerun: yes">  </span>Ack: 0x22FEE4<span
style="mso-spacerun: yes">  </span>Win: 0x1000<span style="mso-spacerun: yes"> 
</span>TcpLen: 20<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.5pt;
mso-bidi-font-size:10.0pt;font-family:"Trebuchet MS";mso-bidi-font-family:"Courier New"'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.5pt;
mso-bidi-font-size:10.0pt;font-family:"Trebuchet MS";mso-bidi-font-family:"Courier New"'>A
range can be given with a - sign. Here we have packets with ttl's ranging from
10 to 15, i.e. 10 and 13, therefore we see two alerts.<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.5pt;
mso-bidi-font-size:10.0pt;font-family:"Trebuchet MS";mso-bidi-font-family:"Courier New"'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.5pt;
mso-bidi-font-size:10.0pt;font-family:"Trebuchet MS";mso-bidi-font-family:"Courier New"'>alert
tcp any any &lt;&gt; any any<span style="mso-spacerun: yes"> 
</span>(msg:&quot;Rule 1&quot;; ttl:&gt;50; )<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.5pt;
mso-bidi-font-size:10.0pt;font-family:"Trebuchet MS";mso-bidi-font-family:"Courier New"'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.5pt;
mso-bidi-font-size:10.0pt;font-family:"Trebuchet MS";mso-bidi-font-family:"Courier New"'>[**]
[1:0:0] Rule 1 [**]<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.5pt;
mso-bidi-font-size:10.0pt;font-family:"Trebuchet MS";mso-bidi-font-family:"Courier New"'>[Priority:
0] <o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.5pt;
mso-bidi-font-size:10.0pt;font-family:"Trebuchet MS";mso-bidi-font-family:"Courier New"'>05/26-18:13:55.531572
0:0:E8:EE:EC:88 -&gt; FF:FF:FF:FF:FF:FF type:0x800 len:0x46<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.5pt;
mso-bidi-font-size:10.0pt;font-family:"Trebuchet MS";mso-bidi-font-family:"Courier New"'>1.1.1.4:65286
-&gt; 196.254.34.0:65286 TCP TTL:120 TOS:0x0 ID:65286 IpLen:20 DgmLen:56<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.5pt;
mso-bidi-font-size:10.0pt;font-family:"Trebuchet MS";mso-bidi-font-family:"Courier New"'>******S*
Seq: 0x22FEE4<span style="mso-spacerun: yes">  </span>Ack: 0x22FEE4<span
style="mso-spacerun: yes">  </span>Win: 0x1000<span style="mso-spacerun: yes"> 
</span>TcpLen: 20<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.5pt;
mso-bidi-font-size:10.0pt;font-family:"Trebuchet MS";mso-bidi-font-family:"Courier New"'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.5pt;
mso-bidi-font-size:10.0pt;font-family:"Trebuchet MS";mso-bidi-font-family:"Courier New"'>Finally
all ttl's larger than 50 triggers one alert as we have one packet with a ttl of
120. In future normally all options allow us a single value or a range using -
or a higher and lower range. <o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.5pt;
mso-bidi-font-size:10.0pt;font-family:"Trebuchet MS";mso-bidi-font-family:"Courier New"'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.5pt;
mso-bidi-font-size:10.0pt;font-family:"Trebuchet MS";mso-bidi-font-family:"Courier New"'>alert
tcp any any &lt;&gt; any any<span style="mso-spacerun: yes"> 
</span>(msg:&quot;Rule 1&quot;; sameip; )<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.5pt;
mso-bidi-font-size:10.0pt;font-family:"Trebuchet MS";mso-bidi-font-family:"Courier New"'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.5pt;
mso-bidi-font-size:10.0pt;font-family:"Trebuchet MS";mso-bidi-font-family:"Courier New"'>nemesis
tcp -v<span style="mso-spacerun: yes">  </span>-P vijay.txt<span
style="mso-spacerun: yes">  </span>-S 1.1.1.1 -D 1.1.1.1<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.5pt;
mso-bidi-font-size:10.0pt;font-family:"Trebuchet MS";mso-bidi-font-family:"Courier New"'>nemesis
tcp -v<span style="mso-spacerun: yes">  </span>-P vijay.txt<span
style="mso-spacerun: yes">  </span>-S 1.1.1.2 -D 1.1.1.1<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.5pt;
mso-bidi-font-size:10.0pt;font-family:"Trebuchet MS";mso-bidi-font-family:"Courier New"'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.5pt;
mso-bidi-font-size:10.0pt;font-family:"Trebuchet MS";mso-bidi-font-family:"Courier New"'>[**]
[1:0:0] Rule 1 [**]<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.5pt;
mso-bidi-font-size:10.0pt;font-family:"Trebuchet MS";mso-bidi-font-family:"Courier New"'>[Priority:
0] <o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.5pt;
mso-bidi-font-size:10.0pt;font-family:"Trebuchet MS";mso-bidi-font-family:"Courier New"'>05/27-10:09:41.114732
0:0:E8:EE:EC:88 -&gt; FF:FF:FF:FF:FF:FF type:0x800 len:0x46<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.5pt;
mso-bidi-font-size:10.0pt;font-family:"Trebuchet MS";mso-bidi-font-family:"Courier New"'>1.1.1.1:65286
-&gt; 1.1.1.1:65286 TCP TTL:255 TOS:0x0 ID:65286 IpLen:20 DgmLen:56<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.5pt;
mso-bidi-font-size:10.0pt;font-family:"Trebuchet MS";mso-bidi-font-family:"Courier New"'>******S*
Seq: 0x22FEE4<span style="mso-spacerun: yes">  </span>Ack: 0x22FEE4<span
style="mso-spacerun: yes">  </span>Win: 0x1000<span style="mso-spacerun: yes"> 
</span>TcpLen: 20<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.5pt;
mso-bidi-font-size:10.0pt;font-family:"Trebuchet MS";mso-bidi-font-family:"Courier New"'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.5pt;
mso-bidi-font-size:10.0pt;font-family:"Trebuchet MS";mso-bidi-font-family:"Courier New"'>Many
a times in the past we have heard of syn flloding where a syn packet is sent
but the 3 way handshake is not completed. Some guys found out that on the
Windows OS if a syn packet is sent with the same source and destination IP
address, all networking activities would stop and there was no option but a
reboot to set it right. This was called the land attack. <o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.5pt;
mso-bidi-font-size:10.0pt;font-family:"Trebuchet MS";mso-bidi-font-family:"Courier New"'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.5pt;
mso-bidi-font-size:10.0pt;font-family:"Trebuchet MS";mso-bidi-font-family:"Courier New"'>The
sameip keyword in the alert checks whether the source and destination IP
addresses are the same. We send two packets where the first has the same source
and destination IP addresses 1.1.1.1 and in the second they are different. The
first packet triggers off an alert.<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.5pt;
mso-bidi-font-size:10.0pt;font-family:"Trebuchet MS";mso-bidi-font-family:"Courier New"'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.5pt;
mso-bidi-font-size:10.0pt;font-family:"Trebuchet MS";mso-bidi-font-family:"Courier New"'>nemesis
tcp -v<span style="mso-spacerun: yes">  </span>-P vijay.txt<span
style="mso-spacerun: yes">  </span>-S 1.1.1.1 -D 1.1.1.2<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.5pt;
mso-bidi-font-size:10.0pt;font-family:"Trebuchet MS";mso-bidi-font-family:"Courier New"'>nemesis
tcp -v<span style="mso-spacerun: yes">  </span>-P vijay1.txt<span
style="mso-spacerun: yes">  </span>-S 1.1.1.1 -D 1.1.1.3<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.5pt;
mso-bidi-font-size:10.0pt;font-family:"Trebuchet MS";mso-bidi-font-family:"Courier New"'>nemesis
tcp -v<span style="mso-spacerun: yes">  </span>-P vijay2.txt<span
style="mso-spacerun: yes">  </span>-S 1.1.1.1 -D 1.1.1.4<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.5pt;
mso-bidi-font-size:10.0pt;font-family:"Trebuchet MS";mso-bidi-font-family:"Courier New"'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.5pt;
mso-bidi-font-size:10.0pt;font-family:"Trebuchet MS";mso-bidi-font-family:"Courier New"'>vijay1.txt<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.5pt;
mso-bidi-font-size:10.0pt;font-family:"Trebuchet MS";mso-bidi-font-family:"Courier New"'>one<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.5pt;
mso-bidi-font-size:10.0pt;font-family:"Trebuchet MS";mso-bidi-font-family:"Courier New"'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.5pt;
mso-bidi-font-size:10.0pt;font-family:"Trebuchet MS";mso-bidi-font-family:"Courier New"'>vijay2.txt<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.5pt;
mso-bidi-font-size:10.0pt;font-family:"Trebuchet MS";mso-bidi-font-family:"Courier New"'>two<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.5pt;
mso-bidi-font-size:10.0pt;font-family:"Trebuchet MS";mso-bidi-font-family:"Courier New"'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.5pt;
mso-bidi-font-size:10.0pt;font-family:"Trebuchet MS";mso-bidi-font-family:"Courier New"'>alert
tcp any any -&gt; any any<span style="mso-spacerun: yes"> 
</span>(msg:&quot;Rule 1&quot;; content: &quot;vijay&quot;;)<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.5pt;
mso-bidi-font-size:10.0pt;font-family:"Trebuchet MS";mso-bidi-font-family:"Courier New"'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.5pt;
mso-bidi-font-size:10.0pt;font-family:"Trebuchet MS";mso-bidi-font-family:"Courier New"'>[**]
[1:0:0] Rule 1 [**]<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.5pt;
mso-bidi-font-size:10.0pt;font-family:"Trebuchet MS";mso-bidi-font-family:"Courier New"'>[Priority:
0] <o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.5pt;
mso-bidi-font-size:10.0pt;font-family:"Trebuchet MS";mso-bidi-font-family:"Courier New"'>05/27-10:24:43.356907
0:0:E8:EE:EC:88 -&gt; FF:FF:FF:FF:FF:FF type:0x800 len:0x46<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.5pt;
mso-bidi-font-size:10.0pt;font-family:"Trebuchet MS";mso-bidi-font-family:"Courier New"'>1.1.1.1:65286
-&gt; 1.1.1.2:65286 TCP TTL:255 TOS:0x0 ID:65286 IpLen:20 DgmLen:56<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.5pt;
mso-bidi-font-size:10.0pt;font-family:"Trebuchet MS";mso-bidi-font-family:"Courier New"'>******S*
Seq: 0x22FEE4<span style="mso-spacerun: yes">  </span>Ack: 0x22FEE4<span
style="mso-spacerun: yes">  </span>Win: 0x1000<span style="mso-spacerun: yes"> 
</span>TcpLen: 20<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.5pt;
mso-bidi-font-size:10.0pt;font-family:"Trebuchet MS";mso-bidi-font-family:"Courier New"'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.5pt;
mso-bidi-font-size:10.0pt;font-family:"Trebuchet MS";mso-bidi-font-family:"Courier New"'>We
send three packets and the alert.ids shows us only one alert as we have only
one packet that has the content vijay. However in the vijay subdirectory we see
a directory 1.1.1.1. This is because all three packets have the IP address of
1.1.1.1. Thus in the log file packets are found in directories, as mentioned
before, based on the source IP addresses. This makes sense as we can now simply
move into a directory to find all packets from a certain source. There is only
one file tcp_65286-65286.ids which has only one entry similar to the alert
file. <o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.5pt;
mso-bidi-font-size:10.0pt;font-family:"Trebuchet MS";mso-bidi-font-family:"Courier New"'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.5pt;
mso-bidi-font-size:10.0pt;font-family:"Trebuchet MS";mso-bidi-font-family:"Courier New"'>tcp_65286-65286.ids<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.5pt;
mso-bidi-font-size:10.0pt;font-family:"Trebuchet MS";mso-bidi-font-family:"Courier New"'>[**]
Rule 1 [**]<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.5pt;
mso-bidi-font-size:10.0pt;font-family:"Trebuchet MS";mso-bidi-font-family:"Courier New"'>05/27-10:24:43.356907
0:0:E8:EE:EC:88 -&gt; FF:FF:FF:FF:FF:FF type:0x800 len:0x46<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.5pt;
mso-bidi-font-size:10.0pt;font-family:"Trebuchet MS";mso-bidi-font-family:"Courier New"'>1.1.1.1:65286
-&gt; 1.1.1.2:65286 TCP TTL:255 TOS:0x0 ID:65286 IpLen:20 DgmLen:56<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.5pt;
mso-bidi-font-size:10.0pt;font-family:"Trebuchet MS";mso-bidi-font-family:"Courier New"'>******S*
Seq: 0x22FEE4<span style="mso-spacerun: yes">  </span>Ack: 0x22FEE4<span
style="mso-spacerun: yes">  </span>Win: 0x1000<span style="mso-spacerun: yes"> 
</span>TcpLen: 20<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.5pt;
mso-bidi-font-size:10.0pt;font-family:"Trebuchet MS";mso-bidi-font-family:"Courier New"'>76
69 6A 61 79 20 61 6E 64 20 73 6F 6E 61 6C 0A<span style="mso-spacerun: yes"> 
</span>vijay and sonal.<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.5pt;
mso-bidi-font-size:10.0pt;font-family:"Trebuchet MS";mso-bidi-font-family:"Courier New"'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.5pt;
mso-bidi-font-size:10.0pt;font-family:"Trebuchet MS";mso-bidi-font-family:"Courier New"'>Thus
alert corresponds to log and alert at the same time. The other two packets are
not logged as they do not match a condition. <o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.5pt;
mso-bidi-font-size:10.0pt;font-family:"Trebuchet MS";mso-bidi-font-family:"Courier New"'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.5pt;
mso-bidi-font-size:10.0pt;font-family:"Trebuchet MS";mso-bidi-font-family:"Courier New"'>Lets
take the buffer overflow. The first packet start with some valid bytes say
vijay but the actual exploit lies in the coming packets. Let see how to build
such a system.<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.5pt;
mso-bidi-font-size:10.0pt;font-family:"Trebuchet MS";mso-bidi-font-family:"Courier New"'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.5pt;
mso-bidi-font-size:10.0pt;font-family:"Trebuchet MS";mso-bidi-font-family:"Courier New"'>activate
tcp any any -&gt; any any<span style="mso-spacerun: yes">  </span>(msg:&quot;Rule
1&quot;; content: &quot;vijay&quot;; activates: 5;)<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.5pt;
mso-bidi-font-size:10.0pt;font-family:"Trebuchet MS";mso-bidi-font-family:"Courier New"'>dynamic<span
style="mso-spacerun: yes">  </span>tcp any any -&gt; any any<span
style="mso-spacerun: yes">  </span>(msg:&quot;Rule 2&quot;;activated_by: 5;
count: 2;)<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.5pt;
mso-bidi-font-size:10.0pt;font-family:"Trebuchet MS";mso-bidi-font-family:"Courier New"'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.5pt;
mso-bidi-font-size:10.0pt;font-family:"Trebuchet MS";mso-bidi-font-family:"Courier New"'>alert.ids<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.5pt;
mso-bidi-font-size:10.0pt;font-family:"Trebuchet MS";mso-bidi-font-family:"Courier New"'>[**]
[1:0:0] Rule 1 [**]<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.5pt;
mso-bidi-font-size:10.0pt;font-family:"Trebuchet MS";mso-bidi-font-family:"Courier New"'>[Priority:
0] <o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.5pt;
mso-bidi-font-size:10.0pt;font-family:"Trebuchet MS";mso-bidi-font-family:"Courier New"'>05/27-10:32:30.439884
0:0:E8:EE:EC:88 -&gt; FF:FF:FF:FF:FF:FF type:0x800 len:0x46<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.5pt;
mso-bidi-font-size:10.0pt;font-family:"Trebuchet MS";mso-bidi-font-family:"Courier New"'>1.1.1.1:65286
-&gt; 1.1.1.2:65286 TCP TTL:255 TOS:0x0 ID:65286 IpLen:20 DgmLen:56<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.5pt;
mso-bidi-font-size:10.0pt;font-family:"Trebuchet MS";mso-bidi-font-family:"Courier New"'>******S*
Seq: 0x22FEE4<span style="mso-spacerun: yes">  </span>Ack: 0x22FEE4<span
style="mso-spacerun: yes">  </span>Win: 0x1000<span style="mso-spacerun: yes"> 
</span>TcpLen: 20<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.5pt;
mso-bidi-font-size:10.0pt;font-family:"Trebuchet MS";mso-bidi-font-family:"Courier New"'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.5pt;
mso-bidi-font-size:10.0pt;font-family:"Trebuchet MS";mso-bidi-font-family:"Courier New"'>tcp_65286-65286.ids<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.5pt;
mso-bidi-font-size:10.0pt;font-family:"Trebuchet MS";mso-bidi-font-family:"Courier New"'>[**]
Rule 1 [**]<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.5pt;
mso-bidi-font-size:10.0pt;font-family:"Trebuchet MS";mso-bidi-font-family:"Courier New"'>05/27-10:32:30.439884
0:0:E8:EE:EC:88 -&gt; FF:FF:FF:FF:FF:FF type:0x800 len:0x46<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.5pt;
mso-bidi-font-size:10.0pt;font-family:"Trebuchet MS";mso-bidi-font-family:"Courier New"'>1.1.1.1:65286
-&gt; 1.1.1.2:65286 TCP TTL:255 TOS:0x0 ID:65286 IpLen:20 DgmLen:56<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.5pt;
mso-bidi-font-size:10.0pt;font-family:"Trebuchet MS";mso-bidi-font-family:"Courier New"'>******S*
Seq: 0x22FEE4<span style="mso-spacerun: yes">  </span>Ack: 0x22FEE4<span
style="mso-spacerun: yes">  </span>Win: 0x1000<span style="mso-spacerun: yes"> 
</span>TcpLen: 20<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.5pt;
mso-bidi-font-size:10.0pt;font-family:"Trebuchet MS";mso-bidi-font-family:"Courier New"'>76
69 6A 61 79 20 61 6E 64 20 73 6F 6E 61 6C 0A<span style="mso-spacerun: yes"> 
</span>vijay and sonal.<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.5pt;
mso-bidi-font-size:10.0pt;font-family:"Trebuchet MS";mso-bidi-font-family:"Courier New"'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.5pt;
mso-bidi-font-size:10.0pt;font-family:"Trebuchet MS";mso-bidi-font-family:"Courier New"'>[**]
Rule 2 [**]<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.5pt;
mso-bidi-font-size:10.0pt;font-family:"Trebuchet MS";mso-bidi-font-family:"Courier New"'>05/27-10:32:31.000762
0:0:E8:EE:EC:88 -&gt; FF:FF:FF:FF:FF:FF type:0x800 len:0x3C<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.5pt;
mso-bidi-font-size:10.0pt;font-family:"Trebuchet MS";mso-bidi-font-family:"Courier New"'>1.1.1.1:65286
-&gt; 1.1.1.3:65286 TCP TTL:255 TOS:0x0 ID:65286 IpLen:20 DgmLen:45<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.5pt;
mso-bidi-font-size:10.0pt;font-family:"Trebuchet MS";mso-bidi-font-family:"Courier New"'>******S*
Seq: 0x22FEE4<span style="mso-spacerun: yes">  </span>Ack: 0x22FEE4<span
style="mso-spacerun: yes">  </span>Win: 0x1000<span style="mso-spacerun: yes"> 
</span>TcpLen: 20<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.5pt;
mso-bidi-font-size:10.0pt;font-family:"Trebuchet MS";mso-bidi-font-family:"Courier New"'>6F
6E 65 0A 0A<span style="mso-spacerun: yes">                                  
</span>one..<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.5pt;
mso-bidi-font-size:10.0pt;font-family:"Trebuchet MS";mso-bidi-font-family:"Courier New"'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.5pt;
mso-bidi-font-size:10.0pt;font-family:"Trebuchet MS";mso-bidi-font-family:"Courier New"'>[**]
Rule 2 [**]<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.5pt;
mso-bidi-font-size:10.0pt;font-family:"Trebuchet MS";mso-bidi-font-family:"Courier New"'>05/27-10:32:31.561681
0:0:E8:EE:EC:88 -&gt; FF:FF:FF:FF:FF:FF type:0x800 len:0x3C<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.5pt;
mso-bidi-font-size:10.0pt;font-family:"Trebuchet MS";mso-bidi-font-family:"Courier New"'>1.1.1.1:65286
-&gt; 1.1.1.4:65286 TCP TTL:255 TOS:0x0 ID:65286 IpLen:20 DgmLen:45<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.5pt;
mso-bidi-font-size:10.0pt;font-family:"Trebuchet MS";mso-bidi-font-family:"Courier New"'>******S*
Seq: 0x22FEE4<span style="mso-spacerun: yes">  </span>Ack: 0x22FEE4<span
style="mso-spacerun: yes">  </span>Win: 0x1000<span style="mso-spacerun: yes"> 
</span>TcpLen: 20<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.5pt;
mso-bidi-font-size:10.0pt;font-family:"Trebuchet MS";mso-bidi-font-family:"Courier New"'>74
77 6F 0A 0A<span style="mso-spacerun: yes">                    </span><span
style="mso-spacerun: yes">               </span>two..<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.5pt;
mso-bidi-font-size:10.0pt;font-family:"Trebuchet MS";mso-bidi-font-family:"Courier New"'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.5pt;
mso-bidi-font-size:10.0pt;font-family:"Trebuchet MS";mso-bidi-font-family:"Courier New"'>The
alert.ids file remains the same as before. This is because we have simply
triggered one alert. Our aim is to log the packets after the one we have found.
Take a look at the tcp_65286-65286.ids file. We see the next two packets logged
after the Rule 1 packet. <o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.5pt;
mso-bidi-font-size:10.0pt;font-family:"Trebuchet MS";mso-bidi-font-family:"Courier New"'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.5pt;
mso-bidi-font-size:10.0pt;font-family:"Trebuchet MS";mso-bidi-font-family:"Courier New"'>This
makes sense as we can now figure out the exploit in the log file thus not
cluttering alert file. In a sense we are logging packets after a condition has
been satisfied. The activate rule is a super set of alert. It is basically to
trigger an alert if the condition is met. In our case a packet with content
vijay will trigger off the alert. <o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.5pt;
mso-bidi-font-size:10.0pt;font-family:"Trebuchet MS";mso-bidi-font-family:"Courier New"'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.5pt;
mso-bidi-font-size:10.0pt;font-family:"Trebuchet MS";mso-bidi-font-family:"Courier New"'>We
also have used the keyword activates which looks for a rule that starts with
dynamic. This must have an activated_by keyword with the same number as the
activate rule. If found, execute it. As this rule uses the count keyword
followed by a value of 2, the next two packets get logged also. The dynamic
rule does not get called directly, it gets activated by an activate. In this
manner, one rule can trigger off a large number of other rules.<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.5pt;
mso-bidi-font-size:10.0pt;font-family:"Trebuchet MS";mso-bidi-font-family:"Courier New"'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.5pt;
mso-bidi-font-size:10.0pt;font-family:"Trebuchet MS";mso-bidi-font-family:"Courier New"'>nemesis
tcp -v<span style="mso-spacerun: yes">  </span>-P vijay.txt<span
style="mso-spacerun: yes">  </span>-S 1.1.1.1 -D 1.1.1.2<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.5pt;
mso-bidi-font-size:10.0pt;font-family:"Trebuchet MS";mso-bidi-font-family:"Courier New"'>nemesis
tcp -v<span style="mso-spacerun: yes">  </span>-P vijay1.txt<span
style="mso-spacerun: yes">  </span>-S 1.1.1.1 -D 1.1.1.3<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.5pt;
mso-bidi-font-size:10.0pt;font-family:"Trebuchet MS";mso-bidi-font-family:"Courier New"'>nemesis
tcp -v<span style="mso-spacerun: yes">  </span>-P vijay2.txt<span
style="mso-spacerun: yes">  </span>-S 1.1.1.1 -D 1.1.1.4<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.5pt;
mso-bidi-font-size:10.0pt;font-family:"Trebuchet MS";mso-bidi-font-family:"Courier New"'>nemesis
tcp -v<span style="mso-spacerun: yes">  </span>-P vijay2.txt<span
style="mso-spacerun: yes">  </span>-S 1.1.1.1 -D 1.1.1.5<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.5pt;
mso-bidi-font-size:10.0pt;font-family:"Trebuchet MS";mso-bidi-font-family:"Courier New"'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.5pt;
mso-bidi-font-size:10.0pt;font-family:"Trebuchet MS";mso-bidi-font-family:"Courier New"'>We
now add a fourth packet but our log files remain the same as we only log the
next two packets. <o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.5pt;
mso-bidi-font-size:10.0pt;font-family:"Trebuchet MS";mso-bidi-font-family:"Courier New"'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.5pt;
mso-bidi-font-size:10.0pt;font-family:"Trebuchet MS";mso-bidi-font-family:"Courier New"'>nemesis
tcp -v<span style="mso-spacerun: yes">  </span>-P vijay.txt -S 1.1.1.1 -D
1.1.1.2 -t 5<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.5pt;
mso-bidi-font-size:10.0pt;font-family:"Trebuchet MS";mso-bidi-font-family:"Courier New"'>nemesis
tcp -v<span style="mso-spacerun: yes">  </span>-P vijay.txt -S 1.1.1.1 -D
1.1.1.2 -t 6<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.5pt;
mso-bidi-font-size:10.0pt;font-family:"Trebuchet MS";mso-bidi-font-family:"Courier New"'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.5pt;
mso-bidi-font-size:10.0pt;font-family:"Trebuchet MS";mso-bidi-font-family:"Courier New"'>alert
tcp any any -&gt; any any <span style="mso-spacerun:
yes"> </span>(msg:&quot;Rule 1&quot;; tos:5; )<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.5pt;
mso-bidi-font-size:10.0pt;font-family:"Trebuchet MS";mso-bidi-font-family:"Courier New"'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.5pt;
mso-bidi-font-size:10.0pt;font-family:"Trebuchet MS";mso-bidi-font-family:"Courier New"'>[**]
[1:0:0] Rule 1 [**]<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.5pt;
mso-bidi-font-size:10.0pt;font-family:"Trebuchet MS";mso-bidi-font-family:"Courier New"'>[Priority:
0] <o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.5pt;
mso-bidi-font-size:10.0pt;font-family:"Trebuchet MS";mso-bidi-font-family:"Courier New"'>05/27-11:17:54.036782
0:0:E8:EE:EC:88 -&gt; FF:FF:FF:FF:FF:FF type:0x800 len:0x46<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.5pt;
mso-bidi-font-size:10.0pt;font-family:"Trebuchet MS";mso-bidi-font-family:"Courier New"'>1.1.1.1:65286
-&gt; 1.1.1.2:65286 TCP TTL:255 TOS:0x5 ID:65286 IpLen:20 DgmLen:56<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.5pt;
mso-bidi-font-size:10.0pt;font-family:"Trebuchet MS";mso-bidi-font-family:"Courier New"'>******S*
Seq: 0x22FEE4<span style="mso-spacerun: yes">  </span>Ack: 0x22FEE4<span
style="mso-spacerun: yes">  </span>Win: 0x1000<span style="mso-spacerun: yes"> 
</span>TcpLen: 20<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.5pt;
mso-bidi-font-size:10.0pt;font-family:"Trebuchet MS";mso-bidi-font-family:"Courier New"'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.5pt;
mso-bidi-font-size:10.0pt;font-family:"Trebuchet MS";mso-bidi-font-family:"Courier New"'>We
send two packets across,<span style="mso-spacerun: yes">  </span>one with tos 5
and the other with tos 6. The tos keyword takes a single type of service and
matches it. Thus the packet with tos 5 matches and tos 6 fails.<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.5pt;
mso-bidi-font-size:10.0pt;font-family:"Trebuchet MS";mso-bidi-font-family:"Courier New"'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.5pt;
mso-bidi-font-size:10.0pt;font-family:"Trebuchet MS";mso-bidi-font-family:"Courier New"'>alert
tcp any any -&gt; any any<span style="mso-spacerun: yes">  </span>(msg:&quot;Rule
1&quot;; tos:!0x5;)<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.5pt;
mso-bidi-font-size:10.0pt;font-family:"Trebuchet MS";mso-bidi-font-family:"Courier New"'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.5pt;
mso-bidi-font-size:10.0pt;font-family:"Trebuchet MS";mso-bidi-font-family:"Courier New"'>[**]
[1:0:0] Rule 1 [**]<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.5pt;
mso-bidi-font-size:10.0pt;font-family:"Trebuchet MS";mso-bidi-font-family:"Courier New"'>[Priority:
0] <o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.5pt;
mso-bidi-font-size:10.0pt;font-family:"Trebuchet MS";mso-bidi-font-family:"Courier New"'>05/27-11:20:54.974173
0:0:E8:EE:EC:88 -&gt; FF:FF:FF:FF:FF:FF type:0x800 len:0x46<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.5pt;
mso-bidi-font-size:10.0pt;font-family:"Trebuchet MS";mso-bidi-font-family:"Courier New"'>1.1.1.1:65286
-&gt; 1.1.1.2:65286 TCP TTL:255 TOS:0x6 ID:65286 IpLen:20 DgmLen:56<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.5pt;
mso-bidi-font-size:10.0pt;font-family:"Trebuchet MS";mso-bidi-font-family:"Courier New"'>******S*
Seq: 0x22FEE4<span style="mso-spacerun: yes">  </span>Ack: 0x22FEE4<span
style="mso-spacerun: yes">  </span>Win: 0x1000<span style="mso-spacerun: yes"> 
</span>TcpLen: 20<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.5pt;
mso-bidi-font-size:10.0pt;font-family:"Trebuchet MS";mso-bidi-font-family:"Courier New"'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.5pt;
mso-bidi-font-size:10.0pt;font-family:"Trebuchet MS";mso-bidi-font-family:"Courier New"'>The
! or negation operator triggers the alert whenever we find a tos that is not 5,
as a result the second packet with tos 6 matches.<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.5pt;
mso-bidi-font-size:10.0pt;font-family:"Trebuchet MS";mso-bidi-font-family:"Courier New"'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.5pt;
mso-bidi-font-size:10.0pt;font-family:"Trebuchet MS";mso-bidi-font-family:"Courier New"'>alert
tcp any any -&gt; any any<span style="mso-spacerun: yes"> 
</span>(msg:&quot;Rule 1&quot;; tos:!5;)<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.5pt;
mso-bidi-font-size:10.0pt;font-family:"Trebuchet MS";mso-bidi-font-family:"Courier New"'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.5pt;
mso-bidi-font-size:10.0pt;font-family:"Trebuchet MS";mso-bidi-font-family:"Courier New"'>[**]
[1:0:0] Rule 1 [**]<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.5pt;
mso-bidi-font-size:10.0pt;font-family:"Trebuchet MS";mso-bidi-font-family:"Courier New"'>[Priority:
0] <o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.5pt;
mso-bidi-font-size:10.0pt;font-family:"Trebuchet MS";mso-bidi-font-family:"Courier New"'>05/27-11:22:25.599925
0:0:E8:EE:EC:88 -&gt; FF:FF:FF:FF:FF:FF type:0x800 len:0x46<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.5pt;
mso-bidi-font-size:10.0pt;font-family:"Trebuchet MS";mso-bidi-font-family:"Courier New"'>1.1.1.1:65286
-&gt; 1.1.1.2:65286 TCP TTL:255 TOS:0x5 ID:65286 IpLen:20 DgmLen:56<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.5pt;
mso-bidi-font-size:10.0pt;font-family:"Trebuchet MS";mso-bidi-font-family:"Courier New"'>******S*
Seq: 0x22FEE4<span style="mso-spacerun: yes">  </span>Ack: 0x22FEE4<span
style="mso-spacerun: yes">  </span>Win: 0x1000<span style="mso-spacerun: yes"> 
</span>TcpLen: 20<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.5pt;
mso-bidi-font-size:10.0pt;font-family:"Trebuchet MS";mso-bidi-font-family:"Courier New"'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.5pt;
mso-bidi-font-size:10.0pt;font-family:"Trebuchet MS";mso-bidi-font-family:"Courier New"'>[**]
[1:0:0] Rule 1 [**]<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.5pt;
mso-bidi-font-size:10.0pt;font-family:"Trebuchet MS";mso-bidi-font-family:"Courier New"'>[Priority:
0] <o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.5pt;
mso-bidi-font-size:10.0pt;font-family:"Trebuchet MS";mso-bidi-font-family:"Courier New"'>05/27-11:22:26.160705
0:0:E8:EE:EC:88 -&gt; FF:FF:FF:FF:FF:FF type:0x800 len:0x46<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.5pt;
mso-bidi-font-size:10.0pt;font-family:"Trebuchet MS";mso-bidi-font-family:"Courier New"'>1.1.1.1:65286
-&gt; 1.1.1.2:65286 TCP TTL:255 TOS:0x6 ID:65286 IpLen:20 DgmLen:56<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.5pt;
mso-bidi-font-size:10.0pt;font-family:"Trebuchet MS";mso-bidi-font-family:"Courier New"'>******S*
Seq: 0x22FEE4<span style="mso-spacerun: yes">  </span>Ack: 0x22FEE4<span
style="mso-spacerun: yes">  </span>Win: 0x1000<span style="mso-spacerun: yes"> 
</span>TcpLen: 20<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.5pt;
mso-bidi-font-size:10.0pt;font-family:"Trebuchet MS";mso-bidi-font-family:"Courier New"'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.5pt;
mso-bidi-font-size:10.0pt;font-family:"Trebuchet MS";mso-bidi-font-family:"Courier New"'>Every
piece of software that we have used so far has bugs, Microsoft or open source.
In the above conf file we have made only one change, we have removed the hex
notation. We always thought that 5 and 0x5 were the same. Snort thinks not and
if we remove the hex notation we get a match on all tos values. Can't figure
out what has gone wrong.<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.5pt;
mso-bidi-font-size:10.0pt;font-family:"Trebuchet MS";mso-bidi-font-family:"Courier New"'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.5pt;
mso-bidi-font-size:10.0pt;font-family:"Trebuchet MS";mso-bidi-font-family:"Courier New"'>nemesis
tcp -v<span style="mso-spacerun: yes">  </span>-P vijay.txt -S 1.1.1.1 -D
1.1.1.2 -I 5<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.5pt;
mso-bidi-font-size:10.0pt;font-family:"Trebuchet MS";mso-bidi-font-family:"Courier New"'>nemesis
tcp -v<span style="mso-spacerun: yes">  </span>-P vijay.txt -S 1.1.1.1 -D
1.1.1.2 -I 6<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.5pt;
mso-bidi-font-size:10.0pt;font-family:"Trebuchet MS";mso-bidi-font-family:"Courier New"'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.5pt;
mso-bidi-font-size:10.0pt;font-family:"Trebuchet MS";mso-bidi-font-family:"Courier New"'>alert
tcp any any -&gt; any any<span style="mso-spacerun: yes"> 
</span>(msg:&quot;Rule 1&quot;; id:5;)<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.5pt;
mso-bidi-font-size:10.0pt;font-family:"Trebuchet MS";mso-bidi-font-family:"Courier New"'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.5pt;
mso-bidi-font-size:10.0pt;font-family:"Trebuchet MS";mso-bidi-font-family:"Courier New"'>[**]
[1:0:0] Rule 1 [**]<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.5pt;
mso-bidi-font-size:10.0pt;font-family:"Trebuchet MS";mso-bidi-font-family:"Courier New"'>[Priority:
0] <o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.5pt;
mso-bidi-font-size:10.0pt;font-family:"Trebuchet MS";mso-bidi-font-family:"Courier New"'>05/27-11:26:18.281239
0:0:E8:EE:EC:88 -&gt; FF:FF:FF:FF:FF:FF type:0x800 len:0x46<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.5pt;
mso-bidi-font-size:10.0pt;font-family:"Trebuchet MS";mso-bidi-font-family:"Courier New"'>1.1.1.1:65286
-&gt; 1.1.1.2:65286 TCP TTL:255 TOS:0x0 ID:5 IpLen:20 DgmLen:56<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.5pt;
mso-bidi-font-size:10.0pt;font-family:"Trebuchet MS";mso-bidi-font-family:"Courier New"'>******S*
Seq: 0x22FEE4<span style="mso-spacerun: yes">  </span>Ack: 0x22FEE4<span
style="mso-spacerun: yes">  </span>Win: 0x1000<span style="mso-spacerun: yes"> 
</span>TcpLen: 20<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.5pt;
mso-bidi-font-size:10.0pt;font-family:"Trebuchet MS";mso-bidi-font-family:"Courier New"'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.5pt;
mso-bidi-font-size:10.0pt;font-family:"Trebuchet MS";mso-bidi-font-family:"Courier New"'>The
-I option of nemesis allows us to set the id of a IP packet. Using this option,
we send two IP packets with id 5 and 6. This id field to the best of everyones
knowledge is never used by any protocol. Thus it can be safely ignored. However
some hackers, when they send packets use the same id consistently. Thus we use
the id keyword to alert on such packets. Using alerts can give rise to a large
number of false alarms. The snort manual states that the id 31337 is often used
by hackers. build an alert for this and we will start getting a large number of
false positives. Thus be careful in building alerts. Our advice is build a few
alerts but not generic ones. The id field does not even take a negation
operator. Take a look, the first packet with id 5 gets caught.<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.5pt;
mso-bidi-font-size:10.0pt;font-family:"Trebuchet MS";mso-bidi-font-family:"Courier New"'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.5pt;
mso-bidi-font-size:10.0pt;font-family:"Trebuchet MS";mso-bidi-font-family:"Courier New"'>nemesis
tcp -v<span style="mso-spacerun: yes">  </span>-P vijay.txt -S 1.1.1.1 -D
1.1.1.2<span style="mso-spacerun: yes">  </span>-I 5<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.5pt;
mso-bidi-font-size:10.0pt;font-family:"Trebuchet MS";mso-bidi-font-family:"Courier New"'>nemesis
tcp -v<span style="mso-spacerun: yes">  </span>-P vijay1.txt -S 1.1.1.1 -D
1.1.1.3 -I 6<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.5pt;
mso-bidi-font-size:10.0pt;font-family:"Trebuchet MS";mso-bidi-font-family:"Courier New"'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.5pt;
mso-bidi-font-size:10.0pt;font-family:"Trebuchet MS";mso-bidi-font-family:"Courier New"'>vijay.txt<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.5pt;
mso-bidi-font-size:10.0pt;font-family:"Trebuchet MS";mso-bidi-font-family:"Courier New"'>vijay
and sonal<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.5pt;
mso-bidi-font-size:10.0pt;font-family:"Trebuchet MS";mso-bidi-font-family:"Courier New"'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.5pt;
mso-bidi-font-size:10.0pt;font-family:"Trebuchet MS";mso-bidi-font-family:"Courier New"'>vijay1.txt<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.5pt;
mso-bidi-font-size:10.0pt;font-family:"Trebuchet MS";mso-bidi-font-family:"Courier New"'>one<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.5pt;
mso-bidi-font-size:10.0pt;font-family:"Trebuchet MS";mso-bidi-font-family:"Courier New"'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.5pt;
mso-bidi-font-size:10.0pt;font-family:"Trebuchet MS";mso-bidi-font-family:"Courier New"'>alert
tcp any any -&gt; any any<span style="mso-spacerun: yes"> 
</span>(msg:&quot;Rule 1&quot;; dsize: &gt;5;)<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.5pt;
mso-bidi-font-size:10.0pt;font-family:"Trebuchet MS";mso-bidi-font-family:"Courier New"'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.5pt;
mso-bidi-font-size:10.0pt;font-family:"Trebuchet MS";mso-bidi-font-family:"Courier New"'>[**]
[1:0:0] Rule 1 [**]<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.5pt;
mso-bidi-font-size:10.0pt;font-family:"Trebuchet MS";mso-bidi-font-family:"Courier New"'>[Priority:
0] <o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.5pt;
mso-bidi-font-size:10.0pt;font-family:"Trebuchet MS";mso-bidi-font-family:"Courier New"'>05/27-11:35:58.246689
0:0:E8:EE:EC:88 -&gt; FF:FF:FF:FF:FF:FF type:0x800 len:0x46<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.5pt;
mso-bidi-font-size:10.0pt;font-family:"Trebuchet MS";mso-bidi-font-family:"Courier New"'>1.1.1.1:65286
-&gt; 1.1.1.2:65286 TCP TTL:255 TOS:0x0 ID:5 IpLen:20 DgmLen:56<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.5pt;
mso-bidi-font-size:10.0pt;font-family:"Trebuchet MS";mso-bidi-font-family:"Courier New"'>******S*
Seq: 0x22FEE4<span style="mso-spacerun: yes">  </span>Ack: 0x22FEE4<span
style="mso-spacerun: yes">  </span>Win: 0x1000<span style="mso-spacerun: yes"> 
</span>TcpLen: 20<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.5pt;
mso-bidi-font-size:10.0pt;font-family:"Trebuchet MS";mso-bidi-font-family:"Courier New"'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.5pt;
mso-bidi-font-size:10.0pt;font-family:"Trebuchet MS";mso-bidi-font-family:"Courier New"'>We
send two payloads one with size 16 and the other with size 5. The dsize options
catches packets of a certain size. We want to catch all packets larger than 5
and hence use the dsize keywrd with &gt;5. This helps in catching odd sized
packets. <o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.5pt;
mso-bidi-font-size:10.0pt;font-family:"Trebuchet MS";mso-bidi-font-family:"Courier New"'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.5pt;
mso-bidi-font-size:10.0pt;font-family:"Trebuchet MS";mso-bidi-font-family:"Courier New"'>alert
tcp any any -&gt; any any<span style="mso-spacerun: yes"> 
</span>(msg:&quot;Rule 1&quot;; dsize: 3&lt;&gt;8;)<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.5pt;
mso-bidi-font-size:10.0pt;font-family:"Trebuchet MS";mso-bidi-font-family:"Courier New"'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.5pt;
mso-bidi-font-size:10.0pt;font-family:"Trebuchet MS";mso-bidi-font-family:"Courier New"'>[**]
[1:0:0] Rule 1 [**]<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.5pt;
mso-bidi-font-size:10.0pt;font-family:"Trebuchet MS";mso-bidi-font-family:"Courier New"'>[Priority:
0] <o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.5pt;
mso-bidi-font-size:10.0pt;font-family:"Trebuchet MS";mso-bidi-font-family:"Courier New"'>05/27-11:42:47.297106
0:0:E8:EE:EC:88 -&gt; FF:FF:FF:FF:FF:FF type:0x800 len:0x3C<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.5pt;
mso-bidi-font-size:10.0pt;font-family:"Trebuchet MS";mso-bidi-font-family:"Courier New"'>1.1.1.1:65286
-&gt; 1.1.1.3:65286 TCP TTL:255 TOS:0x0 ID:6 IpLen:20 DgmLen:45<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.5pt;
mso-bidi-font-size:10.0pt;font-family:"Trebuchet MS";mso-bidi-font-family:"Courier New"'>******S*
Seq: 0x22FEE4<span style="mso-spacerun: yes">  </span>Ack: 0x22FEE4<span
style="mso-spacerun: yes">  </span>Win: 0x1000<span style="mso-spacerun: yes"> 
</span>TcpLen: 20<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.5pt;
mso-bidi-font-size:10.0pt;font-family:"Trebuchet MS";mso-bidi-font-family:"Courier New"'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.5pt;
mso-bidi-font-size:10.0pt;font-family:"Trebuchet MS";mso-bidi-font-family:"Courier New"'>The
&lt;&gt; can be used as a range and thus 3 &lt;&gt; 8 catches all packets with
a payload size not counting TCP and IP of between 3 and 8. The second packet
has a payload 4 and thus it triggers off.<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.5pt;
mso-bidi-font-size:10.0pt;font-family:"Trebuchet MS";mso-bidi-font-family:"Courier New"'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.5pt;
mso-bidi-font-size:10.0pt;font-family:"Trebuchet MS";mso-bidi-font-family:"Courier New"'>nemesis
tcp -v<span style="mso-spacerun: yes">  </span>-P vijay.txt -S 1.1.1.1 -D
1.1.1.2<span style="mso-spacerun: yes">  </span>-I 5 -fSA<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.5pt;
mso-bidi-font-size:10.0pt;font-family:"Trebuchet MS";mso-bidi-font-family:"Courier New"'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.5pt;
mso-bidi-font-size:10.0pt;font-family:"Trebuchet MS";mso-bidi-font-family:"Courier New"'>alert
tcp any any -&gt; any any<span style="mso-spacerun: yes"> 
</span>(msg:&quot;Rule 1&quot;; flags:SA;)<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.5pt;
mso-bidi-font-size:10.0pt;font-family:"Trebuchet MS";mso-bidi-font-family:"Courier New"'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.5pt;
mso-bidi-font-size:10.0pt;font-family:"Trebuchet MS";mso-bidi-font-family:"Courier New"'>[**]
[1:0:0] Rule 1 [**]<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.5pt;
mso-bidi-font-size:10.0pt;font-family:"Trebuchet MS";mso-bidi-font-family:"Courier New"'>[Priority:
0] <o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.5pt;
mso-bidi-font-size:10.0pt;font-family:"Trebuchet MS";mso-bidi-font-family:"Courier New"'>05/27-11:48:11.096364
0:0:E8:EE:EC:88 -&gt; FF:FF:FF:FF:FF:FF type:0x800 len:0x46<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.5pt;
mso-bidi-font-size:10.0pt;font-family:"Trebuchet MS";mso-bidi-font-family:"Courier New"'>1.1.1.1:65286
-&gt; 1.1.1.2:65286 TCP TTL:255 TOS:0x0 ID:5 IpLen:20 DgmLen:56<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.5pt;
mso-bidi-font-size:10.0pt;font-family:"Trebuchet MS";mso-bidi-font-family:"Courier New"'>***A**S*
Seq: 0x22FEE4<span style="mso-spacerun: yes">  </span>Ack: 0x22FEE4<span
style="mso-spacerun: yes">  </span>Win: 0x1000<span style="mso-spacerun: yes"> 
</span>TcpLen: 20<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.5pt;
mso-bidi-font-size:10.0pt;font-family:"Trebuchet MS";mso-bidi-font-family:"Courier New"'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.5pt;
mso-bidi-font-size:10.0pt;font-family:"Trebuchet MS";mso-bidi-font-family:"Courier New"'>The
TCP protocol uses a full byte for flags but the last two from the MSB side
remain unused. There are 6 flags S for SYN, A ACK, R RST, F FIn, P PUSH and U
Urgent Pointer. The number 1 and 2 are for the two reserved bits. In nemesis,
the -f option is used for setting flags. Our packet has two flags set Syn and
Ack. The flags in turn give the TCP protocol the extra bytes. A connection is
started by the SYN flag and the Fin flag ends it. An Rst is sent whenever a
packet received is not valid. <o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.5pt;
mso-bidi-font-size:10.0pt;font-family:"Trebuchet MS";mso-bidi-font-family:"Courier New"'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.5pt;
mso-bidi-font-size:10.0pt;font-family:"Trebuchet MS";mso-bidi-font-family:"Courier New"'>The
flags keyword is used to test the flags and we have tested for the Syn and Ack
flags. As our packet has these flags on, an alert gets triggered. <o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.5pt;
mso-bidi-font-size:10.0pt;font-family:"Trebuchet MS";mso-bidi-font-family:"Courier New"'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.5pt;
mso-bidi-font-size:10.0pt;font-family:"Trebuchet MS";mso-bidi-font-family:"Courier New"'>nemesis
tcp -v<span style="mso-spacerun: yes">  </span>-P vijay.txt -S 1.1.1.1 -D
1.1.1.2<span style="mso-spacerun: yes">  </span>-I 5 -fS<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.5pt;
mso-bidi-font-size:10.0pt;font-family:"Trebuchet MS";mso-bidi-font-family:"Courier New"'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.5pt;
mso-bidi-font-size:10.0pt;font-family:"Trebuchet MS";mso-bidi-font-family:"Courier New"'>We
simply send a packet with the Syn flag on but since we are testing for Syn and
Ack, there is no alert.<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.5pt;
mso-bidi-font-size:10.0pt;font-family:"Trebuchet MS";mso-bidi-font-family:"Courier New"'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.5pt;
mso-bidi-font-size:10.0pt;font-family:"Trebuchet MS";mso-bidi-font-family:"Courier New"'>alert
tcp any any -&gt; any any<span style="mso-spacerun: yes"> 
</span>(msg:&quot;Rule 1&quot;; flags:S;)<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.5pt;
mso-bidi-font-size:10.0pt;font-family:"Trebuchet MS";mso-bidi-font-family:"Courier New"'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.5pt;
mso-bidi-font-size:10.0pt;font-family:"Trebuchet MS";mso-bidi-font-family:"Courier New"'>[**]
[1:0:0] Rule 1 [**]<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.5pt;
mso-bidi-font-size:10.0pt;font-family:"Trebuchet MS";mso-bidi-font-family:"Courier New"'>[Priority:
0] <o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.5pt;
mso-bidi-font-size:10.0pt;font-family:"Trebuchet MS";mso-bidi-font-family:"Courier New"'>05/27-13:19:43.992223
0:0:E8:EE:EC:88 -&gt; FF:FF:FF:FF:FF:FF type:0x800 len:0x46<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.5pt;
mso-bidi-font-size:10.0pt;font-family:"Trebuchet MS";mso-bidi-font-family:"Courier New"'>1.1.1.1:65286
-&gt; 1.1.1.2:65286 TCP TTL:255 TOS:0x0 ID:5 IpLen:20 DgmLen:56<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.5pt;
mso-bidi-font-size:10.0pt;font-family:"Trebuchet MS";mso-bidi-font-family:"Courier New"'>******S*
Seq: 0x22FEE4<span style="mso-spacerun: yes">  </span>Ack: 0x22FEE4<span
style="mso-spacerun: yes">  </span>Win: 0x1000<span style="mso-spacerun: yes"> 
</span>TcpLen: 20<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.5pt;
mso-bidi-font-size:10.0pt;font-family:"Trebuchet MS";mso-bidi-font-family:"Courier New"'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.5pt;
mso-bidi-font-size:10.0pt;font-family:"Trebuchet MS";mso-bidi-font-family:"Courier New"'>An
alert is generated as the packet has a SYN and the rule also looks for it.
Thus, the default is an exact macth.<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.5pt;
mso-bidi-font-size:10.0pt;font-family:"Trebuchet MS";mso-bidi-font-family:"Courier New"'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.5pt;
mso-bidi-font-size:10.0pt;font-family:"Trebuchet MS";mso-bidi-font-family:"Courier New"'>nemesis
tcp -v<span style="mso-spacerun: yes">  </span>-P vijay.txt -S 1.1.1.1 -D
1.1.1.2<span style="mso-spacerun: yes">  </span>-I 5 -fSAP<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.5pt;
mso-bidi-font-size:10.0pt;font-family:"Trebuchet MS";mso-bidi-font-family:"Courier New"'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.5pt;
mso-bidi-font-size:10.0pt;font-family:"Trebuchet MS";mso-bidi-font-family:"Courier New"'>alert
tcp any any -&gt; any any<span style="mso-spacerun: yes"> 
</span>(msg:&quot;Rule 1&quot;; flags:SA;)<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.5pt;
mso-bidi-font-size:10.0pt;font-family:"Trebuchet MS";mso-bidi-font-family:"Courier New"'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.5pt;
mso-bidi-font-size:10.0pt;font-family:"Trebuchet MS";mso-bidi-font-family:"Courier New"'>To
iterate again we are sending three flags S, P and A but our alert checks for
only two S and A. There is no alert. This can get highly restraining as the
flags must exactly match. To trigger an event, the flags must be changed to
SAP.<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.5pt;
mso-bidi-font-size:10.0pt;font-family:"Trebuchet MS";mso-bidi-font-family:"Courier New"'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.5pt;
mso-bidi-font-size:10.0pt;font-family:"Trebuchet MS";mso-bidi-font-family:"Courier New"'>alert
tcp any any -&gt; any any<span style="mso-spacerun: yes"> 
</span>(msg:&quot;Rule 1&quot;; flags:SA*;)<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.5pt;
mso-bidi-font-size:10.0pt;font-family:"Trebuchet MS";mso-bidi-font-family:"Courier New"'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.5pt;
mso-bidi-font-size:10.0pt;font-family:"Trebuchet MS";mso-bidi-font-family:"Courier New"'>[**]
[1:0:0] Rule 1 [**]<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.5pt;
mso-bidi-font-size:10.0pt;font-family:"Trebuchet MS";mso-bidi-font-family:"Courier New"'>[Priority:
0] <o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.5pt;
mso-bidi-font-size:10.0pt;font-family:"Trebuchet MS";mso-bidi-font-family:"Courier New"'>05/27-13:24:54.733301
0:0:E8:EE:EC:88 -&gt; FF:FF:FF:FF:FF:FF type:0x800 len:0x46<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.5pt;
mso-bidi-font-size:10.0pt;font-family:"Trebuchet MS";mso-bidi-font-family:"Courier New"'>1.1.1.1:65286
-&gt; 1.1.1.2:65286 TCP TTL:255 TOS:0x0 ID:5 IpLen:20 DgmLen:56<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.5pt;
mso-bidi-font-size:10.0pt;font-family:"Trebuchet MS";mso-bidi-font-family:"Courier New"'>***AP*S*
Seq: 0x22FEE4<span style="mso-spacerun: yes">  </span>Ack: 0x22FEE4<span
style="mso-spacerun: yes">  </span>Win: 0x1000<span style="mso-spacerun: yes"> 
</span>TcpLen: 20<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.5pt;
mso-bidi-font-size:10.0pt;font-family:"Trebuchet MS";mso-bidi-font-family:"Courier New"'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.5pt;
mso-bidi-font-size:10.0pt;font-family:"Trebuchet MS";mso-bidi-font-family:"Courier New"'>The
* means or. Thus if any of the flags meet a match the alert is triggered.<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.5pt;
mso-bidi-font-size:10.0pt;font-family:"Trebuchet MS";mso-bidi-font-family:"Courier New"'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.5pt;
mso-bidi-font-size:10.0pt;font-family:"Trebuchet MS";mso-bidi-font-family:"Courier New"'>alert
tcp any any -&gt; any any<span style="mso-spacerun: yes"> 
</span>(msg:&quot;Rule 1&quot;; flags:S*;)<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.5pt;
mso-bidi-font-size:10.0pt;font-family:"Trebuchet MS";mso-bidi-font-family:"Courier New"'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.5pt;
mso-bidi-font-size:10.0pt;font-family:"Trebuchet MS";mso-bidi-font-family:"Courier New"'>[**]
[1:0:0] Rule 1 [**]<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.5pt;
mso-bidi-font-size:10.0pt;font-family:"Trebuchet MS";mso-bidi-font-family:"Courier New"'>[Priority:
0] <o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.5pt;
mso-bidi-font-size:10.0pt;font-family:"Trebuchet MS";mso-bidi-font-family:"Courier New"'>05/27-13:26:04.774856
0:0:E8:EE:EC:88 -&gt; FF:FF:FF:FF:FF:FF type:0x800 len:0x46<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.5pt;
mso-bidi-font-size:10.0pt;font-family:"Trebuchet MS";mso-bidi-font-family:"Courier New"'>1.1.1.1:65286
-&gt; 1.1.1.2:65286 TCP TTL:255 TOS:0x0 ID:5 IpLen:20 DgmLen:56<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.5pt;
mso-bidi-font-size:10.0pt;font-family:"Trebuchet MS";mso-bidi-font-family:"Courier New"'>***AP*S*
Seq: 0x22FEE4<span style="mso-spacerun: yes">  </span>Ack: 0x22FEE4<span
style="mso-spacerun: yes">  </span>Win: 0x1000<span style="mso-spacerun: yes"> 
</span>TcpLen: 20<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.5pt;
mso-bidi-font-size:10.0pt;font-family:"Trebuchet MS";mso-bidi-font-family:"Courier New"'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.5pt;
mso-bidi-font-size:10.0pt;font-family:"Trebuchet MS";mso-bidi-font-family:"Courier New"'>The
above rule works as long as the syn flag is on.<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.5pt;
mso-bidi-font-size:10.0pt;font-family:"Trebuchet MS";mso-bidi-font-family:"Courier New"'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.5pt;
mso-bidi-font-size:10.0pt;font-family:"Trebuchet MS";mso-bidi-font-family:"Courier New"'>nemesis
tcp -v<span style="mso-spacerun: yes">  </span>-P vijay.txt -S 1.1.1.1 -D
1.1.1.2<span style="mso-spacerun: yes">  </span>-I 5 -fSAP<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.5pt;
mso-bidi-font-size:10.0pt;font-family:"Trebuchet MS";mso-bidi-font-family:"Courier New"'>nemesis
tcp -v<span style="mso-spacerun: yes">  </span>-P vijay.txt -S 1.1.1.1 -D
1.1.1.2<span style="mso-spacerun: yes">  </span>-I 6 -fSA<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.5pt;
mso-bidi-font-size:10.0pt;font-family:"Trebuchet MS";mso-bidi-font-family:"Courier New"'>nemesis
tcp -v <span style="mso-spacerun: yes"> </span>-P vijay.txt -S 1.1.1.1 -D
1.1.1.2<span style="mso-spacerun: yes">  </span>-I 7 -fP<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.5pt;
mso-bidi-font-size:10.0pt;font-family:"Trebuchet MS";mso-bidi-font-family:"Courier New"'>nemesis
tcp -v<span style="mso-spacerun: yes">  </span>-P vijay.txt -S 1.1.1.1 -D
1.1.1.2<span style="mso-spacerun: yes">  </span>-I 8 -fA<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.5pt;
mso-bidi-font-size:10.0pt;font-family:"Trebuchet MS";mso-bidi-font-family:"Courier New"'>nemesis
tcp -v<span style="mso-spacerun: yes">  </span>-P vijay.txt -S 1.1.1.1 -D
1.1.1.2<span style="mso-spacerun: yes">  </span>-I 9 -fS<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.5pt;
mso-bidi-font-size:10.0pt;font-family:"Trebuchet MS";mso-bidi-font-family:"Courier New"'>nemesis
tcp -v<span style="mso-spacerun: yes">  </span>-P vijay.txt -S 1.1.1.1 -D
1.1.1.2<span style="mso-spacerun: yes">  </span>-I 10 -fSP<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.5pt;
mso-bidi-font-size:10.0pt;font-family:"Trebuchet MS";mso-bidi-font-family:"Courier New"'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.5pt;
mso-bidi-font-size:10.0pt;font-family:"Trebuchet MS";mso-bidi-font-family:"Courier New"'>alert
tcp any any -&gt; any any<span style="mso-spacerun: yes"> 
</span>(msg:&quot;Rule 1&quot;; flags:SA*;)<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.5pt;
mso-bidi-font-size:10.0pt;font-family:"Trebuchet MS";mso-bidi-font-family:"Courier New"'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.5pt;
mso-bidi-font-size:10.0pt;font-family:"Trebuchet MS";mso-bidi-font-family:"Courier New"'>[**]
[1:0:0] Rule 1 [**]<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.5pt;
mso-bidi-font-size:10.0pt;font-family:"Trebuchet MS";mso-bidi-font-family:"Courier New"'>[Priority:
0] <o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.5pt;
mso-bidi-font-size:10.0pt;font-family:"Trebuchet MS";mso-bidi-font-family:"Courier New"'>05/27-13:28:28.660888
0:0:E8:EE:EC:88 -&gt; FF:FF:FF:FF:FF:FF type:0x800 len:0x46<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.5pt;
mso-bidi-font-size:10.0pt;font-family:"Trebuchet MS";mso-bidi-font-family:"Courier New"'>1.1.1.1:65286
-&gt; 1.1.1.2:65286 TCP TTL:255 TOS:0x0 ID:5 IpLen:20 DgmLen:56<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.5pt;
mso-bidi-font-size:10.0pt;font-family:"Trebuchet MS";mso-bidi-font-family:"Courier New"'>***AP*S*
Seq: 0x22FEE4<span style="mso-spacerun: yes">  </span>Ack: 0x22FEE4<span
style="mso-spacerun: yes">  </span>Win: 0x1000<span style="mso-spacerun: yes"> 
</span>TcpLen: 20<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.5pt;
mso-bidi-font-size:10.0pt;font-family:"Trebuchet MS";mso-bidi-font-family:"Courier New"'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.5pt;
mso-bidi-font-size:10.0pt;font-family:"Trebuchet MS";mso-bidi-font-family:"Courier New"'>[**]
[1:0:0] Rule 1 [**]<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.5pt;
mso-bidi-font-size:10.0pt;font-family:"Trebuchet MS";mso-bidi-font-family:"Courier New"'>[Priority:
0] <o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.5pt;
mso-bidi-font-size:10.0pt;font-family:"Trebuchet MS";mso-bidi-font-family:"Courier New"'>05/27-13:28:29.242084
0:0:E8:EE:EC:88 -&gt; FF:FF:FF:FF:FF:FF type:0x800 len:0x46<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.5pt;
mso-bidi-font-size:10.0pt;font-family:"Trebuchet MS";mso-bidi-font-family:"Courier New"'>1.1.1.1:65286
-&gt; 1.1.1.2:65286 TCP TTL:255 TOS:0x0 ID:6 IpLen:20 DgmLen:56<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.5pt;
mso-bidi-font-size:10.0pt;font-family:"Trebuchet MS";mso-bidi-font-family:"Courier New"'>***A**S*
Seq: 0x22FEE4<span style="mso-spacerun: yes">  </span>Ack: 0x22FEE4<span
style="mso-spacerun: yes">  </span>Win: 0x1000<span style="mso-spacerun: yes"> 
</span>TcpLen: 20<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.5pt;
mso-bidi-font-size:10.0pt;font-family:"Trebuchet MS";mso-bidi-font-family:"Courier New"'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.5pt;
mso-bidi-font-size:10.0pt;font-family:"Trebuchet MS";mso-bidi-font-family:"Courier New"'>[**]
[1:0:0] Rule 1 [**]<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.5pt;
mso-bidi-font-size:10.0pt;font-family:"Trebuchet MS";mso-bidi-font-family:"Courier New"'>[Priority:
0] <o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.5pt;
mso-bidi-font-size:10.0pt;font-family:"Trebuchet MS";mso-bidi-font-family:"Courier New"'>05/27-13:28:30.383703
0:0:E8:EE:EC:88 -&gt; FF:FF:FF:FF:FF:FF type:0x800 len:0x46<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.5pt;
mso-bidi-font-size:10.0pt;font-family:"Trebuchet MS";mso-bidi-font-family:"Courier New"'>1.1.1.1:65286
-&gt; 1.1.1.2:65286 TCP TTL:255 TOS:0x0 ID:8 IpLen:20 DgmLen:56<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.5pt;
mso-bidi-font-size:10.0pt;font-family:"Trebuchet MS";mso-bidi-font-family:"Courier New"'>***A****
Seq: 0x22FEE4<span style="mso-spacerun: yes">  </span>Ack: 0x22FEE4<span
style="mso-spacerun: yes">  </span>Win: 0x1000<span style="mso-spacerun: yes"> 
</span>TcpLen: 20<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.5pt;
mso-bidi-font-size:10.0pt;font-family:"Trebuchet MS";mso-bidi-font-family:"Courier New"'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.5pt;
mso-bidi-font-size:10.0pt;font-family:"Trebuchet MS";mso-bidi-font-family:"Courier New"'>[**]
[1:0:0] Rule 1 [**]<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.5pt;
mso-bidi-font-size:10.0pt;font-family:"Trebuchet MS";mso-bidi-font-family:"Courier New"'>[Priority:
0] <o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.5pt;
mso-bidi-font-size:10.0pt;font-family:"Trebuchet MS";mso-bidi-font-family:"Courier New"'>05/27-13:28:30.954243
0:0:E8:EE:EC:88 -&gt; FF:FF:FF:FF:FF:FF type:0x800 len:0x46<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.5pt;
mso-bidi-font-size:10.0pt;font-family:"Trebuchet MS";mso-bidi-font-family:"Courier New"'>1.1.1.1:65286
-&gt; 1.1.1.2:65286 TCP TTL:255 TOS:0x0 ID:9 IpLen:20 DgmLen:56<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.5pt;
mso-bidi-font-size:10.0pt;font-family:"Trebuchet MS";mso-bidi-font-family:"Courier New"'>******S*
Seq: 0x22FEE4<span style="mso-spacerun: yes">  </span>Ack: 0x22FEE4<span
style="mso-spacerun: yes">  </span>Win: 0x1000<span style="mso-spacerun: yes"> 
</span>TcpLen: 20<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.5pt;
mso-bidi-font-size:10.0pt;font-family:"Trebuchet MS";mso-bidi-font-family:"Courier New"'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.5pt;
mso-bidi-font-size:10.0pt;font-family:"Trebuchet MS";mso-bidi-font-family:"Courier New"'>[**]
[1:0:0] Rule 1 [**]<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.5pt;
mso-bidi-font-size:10.0pt;font-family:"Trebuchet MS";mso-bidi-font-family:"Courier New"'>[Priority:
0] <o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.5pt;
mso-bidi-font-size:10.0pt;font-family:"Trebuchet MS";mso-bidi-font-family:"Courier New"'>05/27-13:28:31.525366
0:0:E8:EE:EC:88 -&gt; FF:FF:FF:FF:FF:FF type:0x800 len:0x46<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.5pt;
mso-bidi-font-size:10.0pt;font-family:"Trebuchet MS";mso-bidi-font-family:"Courier New"'>1.1.1.1:65286
-&gt; 1.1.1.2:65286 TCP TTL:255 TOS:0x0 ID:10 IpLen:20 DgmLen:56<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.5pt;
mso-bidi-font-size:10.0pt;font-family:"Trebuchet MS";mso-bidi-font-family:"Courier New"'>****P*S*
Seq: 0x22FEE4<span style="mso-spacerun: yes">  </span>Ack: 0x22FEE4<span
style="mso-spacerun: yes">  </span>Win: 0x1000<span style="mso-spacerun: yes"> 
</span>TcpLen: 20<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.5pt;
mso-bidi-font-size:10.0pt;font-family:"Trebuchet MS";mso-bidi-font-family:"Courier New"'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.5pt;
mso-bidi-font-size:10.0pt;font-family:"Trebuchet MS";mso-bidi-font-family:"Courier New"'>Our
rule dictates that either the Syn or Ack flags or both flags must be on in the
packet. Packet with id 5 passes as it has both flags on plus an extra push that
does not come in the way. ID 6 has both Syn and Ack and thus passes. Packet id
7 has only push and hence does not trigger an alert. Packets with id 8 and 9
only have Syn or Ack and hence trigger. Packet ID 10 has Syn and Push and
triggers the event. The * means all but even if one flag matches the trigger
goes on, the other flags do not matter.<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.5pt;
mso-bidi-font-size:10.0pt;font-family:"Trebuchet MS";mso-bidi-font-family:"Courier New"'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.5pt;
mso-bidi-font-size:10.0pt;font-family:"Trebuchet MS";mso-bidi-font-family:"Courier New"'>alert
tcp any any -&gt; any any<span style="mso-spacerun: yes"> 
</span>(msg:&quot;Rule 1&quot;; flags:SA+;)<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.5pt;
mso-bidi-font-size:10.0pt;font-family:"Trebuchet MS";mso-bidi-font-family:"Courier New"'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.5pt;
mso-bidi-font-size:10.0pt;font-family:"Trebuchet MS";mso-bidi-font-family:"Courier New"'>[**]
[1:0:0] Rule 1 [**]<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.5pt;
mso-bidi-font-size:10.0pt;font-family:"Trebuchet MS";mso-bidi-font-family:"Courier New"'>[Priority:
0] <o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.5pt;
mso-bidi-font-size:10.0pt;font-family:"Trebuchet MS";mso-bidi-font-family:"Courier New"'>05/27-13:33:06.698437
0:0:E8:EE:EC:88 -&gt; FF:FF:FF:FF:FF:FF type:0x800 len:0x46<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.5pt;
mso-bidi-font-size:10.0pt;font-family:"Trebuchet MS";mso-bidi-font-family:"Courier New"'>1.1.1.1:65286
-&gt; 1.1.1.2:65286 TCP TTL:255 TOS:0x0 ID:5 IpLen:20 DgmLen:56<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.5pt;
mso-bidi-font-size:10.0pt;font-family:"Trebuchet MS";mso-bidi-font-family:"Courier New"'>***AP*S*
Seq: 0x22FEE4<span style="mso-spacerun: yes">  </span>Ack: 0x22FEE4<span
style="mso-spacerun: yes">  </span>Win: 0x1000<span style="mso-spacerun: yes"> 
</span>TcpLen: 20<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.5pt;
mso-bidi-font-size:10.0pt;font-family:"Trebuchet MS";mso-bidi-font-family:"Courier New"'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.5pt;
mso-bidi-font-size:10.0pt;font-family:"Trebuchet MS";mso-bidi-font-family:"Courier New"'>[**]
[1:0:0] Rule 1 [**]<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.5pt;
mso-bidi-font-size:10.0pt;font-family:"Trebuchet MS";mso-bidi-font-family:"Courier New"'>[Priority:
0] <o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.5pt;
mso-bidi-font-size:10.0pt;font-family:"Trebuchet MS";mso-bidi-font-family:"Courier New"'>05/27-13:33:07.269587
0:0:E8:EE:EC:88 -&gt; FF:FF:FF:FF:FF:FF type:0x800 len:0x46<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.5pt;
mso-bidi-font-size:10.0pt;font-family:"Trebuchet MS";mso-bidi-font-family:"Courier New"'>1.1.1.1:65286
-&gt; 1.1.1.2:65286 TCP TTL:255 TOS:0x0 ID:6 IpLen:20 DgmLen:56<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.5pt;
mso-bidi-font-size:10.0pt;font-family:"Trebuchet MS";mso-bidi-font-family:"Courier New"'>***A**S*
Seq: 0x22FEE4<span style="mso-spacerun: yes">  </span>Ack: 0x22FEE4<span
style="mso-spacerun: yes">  </span>Win: 0x1000<span style="mso-spacerun: yes"> 
</span>TcpLen: 20<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.5pt;
mso-bidi-font-size:10.0pt;font-family:"Trebuchet MS";mso-bidi-font-family:"Courier New"'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.5pt;
mso-bidi-font-size:10.0pt;font-family:"Trebuchet MS";mso-bidi-font-family:"Courier New"'>The
plus means and and therefore it makes sure that if all the flags are present
in the packet the alert sends. In our case, packets with id 5 and 6 are the
only ones that have both Syn and Ack present. Packet 5 may have an extra flag
push, but as it has s and a, it triggers the event.<span style="mso-spacerun:
yes">  </span>Without a +, it means an exact match no extra flags, the + is
less restrictive, it only says the flags must be there, extras flags<span
style="mso-spacerun: yes">  </span>will be ignored.<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.5pt;
mso-bidi-font-size:10.0pt;font-family:"Trebuchet MS";mso-bidi-font-family:"Courier New"'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.5pt;
mso-bidi-font-size:10.0pt;font-family:"Trebuchet MS";mso-bidi-font-family:"Courier New"'>alert
tcp any any -&gt; any any<span style="mso-spacerun: yes"> 
</span>(msg:&quot;Rule 1&quot;; flags:SA;)<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.5pt;
mso-bidi-font-size:10.0pt;font-family:"Trebuchet MS";mso-bidi-font-family:"Courier New"'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.5pt;
mso-bidi-font-size:10.0pt;font-family:"Trebuchet MS";mso-bidi-font-family:"Courier New"'>[**]
[1:0:0] Rule 1 [**]<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.5pt;
mso-bidi-font-size:10.0pt;font-family:"Trebuchet MS";mso-bidi-font-family:"Courier New"'>[Priority:
0] <o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.5pt;
mso-bidi-font-size:10.0pt;font-family:"Trebuchet MS";mso-bidi-font-family:"Courier New"'>05/27-13:36:03.257786
0:0:E8:EE:EC:88 -&gt; FF:FF:FF:FF:FF:FF type:0x800 len:0x46<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.5pt;
mso-bidi-font-size:10.0pt;font-family:"Trebuchet MS";mso-bidi-font-family:"Courier New"'>1.1.1.1:65286
-&gt; 1.1.1.2:65286 TCP TTL:255 TOS:0x0 ID:6 IpLen:20 DgmLen:56<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.5pt;
mso-bidi-font-size:10.0pt;font-family:"Trebuchet MS";mso-bidi-font-family:"Courier New"'>***A**S*
Seq: 0x22FEE4<span style="mso-spacerun: yes">  </span>Ack: 0x22FEE4<span
style="mso-spacerun: yes">  </span>Win: 0x1000<span style="mso-spacerun: yes"> 
</span>TcpLen: 20<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.5pt;
mso-bidi-font-size:10.0pt;font-family:"Trebuchet MS";mso-bidi-font-family:"Courier New"'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.5pt;
mso-bidi-font-size:10.0pt;font-family:"Trebuchet MS";mso-bidi-font-family:"Courier New"'>Just
to reiterate, only packet id 6 has only S and A. Thus packet id 5 will not
match. <o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.5pt;
mso-bidi-font-size:10.0pt;font-family:"Trebuchet MS";mso-bidi-font-family:"Courier New"'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.5pt;
mso-bidi-font-size:10.0pt;font-family:"Trebuchet MS";mso-bidi-font-family:"Courier New"'>alert
tcp any any -&gt; any any<span style="mso-spacerun: yes"> 
</span>(msg:&quot;Rule 1&quot;; flags:SA,P;)<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.5pt;
mso-bidi-font-size:10.0pt;font-family:"Trebuchet MS";mso-bidi-font-family:"Courier New"'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.5pt;
mso-bidi-font-size:10.0pt;font-family:"Trebuchet MS";mso-bidi-font-family:"Courier New"'>[**]
[1:0:0] Rule 1 [**]<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.5pt;
mso-bidi-font-size:10.0pt;font-family:"Trebuchet MS";mso-bidi-font-family:"Courier New"'>[Priority:
0] <o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.5pt;
mso-bidi-font-size:10.0pt;font-family:"Trebuchet MS";mso-bidi-font-family:"Courier New"'>05/27-13:37:14.198132
0:0:E8:EE:EC:88 -&gt; FF:FF:FF:FF:FF:FF type:0x800 len:0x46<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.5pt;
mso-bidi-font-size:10.0pt;font-family:"Trebuchet MS";mso-bidi-font-family:"Courier New"'>1.1.1.1:65286
-&gt; 1.1.1.2:65286 TCP TTL:255 TOS:0x0 ID:5 IpLen:20 DgmLen:56<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.5pt;
mso-bidi-font-size:10.0pt;font-family:"Trebuchet MS";mso-bidi-font-family:"Courier New"'>***AP*S*
Seq: 0x22FEE4<span style="mso-spacerun: yes">  </span>Ack: 0x22FEE4<span
style="mso-spacerun: yes">  </span>Win: 0x1000<span style="mso-spacerun: yes"> 
</span>TcpLen: 20<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.5pt;
mso-bidi-font-size:10.0pt;font-family:"Trebuchet MS";mso-bidi-font-family:"Courier New"'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.5pt;
mso-bidi-font-size:10.0pt;font-family:"Trebuchet MS";mso-bidi-font-family:"Courier New"'>[**]
[1:0:0] Rule 1 [**]<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.5pt;
mso-bidi-font-size:10.0pt;font-family:"Trebuchet MS";mso-bidi-font-family:"Courier New"'>[Priority:
0] <o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.5pt;
mso-bidi-font-size:10.0pt;font-family:"Trebuchet MS";mso-bidi-font-family:"Courier New"'>05/27-13:37:14.768869
0:0:E8:EE:EC:88 -&gt; FF:FF:FF:FF:FF:FF type:0x800 len:0x46<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.5pt;
mso-bidi-font-size:10.0pt;font-family:"Trebuchet MS";mso-bidi-font-family:"Courier New"'>1.1.1.1:65286
-&gt; 1.1.1.2:65286 TCP TTL:255 TOS:0x0 ID:6 IpLen:20 DgmLen:56<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.5pt;
mso-bidi-font-size:10.0pt;font-family:"Trebuchet MS";mso-bidi-font-family:"Courier New"'>***A**S*
Seq: 0x22FEE4<span style="mso-spacerun: yes">  </span>Ack: 0x22FEE4<span
style="mso-spacerun: yes">  </span>Win: 0x1000<span style="mso-spacerun: yes"> 
</span>TcpLen: 20<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.5pt;
mso-bidi-font-size:10.0pt;font-family:"Trebuchet MS";mso-bidi-font-family:"Courier New"'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.5pt;
mso-bidi-font-size:10.0pt;font-family:"Trebuchet MS";mso-bidi-font-family:"Courier New"'>We
can add a , after the flags to specify a list of flags to ignore. Thus when it
checks the packet it will check for a SYN and a ACK but will yet match if there
is a Push. Thus after the comma we place a series of flags that are to be
ignored.<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.5pt;
mso-bidi-font-size:10.0pt;font-family:"Trebuchet MS";mso-bidi-font-family:"Courier New"'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.5pt;
mso-bidi-font-size:10.0pt;font-family:"Trebuchet MS";mso-bidi-font-family:"Courier New"'>nemesis
tcp -v<span style="mso-spacerun: yes">  </span>-P vijay.txt -S 1.1.1.1 -D
1.1.1.2<span style="mso-spacerun: yes">  </span>-I 5 -fSAPU<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.5pt;
mso-bidi-font-size:10.0pt;font-family:"Trebuchet MS";mso-bidi-font-family:"Courier New"'>nemesis
tcp -v<span style="mso-spacerun: yes">  </span>-P vijay.txt -S 1.1.1.1 -D
1.1.1.2<span style="mso-spacerun: yes">  </span>-I 5 -fSAP<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.5pt;
mso-bidi-font-size:10.0pt;font-family:"Trebuchet MS";mso-bidi-font-family:"Courier New"'>nemesis
tcp -v<span style="mso-spacerun: yes">  </span>-P vijay.txt -S 1.1.1.1 -D
1.1.1.2<span style="mso-spacerun: yes">  </span>-I 5 -fSP<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.5pt;
mso-bidi-font-size:10.0pt;font-family:"Trebuchet MS";mso-bidi-font-family:"Courier New"'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.5pt;
mso-bidi-font-size:10.0pt;font-family:"Trebuchet MS";mso-bidi-font-family:"Courier New"'>alert
tcp any any -&gt; any any<span style="mso-spacerun: yes"> 
</span>(msg:&quot;Rule 1&quot;; flags:SA,P;)<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.5pt;
mso-bidi-font-size:10.0pt;font-family:"Trebuchet MS";mso-bidi-font-family:"Courier New"'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.5pt;
mso-bidi-font-size:10.0pt;font-family:"Trebuchet MS";mso-bidi-font-family:"Courier New"'>[**]
[1:0:0] Rule 1 [**]<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.5pt;
mso-bidi-font-size:10.0pt;font-family:"Trebuchet MS";mso-bidi-font-family:"Courier New"'>[Priority:
0] <o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.5pt;
mso-bidi-font-size:10.0pt;font-family:"Trebuchet MS";mso-bidi-font-family:"Courier New"'>05/27-13:51:53.539290
0:0:E8:EE:EC:88 -&gt; FF:FF:FF:FF:FF:FF type:0x800 len:0x46<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.5pt;
mso-bidi-font-size:10.0pt;font-family:"Trebuchet MS";mso-bidi-font-family:"Courier New"'>1.1.1.1:65286
-&gt; 1.1.1.2:65286 TCP TTL:255 TOS:0x0 ID:5 IpLen:20 DgmLen:56<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.5pt;
mso-bidi-font-size:10.0pt;font-family:"Trebuchet MS";mso-bidi-font-family:"Courier New"'>***AP*S*
Seq: 0x22FEE4<span style="mso-spacerun: yes">  </span>Ack: 0x22FEE4<span
style="mso-spacerun: yes">  </span>Win: 0x1000<span style="mso-spacerun: yes"> 
</span>TcpLen: 20<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.5pt;
mso-bidi-font-size:10.0pt;font-family:"Trebuchet MS";mso-bidi-font-family:"Courier New"'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.5pt;
mso-bidi-font-size:10.0pt;font-family:"Trebuchet MS";mso-bidi-font-family:"Courier New"'>Our
rule is very clear, the packet must have the Syn and Ack flags on but if there
is a push this is allowed. Thus the only two valid combinations are SA and SAP.
The first packet has the U flag and hence does not match. The second matches as
it has S A and P which is optional. The third does<span style="mso-spacerun:
yes">  </span>not have the A and hence does not match. The P is optional. <o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.5pt;
mso-bidi-font-size:10.0pt;font-family:"Trebuchet MS";mso-bidi-font-family:"Courier New"'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.5pt;
mso-bidi-font-size:10.0pt;font-family:"Trebuchet MS";mso-bidi-font-family:"Courier New"'>nemesis
tcp -v<span style="mso-spacerun: yes">  </span>-P vijay.txt -S 1.1.1.1 -D
1.1.1.2<span style="mso-spacerun: yes">  </span>-I 5 -s 2 <o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.5pt;
mso-bidi-font-size:10.0pt;font-family:"Trebuchet MS";mso-bidi-font-family:"Courier New"'>nemesis
tcp -v<span style="mso-spacerun: yes">  </span>-P vijay.txt -S 1.1.1.1 -D
1.1.1.2<span style="mso-spacerun: yes">  </span>-I 5 -a 3<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.5pt;
mso-bidi-font-size:10.0pt;font-family:"Trebuchet MS";mso-bidi-font-family:"Courier New"'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.5pt;
mso-bidi-font-size:10.0pt;font-family:"Trebuchet MS";mso-bidi-font-family:"Courier New"'>alert
tcp any any -&gt; any any<span style="mso-spacerun: yes"> 
</span>(msg:&quot;Rule 1&quot;; seq: 2;)<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.5pt;
mso-bidi-font-size:10.0pt;font-family:"Trebuchet MS";mso-bidi-font-family:"Courier New"'>alert
tcp any any -&gt; any any<span style="mso-spacerun: yes"> 
</span>(msg:&quot;Rule 2&quot;; ack: 3;)<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.5pt;
mso-bidi-font-size:10.0pt;font-family:"Trebuchet MS";mso-bidi-font-family:"Courier New"'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.5pt;
mso-bidi-font-size:10.0pt;font-family:"Trebuchet MS";mso-bidi-font-family:"Courier New"'>[**]
[1:0:0] Rule 1 [**]<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.5pt;
mso-bidi-font-size:10.0pt;font-family:"Trebuchet MS";mso-bidi-font-family:"Courier New"'>[Priority:
0] <o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.5pt;
mso-bidi-font-size:10.0pt;font-family:"Trebuchet MS";mso-bidi-font-family:"Courier New"'>05/27-13:56:55.251161
0:0:E8:EE:EC:88 -&gt; FF:FF:FF:FF:FF:FF type:0x800 len:0x46<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.5pt;
mso-bidi-font-size:10.0pt;font-family:"Trebuchet MS";mso-bidi-font-family:"Courier New"'>1.1.1.1:65286
-&gt; 1.1.1.2:65286 TCP TTL:255 TOS:0x0 ID:5 IpLen:20 DgmLen:56<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.5pt;
mso-bidi-font-size:10.0pt;font-family:"Trebuchet MS";mso-bidi-font-family:"Courier New"'>******S*
Seq: 0x2<span style="mso-spacerun: yes">  </span>Ack: 0x22FEE4<span
style="mso-spacerun: yes">  </span>Win: 0x1000<span style="mso-spacerun: yes"> 
</span>TcpLen: 20<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.5pt;
mso-bidi-font-size:10.0pt;font-family:"Trebuchet MS";mso-bidi-font-family:"Courier New"'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.5pt;
mso-bidi-font-size:10.0pt;font-family:"Trebuchet MS";mso-bidi-font-family:"Courier New"'>[**]
[1:0:0] Rule 2 [**]<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.5pt;
mso-bidi-font-size:10.0pt;font-family:"Trebuchet MS";mso-bidi-font-family:"Courier New"'>[Priority:
0] <o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.5pt;
mso-bidi-font-size:10.0pt;font-family:"Trebuchet MS";mso-bidi-font-family:"Courier New"'>05/27-13:56:55.822513
0:0:E8:EE:EC:88 -&gt; FF:FF:FF:FF:FF:FF type:0x800 len:0x46<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.5pt;
mso-bidi-font-size:10.0pt;font-family:"Trebuchet MS";mso-bidi-font-family:"Courier New"'>1.1.1.1:65286
-&gt; 1.1.1.2:65286 TCP TTL:255 TOS:0x0 ID:5 IpLen:20 DgmLen:56<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.5pt;
mso-bidi-font-size:10.0pt;font-family:"Trebuchet MS";mso-bidi-font-family:"Courier New"'>******S*
Seq: 0x22FEE4<span style="mso-spacerun: yes">  </span>Ack: 0x3<span
style="mso-spacerun: yes">  </span>Win: 0x1000<span style="mso-spacerun: yes"> 
</span>TcpLen: 20<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.5pt;
mso-bidi-font-size:10.0pt;font-family:"Trebuchet MS";mso-bidi-font-family:"Courier New"'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.5pt;
mso-bidi-font-size:10.0pt;font-family:"Trebuchet MS";mso-bidi-font-family:"Courier New"'>The
sequence number field is used by tcp to number the data sent by the packet. In
the three-way handshake, the sequence numbers are exchanged in order to verify
and validate the initial number given to the data sent across. <o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.5pt;
mso-bidi-font-size:10.0pt;font-family:"Trebuchet MS";mso-bidi-font-family:"Courier New"'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.5pt;
mso-bidi-font-size:10.0pt;font-family:"Trebuchet MS";mso-bidi-font-family:"Courier New"'>For
eg, if we have 30 bytes of data to send and a seq no of 12 is sent, we are
specifying that the first byte of data is no 13, the second is no 14, then no
15 and so on. The ACK number simply calls for data from such and such byte
across. Thus an ack of 18 informs that the other side has received bytes 13,
14, 15, 16 and 17 and the data from bytes 18 onwards should be sent. Thus seq
and ack are used for flow control and thus they are the backbone of tcp. <o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.5pt;
mso-bidi-font-size:10.0pt;font-family:"Trebuchet MS";mso-bidi-font-family:"Courier New"'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.5pt;
mso-bidi-font-size:10.0pt;font-family:"Trebuchet MS";mso-bidi-font-family:"Courier New"'>We
have two rules, any packet with a sequence number of 2 is to set off rule 1 as
we are using the keyword seq. The second rule uses the keyword ack to match a
packet with a ack no of 3. Nemesis uses the -s keyword to set the sequence
number to 3 and the second packet uses the ack keyword to set the ack number to
3.<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.5pt;
mso-bidi-font-size:10.0pt;font-family:"Trebuchet MS";mso-bidi-font-family:"Courier New"'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.5pt;
mso-bidi-font-size:10.0pt;font-family:"Trebuchet MS";mso-bidi-font-family:"Courier New"'>nemesis
tcp -v<span style="mso-spacerun: yes">  </span>-P vijay.txt -S 1.1.1.1 -D
1.1.1.2<span style="mso-spacerun: yes">  </span>-I 5 -s 2 <o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.5pt;
mso-bidi-font-size:10.0pt;font-family:"Trebuchet MS";mso-bidi-font-family:"Courier New"'>nemesis
tcp -v<span style="mso-spacerun: yes">  </span>-P vijay.txt -S 1.1.1.1 -D
1.1.1.2<span style="mso-spacerun: yes">  </span>-I 5 -a 3<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.5pt;
mso-bidi-font-size:10.0pt;font-family:"Trebuchet MS";mso-bidi-font-family:"Courier New"'>nemesis
tcp -v<span style="mso-spacerun: yes">  </span>-P vijay.txt -S 1.1.1.1 -D
1.1.1.2<span style="mso-spacerun: yes">  </span>-I 5 -a 3 -s 2<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.5pt;
mso-bidi-font-size:10.0pt;font-family:"Trebuchet MS";mso-bidi-font-family:"Courier New"'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.5pt;
mso-bidi-font-size:10.0pt;font-family:"Trebuchet MS";mso-bidi-font-family:"Courier New"'>alert
tcp any any -&gt; any any<span style="mso-spacerun: yes">  </span>(msg:&quot;Rule
1&quot;; seq: 2; ack: 3;)<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.5pt;
mso-bidi-font-size:10.0pt;font-family:"Trebuchet MS";mso-bidi-font-family:"Courier New"'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.5pt;
mso-bidi-font-size:10.0pt;font-family:"Trebuchet MS";mso-bidi-font-family:"Courier New"'>[**]
[1:0:0] Rule 1 [**]<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.5pt;
mso-bidi-font-size:10.0pt;font-family:"Trebuchet MS";mso-bidi-font-family:"Courier New"'>[Priority:
0] <o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.5pt;
mso-bidi-font-size:10.0pt;font-family:"Trebuchet MS";mso-bidi-font-family:"Courier New"'>05/27-14:04:45.498954
0:0:E8:EE:EC:88 -&gt; FF:FF:FF:FF:FF:FF type:0x800 len:0x46<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.5pt;
mso-bidi-font-size:10.0pt;font-family:"Trebuchet MS";mso-bidi-font-family:"Courier New"'>1.1.1.1:65286
-&gt; 1.1.1.2:65286 TCP TTL:255 TOS:0x0 ID:5 IpLen:20 DgmLen:56<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.5pt;
mso-bidi-font-size:10.0pt;font-family:"Trebuchet MS";mso-bidi-font-family:"Courier New"'>******S*
Seq: 0x2<span style="mso-spacerun: yes">  </span>Ack: 0x3<span
style="mso-spacerun: yes">  </span>Win: 0x1000<span style="mso-spacerun: yes"> 
</span>TcpLen: 20<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.5pt;
mso-bidi-font-size:10.0pt;font-family:"Trebuchet MS";mso-bidi-font-family:"Courier New"'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.5pt;
mso-bidi-font-size:10.0pt;font-family:"Trebuchet MS";mso-bidi-font-family:"Courier New"'>In
nemesis when the -s or -a options are not set, the sequence number and ack no
is randomly generated. The options part of the rule acts like and and in our
case both the sequence and ack nos must be set to 2 and 3. Only packet 3
triggers the alert. <o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.5pt;
mso-bidi-font-size:10.0pt;font-family:"Trebuchet MS";mso-bidi-font-family:"Courier New"'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.5pt;
mso-bidi-font-size:10.0pt;font-family:"Trebuchet MS";mso-bidi-font-family:"Courier New"'>This
option is useful to check when the seq and ack number are zero. These are
packets send by hackers to probe our system.<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.5pt;
mso-bidi-font-size:10.0pt;font-family:"Trebuchet MS";mso-bidi-font-family:"Courier New"'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.5pt;
mso-bidi-font-size:10.0pt;font-family:"Trebuchet MS";mso-bidi-font-family:"Courier New"'>alert
tcp any any -&gt; any any<span style="mso-spacerun: yes"> 
</span>(msg:&quot;Rule 1&quot;; window: 12;)<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.5pt;
mso-bidi-font-size:10.0pt;font-family:"Trebuchet MS";mso-bidi-font-family:"Courier New"'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.5pt;
mso-bidi-font-size:10.0pt;font-family:"Trebuchet MS";mso-bidi-font-family:"Courier New"'>nemesis
tcp -v<span style="mso-spacerun: yes">  </span>-P vijay.txt -S 1.1.1.1 -D
1.1.1.2<span style="mso-spacerun: yes">  </span>-I 5 -w 12<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.5pt;
mso-bidi-font-size:10.0pt;font-family:"Trebuchet MS";mso-bidi-font-family:"Courier New"'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.5pt;
mso-bidi-font-size:10.0pt;font-family:"Trebuchet MS";mso-bidi-font-family:"Courier New"'>[**]
[1:0:0] Rule 1 [**]<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.5pt;
mso-bidi-font-size:10.0pt;font-family:"Trebuchet MS";mso-bidi-font-family:"Courier New"'>[Priority:
0] <o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.5pt;
mso-bidi-font-size:10.0pt;font-family:"Trebuchet MS";mso-bidi-font-family:"Courier New"'>05/27-14:28:49.604309
0:0:E8:EE:EC:88 -&gt; FF:FF:FF:FF:FF:FF type:0x800 len:0x46<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.5pt;
mso-bidi-font-size:10.0pt;font-family:"Trebuchet MS";mso-bidi-font-family:"Courier New"'>1.1.1.1:65286
-&gt; 1.1.1.2:65286 TCP TTL:255 TOS:0x0 ID:5 IpLen:20 DgmLen:56<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.5pt;
mso-bidi-font-size:10.0pt;font-family:"Trebuchet MS";mso-bidi-font-family:"Courier New"'>******S*
Seq: 0x22FEE4<span style="mso-spacerun: yes">  </span>Ack: 0x22FEE4<span
style="mso-spacerun: yes">  </span>Win: 0xC<span style="mso-spacerun: yes"> 
</span>TcpLen: 20<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.5pt;
mso-bidi-font-size:10.0pt;font-family:"Trebuchet MS";mso-bidi-font-family:"Courier New"'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.5pt;
mso-bidi-font-size:10.0pt;font-family:"Trebuchet MS";mso-bidi-font-family:"Courier New"'>In
nemesis, the -w option set the window size and in snort, the window keyword
triggeres an alert for packets of a certain window size. The window size is to
be set by both ends on connection. If the window size is 2000, it means that
the other side will send 2000 bytes without awaiting an ack. Thus it will send
packets totaling 2000 bytes payload and if there is no ack in the forthcoming,
it will resend the packet. The window keyword only has a negation operator.<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.5pt;
mso-bidi-font-size:10.0pt;font-family:"Trebuchet MS";mso-bidi-font-family:"Courier New"'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.5pt;
mso-bidi-font-size:10.0pt;font-family:"Trebuchet MS";mso-bidi-font-family:"Courier New"'>We
installed nmap on machine 70.0.0.1 and ran it as<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.5pt;
mso-bidi-font-size:10.0pt;font-family:"Trebuchet MS";mso-bidi-font-family:"Courier New"'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.5pt;
mso-bidi-font-size:10.0pt;font-family:"Trebuchet MS";mso-bidi-font-family:"Courier New"'>nmap
70.0.0.3<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.5pt;
mso-bidi-font-size:10.0pt;font-family:"Trebuchet MS";mso-bidi-font-family:"Courier New"'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.5pt;
mso-bidi-font-size:10.0pt;font-family:"Trebuchet MS";mso-bidi-font-family:"Courier New"'>This
does a port scan on ip address 70.0.0.3. <o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.5pt;
mso-bidi-font-size:10.0pt;font-family:"Trebuchet MS";mso-bidi-font-family:"Courier New"'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.5pt;
mso-bidi-font-size:10.0pt;font-family:"Trebuchet MS";mso-bidi-font-family:"Courier New"'>Now
we our IDs to inform us whenever a port-scan is attempted on any machine on our
network.<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.5pt;
mso-bidi-font-size:10.0pt;font-family:"Trebuchet MS";mso-bidi-font-family:"Courier New"'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.5pt;
mso-bidi-font-size:10.0pt;font-family:"Trebuchet MS";mso-bidi-font-family:"Courier New"'>preprocessor
flow: <o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.5pt;
mso-bidi-font-size:10.0pt;font-family:"Trebuchet MS";mso-bidi-font-family:"Courier New"'>preprocessor
sfportscan: <o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.5pt;
mso-bidi-font-size:10.0pt;font-family:"Trebuchet MS";mso-bidi-font-family:"Courier New"'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.5pt;
mso-bidi-font-size:10.0pt;font-family:"Trebuchet MS";mso-bidi-font-family:"Courier New"'>There
is a concept of a preprocessor in snort, which receives data before the rules
kick in. The preprocessor is the first entity that receives the packet and it
can store the packet data internally. For example it can wait for a TCP packet
with the syn flag on, it now knows that a connection is to be established. It
can save the entire connection packets and release them when a FIN is send. In
this way, it monitors a session. <o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.5pt;
mso-bidi-font-size:10.0pt;font-family:"Trebuchet MS";mso-bidi-font-family:"Courier New"'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.5pt;
mso-bidi-font-size:10.0pt;font-family:"Trebuchet MS";mso-bidi-font-family:"Courier New"'>For
a port scan it can monitor which host is sending a Syn but not sending a ack.
This host would also be sending multiple syns to port at random. To activate
the preprocessor that monitors scans, we use the sfportscan preprocessor with
no options. This preprocessor relies on the flow preprocessor to work. <o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.5pt;
mso-bidi-font-size:10.0pt;font-family:"Trebuchet MS";mso-bidi-font-family:"Courier New"'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.5pt;
mso-bidi-font-size:10.0pt;font-family:"Trebuchet MS";mso-bidi-font-family:"Courier New"'>[**]
[122:1:0] (portscan) TCP Portscan [**]<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.5pt;
mso-bidi-font-size:10.0pt;font-family:"Trebuchet MS";mso-bidi-font-family:"Courier New"'>05/27-14:49:24.358004
4D:41:43:44:41:44 -&gt; 4D:41:43:44:41:44 type:0x800 len:0xA6<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.5pt;
mso-bidi-font-size:10.0pt;font-family:"Trebuchet MS";mso-bidi-font-family:"Courier New"'>70.0.0.1
-&gt; 70.0.0.3 PROTO255 TTL:0 TOS:0x0 ID:19638 IpLen:20 DgmLen:152<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.5pt;
mso-bidi-font-size:10.0pt;font-family:"Trebuchet MS";mso-bidi-font-family:"Courier New"'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.5pt;
mso-bidi-font-size:10.0pt;font-family:"Trebuchet MS";mso-bidi-font-family:"Courier New"'>An
alert is given signifying a TCP portscan from IP address 70.0.0.1. <o:p></o:p></span></p>

</div>

</body>


<!-- Mirrored from www.vijaymukhi.com/seccourse/snortrules.htm by HTTrack Website Copier/3.x [XR&CO'2014], Fri, 11 Oct 2024 14:42:09 GMT -->
</html>
