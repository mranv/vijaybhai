<html xmlns:o="urn:schemas-microsoft-com:office:office"
xmlns:w="urn:schemas-microsoft-com:office:word"
xmlns="http://www.w3.org/TR/REC-html40">


<!-- Mirrored from www.vijaymukhi.com/seccourse/macaddr.htm by HTTrack Website Copier/3.x [XR&CO'2014], Fri, 11 Oct 2024 14:42:21 GMT -->
<head>
<meta http-equiv=Content-Type content="text/html; charset=windows-1252">
<meta name=ProgId content=Word.Document>
<meta name=Generator content="Microsoft Word 9">
<meta name=Originator content="Microsoft Word 9">
<link rel=File-List href="macaddr_files/filelist.html">
<title>Spoofing a MAC address</title>
<!--[if gte mso 9]><xml>
 <o:DocumentProperties>
  <o:Author>Vijay Mukhi</o:Author>
  <o:Template>Normal</o:Template>
  <o:LastAuthor>Vijay Mukhi</o:LastAuthor>
  <o:Revision>2</o:Revision>
  <o:TotalTime>67</o:TotalTime>
  <o:Created>2005-08-27T11:11:00Z</o:Created>
  <o:LastSaved>2005-08-27T11:11:00Z</o:LastSaved>
  <o:Pages>3</o:Pages>
  <o:Words>965</o:Words>
  <o:Characters>5505</o:Characters>
  <o:Company>VMCI</o:Company>
  <o:Lines>45</o:Lines>
  <o:Paragraphs>11</o:Paragraphs>
  <o:CharactersWithSpaces>6760</o:CharactersWithSpaces>
  <o:Version>9.2720</o:Version>
 </o:DocumentProperties>
</xml><![endif]-->
<style>
<!--
 /* Style Definitions */
p.MsoNormal, li.MsoNormal, div.MsoNormal
	{mso-style-parent:"";
	margin:0in;
	margin-bottom:.0001pt;
	mso-pagination:widow-orphan;
	font-size:12.0pt;
	font-family:"Times New Roman";
	mso-fareast-font-family:"Times New Roman";}
a:link, span.MsoHyperlink
	{color:blue;
	text-decoration:underline;
	text-underline:single;}
a:visited, span.MsoHyperlinkFollowed
	{color:purple;
	text-decoration:underline;
	text-underline:single;}
@page Section1
	{size:8.5in 11.0in;
	margin:1.0in 1.25in 1.0in 1.25in;
	mso-header-margin:.5in;
	mso-footer-margin:.5in;
	mso-paper-source:0;}
div.Section1
	{page:Section1;}
-->
</style>
</head>

<body lang=EN-US link=blue vlink=purple style='tab-interval:.5in'>

<div class=Section1>

<p class=MsoNormal>Spoofing a MAC address.</p>

<p class=MsoNormal><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=MsoNormal>Every Ethernet card or NIC (Network Interface Card) is know
by a 48 bit number. This number is called the Ethernet address of the card. An
IP address is a logical number and is a 32 bit address. As IP addresses are
logical they can be changed at will. Thus we cannot use an IP address to
pinpoint a machine, but we can use Ethernet addresses to uniquely identify a
NIC card placed in a machine. </p>

<p class=MsoNormal><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=MsoNormal>Ethernet is the lowest or the bottommost protocol in our
networking stack. An Ethernet address identifies a physical end point. An
Ethernet address is used to finally deliver a packet. What we will now show you
is how to change an Ethernet address.</p>

<p class=MsoNormal><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=MsoNormal>We first run a program available on all operating systems
called ipconfig.</p>

<p class=MsoNormal><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=MsoNormal>Ipconfig /all</p>

<p class=MsoNormal><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=MsoNormal>Windows 2000 IP Configuration</p>

<p class=MsoNormal><span style='mso-tab-count:1'>            </span>Host Name .
. . . . . . . . . . . : vmci</p>

<p class=MsoNormal><span style='mso-tab-count:1'>            </span>Primary DNS
Suffix<span style="mso-spacerun: yes">  </span>. . . . . . . : </p>

<p class=MsoNormal><span style='mso-tab-count:1'>            </span>Node Type .
. . . . . . . . . . . : Broadcast</p>

<p class=MsoNormal><span style='mso-tab-count:1'>            </span>IP Routing
Enabled. . . . . . . . : No</p>

<p class=MsoNormal><span style='mso-tab-count:1'>            </span>WINS Proxy
Enabled. . . . . . . . : No</p>

<p class=MsoNormal>Ethernet adapter Bluetooth Network:</p>

<p class=MsoNormal><span style='mso-tab-count:1'>            </span>Media State
. . . . . . . . . . . : Cable Disconnected</p>

<p class=MsoNormal><span style='mso-tab-count:1'>            </span>Description
. . . . . . . . . . . : Bluetooth LAN Access Server Driver</p>

<p class=MsoNormal><span style='mso-tab-count:1'>            </span>Physical
Address. . . . . . . . . : 00-10-60-A8-A4-44</p>

<p class=MsoNormal>Ethernet adapter Local Area Connection 2:</p>

<p class=MsoNormal><span style='mso-tab-count:1'>            </span>Connection-specific
DNS Suffix<span style="mso-spacerun: yes">  </span>. : </p>

<p class=MsoNormal><span style='mso-tab-count:1'>            </span>Description
. . . . . . . . . . . : Realtek RTL8029(AS)-based PCI Ethernet Adapter #2</p>

<p class=MsoNormal><span style='mso-tab-count:1'>            </span>Physical
Address. . . . . . . . . : 00-00-E8-DF-A4-66</p>

<p class=MsoNormal><span style='mso-tab-count:1'>            </span>DHCP
Enabled. . . . . . . . . . . : No</p>

<p class=MsoNormal><span style='mso-tab-count:1'>            </span>IP Address.
. . . . . . . . . . . : 70.0.0.10</p>

<p class=MsoNormal><span style='mso-tab-count:1'>            </span>Subnet Mask
. . . . . . . . . . . : 255.255.255.0</p>

<p class=MsoNormal><span style='mso-tab-count:1'>            </span>Default
Gateway . . . . . . . . . : 70.0.0.4</p>

<p class=MsoNormal><span style='mso-tab-count:1'>            </span>DNS Servers
. . . . . . . . . . . :</p>

<p class=MsoNormal><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=MsoNormal>The above output shows that we have a bluetooth network also
installed and a ethernet card as local area network Connection 2. Our IP
address is 70.0.0.10 and our ethernet address is 00-00-E8-DF-A4-66. The minus
signs are for effect only. We also see that a company called Realtek has
manufactured our card. </p>

<p class=MsoNormal><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=MsoNormal>We then run the regedit program and try and find the string
0000E8DFA466 which is our ethernet address minus the minus signs in our
registry. We click on the menu Edit and then search. The program searches our
entire registry and comes up with a blank. No match found. Thus our ethernet
address is not stored in the registry. We do not give up and now try a
different track. We search for the string Realtek in our registry. We find that
the search stops at a key name
HKEY_LOCAL_MACHINE\SYSTEM\ControlSet001\Control\Class\{4D36E972-E325-11CE-BFC1-08002BE10318}.<span
style="mso-spacerun: yes">  </span>This key is the same for all machines. Here
we have present the descriptions of the network cards and drivers our system
has. For example the 8<sup>th</sup> item is our bluetooth driver and the 10<sup>th</sup>
is the ethernet card. The key DriverDesc has a value of Realtek
RTL8029(AS)-based PCI Ethernet Adapter. We then click with the right mouse
button on key sub name 10 and then choose new, String value. In your case you
would choose the key number corresponding to your ethernet card. We name the
key NetworkAddress. We then press enter and double click on the name, we are
given a dialog box to write out our ethernet address which we specify as
1234567890ab. We now ipconfig /all and see no change at all. We then reboot our
machine. Now when we run ipconfig /all this is what we get </p>

<p class=MsoNormal><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=MsoNormal><span style='mso-tab-count:1'>            </span>Description
. . . . . . . . . . . : Realtek RTL8029(AS)-based PCI Ethernet Adapter #2</p>

<p class=MsoNormal><span style='mso-tab-count:1'>            </span>Physical
Address. . . . . . . . . : 12-34-56-78-90-AB</p>

<p class=MsoNormal></p>

<p class=MsoNormal>When we run ethereal on our machine our ethernet address has
changed. Thus we have changed the ethernet address of our card, the question is
how did we create the above magic. We cheated. Lets tell you how we cheated.</p>

<p class=MsoNormal><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=MsoNormal>While surfing the net for mac cloning we came across a site
that has a program to change a mac address. The url is <a
href="http://www.klcconsulting.net/smac/smac12_download/SMAC12_Eval.exe/">http://www.klcconsulting.net/smac/smac12_download/SMAC12_Eval.exe/</a>
This is a free trial version that changes the mac address to 0c0c0c0c0c01. When
we run the program it shows us all the interfaces we have, we choose the interface
in our case Realtek and then click on update mac. We reboot the system and
viola the mac address changes. We wanted to know how this program works its
magic.</p>

<p class=MsoNormal><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=MsoNormal>We next downloaded a program <a
href="http://www.sysinternals.com/Files/RegmonNt.zip">http://www.sysinternals.com/Files/RegmonNt.zip</a>
from the site sysinternals. We extracted the program and then ran the exe file
regmon. This program is a registry spy and tells us what program is making what
changes to our registry. We then ran the smac and carried out the same
procedure. We then saw in the registry spy that smac is simply creating the key
NetworkAddress and giving it<span style="mso-spacerun: yes">  </span>a value.</p>

<p class=MsoNormal><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=MsoNormal>SMAC.exe:520<span style='mso-tab-count:1'>            </span>CreateKey<span
style='mso-tab-count:1'>            </span>HKLM\SYSTEM\CurrentControlSet\Control\Class\{4D36E972-E325-11CE-BFC1-08002BE10318}\0010<span
style='mso-tab-count:1'>            </span>SUCCESS<span style='mso-tab-count:
1'>     </span>Access: 0xF003F <span style='mso-tab-count:1'>         </span></p>

<p class=MsoNormal>SMAC.exe:520<span style='mso-tab-count:1'>            </span>SetValue<span
style='mso-tab-count:1'>            </span>HKLM\SYSTEM\CurrentControlSet\Control\Class\{4D36E972-E325-11CE-BFC1-08002BE10318}\0010\NetworkAddress<span
style='mso-tab-count:1'>            </span>SUCCESS<span style='mso-tab-count:
1'>            </span>&quot;0C0C0C0C0C01&quot;<span style='mso-tab-count:1'>     </span></p>

<p class=MsoNormal><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=MsoNormal>This is how we figure out what a piece of software does. To
sum up, the network address is not stored in the registry in a form that can be
read. If we create a key NetworkAddress and give it a value, this is the
ethernet address used. If we delete the key, the system can now use the
original ethernet address. </p>

<p class=MsoNormal><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=MsoNormal>12338: System:8<span style='mso-tab-count:1'>            </span>QueryValue<span
style='mso-tab-count:1'>            </span>HKLM\System\CurrentControlSet\Control\Class\{4D36E972-E325-11CE-BFC1-08002BE10318}\0010\NetworkAddress<span
style='mso-tab-count:1'>            </span>NOT FOUND<span style='mso-tab-count:
1'>          </span></p>

<p class=MsoNormal><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=MsoNormal>We next set an menu option, Options,<span
style="mso-spacerun: yes">  </span>Log Boot on and we get a message box saying
that our log file will be stored in a file C:\winnt\regmon.log. This is a log
of all registry activity made by windows at startup. We can see that it checks
for a key NetworkAddress and if it finds the key it uses its value as the
ethernet address. </p>

<p class=MsoNormal><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=MsoNormal>The key name is<span style="mso-spacerun: yes"> 
</span>HKEY_LOCAL_MACHINE\SYSTEM\ControlSet001\Control\Class\{4D36E972-E325-11CE-BFC1-08002BE10318}
and it is present under the text network adapters in the registry. </p>

<p class=MsoNormal><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=MsoNormal>It is also present under
HKEY_LOCAL_MACHINE\SYSTEM\ControlSet001\Control\Network\{4D36E972-E325-11CE-BFC1-08002BE10318}
and HKEY_LOCAL_MACHINE\SYSTEM\ControlSet001\Control\SafeBoot\Network\{4D36E972-E325-11CE-BFC1-08002BE10318}
and in the below key<span style="mso-spacerun: yes"> 
</span>HKEY_LOCAL_MACHINE\SYSTEM\ControlSet001\Enum\PCI\VEN_10EC&amp;DEV_8029&amp;SUBSYS_00000000&amp;REV_00\4&amp;2af9ed5&amp;0&amp;08F0
under sub key Class GUID.</p>

<p class=MsoNormal><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=MsoNormal>The other places are too numerous to mention.</p>

<p class=MsoNormal><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=MsoNormal>We then downloaded a another program from the site <a
href="http://amac.paqtool.com/images/amac.exe">http://amac.paqtool.com/images/amac.exe</a>
which does the same thing. We double checked that it changes the same registry
settings.</p>

<p class=MsoNormal><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=MsoNormal><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=MsoNormal><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=MsoNormal><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

</div>

</body>


<!-- Mirrored from www.vijaymukhi.com/seccourse/macaddr.htm by HTTrack Website Copier/3.x [XR&CO'2014], Fri, 11 Oct 2024 14:42:22 GMT -->
</html>
