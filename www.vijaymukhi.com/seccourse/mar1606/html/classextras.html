<html xmlns:o="urn:schemas-microsoft-com:office:office"
xmlns:w="urn:schemas-microsoft-com:office:word"
xmlns="http://www.w3.org/TR/REC-html40">


<!-- Mirrored from www.vijaymukhi.com/seccourse/mar1606/html/classextras.htm by HTTrack Website Copier/3.x [XR&CO'2014], Fri, 11 Oct 2024 14:42:24 GMT -->
<head>
<meta http-equiv=Content-Type content="text/html; charset=windows-1252">
<meta name=ProgId content=Word.Document>
<meta name=Generator content="Microsoft Word 9">
<meta name=Originator content="Microsoft Word 9">
<link rel=File-List href="classextras_files/filelist.html">
<title>Misc</title>
<!--[if gte mso 9]><xml>
 <o:DocumentProperties>
  <o:Author>Vijay Mukhi</o:Author>
  <o:Template>Normal</o:Template>
  <o:LastAuthor>Sonal Mukhi</o:LastAuthor>
  <o:Revision>2</o:Revision>
  <o:TotalTime>261</o:TotalTime>
  <o:Created>2006-03-17T10:03:00Z</o:Created>
  <o:LastSaved>2006-03-17T10:03:00Z</o:LastSaved>
  <o:Pages>8</o:Pages>
  <o:Words>1703</o:Words>
  <o:Characters>9708</o:Characters>
  <o:Company>VMCI</o:Company>
  <o:Lines>80</o:Lines>
  <o:Paragraphs>19</o:Paragraphs>
  <o:CharactersWithSpaces>11922</o:CharactersWithSpaces>
  <o:Version>9.2720</o:Version>
 </o:DocumentProperties>
</xml><![endif]-->
<style>
<!--
 /* Style Definitions */
p.MsoNormal, li.MsoNormal, div.MsoNormal
	{mso-style-parent:"";
	margin:0in;
	margin-bottom:.0001pt;
	mso-pagination:widow-orphan;
	font-size:12.0pt;
	font-family:"Times New Roman";
	mso-fareast-font-family:"Times New Roman";}
@page Section1
	{size:8.5in 11.0in;
	margin:1.0in 1.25in 1.0in 1.25in;
	mso-header-margin:.5in;
	mso-footer-margin:.5in;
	mso-paper-source:0;}
div.Section1
	{page:Section1;}
-->
</style>
</head>

<body lang=EN-US style='tab-interval:.5in'>

<div class=Section1>

<p class=MsoNormal>Miscellaneous - Class</p>

<p class=MsoNormal>Is operator</p>

<p class=MsoNormal><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=MsoNormal>class zzz</p>

<p class=MsoNormal>{</p>

<p class=MsoNormal>public static void Main()</p>

<p class=MsoNormal>{</p>

<p class=MsoNormal>yyy a = new yyy();</p>

<p class=MsoNormal>xxx b= new xxx();</p>

<p class=MsoNormal>object o = a;</p>

<p class=MsoNormal>if ( o is yyy)</p>

<p class=MsoNormal>System.Console.WriteLine(&quot;o is yyy&quot;);</p>

<p class=MsoNormal>else</p>

<p class=MsoNormal>System.Console.WriteLine(&quot;o is not yyy&quot;);</p>

<p class=MsoNormal>o = b;</p>

<p class=MsoNormal>if ( o is yyy)</p>

<p class=MsoNormal>System.Console.WriteLine(&quot;o is yyy&quot;);</p>

<p class=MsoNormal>else</p>

<p class=MsoNormal>System.Console.WriteLine(&quot;o is not yyy&quot;);</p>

<p class=MsoNormal>}</p>

<p class=MsoNormal>}</p>

<p class=MsoNormal>class xxx</p>

<p class=MsoNormal>{</p>

<p class=MsoNormal>}</p>

<p class=MsoNormal>class yyy</p>

<p class=MsoNormal>{</p>

<p class=MsoNormal>}</p>

<p class=MsoNormal><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=MsoNormal>o is yyy</p>

<p class=MsoNormal>o is not yyy</p>

<p class=MsoNormal><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=MsoNormal>All classes under .net are derived from the class object. We
are allowed to set a lower class to a higher class and this is why the line o =
a gives us no error. The variable o is of type object but set to a yyy type.
The is keyword allows us to get at the real data type of the variable we are
working with. Lots of times we equate a derived class to a base class, using
the is keyword we can figure the highest class our variable belongs to.</p>

<p class=MsoNormal><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=MsoNormal>Creating Mdi forms</p>

<p class=MsoNormal><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=MsoNormal>We create a simple Windows application in visual studio.net.
We then click on the form and choose menu option View, properties menu. In the
tab Window Style there will be a property IsMdiContainer which is a Boolean
property and we set its value to be true from the default false. The windows
colours change. </p>

<p class=MsoNormal><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=MsoNormal>We then activate the solution explorer, click on name of
solution, right mouse button and choose Add then<span style="mso-spacerun:
yes">  </span>Windows Form where we click on OK at the dialog box. We get a new
form called form2.cs added to our project. We then add a button to this form
form2.<span style="mso-spacerun: yes">  </span>We then choose from the menu tab
of the toolbox a menu strip control into our mdi form form1.cs. We then create
a menu name vijay and below that a label one and click on it so that the
following code gets activated. </p>

<p class=MsoNormal><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=MsoNormal style='mso-layout-grid-align:none;text-autospace:none'><span
style='font-size:10.0pt;font-family:"Courier New";color:blue'>private</span><span
style='font-size:10.0pt;font-family:"Courier New"'> <span style='color:blue'>void</span>
oneToolStripMenuItem_Click(<span style='color:blue'>object</span> sender, <span
style='color:teal'>EventArgs</span> e)<o:p></o:p></span></p>

<p class=MsoNormal style='mso-layout-grid-align:none;text-autospace:none'><span
style='font-size:10.0pt;font-family:"Courier New"'>{<o:p></o:p></span></p>

<p class=MsoNormal style='mso-layout-grid-align:none;text-autospace:none'><span
style='font-size:10.0pt;font-family:"Courier New";color:teal'>Form2</span><span
style='font-size:10.0pt;font-family:"Courier New"'> f = <span style='color:
blue'>new</span> <span style='color:teal'>Form2</span>();<o:p></o:p></span></p>

<p class=MsoNormal style='mso-layout-grid-align:none;text-autospace:none'><span
style='font-size:10.0pt;font-family:"Courier New"'>f.Show();<o:p></o:p></span></p>

<p class=MsoNormal><span style='font-size:10.0pt;font-family:"Courier New"'>}</span></p>

<p class=MsoNormal><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=MsoNormal>As our from is called Form2 we have a class called Form2
which we instantiate. When we call the show function we are actually displaying
the form. Thus we run our program , click on menu vijay and then on menu one
and we see our form. The problem is that it is displayed as an independent
form, not as part of the mdi form.</p>

<p class=MsoNormal><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=MsoNormal style='mso-layout-grid-align:none;text-autospace:none'><span
style='font-size:10.0pt;font-family:"Courier New"'><span style='mso-tab-count:
1'>      </span><span style='color:teal'>Form2</span> f = <span
style='color:blue'>new</span> <span style='color:teal'>Form2</span>();<o:p></o:p></span></p>

<p class=MsoNormal style='mso-layout-grid-align:none;text-autospace:none'><span
style='font-size:10.0pt;font-family:"Courier New"'><span style='mso-tab-count:
3'>                  </span>f.MdiParent = <span style='color:blue'>this</span>;<o:p></o:p></span></p>

<p class=MsoNormal><span style='font-size:10.0pt;font-family:"Courier New"'><span
style='mso-tab-count:3'>                  </span>f.Show();</span></p>

<p class=MsoNormal>We take the MdiParent property of the form and set it to
this which represents the form form1 which is set to be a mdi parent. Now this
form form2 displays within our MDI parent. Create a form Form3 and repeat the
above process.</p>

<p class=MsoNormal><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=MsoNormal>Lock keyword</p>

<p class=MsoNormal><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=MsoNormal>using System.Threading;</p>

<p class=MsoNormal>public class zzz</p>

<p class=MsoNormal>{</p>

<p class=MsoNormal>public static void Main()</p>

<p class=MsoNormal>{</p>

<p class=MsoNormal>yyy a = new yyy();</p>

<p class=MsoNormal>Thread t1 = new Thread(a.abc);</p>

<p class=MsoNormal>Thread t2 = new Thread(a.abc);</p>

<p class=MsoNormal>t1.Start();</p>

<p class=MsoNormal>t2.Start();</p>

<p class=MsoNormal>}</p>

<p class=MsoNormal>}</p>

<p class=MsoNormal>public class yyy</p>

<p class=MsoNormal>{</p>

<p class=MsoNormal>public void abc()</p>

<p class=MsoNormal>{</p>

<p class=MsoNormal>lock(this)</p>

<p class=MsoNormal>{</p>

<p class=MsoNormal>for ( int i = 0 ; i &lt;= 100 ; i ++)</p>

<p class=MsoNormal>{</p>

<p class=MsoNormal>System.Console.Write(&quot;abc {0} &quot;,i);</p>

<p class=MsoNormal>}</p>

<p class=MsoNormal>}</p>

<p class=MsoNormal>}</p>

<p class=MsoNormal>}</p>

<p class=MsoNormal><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=MsoNormal>We are creating two threads that call the same function abc
using the Start method of the thread. As we have commented out the lock
keyword, the two functions output Is intermingled. On our machine the first
call of the thread executes the for loop till 65 and then executes the second
abc for loop. By placing the lock keyword, we are making sure that unless all
the code of abc does net get called, no other thread is allowed to call the
code of abc. Thus the first abc now finishes before the second can get called.</p>

<p class=MsoNormal><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=MsoNormal>using System.Messaging;</p>

<p class=MsoNormal>using System.Text;</p>

<p class=MsoNormal>using System;</p>

<p class=MsoNormal>using System.Drawing;</p>

<p class=MsoNormal>using System.Collections;</p>

<p class=MsoNormal>using System.ComponentModel;</p>

<p class=MsoNormal>using System.Windows.Forms;</p>

<p class=MsoNormal>using System.Data;</p>

<p class=MsoNormal>public class zzz : Form</p>

<p class=MsoNormal>{</p>

<p class=MsoNormal>Button b1;</p>

<p class=MsoNormal>Button b2;</p>

<p class=MsoNormal>public zzz()</p>

<p class=MsoNormal>{</p>

<p class=MsoNormal>b1 = new Button();</p>

<p class=MsoNormal>b2 = new Button();</p>

<p class=MsoNormal>b1.Text = &quot;Send Payment&quot;;</p>

<p class=MsoNormal>b1.Click += new System.EventHandler(abcsend);</p>

<p class=MsoNormal>b1.Location = new Point( 60,90);</p>

<p class=MsoNormal>b2.Text = &quot;Process Payment&quot;;</p>

<p class=MsoNormal>b2.Click += new System.EventHandler(abcrecv);</p>

<p class=MsoNormal>Controls.Add(b2);</p>

<p class=MsoNormal>Controls.Add(b1);</p>

<p class=MsoNormal>}</p>

<p class=MsoNormal>static void Main() </p>

<p class=MsoNormal>{</p>

<p class=MsoNormal>Application.Run(new zzz());</p>

<p class=MsoNormal>}</p>

<p class=MsoNormal>private void abcsend(object sender, System.EventArgs e)</p>

<p class=MsoNormal>{</p>

<p class=MsoNormal>System.Messaging.Message m = new System.Messaging.Message();</p>

<p class=MsoNormal>m.Body=&quot;vijay Mukhi&quot;;</p>

<p class=MsoNormal>MessageQueue mq =new
MessageQueue(&quot;.\\Private$\\sonal&quot;);</p>

<p class=MsoNormal>mq.Send(m);</p>

<p class=MsoNormal>}</p>

<p class=MsoNormal>private void abcrecv(object sender, System.EventArgs e)</p>

<p class=MsoNormal>{<span style='mso-tab-count:1'>          </span></p>

<p class=MsoNormal>MessageQueue m = new
MessageQueue(&quot;.\\Private$\\sonal&quot;);</p>

<p class=MsoNormal>String s =(String)m.Receive().Body;<span style='mso-tab-count:
2'>                  </span></p>

<p class=MsoNormal>MessageBox.Show(s, &quot;Message Received!&quot;);</p>

<p class=MsoNormal>}</p>

<p class=MsoNormal>}</p>

<p class=MsoNormal><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=MsoNormal>&lt;html&gt;</p>

<p class=MsoNormal>&lt;form id=&quot;form1&quot; runat=&quot;server&quot;&gt;</p>

<p class=MsoNormal>hi</p>

<p class=MsoNormal>&lt;asp:DropDownList ID=&quot;d1&quot;
runat=&quot;server&quot; AutoPostBack=&quot;True&quot;
DataSourceID=&quot;s1&quot; DataTextField=&quot;CompanyName&quot;
DataValueField=&quot;CustomerID&quot; /&gt;</p>

<p class=MsoNormal>&lt;asp:SqlDataSource ID=&quot;s1&quot;
runat=&quot;server&quot;
ConnectionString=&quot;server=localhost;uid=sa;pwd=;database=Northwind&quot;
SelectCommand=&quot;SELECT [CustomerID], [CompanyName] FROM [Customers]&quot;
/&gt;</p>

<p class=MsoNormal>&lt;asp:GridView ID=&quot;GridView1&quot;
runat=&quot;server&quot;<span style="mso-spacerun: yes"> 
</span>DataSourceID=&quot;s2&quot; /&gt;</p>

<p class=MsoNormal>&lt;asp:SqlDataSource ID=&quot;s2&quot;
runat=&quot;server&quot;
ConnectionString=&quot;server=localhost;uid=sa;pwd=;database=Northwind&quot;
SelectCommand=&quot;SELECT * FROM [Orders] WHERE [CustomerID] =
@CustomerID&quot;&gt;</p>

<p class=MsoNormal>&lt;SelectParameters&gt;</p>

<p class=MsoNormal>&lt;asp:ControlParameter ControlID=&quot;D1&quot;
Name=&quot;CustomerID&quot; PropertyName=&quot;SelectedValue&quot;
Type=&quot;String&quot; /&gt;</p>

<p class=MsoNormal>&lt;/SelectParameters&gt;</p>

<p class=MsoNormal>&lt;/asp:SqlDataSource&gt;</p>

<p class=MsoNormal>&lt;/form&gt;</p>

<p class=MsoNormal>&lt;/body&gt;</p>

<p class=MsoNormal>&lt;/html&gt;</p>

<p class=MsoNormal>In the above program we first create a drop down list box
that gets its data from<span style="mso-spacerun: yes">  </span>a sql data
source control called s1. From now on we do not write C# code for fetching
data, we use a sql data source control instead. The AutoPostBack property is
set to true so that each time we choose a different item from the list box, the
server should be notified. The sql data source control s1 has a connection
string property which is the same as what we supplied to the constructor of the
sqlconnection class. The select command is what supplies the data to the data
aware controls.<span style="mso-spacerun: yes">  </span>A grid view control is
also like a data grid, they display data. The grid view gets its data from the
sql data source s2 which selects data from the orders table with a where
clause. In the where clause, any word beginning with the @ is a variable or a
parameter that needs to be created by us. We use the Select Parameters and the
control parameter tags to create a parameter CustomerID. This parameter gets
its value from the list box d1 and the value will be the value of the property
SelectedValue. Thus each time we change the value of the list box, a new set of
data is displayed in the grid view.</p>

<p class=MsoNormal><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=MsoNormal>&lt;html&gt;</p>

<p class=MsoNormal>&lt;form runat=&quot;server&quot;&gt;</p>

<p class=MsoNormal>hi1</p>

<p class=MsoNormal>&lt;asp:TextBox ID=&quot;t1&quot; runat=&quot;server&quot;
AutoPostBack=&quot;True&quot;/&gt;</p>

<p class=MsoNormal>&lt;asp:TextBox ID=&quot;t2&quot; runat=&quot;server&quot;
AutoPostBack=&quot;True&quot; /&gt;</p>

<p class=MsoNormal>&lt;asp:GridView runat=&quot;server&quot;<span
style="mso-spacerun: yes">  </span>DataSourceID=&quot;s1&quot; /&gt;</p>

<p class=MsoNormal>&lt;asp:SqlDataSource ID=&quot;s1&quot;
runat=&quot;server&quot; ConnectionString=&quot;Data Source=localhost;Initial
Catalog=Northwind;User ID=sa&quot;</p>

<p class=MsoNormal><span style="mso-spacerun: yes">  
</span>SelectCommand=&quot;SELECT * FROM [Orders] WHERE [CustomerID] = @CID AND
[EmployeeID] &gt;= @EID&quot;&gt;</p>

<p class=MsoNormal>&lt;SelectParameters&gt;</p>

<p class=MsoNormal>&lt;asp:ControlParameter ControlID=&quot;t1&quot;
Name=&quot;CID&quot;<span style="mso-spacerun: yes"> 
</span>Type=&quot;String&quot; /&gt;</p>

<p class=MsoNormal>&lt;asp:ControlParameter ControlID=&quot;t2&quot;
Name=&quot;EID&quot;<span style="mso-spacerun: yes"> 
</span>Type=&quot;Int32&quot; /&gt;</p>

<p class=MsoNormal>&lt;/SelectParameters&gt;</p>

<p class=MsoNormal>&lt;/asp:SqlDataSource&gt;</p>

<p class=MsoNormal>&lt;/form&gt;</p>

<p class=MsoNormal>&lt;/html&gt;</p>

<p class=MsoNormal>The next example is similar to the earlier one, except that
the data comes from two text boxes whose autopostback property is true. The
text boxes are of data type string and int32. The select statement can be as
complex as we want it to be.</p>

<p class=MsoNormal><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=MsoNormal>&lt;html&gt;</p>

<p class=MsoNormal>&lt;form id=&quot;form1&quot; runat=&quot;server&quot;&gt;</p>

<p class=MsoNormal>hi</p>

<p class=MsoNormal>&lt;asp:GridView ID=&quot;g1&quot; runat=&quot;server&quot;
DataSourceID=&quot;s2&quot; AutoGenerateDeleteButton=true
DataKeyNames=&quot;vno&quot;/&gt;</p>

<p class=MsoNormal>&lt;asp:SqlDataSource ID=&quot;s2&quot;
runat=&quot;server&quot;
ConnectionString=&quot;server=localhost;uid=sa;pwd=;database=Northwind&quot; </p>

<p class=MsoNormal><span style="mso-spacerun: yes">  
</span>SelectCommand=&quot;SELECT * FROM zzz&quot; DeleteCommand=&quot;delete
from zzz where vno=@original_vno&quot; DataSourceMode=&quot;DataSet&quot;&gt;</p>

<p class=MsoNormal>&lt;/asp:SqlDataSource&gt;</p>

<p class=MsoNormal>&lt;/form&gt;</p>

<p class=MsoNormal>&lt;/body&gt;</p>

<p class=MsoNormal>&lt;/html&gt;</p>

<p class=MsoNormal>In this example we are using the grid view to delete data.
The property AutogenerateDeleteButton displays a link with the word delete with
each record. The DataKeyNames property is set to the primary key of the table.
The Sql data Source control now hasaDeleteCommand property where we specify the
delete command that we want executed each time we click on the delete link. As
the DataSourceMode is set to DataSet the original_vno is a free variable
available to us and it contains the voucher number to be deleted. Thus each
time we click on a link, that record gets deleted. </p>

<p class=MsoNormal><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=MsoNormal>&lt;%@Import Namespace=&quot;System.Data&quot; %&gt;</p>

<p class=MsoNormal>&lt;%@Import Namespace=&quot;System.Data.SqlClient&quot;
%&gt;</p>

<p class=MsoNormal>&lt;html&gt;</p>

<p class=MsoNormal>&lt;SCRIPT runat=&quot;server&quot;
language=&quot;C#&quot;&gt;</p>

<p class=MsoNormal>void Deleting(Object source, SqlDataSourceCommandEventArgs
e) </p>

<p class=MsoNormal>{<span style="mso-spacerun: yes">    </span></p>

<p class=MsoNormal>//e.Cancel = true;</p>

<p class=MsoNormal>Response.Write(&quot;Deleting &quot; + e.Command.CommandText
+ &quot;&lt;br&gt;&quot;); </p>

<p class=MsoNormal>IDbCommand cmd = e.Command; </p>

<p class=MsoNormal>foreach (SqlParameter param in cmd.Parameters) </p>

<p class=MsoNormal>{</p>

<p class=MsoNormal>Response.Write(param.ParameterName + &quot; - &quot; +
param.Value.ToString() + &quot;&lt;br&gt;&quot;);</p>

<p class=MsoNormal><span style="mso-spacerun: yes">  </span>}</p>

<p class=MsoNormal><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=MsoNormal>}</p>

<p class=MsoNormal>void Deleted(object source, SqlDataSourceStatusEventArgs e) </p>

<p class=MsoNormal>{</p>

<p class=MsoNormal>Response.Write(&quot;Deleted &quot; + e.AffectedRows +<span
style="mso-spacerun: yes">  </span>&quot;,&quot; + e.Command.CommandText +
&quot;&lt;br&gt;&quot;); </p>

<p class=MsoNormal>}</p>

<p class=MsoNormal>&lt;/SCRIPT&gt;</p>

<p class=MsoNormal>&lt;form id=&quot;form1&quot; runat=&quot;server&quot;&gt;</p>

<p class=MsoNormal>hi</p>

<p class=MsoNormal>&lt;asp:GridView ID=&quot;g1&quot; runat=&quot;server&quot;
DataSourceID=&quot;s2&quot; AutoGenerateDeleteButton=true
DataKeyNames=&quot;vno&quot;/&gt;</p>

<p class=MsoNormal>&lt;asp:SqlDataSource ID=&quot;s2&quot;
runat=&quot;server&quot;
ConnectionString=&quot;server=localhost;uid=sa;pwd=;database=Northwind&quot; </p>

<p class=MsoNormal><span style="mso-spacerun: yes">  
</span>SelectCommand=&quot;SELECT * FROM zzz&quot; DeleteCommand=&quot;delete
from zzz where vno=@original_vno&quot; DataSourceMode=&quot;DataSet&quot;</p>

<p class=MsoNormal>OnDeleting=&quot;Deleting&quot;
OnDeleted=&quot;Deleted&quot; /&gt;</p>

<p class=MsoNormal>&lt;/form&gt;</p>

<p class=MsoNormal>&lt;/body&gt;</p>

<p class=MsoNormal>&lt;/html&gt;</p>

<p class=MsoNormal><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=MsoNormal>Amore complex program that does the same thing as the
earlier program. We gt fine control over the entire deleting process. The two
function Deleting gets called just before deleting and Deleted gets called
after the records have been deleted. We can also get access to the delete
command being executed as well as the value of the parameters being used and
the number of records being deleted. If we set the Cancel property to true, we
are asking the entire process to be stopped. </p>

<p class=MsoNormal><span style="mso-spacerun: yes">     </span></p>

<p class=MsoNormal>&lt;SCRIPT runat=&quot;server&quot;
language=&quot;c#&quot;&gt;</p>

<p class=MsoNormal>void abc(Object s, EventArgs e) </p>

<p class=MsoNormal>{</p>

<p class=MsoNormal>s1.Delete();</p>

<p class=MsoNormal>}</p>

<p class=MsoNormal>&lt;/SCRIPT&gt;</p>

<p class=MsoNormal>&lt;HTML&gt;</p>

<p class=MsoNormal>&lt;FORM runat=&quot;server&quot;&gt;h1</p>

<p class=MsoNormal>&lt;asp:SqlDataSource id=&quot;s1&quot;
runat=&quot;server&quot; ConnectionString=&quot;Database=Northwind;Data
Source=localhost;uid=sa;pwd=;&quot;</p>

<p class=MsoNormal><span style="mso-spacerun: yes"> 
</span>SelectCommand=&quot;SELECT * from zzz&quot;</p>

<p class=MsoNormal><span style="mso-spacerun: yes"> 
</span>DeleteCommand=&quot;DELETE FROM zzz WHERE vno=@ovno;DELETE FROM zzz1
WHERE vno=@ovno;&quot;&gt;</p>

<p class=MsoNormal>&lt;DeleteParameters&gt;</p>

<p class=MsoNormal>&lt;asp:ControlParameter Name=&quot;ovno&quot;
ControlId=&quot;d1&quot; PropertyName=&quot;SelectedValue&quot; /&gt;</p>

<p class=MsoNormal>&lt;/DeleteParameters&gt;</p>

<p class=MsoNormal>&lt;/asp:SqlDataSource&gt;</p>

<p class=MsoNormal>&lt;asp:DropDownList id=&quot;d1&quot;
runat=&quot;server&quot; DataTextField=&quot;name&quot;
DataValueField=&quot;vno&quot; DataSourceID=&quot;s1&quot; /&gt;</p>

<p class=MsoNormal>&lt;asp:Button runat=&quot;server&quot; Text=&quot;Delete
vno&quot; OnClick=&quot;abc&quot; /&gt;</p>

<p class=MsoNormal>&lt;/FORM&gt;</p>

<p class=MsoNormal>&lt;/HTML&gt;</p>

<p class=MsoNormal><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=MsoNormal>Another way of deleting something. We display the records in
a list box, and then press the delete button. This calls the delete function
from the sql data source class. As we have select parameters we now have delete
parameters. We can call as many delete<span style="mso-spacerun: yes"> 
</span>statements that we like, separated by a ;. </p>

<p class=MsoNormal><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=MsoNormal>&lt;Script runat=&quot;server&quot;
language=&quot;c#&quot;&gt;</p>

<p class=MsoNormal>void abc (object s, EventArgs e) </p>

<p class=MsoNormal>{</p>

<p class=MsoNormal>Response.Write(&quot;In abc &quot; + DateTime.Now +
&quot;&lt;br&gt;&quot;);</p>

<p class=MsoNormal>s1.Insert();</p>

<p class=MsoNormal>}</p>

<p class=MsoNormal>&lt;/Script&gt;</p>

<p class=MsoNormal>&lt;HTML&gt;</p>

<p class=MsoNormal>&lt;FORM runat=&quot;server&quot;&gt;</p>

<p class=MsoNormal>&lt;asp:sqldatasource id=&quot;s1&quot; runat=&quot;server&quot;
connectionstring=&quot;DataBase=NorthWind;Data
Source=localhost;uid=sa;pwd=;&quot;</p>

<p class=MsoNormal><span style="mso-spacerun: yes">  
</span>insertcommand=&quot;INSERT INTO zzz (vno,name) VALUES
(@svno,@sname);INSERT INTO zzz1 (vno,name) VALUES (@svno,@sname)&quot;&gt;</p>

<p class=MsoNormal>&lt;insertparameters&gt;</p>

<p class=MsoNormal>&lt;asp:formparameter name=&quot;svno&quot; formfield=&quot;tvno&quot;
/&gt;</p>

<p class=MsoNormal>&lt;asp:formparameter name=&quot;sname&quot;<span
style="mso-spacerun: yes">  </span>formfield=&quot;tname&quot; /&gt;</p>

<p class=MsoNormal>&lt;/insertparameters&gt;</p>

<p class=MsoNormal>&lt;/asp:sqldatasource&gt;</p>

<p class=MsoNormal>&lt;asp:textbox id=&quot;tvno&quot; runat=&quot;server&quot;
/&gt;</p>

<p class=MsoNormal>&lt;asp:RequiredFieldValidator runat=&quot;server&quot;
ControlToValidate=&quot;tvno&quot; ErrorMessage=&quot;Please enter a voucher
no&quot; /&gt;</p>

<p class=MsoNormal>&lt;p&gt;</p>

<p class=MsoNormal>&lt;asp:textbox id=&quot;tname&quot;
runat=&quot;server&quot; /&gt;</p>

<p class=MsoNormal>&lt;asp:RequiredFieldValidator runat=&quot;server&quot;
ControlToValidate=&quot;tname&quot; ErrorMessage=&quot;Please enter a
name&quot; /&gt;</p>

<p class=MsoNormal>&lt;p&gt;</p>

<p class=MsoNormal>&lt;asp:button runat=&quot;server&quot; text=&quot;Add&quot;
onclick=&quot;abc&quot; /&gt;</p>

<p class=MsoNormal>&lt;/FORM&gt;</p>

<p class=MsoNormal>&lt;/HTML&gt;</p>

<p class=MsoNormal><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=MsoNormal>Finally a insert. We key in our data into two text boxes,
build our error checks and then use the insert command to specify that our data
goes into two tables. The insertparameters tag is used to specify the names of
the parameters and associate them with text boxes. </p>

<p class=MsoNormal><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=MsoNormal><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

</div>

</body>


<!-- Mirrored from www.vijaymukhi.com/seccourse/mar1606/html/classextras.htm by HTTrack Website Copier/3.x [XR&CO'2014], Fri, 11 Oct 2024 14:42:25 GMT -->
</html>
