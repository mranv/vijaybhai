<html xmlns:o="urn:schemas-microsoft-com:office:office"
xmlns:w="urn:schemas-microsoft-com:office:word"
xmlns="http://www.w3.org/TR/REC-html40">


<!-- Mirrored from www.vijaymukhi.com/seccourse/june2606/pspctbl.htm by HTTrack Website Copier/3.x [XR&CO'2014], Fri, 11 Oct 2024 14:43:06 GMT -->
<head>
<meta http-equiv=Content-Type content="text/html; charset=windows-1252">
<meta name=ProgId content=Word.Document>
<meta name=Generator content="Microsoft Word 9">
<meta name=Originator content="Microsoft Word 9">
<link rel=File-List href="pspctbl_files/filelist.html">
<title>PspCidTable</title>
<!--[if gte mso 9]><xml>
 <o:DocumentProperties>
  <o:Author>Vijay Mukhi</o:Author>
  <o:Template>Normal</o:Template>
  <o:LastAuthor>Vijay Mukhi</o:LastAuthor>
  <o:Revision>2</o:Revision>
  <o:TotalTime>28</o:TotalTime>
  <o:Created>2006-06-26T11:58:00Z</o:Created>
  <o:LastSaved>2006-06-26T11:58:00Z</o:LastSaved>
  <o:Pages>4</o:Pages>
  <o:Words>601</o:Words>
  <o:Characters>3427</o:Characters>
  <o:Company>VMCI</o:Company>
  <o:Lines>28</o:Lines>
  <o:Paragraphs>6</o:Paragraphs>
  <o:CharactersWithSpaces>4208</o:CharactersWithSpaces>
  <o:Version>9.2720</o:Version>
 </o:DocumentProperties>
</xml><![endif]-->
<style>
<!--
 /* Style Definitions */
p.MsoNormal, li.MsoNormal, div.MsoNormal
	{mso-style-parent:"";
	margin:0in;
	margin-bottom:.0001pt;
	mso-pagination:widow-orphan;
	font-size:12.0pt;
	font-family:"Times New Roman";
	mso-fareast-font-family:"Times New Roman";}
h1
	{mso-style-next:Normal;
	margin:0in;
	margin-bottom:.0001pt;
	mso-pagination:widow-orphan;
	page-break-after:avoid;
	mso-outline-level:1;
	font-size:16.0pt;
	mso-bidi-font-size:12.0pt;
	font-family:"Courier New";
	mso-font-kerning:0pt;
	font-weight:normal;}
pre
	{margin:0in;
	margin-bottom:.0001pt;
	mso-pagination:widow-orphan;
	font-size:10.0pt;
	font-family:"Courier New";
	mso-fareast-font-family:"Courier New";}
@page Section1
	{size:8.5in 11.0in;
	margin:1.0in 1.25in 1.0in 1.25in;
	mso-header-margin:.5in;
	mso-footer-margin:.5in;
	mso-paper-source:0;}
div.Section1
	{page:Section1;}
-->
</style>
</head>

<body lang=EN-US style='tab-interval:.5in'>

<div class=Section1>

<h1><span style='font-size:14.0pt;mso-bidi-font-size:12.0pt'>PspCidTable<o:p></o:p></span></h1>

<p class=MsoNormal><span style='font-size:14.0pt;mso-bidi-font-size:12.0pt;
font-family:"Courier New"'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=MsoNormal><span style='font-size:14.0pt;mso-bidi-font-size:12.0pt;
font-family:"Courier New"'>lkd&gt; dd KdversionBlock<o:p></o:p></span></p>

<p class=MsoNormal><span style='font-size:14.0pt;mso-bidi-font-size:12.0pt;
font-family:"Courier New"'>8054c038<span style="mso-spacerun: yes"> 
</span>0a28000f 00020006 030c014c 0000002d<o:p></o:p></span></p>

<p class=MsoNormal><span style='font-size:14.0pt;mso-bidi-font-size:12.0pt;
font-family:"Courier New"'>8054c048<span style="mso-spacerun: yes"> 
</span>804d7000 ffffffff 8055a420 ffffffff<o:p></o:p></span></p>

<p class=MsoNormal><span style='font-size:14.0pt;mso-bidi-font-size:12.0pt;
font-family:"Courier New"'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=MsoNormal><span style='font-size:14.0pt;mso-bidi-font-size:12.0pt;
font-family:"Courier New"'>WinDbg understands a variable called KdVersionBlock
and tells us that it begins at location 8054c038. This value is the value of i1
in our program. The KdVersionBlock is stored at address 0x0ffdff034. We set
variable I to this value and then use a * to pick up the value of the
KdVersionBlock variable. <o:p></o:p></span></p>

<p class=MsoNormal><span style='font-size:14.0pt;mso-bidi-font-size:12.0pt;
font-family:"Courier New"'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=MsoNormal><span style='font-size:14.0pt;mso-bidi-font-size:12.0pt;
font-family:"Courier New"'>We add an offset 0x80 to get a value of 8054c0b8.<o:p></o:p></span></p>

<p class=MsoNormal><span style='font-size:14.0pt;mso-bidi-font-size:12.0pt;
font-family:"Courier New"'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=MsoNormal><span style='font-size:14.0pt;mso-bidi-font-size:12.0pt;
font-family:"Courier New"'>lkd&gt; dd 8054c0b8<o:p></o:p></span></p>

<p class=MsoNormal><span style='font-size:14.0pt;mso-bidi-font-size:12.0pt;
font-family:"Courier New"'>8054c0b8<span style="mso-spacerun: yes">  </span>805605e0
00000000 80562a08 00000000<o:p></o:p></span></p>

<p class=MsoNormal><span style='font-size:14.0pt;mso-bidi-font-size:12.0pt;
font-family:"Courier New"'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=MsoNormal><span style='font-size:14.0pt;mso-bidi-font-size:12.0pt;
font-family:"Courier New"'>The value stored here is the address of the
PspCidTable 805605e0.<o:p></o:p></span></p>

<p class=MsoNormal><span style='font-size:14.0pt;mso-bidi-font-size:12.0pt;
font-family:"Courier New"'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=MsoNormal><span style='font-size:14.0pt;mso-bidi-font-size:12.0pt;
font-family:"Courier New"'>r.c<o:p></o:p></span></p>

<p class=MsoNormal><span style='font-size:14.0pt;mso-bidi-font-size:12.0pt;
font-family:"Courier New"'>#include &lt;ntddk.h&gt;<o:p></o:p></span></p>

<p class=MsoNormal><span style='font-size:14.0pt;mso-bidi-font-size:12.0pt;
font-family:"Courier New"'>#include &lt;stdio.h&gt;<o:p></o:p></span></p>

<p class=MsoNormal><span style='font-size:14.0pt;mso-bidi-font-size:12.0pt;
font-family:"Courier New"'>#define DWORD long<o:p></o:p></span></p>

<p class=MsoNormal><span style='font-size:14.0pt;mso-bidi-font-size:12.0pt;
font-family:"Courier New"'>struct NonExported<o:p></o:p></span></p>

<p class=MsoNormal><span style='font-size:14.0pt;mso-bidi-font-size:12.0pt;
font-family:"Courier New"'>{<o:p></o:p></span></p>

<p class=MsoNormal><span style='font-size:14.0pt;mso-bidi-font-size:12.0pt;
font-family:"Courier New"'>DWORD KernelBase;<o:p></o:p></span></p>

<p class=MsoNormal><span style='font-size:14.0pt;mso-bidi-font-size:12.0pt;
font-family:"Courier New"'>DWORD KiCallUserMode;<o:p></o:p></span></p>

<p class=MsoNormal><span style='font-size:14.0pt;mso-bidi-font-size:12.0pt;
font-family:"Courier New"'>DWORD PsActiveProcessHead;<o:p></o:p></span></p>

<p class=MsoNormal><span style='font-size:14.0pt;mso-bidi-font-size:12.0pt;
font-family:"Courier New"'>DWORD PsLoadedModuleList;<o:p></o:p></span></p>

<p class=MsoNormal><span style='font-size:14.0pt;mso-bidi-font-size:12.0pt;
font-family:"Courier New"'>DWORD PspCidTable;<o:p></o:p></span></p>

<p class=MsoNormal><span style='font-size:14.0pt;mso-bidi-font-size:12.0pt;
font-family:"Courier New"'>DWORD ExpNumberOfPagedPools;<o:p></o:p></span></p>

<p class=MsoNormal><span style='font-size:14.0pt;mso-bidi-font-size:12.0pt;
font-family:"Courier New"'>DWORD ObpRootDirectoryObject;<o:p></o:p></span></p>

<p class=MsoNormal><span style='font-size:14.0pt;mso-bidi-font-size:12.0pt;
font-family:"Courier New"'>DWORD ObpTypeObjectType;<o:p></o:p></span></p>

<p class=MsoNormal><span style='font-size:14.0pt;mso-bidi-font-size:12.0pt;
font-family:"Courier New"'>DWORD MmSystemCacheStart;<o:p></o:p></span></p>

<p class=MsoNormal><span style='font-size:14.0pt;mso-bidi-font-size:12.0pt;
font-family:"Courier New"'>DWORD MmSystemCacheEnd;<o:p></o:p></span></p>

<p class=MsoNormal><span style='font-size:14.0pt;mso-bidi-font-size:12.0pt;
font-family:"Courier New"'>DWORD MmSystemCacheWs;<o:p></o:p></span></p>

<p class=MsoNormal><span style='font-size:14.0pt;mso-bidi-font-size:12.0pt;
font-family:"Courier New"'>DWORD MmPfnDatabase;<o:p></o:p></span></p>

<p class=MsoNormal><span style='font-size:14.0pt;mso-bidi-font-size:12.0pt;
font-family:"Courier New"'>};<o:p></o:p></span></p>

<p class=MsoNormal><span style='font-size:14.0pt;mso-bidi-font-size:12.0pt;
font-family:"Courier New"'>typedef ULONG *LPDWORD;<o:p></o:p></span></p>

<p class=MsoNormal><span style='font-size:14.0pt;mso-bidi-font-size:12.0pt;
font-family:"Courier New"'>#define GetAddress( x )<span style='mso-tab-count:
1'>   </span>(*(LPDWORD)((*(LPDWORD)0x0ffdff034) + (ULONG)(x)))<o:p></o:p></span></p>

<p class=MsoNormal><span style='font-size:14.0pt;mso-bidi-font-size:12.0pt;
font-family:"Courier New"'>void GetNonExportedVariables(struct NonExported
*Table )<o:p></o:p></span></p>

<p class=MsoNormal><span style='font-size:14.0pt;mso-bidi-font-size:12.0pt;
font-family:"Courier New"'>{<o:p></o:p></span></p>

<p class=MsoNormal><span style='font-size:14.0pt;mso-bidi-font-size:12.0pt;
font-family:"Courier New"'>Table-&gt;KernelBase = GetAddress( 0x40 );<o:p></o:p></span></p>

<p class=MsoNormal><span style='font-size:14.0pt;mso-bidi-font-size:12.0pt;
font-family:"Courier New"'>Table-&gt;KiCallUserMode = GetAddress( 0x60 );<o:p></o:p></span></p>

<p class=MsoNormal><span style='font-size:14.0pt;mso-bidi-font-size:12.0pt;
font-family:"Courier New"'>Table-&gt;PsActiveProcessHead = GetAddress( 0x78 );<o:p></o:p></span></p>

<p class=MsoNormal><span style='font-size:14.0pt;mso-bidi-font-size:12.0pt;
font-family:"Courier New"'>Table-&gt;PsLoadedModuleList = GetAddress( 0x70 );<o:p></o:p></span></p>

<p class=MsoNormal><span style='font-size:14.0pt;mso-bidi-font-size:12.0pt;
font-family:"Courier New"'>Table-&gt;PspCidTable = GetAddress( 0x80 );<o:p></o:p></span></p>

<p class=MsoNormal><span style='font-size:14.0pt;mso-bidi-font-size:12.0pt;
font-family:"Courier New"'>Table-&gt;ExpNumberOfPagedPools = GetAddress( 0x98
);<o:p></o:p></span></p>

<p class=MsoNormal><span style='font-size:14.0pt;mso-bidi-font-size:12.0pt;
font-family:"Courier New"'>Table-&gt;ObpRootDirectoryObject = GetAddress( 0xC0
);<o:p></o:p></span></p>

<p class=MsoNormal><span style='font-size:14.0pt;mso-bidi-font-size:12.0pt;
font-family:"Courier New"'>Table-&gt;ObpTypeObjectType = GetAddress( 0xC8 );<o:p></o:p></span></p>

<p class=MsoNormal><span style='font-size:14.0pt;mso-bidi-font-size:12.0pt;
font-family:"Courier New"'>Table-&gt;MmSystemCacheStart = GetAddress( 0xD0 );<o:p></o:p></span></p>

<p class=MsoNormal><span style='font-size:14.0pt;mso-bidi-font-size:12.0pt;
font-family:"Courier New"'>Table-&gt;MmSystemCacheEnd = GetAddress( 0xD8 );<o:p></o:p></span></p>

<p class=MsoNormal><span style='font-size:14.0pt;mso-bidi-font-size:12.0pt;
font-family:"Courier New"'>Table-&gt;MmSystemCacheWs = GetAddress( 0xE0 );<o:p></o:p></span></p>

<p class=MsoNormal><span style='font-size:14.0pt;mso-bidi-font-size:12.0pt;
font-family:"Courier New"'>Table-&gt;MmPfnDatabase = GetAddress( 0xE8 );<o:p></o:p></span></p>

<p class=MsoNormal><span style='font-size:14.0pt;mso-bidi-font-size:12.0pt;
font-family:"Courier New"'>}<o:p></o:p></span></p>

<p class=MsoNormal><span style='font-size:14.0pt;mso-bidi-font-size:12.0pt;
font-family:"Courier New"'>VOID OnUnload(PDRIVER_OBJECT DriverObject )<o:p></o:p></span></p>

<p class=MsoNormal><span style='font-size:14.0pt;mso-bidi-font-size:12.0pt;
font-family:"Courier New"'>{<span style='mso-tab-count:1'>   </span><o:p></o:p></span></p>

<p class=MsoNormal><span style='font-size:14.0pt;mso-bidi-font-size:12.0pt;
font-family:"Courier New"'>DbgPrint(&quot;Unload5&quot;);<o:p></o:p></span></p>

<p class=MsoNormal><span style='font-size:14.0pt;mso-bidi-font-size:12.0pt;
font-family:"Courier New"'>}<o:p></o:p></span></p>

<p class=MsoNormal><span style='font-size:14.0pt;mso-bidi-font-size:12.0pt;
font-family:"Courier New"'>NTSTATUS DriverEntry(PDRIVER_OBJECT
d,PUNICODE_STRING r)<o:p></o:p></span></p>

<p class=MsoNormal><span style='font-size:14.0pt;mso-bidi-font-size:12.0pt;
font-family:"Courier New"'>{<o:p></o:p></span></p>

<p class=MsoNormal><span style='font-size:14.0pt;mso-bidi-font-size:12.0pt;
font-family:"Courier New"'>struct NonExported NPVars;<o:p></o:p></span></p>

<p class=MsoNormal><span style='font-size:14.0pt;mso-bidi-font-size:12.0pt;
font-family:"Courier New"'>long i,i1,i2,i3;<o:p></o:p></span></p>

<p class=MsoNormal><span style='font-size:14.0pt;mso-bidi-font-size:12.0pt;
font-family:"Courier New"'>GetNonExportedVariables( &amp;NPVars );<o:p></o:p></span></p>

<p class=MsoNormal><span style='font-size:14.0pt;mso-bidi-font-size:12.0pt;
font-family:"Courier New"'>DbgPrint( &quot;KernelBase = 0x%X PspCidTable =
0x%X&quot;, NPVars.KernelBase, NPVars.PspCidTable);<o:p></o:p></span></p>

<p class=MsoNormal><span style='font-size:14.0pt;mso-bidi-font-size:12.0pt;
font-family:"Courier New"'>i = 0x0ffdff034;<o:p></o:p></span></p>

<p class=MsoNormal><span style='font-size:14.0pt;mso-bidi-font-size:12.0pt;
font-family:"Courier New"'>i1 = *(long *)i;<o:p></o:p></span></p>

<p class=MsoNormal><span style='font-size:14.0pt;mso-bidi-font-size:12.0pt;
font-family:"Courier New"'>i2 = i1 + 0x80;<o:p></o:p></span></p>

<p class=MsoNormal><span style='font-size:14.0pt;mso-bidi-font-size:12.0pt;
font-family:"Courier New"'>i3 = *(long *)i2;<o:p></o:p></span></p>

<p class=MsoNormal><span style='font-size:14.0pt;mso-bidi-font-size:12.0pt;
font-family:"Courier New"'>DbgPrint(&quot;i=%x i1=%x i2=%x
i3=%x&quot;,i,i1,i2,i3);<o:p></o:p></span></p>

<p class=MsoNormal><span style='font-size:14.0pt;mso-bidi-font-size:12.0pt;
font-family:"Courier New"'>d-&gt;DriverUnload<span style="mso-spacerun: yes"> 
</span>= OnUnload; <o:p></o:p></span></p>

<p class=MsoNormal><span style='font-size:14.0pt;mso-bidi-font-size:12.0pt;
font-family:"Courier New"'>return STATUS_SUCCESS;<o:p></o:p></span></p>

<p class=MsoNormal><span style='font-size:14.0pt;mso-bidi-font-size:12.0pt;
font-family:"Courier New"'>}<o:p></o:p></span></p>

<p class=MsoNormal><span style='font-size:14.0pt;mso-bidi-font-size:12.0pt;
font-family:"Courier New"'>KernelBase = 0x804D7000 PspCidTable = 0x805605E0<o:p></o:p></span></p>

<p class=MsoNormal><span style='font-size:14.0pt;mso-bidi-font-size:12.0pt;
font-family:"Courier New"'>i=ffdff034 i1=8054c038 i2=8054c0b8 i3=805605e0<o:p></o:p></span></p>

<p class=MsoNormal><span style='font-size:14.0pt;mso-bidi-font-size:12.0pt;
font-family:"Courier New"'>Unload5<o:p></o:p></span></p>

<p class=MsoNormal><span style='font-size:14.0pt;mso-bidi-font-size:12.0pt;
font-family:"Courier New"'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=MsoNormal><span style='font-size:14.0pt;mso-bidi-font-size:12.0pt;
font-family:"Courier New"'>The KdVersionBlock is actually a pointer to a
structure called </span>KDDEBUGGER_DATA32. The <span style='font-family:"Courier New"'>KdVersionBlock
field in turn </span><span style="mso-spacerun: yes"> </span><span
style='font-family:"Courier New"'>is a part of the Process Control Region
structure.<o:p></o:p></span></p>

<p class=MsoNormal><span style='font-family:"Courier New"'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<pre>typedef struct _KDDEBUGGER_DATA32 {</pre><pre><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></pre><pre><span style="mso-spacerun: yes">    </span>DBGKD_DEBUG_DATA_HEADER32 Header;</pre><pre><span style="mso-spacerun: yes">    </span>ULONG<span style="mso-spacerun: yes">   </span>KernBase;</pre><pre><span style="mso-spacerun: yes">    </span>ULONG<span style="mso-spacerun: yes">   </span>BreakpointWithStatus;<span style="mso-spacerun: yes">       </span>// address of breakpoint</pre><pre><span style="mso-spacerun: yes">    </span>ULONG<span style="mso-spacerun: yes">   </span>SavedContext;</pre><pre><span style="mso-spacerun: yes">    </span>USHORT<span style="mso-spacerun: yes">  </span>ThCallbackStack;<span style="mso-spacerun: yes">            </span>// offset in thread data</pre><pre><span style="mso-spacerun: yes">    </span>USHORT<span style="mso-spacerun: yes">  </span>NextCallback;<span style="mso-spacerun: yes">               </span>// saved pointer to next callback frame</pre><pre><span style="mso-spacerun: yes">    </span>USHORT<span style="mso-spacerun: yes">  </span>FramePointer;<span style="mso-spacerun: yes">           </span><span style="mso-spacerun: yes">    </span>// saved frame pointer</pre><pre><span style="mso-spacerun: yes">    </span>USHORT<span style="mso-spacerun: yes">  </span>PaeEnabled:1;</pre><pre><span style="mso-spacerun: yes">    </span>ULONG<span style="mso-spacerun: yes">   </span>KiCallUserMode;<span style="mso-spacerun: yes">             </span>// kernel routine</pre><pre><span style="mso-spacerun: yes">    </span>ULONG<span style="mso-spacerun: yes">   </span>KeUserCallbackDispatcher;<span style="mso-spacerun: yes">   </span>// address in ntdll</pre><pre><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></pre><pre><span style="mso-spacerun: yes">    </span>ULONG<span style="mso-spacerun: yes">   </span>PsLoadedModuleList;</pre><pre><span style="mso-spacerun: yes">    </span>ULONG<span style="mso-spacerun: yes">   </span>PsActiveProcessHead;</pre><pre><span style="mso-spacerun: yes">    </span>ULONG<span style="mso-spacerun: yes">   </span>PspCidTable;</pre><pre><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></pre><pre><span style="mso-spacerun: yes">    </span>ULONG<span style="mso-spacerun: yes">   </span>ExpSystemResourcesList;</pre><pre><span style="mso-spacerun: yes">    </span>ULONG<span style="mso-spacerun: yes">   </span>ExpPagedPoolDescriptor;</pre><pre><span style="mso-spacerun: yes">    </span>ULONG<span style="mso-spacerun: yes">   </span>ExpNumberOfPagedPools;</pre><pre><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></pre><pre><span style="mso-spacerun: yes">    </span>[...]</pre><pre><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></pre><pre><span style="mso-spacerun: yes">    </span>ULONG<span style="mso-spacerun: yes">   </span>KdPrintCircularBuffer;</pre><pre><span style="mso-spacerun: yes">    </span>ULONG<span style="mso-spacerun: yes">   </span>KdPrintCircularBufferEnd;</pre><pre><span style="mso-spacerun: yes">    </span>ULONG<span style="mso-spacerun: yes">   </span>KdPrintWritePointer;</pre><pre><span style="mso-spacerun: yes">    </span>ULONG<span style="mso-spacerun: yes">   </span>KdPrintRolloverCount;</pre><pre><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></pre><pre><span style="mso-spacerun: yes">    </span>ULONG<span style="mso-spacerun: yes">   </span>MmLoadedUserImageList;</pre><pre><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></pre><pre>} KDDEBUGGER_DATA32, *PKDDEBUGGER_DATA32;</pre>

<p class=MsoNormal><span style='font-size:14.0pt;mso-bidi-font-size:12.0pt;
font-family:"Courier New"'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=MsoNormal><span style='font-size:14.0pt;mso-bidi-font-size:12.0pt;
font-family:"Courier New"'>Thus in our code we assume that the Process Control
Region starts somewhere and at 0x0ffdff034 is a pointer to the kdVersionBlock
which is a pointer to the above debugger data32 structure. I is a pointer to
the PCR region where the KdVersionBlock pointer is stored, i1 is the
KdVersionBlock pointer, i2 is 80 bytes within the debugger structure and i3 is
where the PspCidTable starts.<o:p></o:p></span></p>

<p class=MsoNormal><span style='font-size:14.0pt;mso-bidi-font-size:12.0pt;
font-family:"Courier New"'>lkd&gt; !pcr<o:p></o:p></span></p>

<p class=MsoNormal><span style='font-size:14.0pt;mso-bidi-font-size:12.0pt;
font-family:"Courier New"'>KPCR for Processor 0 at ffdff000:<o:p></o:p></span></p>

<p class=MsoNormal><span style='font-size:14.0pt;mso-bidi-font-size:12.0pt;
font-family:"Courier New"'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=MsoNormal><span style='font-size:14.0pt;mso-bidi-font-size:12.0pt;
font-family:"Courier New"'>The pcr or Process Control Block extension tells us
that it starts at ffdff000. 34 from the start is found the KdVersionBlock
field.<o:p></o:p></span></p>

<p class=MsoNormal><span style='font-size:14.0pt;mso-bidi-font-size:12.0pt;
font-family:"Courier New"'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=MsoNormal><span style='font-size:14.0pt;mso-bidi-font-size:12.0pt;
font-family:"Courier New"'>lkd&gt; dd ffdff034<o:p></o:p></span></p>

<p class=MsoNormal><span style='font-size:14.0pt;mso-bidi-font-size:12.0pt;
font-family:"Courier New"'>ffdff034<span style="mso-spacerun: yes"> 
</span>8054c038 8003f400 8003f000 80042000<o:p></o:p></span></p>

<p class=MsoNormal><span style='font-size:14.0pt;mso-bidi-font-size:12.0pt;
font-family:"Courier New"'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=MsoNormal><span style='font-size:14.0pt;mso-bidi-font-size:12.0pt;
font-family:"Courier New"'>We thus assume the value of the pcr and from there
we an get at the KdVersionBlock and then the PspCidTable.<o:p></o:p></span></p>

<p class=MsoNormal><span style='font-size:14.0pt;mso-bidi-font-size:12.0pt;
font-family:"Courier New"'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=MsoNormal><span style='font-size:14.0pt;mso-bidi-font-size:12.0pt;
font-family:"Courier New"'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

</div>

</body>


<!-- Mirrored from www.vijaymukhi.com/seccourse/june2606/pspctbl.htm by HTTrack Website Copier/3.x [XR&CO'2014], Fri, 11 Oct 2024 14:43:07 GMT -->
</html>
