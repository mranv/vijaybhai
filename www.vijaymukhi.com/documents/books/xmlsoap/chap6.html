<html xmlns:v="urn:schemas-microsoft-com:vml"
xmlns:o="urn:schemas-microsoft-com:office:office"
xmlns:w="urn:schemas-microsoft-com:office:word"
xmlns="http://www.w3.org/TR/REC-html40">


<!-- Mirrored from www.vijaymukhi.com/documents/books/xmlsoap/chap6.htm by HTTrack Website Copier/3.x [XR&CO'2014], Fri, 11 Oct 2024 13:57:53 GMT -->
<head>
<meta http-equiv=Content-Type content="text/html; charset=windows-1252">
<meta name=ProgId content=Word.Document>
<meta name=Generator content="Microsoft Word 9">
<meta name=Originator content="Microsoft Word 9">
<link rel=File-List href="chap6_files/filelist.html">
<link rel=Edit-Time-Data href="chap6_files/editdata.html">
<!--[if !mso]>
<style>
v\:* {behavior:url(#default#VML);}
o\:* {behavior:url(#default#VML);}
w\:* {behavior:url(#default#VML);}
.shape {behavior:url(#default#VML);}
</style>
<![endif]-->
<title>XML Web Services and SOAP</title>
<!--[if gte mso 9]><xml>
 <o:DocumentProperties>
  <o:Author>Vijay Mukhi</o:Author>
  <o:LastAuthor>Vijay Mukhi</o:LastAuthor>
  <o:Revision>1</o:Revision>
  <o:TotalTime>1</o:TotalTime>
  <o:Created>2002-01-27T20:22:00Z</o:Created>
  <o:LastSaved>2002-01-27T20:23:00Z</o:LastSaved>
  <o:Pages>15</o:Pages>
  <o:Words>4729</o:Words>
  <o:Characters>26960</o:Characters>
  <o:Company>VMCI</o:Company>
  <o:Lines>224</o:Lines>
  <o:Paragraphs>53</o:Paragraphs>
  <o:CharactersWithSpaces>33108</o:CharactersWithSpaces>
  <o:Version>9.2720</o:Version>
 </o:DocumentProperties>
</xml><![endif]-->
<style>
<!--
 /* Font Definitions */
@font-face
	{font-family:Tahoma;
	panose-1:2 11 6 4 3 5 4 4 2 4;
	mso-font-charset:0;
	mso-generic-font-family:swiss;
	mso-font-pitch:variable;
	mso-font-signature:553679495 -2147483648 8 0 66047 0;}
@font-face
	{font-family:"Bookman Old Style";
	panose-1:2 5 6 4 5 5 5 2 2 4;
	mso-font-charset:0;
	mso-generic-font-family:roman;
	mso-font-pitch:variable;
	mso-font-signature:647 0 0 0 159 0;}
@font-face
	{font-family:"Trebuchet MS";
	panose-1:2 11 6 3 2 2 2 2 2 4;
	mso-font-charset:0;
	mso-generic-font-family:swiss;
	mso-font-pitch:variable;
	mso-font-signature:7 0 0 0 19 0;}
@font-face
	{font-family:"Monotype Corsiva";
	panose-1:3 1 1 1 1 2 1 1 1 1;
	mso-font-charset:0;
	mso-generic-font-family:script;
	mso-font-pitch:variable;
	mso-font-signature:647 0 0 0 159 0;}
 /* Style Definitions */
p.MsoNormal, li.MsoNormal, div.MsoNormal
	{mso-style-parent:"";
	margin:0in;
	margin-bottom:.0001pt;
	mso-pagination:widow-orphan;
	font-size:12.0pt;
	font-family:"Times New Roman";
	mso-fareast-font-family:"Times New Roman";}
p.ILoutput, li.ILoutput, div.ILoutput
	{mso-style-name:ILoutput;
	mso-style-parent:ILbase;
	mso-style-next:ILbase;
	margin-top:0in;
	margin-right:0in;
	margin-bottom:0in;
	margin-left:.5in;
	margin-bottom:.0001pt;
	mso-pagination:widow-orphan;
	mso-layout-grid-align:none;
	text-autospace:none;
	font-size:9.5pt;
	font-family:Tahoma;
	mso-fareast-font-family:"Times New Roman";}
p.ILprg, li.ILprg, div.ILprg
	{mso-style-name:ILprg;
	mso-style-parent:ILbase;
	mso-style-next:ILbase;
	margin-top:0in;
	margin-right:0in;
	margin-bottom:0in;
	margin-left:.5in;
	margin-bottom:.0001pt;
	mso-pagination:widow-orphan;
	mso-layout-grid-align:none;
	text-autospace:none;
	font-size:9.5pt;
	font-family:"Trebuchet MS";
	mso-fareast-font-family:"Times New Roman";
	mso-bidi-font-family:"Times New Roman";}
p.ILbase, li.ILbase, div.ILbase
	{mso-style-name:ILbase;
	mso-style-parent:"";
	margin:0in;
	margin-bottom:.0001pt;
	text-align:justify;
	mso-pagination:widow-orphan;
	mso-layout-grid-align:none;
	text-autospace:none;
	font-size:10.0pt;
	font-family:"Bookman Old Style";
	mso-fareast-font-family:"Times New Roman";
	mso-bidi-font-family:"Times New Roman";
	color:black;}
@page Section1
	{size:8.5in 11.0in;
	margin:1.0in 1.25in 1.0in 1.25in;
	mso-header-margin:.5in;
	mso-footer-margin:.5in;
	mso-paper-source:0;}
div.Section1
	{page:Section1;}
-->
</style>
</head>

<body lang=EN-US style='tab-interval:.5in'>

<div class=Section1>

<p class=MsoNormal><img width=64 height=48 id="_x0000_i1025" src=bpb.jpg></p>

<p class=MsoNormal><span style='font-size:24.0pt;font-family:"Monotype Corsiva";
color:black'>6</span></p>

<p class=MsoNormal><span style='font-size:24.0pt;font-family:"Monotype Corsiva";
color:black'>SOAP Headers</span></p>

<p class=ILbase><span style='color:windowtext'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=ILbase><span style='color:windowtext'>All the previous chapters had
riveted their attention on two salient components of the SOAP packet, i.e. the
Envelope and the Body. In this chapter, we shall pan our focus onto the third
major component of the SOAP payload, known as the Header. The SOAP Header is
optional, but when present, it should be placed immediately after the Envelope,
but before the Body.<o:p></o:p></span></p>

<p class=ILbase><span style='color:windowtext'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=ILbase><span style='color:windowtext'>In the case of headers, there
exists abundant flexibility to settle on what they should be used for. These
headers are generally employed in order to send across information that should
not to be sent as part of the SOAP body, since it does not form part of the
data. Thus, specific pieces of information, such as userid, password,
authentication, encryption, security information, etc. are incorporated in the
headers. <o:p></o:p></span></p>

<p class=ILbase><span style='color:windowtext'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=ILprg><u>a.asmx</u><o:p></o:p></p>

<p class=ILprg>&lt;%@ WebService Language=&quot;C#&quot; class=&quot;zzz&quot;
%&gt;<o:p></o:p></p>

<p class=ILprg>using System;<o:p></o:p></p>

<p class=ILprg>using System.Web.Services;<o:p></o:p></p>

<p class=ILprg>using System.Web.Services.Protocols;<o:p></o:p></p>

<p class=ILprg>public class zzz<o:p></o:p></p>

<p class=ILprg>{<o:p></o:p></p>

<p class=ILprg>public yyy z;<o:p></o:p></p>

<p class=ILprg>[WebMethod]<o:p></o:p></p>

<p class=ILprg>[SoapHeader(&quot;z&quot;)]<o:p></o:p></p>

<p class=ILprg>public int abc(int i, int j)<o:p></o:p></p>

<p class=ILprg>{<o:p></o:p></p>

<p class=ILprg>return i + j;<o:p></o:p></p>

<p class=ILprg>}<o:p></o:p></p>

<p class=ILprg>}<o:p></o:p></p>

<p class=ILprg>public class yyy : SoapHeader <o:p></o:p></p>

<p class=ILprg>{<o:p></o:p></p>

<p class=ILprg>public string name;<o:p></o:p></p>

<p class=ILprg>public string pass;<o:p></o:p></p>

<p class=ILprg>}<o:p></o:p></p>

<p class=ILprg><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=ILprg><u>a.cs</u><o:p></o:p></p>

<p class=ILprg>using System;<o:p></o:p></p>

<p class=ILprg>using System.Web.Services.Protocols;<o:p></o:p></p>

<p class=ILprg>using System.Web.Services;<o:p></o:p></p>

<p class=ILprg>public class aaa :
System.Web.Services.Protocols.SoapHttpClientProtocol<o:p></o:p></p>

<p class=ILprg>{<o:p></o:p></p>

<p class=ILprg>public yyy b;<o:p></o:p></p>

<p class=ILprg>public static void Main()<o:p></o:p></p>

<p class=ILprg>{<o:p></o:p></p>

<p class=ILprg>aaa a= new aaa();<o:p></o:p></p>

<p class=ILprg>a.b = new yyy();<o:p></o:p></p>

<p class=ILprg>a.b.name=&quot;vijay&quot; ;<o:p></o:p></p>

<p class=ILprg>a.b.pass=&quot;sonal&quot; ;<o:p></o:p></p>

<p class=ILprg>int i = a.abc(10,20);<o:p></o:p></p>

<p class=ILprg>Console.WriteLine(i);<o:p></o:p></p>

<p class=ILprg>}<o:p></o:p></p>

<p class=ILprg>[System.Web.Services.Protocols.SoapHeaderAttribute(&quot;b&quot;)]<o:p></o:p></p>

<p class=ILprg>[System.Web.Services.Protocols.SoapDocumentMethodAttribute(&quot;http://tempuri.org/abc&quot;)]<o:p></o:p></p>

<p class=ILprg>public int abc(int i, int j) <o:p></o:p></p>

<p class=ILprg>{<o:p></o:p></p>

<p class=ILprg>object[] results = this.Invoke(&quot;abc&quot;, new object[]
{i,j});<o:p></o:p></p>

<p class=ILprg>return ((int)(results[0]));<o:p></o:p></p>

<p class=ILprg>}<o:p></o:p></p>

<p class=ILprg>public aaa()<o:p></o:p></p>

<p class=ILprg>{<o:p></o:p></p>

<p class=ILprg>this.Url = &quot;http://localhost:8080/a.asmx&quot;;<o:p></o:p></p>

<p class=ILprg>}<o:p></o:p></p>

<p class=ILprg>}<o:p></o:p></p>

<p class=ILprg>public class yyy : SoapHeader <o:p></o:p></p>

<p class=ILprg>{<o:p></o:p></p>

<p class=ILprg>public string name;<o:p></o:p></p>

<p class=ILprg>public string pass;<o:p></o:p></p>

<p class=ILprg>}<o:p></o:p></p>

<p class=ILprg><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=ILprg><u>z.bat</u><o:p></o:p></p>

<p class=ILprg>del *.exe<o:p></o:p></p>

<p class=ILprg>del *.dll<o:p></o:p></p>

<p class=ILprg>del zzz.cs<o:p></o:p></p>

<p class=ILprg>wsdl aa.wsdl<o:p></o:p></p>

<p class=ILprg>csc a.cs<o:p></o:p></p>

<p class=ILprg>a<o:p></o:p></p>

<p class=ILbase><span style='color:windowtext'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=ILoutput><u>Output</u><o:p></o:p></p>

<p class=ILoutput>30<o:p></o:p></p>

<p class=ILoutput><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=ILoutput><u>SOAP request</u><o:p></o:p></p>

<p class=ILoutput>&lt;?xml version=&quot;1.0&quot; encoding=&quot;utf-8&quot;
?&gt; <o:p></o:p></p>

<p class=ILoutput>&lt;soap:Envelope
xmlns:soap=http://schemas.xmlsoap.org/soap/envelope/
xmlns:xsi=&quot;http://www.w3.org/2001/XMLSchema-instance&quot;
xmlns:xsd=&quot;http://www.w3.org/2001/XMLSchema&quot;&gt;<o:p></o:p></p>

<p class=ILoutput>&lt;soap:Header&gt;<o:p></o:p></p>

<p class=ILoutput>&lt;yyy xmlns=&quot;http://tempuri.org/&quot;&gt;<o:p></o:p></p>

<p class=ILoutput><span style="mso-spacerun: yes"> 
</span>&lt;name&gt;vijay&lt;/name&gt; <o:p></o:p></p>

<p class=ILoutput><span style="mso-spacerun: yes"> 
</span>&lt;pass&gt;sonal&lt;/pass&gt; <o:p></o:p></p>

<p class=ILoutput><span style="mso-spacerun: yes">  </span>&lt;/yyy&gt;<o:p></o:p></p>

<p class=ILoutput><span style="mso-spacerun: yes">  </span>&lt;/soap:Header&gt;<o:p></o:p></p>

<p class=ILoutput>&lt;soap:Body&gt;<o:p></o:p></p>

<p class=ILoutput>&lt;abc xmlns=&quot;http://tempuri.org/&quot;&gt;<o:p></o:p></p>

<p class=ILoutput><span style="mso-spacerun: yes"> 
</span>&lt;i&gt;10&lt;/i&gt; <o:p></o:p></p>

<p class=ILoutput><span style="mso-spacerun: yes"> 
</span>&lt;j&gt;20&lt;/j&gt; <o:p></o:p></p>

<p class=ILoutput><span style="mso-spacerun: yes">  </span>&lt;/abc&gt;<o:p></o:p></p>

<p class=ILoutput>&lt;/soap:Body&gt;<o:p></o:p></p>

<p class=ILoutput>&lt;/soap:Envelope&gt;<o:p></o:p></p>

<p class=ILoutput><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=ILoutput><u>SOAP response</u><o:p></o:p></p>

<p class=ILoutput>&lt;?xml version=&quot;1.0&quot; encoding=&quot;utf-8&quot;
?&gt; <o:p></o:p></p>

<p class=ILoutput>&lt;soap:Envelope
xmlns:soap=&quot;http://schemas.xmlsoap.org/soap/envelope/&quot;
xmlns:xsi=&quot;http://www.w3.org/2001/XMLSchema-instance&quot;
xmlns:xsd=&quot;http://www.w3.org/2001/XMLSchema&quot;&gt;<o:p></o:p></p>

<p class=ILoutput>&lt;soap:Body&gt;<o:p></o:p></p>

<p class=ILoutput>&lt;abcResponse xmlns=&quot;http://tempuri.org/&quot;&gt;<o:p></o:p></p>

<p class=ILoutput><span style="mso-spacerun: yes"> 
</span>&lt;abcResult&gt;30&lt;/abcResult&gt; <o:p></o:p></p>

<p class=ILoutput><span style="mso-spacerun: yes">  </span>&lt;/abcResponse&gt;<o:p></o:p></p>

<p class=ILoutput><span style="mso-spacerun: yes">  </span>&lt;/soap:Body&gt;<o:p></o:p></p>

<p class=ILoutput>&lt;/soap:Envelope&gt;<o:p></o:p></p>

<p class=ILbase><span style='color:windowtext'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=ILbase><span style='color:windowtext'>Here, we have cogitated on the
client program named a.cs, instead of the asmx file, since it is the client
that dispatches the headers that are received by the asmx file. As in the past,
the client program is written manually, and is followed by the wsdl program, in
order to generate the proxy.<o:p></o:p></span></p>

<p class=ILbase><span style='color:windowtext'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=ILbase><span style='color:windowtext'>After the creation of a new
instance of the aaa object, an object b derived from SoapHeader is created,
since the intent is to send a few headers across. The class yyy, which is
derived from SoapHeader, contains two members called 'name' and 'pass'. They
are initialized to the values 'vijay' and 'sonal', respectively. These are the
values that are required to be sent across in the header. Thus, the basic
principle is to derive a class from SoapHeader, and initiate a list of
variables in it, whose values are to be sent across. <o:p></o:p></span></p>

<p class=ILbase><span style='color:windowtext'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=ILbase><span style='color:windowtext'>Thereafter, the function abc is
called. It is lodged in the class aaa. The only modification that is carried
out to this function is, the addition of an extra attribute named
SoapHeaderAttribute, containing the object b, since it holds the values that
are to be sent across in the header. Everything else remains unchanged. <o:p></o:p></span></p>

<p class=ILbase><span style='color:windowtext'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=ILbase><span style='color:windowtext'>The SOAP request reaffirms the
fact that the headers are actually sent across. As usual, the Envelope drifts
into sight first, followed by the SOAP Header. Since the name of the class is
yyy, it becomes the parent for the two child elements named 'name' and 'pass',
which contain the values of 'vijay' and 'sonal', respectively. In this case,
the headers are not sent back. <o:p></o:p></span></p>

<p class=ILbase><span style='color:windowtext'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=ILbase><span style='color:windowtext'>Thus, custom headers can easily
be created with the help of any user-defined content. For instance, the client
can send the userid and password over in the header. From the SOAP point of
view, the mechanism employed by the server to handle this information is of no
consequence at all. <o:p></o:p></span></p>

<p class=ILbase><span style='color:windowtext'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=ILbase><span style='color:windowtext'>Let us now expound the asmx file
more comprehensively by perusing another example.<o:p></o:p></span></p>

<p class=ILbase><span style='color:windowtext'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=ILprg><u>a.asmx</u><o:p></o:p></p>

<p class=ILprg>&lt;%@ WebService Language=&quot;C#&quot; class=&quot;zzz&quot;
%&gt;<o:p></o:p></p>

<p class=ILprg>using System;<o:p></o:p></p>

<p class=ILprg>using System.Web.Services;<o:p></o:p></p>

<p class=ILprg>using System.Web.Services.Protocols;<o:p></o:p></p>

<p class=ILprg>public class zzz {<o:p></o:p></p>

<p class=ILprg>public yyy z;<o:p></o:p></p>

<p class=ILprg>[WebMethod]<o:p></o:p></p>

<p class=ILprg>[SoapHeader(&quot;z&quot;)]<o:p></o:p></p>

<p class=ILprg>public int abc(int i, int j)<o:p></o:p></p>

<p class=ILprg>{<o:p></o:p></p>

<p class=ILprg>int k = z.name.Length;<o:p></o:p></p>

<p class=ILprg>int l = z.pass.Length;<o:p></o:p></p>

<p class=ILprg>return k + l;<o:p></o:p></p>

<p class=ILprg>}<o:p></o:p></p>

<p class=ILprg>}<o:p></o:p></p>

<p class=ILprg>public class yyy : SoapHeader <o:p></o:p></p>

<p class=ILprg>{<o:p></o:p></p>

<p class=ILprg>public string name;<o:p></o:p></p>

<p class=ILprg>public string pass;<o:p></o:p></p>

<p class=ILprg>}<o:p></o:p></p>

<p class=ILbase><span style='color:windowtext'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=ILoutput><u>Output</u><o:p></o:p></p>

<p class=ILoutput>10<o:p></o:p></p>

<p class=ILbase><span style='color:windowtext'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=ILbase><span style='color:windowtext'>In the asmx file, the class yyy
is derived from the SoapHeader. This is akin to what was witnessed in the
client program. Thereafter, an object z is created as an instance of the yyy
class. <o:p></o:p></span></p>

<p class=ILbase><span style='color:windowtext'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=ILbase><span style='color:windowtext'>The function abc has been
provided with an extra attribute named SoapHeader, which in very clear-cut
terms, specifies that the name of the object is z, and that it contains the
soap headers in the string format. <o:p></o:p></span></p>

<p class=ILbase><span style='color:windowtext'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=ILbase><span style='color:windowtext'>When the function abc gets
called, the system first initializes the object z to the values found in the
Header. In our case, thereafter, we merely determine the length of the two
header values that are sent across, and add these up. Thus, the output obtained
is 10. <o:p></o:p></span></p>

<p class=ILbase><span style='color:windowtext'>However in real life, there
exists ample flexibility for you to act as you desire, when faced with such a
situation. Having unraveled the mystery of the client program, you would
realise that the concept of web service can be comprehended with effortless
ease.<o:p></o:p></span></p>

<p class=ILprg><u><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></u></p>

<p class=ILprg><u>a.asmx</u><o:p></o:p></p>

<p class=ILprg>&lt;%@ WebService Language=&quot;C#&quot; class=&quot;zzz&quot;
%&gt;<o:p></o:p></p>

<p class=ILprg>using System;<o:p></o:p></p>

<p class=ILprg>using System.Web.Services;<o:p></o:p></p>

<p class=ILprg>using System.Web.Services.Protocols;<o:p></o:p></p>

<p class=ILprg>public class zzz<o:p></o:p></p>

<p class=ILprg>{<o:p></o:p></p>

<p class=ILprg>public yyy z;<o:p></o:p></p>

<p class=ILprg>[WebMethod]<o:p></o:p></p>

<p class=ILprg>[SoapHeader(&quot;z&quot;)]<o:p></o:p></p>

<p class=ILprg>public void abc()<o:p></o:p></p>

<p class=ILprg>{<o:p></o:p></p>

<p class=ILprg>z.name = &quot;No&quot;;<o:p></o:p></p>

<p class=ILprg>z.pass = &quot;yes&quot;;<o:p></o:p></p>

<p class=ILprg>}<o:p></o:p></p>

<p class=ILprg>}<o:p></o:p></p>

<p class=ILprg>public class yyy : SoapHeader <o:p></o:p></p>

<p class=ILprg>{<o:p></o:p></p>

<p class=ILprg>public string name;<o:p></o:p></p>

<p class=ILprg>public string pass;<o:p></o:p></p>

<p class=ILprg>}<o:p></o:p></p>

<p class=ILprg><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=ILprg><u>aa.wsdl</u><o:p></o:p></p>

<p class=ILprg>&lt;s:schema attributeFormDefault=&quot;qualified&quot;
elementFormDefault=&quot;qualified&quot;
targetNamespace=&quot;http://tempuri.org/&quot;&gt;<o:p></o:p></p>

<p class=ILprg><span style="mso-spacerun: yes">  </span>&lt;s:element
name=&quot;abc&quot;&gt;<o:p></o:p></p>

<p class=ILprg>&lt;s:complexType /&gt;<o:p></o:p></p>

<p class=ILprg><span style="mso-spacerun: yes">  </span>&lt;/s:element&gt;<o:p></o:p></p>

<p class=ILprg><span style="mso-spacerun: yes">  </span>&lt;s:element
name=&quot;abcResponse&quot;&gt;<o:p></o:p></p>

<p class=ILprg>&lt;s:complexType /&gt;<o:p></o:p></p>

<p class=ILprg><span style="mso-spacerun: yes">  </span>&lt;/s:element&gt;<o:p></o:p></p>

<p class=ILprg><span style="mso-spacerun: yes">  </span>&lt;s:element
name=&quot;yyy&quot; type=&quot;s0:yyy&quot; /&gt;<o:p></o:p></p>

<p class=ILprg><span style="mso-spacerun: yes">  </span>&lt;s:complexType
name=&quot;yyy&quot;&gt;<o:p></o:p></p>

<p class=ILprg>&lt;s:sequence&gt;<o:p></o:p></p>

<p class=ILprg>&lt;s:element minOccurs=&quot;1&quot; maxOccurs=&quot;1&quot;
name=&quot;name&quot; nillable=&quot;true&quot; type=&quot;s:string&quot; /&gt;<o:p></o:p></p>

<p class=ILprg>&lt;s:element minOccurs=&quot;1&quot; maxOccurs=&quot;1&quot;
name=&quot;pass&quot; nillable=&quot;true&quot; type=&quot;s:string&quot; /&gt;<o:p></o:p></p>

<p class=ILprg>&lt;/s:sequence&gt;<o:p></o:p></p>

<p class=ILprg>&lt;/s:complexType&gt;<o:p></o:p></p>

<p class=ILprg>&lt;/s:schema&gt;<o:p></o:p></p>

<p class=ILprg>&lt;message name=&quot;abcyyy&quot;&gt;<o:p></o:p></p>

<p class=ILprg>&lt;part name=&quot;yyy&quot; element=&quot;s0:yyy&quot; /&gt;<o:p></o:p></p>

<p class=ILprg>&lt;/message&gt;<o:p></o:p></p>

<p class=ILprg>&lt;operation name=&quot;abc&quot;&gt;<o:p></o:p></p>

<p class=ILprg>&lt;soap:operation soapAction=&quot;http://tempuri.org/abc&quot;
style=&quot;document&quot; /&gt;<o:p></o:p></p>

<p class=ILprg>&lt;input&gt;<o:p></o:p></p>

<p class=ILprg><span style="mso-spacerun: yes">  </span>&lt;soap:body
use=&quot;literal&quot; /&gt;<o:p></o:p></p>

<p class=ILprg>&lt;soap:header n1:required=&quot;true&quot;
message=&quot;s0:abcyyy&quot; part=&quot;yyy&quot; use=&quot;literal&quot;
xmlns:n1=&quot;http://schemas.xmlsoap.org/wsdl/&quot; /&gt;<o:p></o:p></p>

<p class=ILprg>&lt;/input&gt;<o:p></o:p></p>

<p class=ILprg>&lt;output&gt;<o:p></o:p></p>

<p class=ILprg><span style="mso-spacerun: yes">  </span>&lt;soap:body
use=&quot;literal&quot; /&gt;<o:p></o:p></p>

<p class=ILprg>&lt;/output&gt;<o:p></o:p></p>

<p class=ILprg>&lt;/operation&gt;<o:p></o:p></p>

<p class=ILprg><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=ILprg><u>a.cs</u><o:p></o:p></p>

<p class=ILprg>using System;<o:p></o:p></p>

<p class=ILprg>using System.Web.Services.Protocols;<o:p></o:p></p>

<p class=ILprg>using System.Web.Services;<o:p></o:p></p>

<p class=ILprg>public class aaa :
System.Web.Services.Protocols.SoapHttpClientProtocol<o:p></o:p></p>

<p class=ILprg>{<span style="mso-spacerun: yes">  </span><o:p></o:p></p>

<p class=ILprg>public static void Main()<o:p></o:p></p>

<p class=ILprg>{<o:p></o:p></p>

<p class=ILprg>zzz a= new zzz();<o:p></o:p></p>

<p class=ILprg>a.yyyValue = new yyy();<o:p></o:p></p>

<p class=ILprg>a.yyyValue.name=&quot;vijay&quot; ;<o:p></o:p></p>

<p class=ILprg>a.yyyValue.pass=&quot;sonal&quot; ;<o:p></o:p></p>

<p class=ILprg>a.abc();<o:p></o:p></p>

<p class=ILprg>}<o:p></o:p></p>

<p class=ILprg>}<o:p></o:p></p>

<p class=ILprg><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=ILprg><u>zzz.cs</u><o:p></o:p></p>

<p class=ILprg>public class zzz :
System.Web.Services.Protocols.SoapHttpClientProtocol {<o:p></o:p></p>

<p class=ILprg>public yyy yyyValue;<o:p></o:p></p>

<p class=ILprg>[System.Web.Services.Protocols.SoapHeaderAttribute(&quot;yyyValue&quot;)]<o:p></o:p></p>

<p class=ILprg>[System.Web.Services.Protocols.SoapDocumentMethodAttribute(&quot;http://tempuri.org/abc&quot;)]<o:p></o:p></p>

<p class=ILprg>public void abc() <o:p></o:p></p>

<p class=ILprg>{<o:p></o:p></p>

<p class=ILprg>this.Invoke(&quot;abc&quot;, new object[0]);<o:p></o:p></p>

<p class=ILprg>}<o:p></o:p></p>

<p class=ILprg>}<o:p></o:p></p>

<p class=ILprg>[System.Xml.Serialization.XmlRootAttribute(Namespace=&quot;http://tempuri.org/&quot;,
IsNullable=false)]<o:p></o:p></p>

<p class=ILprg>public class yyy : SoapHeader <o:p></o:p></p>

<p class=ILprg>{<o:p></o:p></p>

<p class=ILprg>public string name;<o:p></o:p></p>

<p class=ILprg>public string pass;<o:p></o:p></p>

<p class=ILprg>}<o:p></o:p></p>

<p class=ILbase><span style='color:windowtext'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=ILbase><span style='color:windowtext'>The SOAP request and the
response packet remain the same as seen in the earlier program.<o:p></o:p></span></p>

<p class=ILbase><span style='color:windowtext'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=ILbase><span style='color:windowtext'>Once again, our primary focus
remains impaled on the asmx file. The class yyy is derived from the class
SoapHeader. Therefore, the soap headers are visible in the packet. The elements
stipulated here are sent across as tags within the header. In this case, the
header comprises of two elements, viz. 'name' and 'pass'. Prior to every
function, we need to specify the headers that the function shall receive. <o:p></o:p></span></p>

<p class=ILbase><span style='color:windowtext'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=ILbase><span style='color:windowtext'>The function abc shall receive
its headers in an object z, which is an instance of the class yyy. It has been
provided as a string parameter, because the SoapHeader specifies that the
object name should be in a string format. The function abc merely modifies the
values contained in 'name' and 'pass'. These newly assigned values are then
sent across. In the normal course, we would have accessed the values that are
sent across, and then modified them.<span style="mso-spacerun: yes">  </span><o:p></o:p></span></p>

<p class=ILbase><span style='color:windowtext'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=ILbase><span style='color:windowtext'>You would have discerned vast
variations in the aa.wsdl file. This is because, when we encounter a class
derived from SoapHeader, IIS is alerted to the fact that Headers too have been
sent across. <o:p></o:p></span></p>

<p class=ILbase><span style='color:windowtext'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=ILbase><span style='color:windowtext'>The element abc has no
parameters; therefore, it has an empty complexType. Since the name of the class
is yyy, an element called yyy is created. The type of this element is also yyy.
It does not possess any other content. Next, a complexType yyy is created to
accommodate two elements called 'name' and 'pass', which correspond to the
variables in the class yyy. <o:p></o:p></span></p>

<p class=ILbase><span style='color:windowtext'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=ILbase><span style='color:windowtext'>Upto this point, in the wsdl
file, there has been no indication that the class yyy has been derived from the
SoapHeader class. Besides, there is no allusion to the fact that yyy represents
a class that is responsible for sending the Headers across. This is because the
schema section looks exclusively at schemas, and Headers have no representation
in a schema. <o:p></o:p></span></p>

<p class=ILbase><span style='color:windowtext'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=ILbase><span style='color:windowtext'>Now, we revert our attention
right back to the message element, which was enucleated in one of the earlier
chapters. Apart from the two messages sighted in the earlier programs, one more
message is sent over. This message contains only a single part named yyy. The
element represented by this part is called yyy. It is of type yyy, which is the
class derived from SoapHeader. Thus, every class derived from SoapHeader is
provided with a message element. <o:p></o:p></span></p>

<p class=ILbase><span style='color:windowtext'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=ILbase><span style='color:windowtext'>The operation abc has a simple
input and output section. The input section has a Body element, comprising of a
Header element from the soap namespace. The 'required' member with the value of
'true', mandates the presence of a header. The message is named as abcyyy. This
name is formed by the conjunction of the name of the function, and the name of
the header class. It specifies the format of the header. <o:p></o:p></span></p>

<p class=ILbase><span style='color:windowtext'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=ILbase><span style='color:windowtext'>Thus, headers are dispatched as
per the functions. This statement will be proved beyond doubt in one of the
forthcoming examples. The yyy part is responsible for the message, since this
is where the element is expressly specified. The 'use' attribute works in a
manner analogous to the 'operation' element.<o:p></o:p></span></p>

<p class=ILbase><span style='color:windowtext'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=ILbase><span style='color:windowtext'>As always, a new instance of the
zzz class is created in the client program, and the yyyValue member is initialized
to a yyy object. The header class is yyy. Therefore, the member that represents
this header in the proxy is named as yyyValue, i.e. classname plus the word
'Value'. The 'name' and 'pass' members are initialized to 'vijay' and 'sonal',
respectively. When the function abc is called, the headers are sent across, as
a consequence of the attributes created in the proxy. <o:p></o:p></span></p>

<p class=ILbase><span style='color:windowtext'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=ILbase><span style='color:windowtext'>Let us now explore the proxy
generated by the wsdl file. The class yyy is sighted at the absolute end of the
file that has been derived from SoapHeader. This is due to the fact that
'operation' contains the Header tag for the element yyy. The function remains
the same, except that the SoapHeaderAttribute has been added. The string
parameter contains the name of the object that would carry the header data
yyyValue. All functions that carry this attribute, send the headers across the
wire. <o:p></o:p></span></p>

<p class=ILbase><span style='color:windowtext'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=ILbase><span style='color:windowtext'>So far, the SOAP Headers have
been gliding in one direction only, i.e. from the client to the server. It is
our intent to reverse this direction in the next example, i.e. send the Headers
back from the server to the client.<o:p></o:p></span></p>

<p class=ILbase><span style='color:windowtext'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=ILbase><span style='color:windowtext'>In order to achieve this, we
effect a minor modification to the asmx file, by changing the SoapHeader
attribute to the following:<o:p></o:p></span></p>

<p class=ILbase><span style='color:windowtext'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=ILprg>[SoapHeader(&quot;z&quot;,Direction=SoapHeaderDirection.InOut)]<o:p></o:p></p>

<p class=ILbase><span style='color:windowtext'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=ILprg><u>aa.wsdl</u><o:p></o:p></p>

<p class=ILprg>&lt;output&gt;<o:p></o:p></p>

<p class=ILprg>&lt;soap:body use=&quot;literal&quot; /&gt;<o:p></o:p></p>

<p class=ILprg>&lt;soap:header n1:required=&quot;true&quot;
message=&quot;s0:abcyyy&quot; part=&quot;yyy&quot; use=&quot;literal&quot;
xmlns:n1=&quot;http://schemas.xmlsoap.org/wsdl/&quot; /&gt;<o:p></o:p></p>

<p class=ILprg>&lt;/output&gt;<o:p></o:p></p>

<p class=ILprg><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=ILprg><u>a.cs</u><o:p></o:p></p>

<p class=ILprg>a.abc();<o:p></o:p></p>

<p class=ILprg>Console.WriteLine(a.yyyValue.name);<o:p></o:p></p>

<p class=ILprg>Console.WriteLine(a.yyyValue.pass);<o:p></o:p></p>

<p class=ILbase><span style='color:windowtext'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=ILoutput><u>Output</u><o:p></o:p></p>

<p class=ILoutput>No<o:p></o:p></p>

<p class=ILoutput>Yes<o:p></o:p></p>

<p class=ILbase><span style='color:windowtext'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=ILprg><u>zzz.cs</u><o:p></o:p></p>

<p class=ILprg>[System.Web.Services.Protocols.SoapHeaderAttribute(&quot;yyyValue&quot;,
Direction=System.Web.Services.Protocols.SoapHeaderDirection.InOut)]<o:p></o:p></p>

<p class=ILoutput><u>soap response</u><o:p></o:p></p>

<p class=ILoutput>&lt;soap:Envelope xmlns:soap=&quot;http://schemas.xmlsoap.org/soap/envelope/&quot;
xmlns:xsi=&quot;http://www.w3.org/2001/XMLSchema-instance&quot;
xmlns:xsd=&quot;http://www.w3.org/2001/XMLSchema&quot;&gt;<o:p></o:p></p>

<p class=ILoutput>&lt;soap:Header&gt;<o:p></o:p></p>

<p class=ILoutput>&lt;yyy xmlns=&quot;http://tempuri.org/&quot;&gt;<o:p></o:p></p>

<p class=ILoutput><span style="mso-spacerun: yes"> 
</span>&lt;name&gt;No&lt;/name&gt; <o:p></o:p></p>

<p class=ILoutput><span style="mso-spacerun: yes"> 
</span>&lt;pass&gt;yes&lt;/pass&gt; <o:p></o:p></p>

<p class=ILoutput><span style="mso-spacerun: yes">  </span>&lt;/yyy&gt;<o:p></o:p></p>

<p class=ILoutput><span style="mso-spacerun: yes">  </span>&lt;/soap:Header&gt;<o:p></o:p></p>

<p class=ILoutput>&lt;soap:Body&gt;<o:p></o:p></p>

<p class=ILoutput><span style="mso-spacerun: yes">  </span>&lt;abcResponse
xmlns=&quot;http://tempuri.org/&quot; /&gt; <o:p></o:p></p>

<p class=ILoutput><span style="mso-spacerun: yes">  </span>&lt;/soap:Body&gt;<o:p></o:p></p>

<p class=ILoutput><span style="mso-spacerun: yes"> 
</span>&lt;/soap:Envelope&gt;<o:p></o:p></p>

<p class=ILbase><span style='color:windowtext'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=ILbase><span style='color:windowtext'>By merely adding one more
property to the SoapHeader attribute, we have been able to add a header to the
SOAP response packet. In the asmx file, the values of the 'name' and the 'pass'
properties are initialized to 'no' and 'yes', respectively. <o:p></o:p></span></p>

<p class=ILbase><span style='color:windowtext'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=ILbase><span style='color:windowtext'>Further, since the Direction
property has been set to 'InOut', the headers now flow in both directions. The
default value of the Direction property is 'In'. The third possible value that
it can assume is 'Out', which is normally used in the response packet only.<o:p></o:p></span></p>

<p class=ILbase><span style='color:windowtext'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=ILbase><span style='color:windowtext'>The wsdl file does not display
the word 'InOut'. Moreover, the output element in the operation for abc, which
earlier contained a single member body, now has an additional member - the
header, along with its attributes. <o:p></o:p></span></p>

<p class=ILbase><span style='color:windowtext'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=ILbase><span style='color:windowtext'>Since the wsdl file contains the
Header element in both the input and the output elements, the Direction
property in the proxy is set to 'InOut'. The client program adds two lines at
the end, to display the values of the 'pass' and 'name' members, which are
modified to 'yes' and 'no', respectively.<o:p></o:p></span></p>

<p class=ILbase><span style='color:windowtext'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=ILprg><u>a.asmx</u><o:p></o:p></p>

<p class=ILprg>&lt;%@ WebService Language=&quot;C#&quot; class=&quot;zzz&quot;
%&gt;<o:p></o:p></p>

<p class=ILprg>using System;<o:p></o:p></p>

<p class=ILprg>using System.Web.Services;<o:p></o:p></p>

<p class=ILprg>using System.Web.Services.Protocols;<o:p></o:p></p>

<p class=ILprg>public class zzz<o:p></o:p></p>

<p class=ILprg>{<o:p></o:p></p>

<p class=ILprg>public yyy z;<o:p></o:p></p>

<p class=ILprg>public xxx z1;<o:p></o:p></p>

<p class=ILprg>[WebMethod]<o:p></o:p></p>

<p class=ILprg>[SoapHeader(&quot;z&quot;)]<o:p></o:p></p>

<p class=ILprg>[SoapHeader(&quot;z1&quot;)]<o:p></o:p></p>

<p class=ILprg>public void abc()<o:p></o:p></p>

<p class=ILprg>{<o:p></o:p></p>

<p class=ILprg>}<o:p></o:p></p>

<p class=ILprg>[WebMethod]<o:p></o:p></p>

<p class=ILprg>[SoapHeader(&quot;z1&quot;)]<o:p></o:p></p>

<p class=ILprg>public void pqr()<o:p></o:p></p>

<p class=ILprg>{<o:p></o:p></p>

<p class=ILprg>}<o:p></o:p></p>

<p class=ILprg>}<o:p></o:p></p>

<p class=ILprg>public class yyy : SoapHeader <o:p></o:p></p>

<p class=ILprg>{<o:p></o:p></p>

<p class=ILprg>public string name;<o:p></o:p></p>

<p class=ILprg>public string pass;<o:p></o:p></p>

<p class=ILprg>}<o:p></o:p></p>

<p class=ILprg>public class xxx : SoapHeader <o:p></o:p></p>

<p class=ILprg>{<o:p></o:p></p>

<p class=ILprg>public string aa;<o:p></o:p></p>

<p class=ILprg>}<o:p></o:p></p>

<p class=ILprg><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=ILprg><u>a.cs</u><o:p></o:p></p>

<p class=ILprg>using System;<o:p></o:p></p>

<p class=ILprg>using System.Web.Services.Protocols;<o:p></o:p></p>

<p class=ILprg>using System.Web.Services;<o:p></o:p></p>

<p class=ILprg>public class aaa :
System.Web.Services.Protocols.SoapHttpClientProtocol<o:p></o:p></p>

<p class=ILprg>{<span style="mso-spacerun: yes">        </span><o:p></o:p></p>

<p class=ILprg>public static void Main()<o:p></o:p></p>

<p class=ILprg>{<o:p></o:p></p>

<p class=ILprg>zzz a= new zzz();<o:p></o:p></p>

<p class=ILprg>a.yyyValue = new yyy();<o:p></o:p></p>

<p class=ILprg>a.xxxValue = new xxx();<o:p></o:p></p>

<p class=ILprg>a.yyyValue.name=&quot;vijay&quot; ;<o:p></o:p></p>

<p class=ILprg>a.yyyValue.pass=&quot;sonal&quot; ;<o:p></o:p></p>

<p class=ILprg>a.xxxValue.aa=&quot;mukhi&quot; ;<o:p></o:p></p>

<p class=ILprg>a.abc();<o:p></o:p></p>

<p class=ILprg>a.pqr();<o:p></o:p></p>

<p class=ILprg>}<o:p></o:p></p>

<p class=ILprg>}<o:p></o:p></p>

<p class=ILprg><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=ILprg><u>aa.wsdl</u><o:p></o:p></p>

<p class=ILprg><span style="mso-spacerun: yes">  </span>&lt;message
name=&quot;abcyyy&quot;&gt;<o:p></o:p></p>

<p class=ILprg>&lt;part name=&quot;yyy&quot; element=&quot;s0:yyy&quot; /&gt;<o:p></o:p></p>

<p class=ILprg><span style="mso-spacerun: yes">  </span>&lt;/message&gt;<o:p></o:p></p>

<p class=ILprg><span style="mso-spacerun: yes">  </span>&lt;message
name=&quot;abcxxx&quot;&gt;<o:p></o:p></p>

<p class=ILprg>&lt;part name=&quot;xxx&quot; element=&quot;s0:xxx&quot; /&gt;<o:p></o:p></p>

<p class=ILprg><span style="mso-spacerun: yes">  </span>&lt;/message&gt;<o:p></o:p></p>

<p class=ILprg><span style="mso-spacerun: yes">  </span>&lt;message
name=&quot;pqrxxx&quot;&gt;<o:p></o:p></p>

<p class=ILprg>&lt;part name=&quot;xxx&quot; element=&quot;s0:xxx&quot; /&gt;<o:p></o:p></p>

<p class=ILprg><span style="mso-spacerun: yes">  </span>&lt;/message&gt;<o:p></o:p></p>

<p class=ILprg>&lt;operation name=&quot;abc&quot;&gt;<o:p></o:p></p>

<p class=ILprg>&lt;soap:operation soapAction=&quot;http://tempuri.org/abc&quot;
style=&quot;document&quot; /&gt;<o:p></o:p></p>

<p class=ILprg>&lt;input&gt;<o:p></o:p></p>

<p class=ILprg><span style="mso-spacerun: yes">  </span>&lt;soap:body
use=&quot;literal&quot; /&gt;<o:p></o:p></p>

<p class=ILprg><span style="mso-spacerun: yes">  </span>&lt;soap:header
n1:required=&quot;true&quot; message=&quot;s0:abcyyy&quot; part=&quot;yyy&quot;
use=&quot;literal&quot; xmlns:n1=&quot;http://schemas.xmlsoap.org/wsdl/&quot;
/&gt;<o:p></o:p></p>

<p class=ILprg><span style="mso-spacerun: yes">  </span>&lt;soap:header
n1:required=&quot;true&quot; message=&quot;s0:abcxxx&quot; part=&quot;xxx&quot;
use=&quot;literal&quot; xmlns:n1=&quot;http://schemas.xmlsoap.org/wsdl/&quot;
/&gt;<o:p></o:p></p>

<p class=ILprg>&lt;/input&gt;<o:p></o:p></p>

<p class=ILprg>&lt;output&gt;<o:p></o:p></p>

<p class=ILprg><span style="mso-spacerun: yes">  </span>&lt;soap:body
use=&quot;literal&quot; /&gt;<o:p></o:p></p>

<p class=ILprg>&lt;/output&gt;<o:p></o:p></p>

<p class=ILprg>&lt;/operation&gt;<o:p></o:p></p>

<p class=ILprg>&lt;operation name=&quot;pqr&quot;&gt;<o:p></o:p></p>

<p class=ILprg>&lt;soap:operation soapAction=&quot;http://tempuri.org/pqr&quot;
style=&quot;document&quot; /&gt;<o:p></o:p></p>

<p class=ILprg>&lt;input&gt;<o:p></o:p></p>

<p class=ILprg><span style="mso-spacerun: yes">  </span>&lt;soap:body
use=&quot;literal&quot; /&gt;<o:p></o:p></p>

<p class=ILprg>&lt;soap:header n1:required=&quot;true&quot;
message=&quot;s0:pqrxxx&quot; part=&quot;xxx&quot; use=&quot;literal&quot;
xmlns:n1=&quot;http://schemas.xmlsoap.org/wsdl/&quot; /&gt;<o:p></o:p></p>

<p class=ILprg>&lt;/input&gt;<o:p></o:p></p>

<p class=ILprg>&lt;output&gt;<o:p></o:p></p>

<p class=ILprg><span style="mso-spacerun: yes">  </span>&lt;soap:body
use=&quot;literal&quot; /&gt;<o:p></o:p></p>

<p class=ILprg>&lt;/output&gt;<o:p></o:p></p>

<p class=ILprg>&lt;/operation&gt;<o:p></o:p></p>

<p class=ILprg><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=ILbase><span style='color:windowtext'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=ILprg><u>zzz.cs</u><o:p></o:p></p>

<p class=ILprg>public class zzz :
System.Web.Services.Protocols.SoapHttpClientProtocol {<o:p></o:p></p>

<p class=ILprg>public yyy yyyValue;<o:p></o:p></p>

<p class=ILprg>public xxx xxxValue;<o:p></o:p></p>

<p class=ILprg>[System.Web.Services.Protocols.SoapHeaderAttribute(&quot;yyyValue&quot;)]<o:p></o:p></p>

<p class=ILprg>[System.Web.Services.Protocols.SoapHeaderAttribute(&quot;xxxValue&quot;)]<o:p></o:p></p>

<p class=ILprg>[System.Web.Services.Protocols.SoapDocumentMethodAttribute(&quot;http://tempuri.org/abc&quot;]<o:p></o:p></p>

<p class=ILprg>public void abc() <o:p></o:p></p>

<p class=ILprg>{<o:p></o:p></p>

<p class=ILprg>this.Invoke(&quot;abc&quot;, new object[0]);<o:p></o:p></p>

<p class=ILprg>}<o:p></o:p></p>

<p class=ILprg>[System.Web.Services.Protocols.SoapHeaderAttribute(&quot;xxxValue&quot;)]<o:p></o:p></p>

<p class=ILprg>[System.Web.Services.Protocols.SoapDocumentMethodAttribute(http://tempuri.org/pqr)]<o:p></o:p></p>

<p class=ILprg>public void pqr() <o:p></o:p></p>

<p class=ILprg>{<o:p></o:p></p>

<p class=ILprg>this.Invoke(&quot;pqr&quot;, new object[0]);<o:p></o:p></p>

<p class=ILprg>}<span style="mso-spacerun: yes">    </span><o:p></o:p></p>

<p class=ILprg>}<o:p></o:p></p>

<p class=ILprg>public class yyy : SoapHeader <o:p></o:p></p>

<p class=ILprg>{<o:p></o:p></p>

<p class=ILprg>public string name;<o:p></o:p></p>

<p class=ILprg>public string pass;<o:p></o:p></p>

<p class=ILprg>}<o:p></o:p></p>

<p class=ILprg>public class xxx : SoapHeader <o:p></o:p></p>

<p class=ILprg>{<o:p></o:p></p>

<p class=ILprg>public string aa;<o:p></o:p></p>

<p class=ILprg>}<o:p></o:p></p>

<p class=ILbase><span style='color:windowtext'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=ILoutput><u>Soap Request 1</u><o:p></o:p></p>

<p class=ILoutput>&lt;soap:Header&gt;<o:p></o:p></p>

<p class=ILoutput>&lt;xxx xmlns=&quot;http://tempuri.org/&quot;&gt;<o:p></o:p></p>

<p class=ILoutput><span style="mso-spacerun: yes"> 
</span>&lt;aa&gt;mukhi&lt;/aa&gt; <o:p></o:p></p>

<p class=ILoutput><span style="mso-spacerun: yes">  </span>&lt;/xxx&gt;<o:p></o:p></p>

<p class=ILoutput>&lt;yyy xmlns=&quot;http://tempuri.org/&quot;&gt;<o:p></o:p></p>

<p class=ILoutput><span style="mso-spacerun: yes"> 
</span>&lt;name&gt;vijay&lt;/name&gt; <o:p></o:p></p>

<p class=ILoutput><span style="mso-spacerun: yes"> 
</span>&lt;pass&gt;sonal&lt;/pass&gt; <o:p></o:p></p>

<p class=ILoutput><span style="mso-spacerun: yes">  </span>&lt;/yyy&gt;<o:p></o:p></p>

<p class=ILoutput>&lt;/soap:Header&gt;<o:p></o:p></p>

<p class=ILoutput><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=ILoutput><u>Soap Request 2</u><o:p></o:p></p>

<p class=ILoutput>&lt;soap:Header&gt;<o:p></o:p></p>

<p class=ILoutput>&lt;xxx xmlns=&quot;http://tempuri.org/&quot;&gt;<o:p></o:p></p>

<p class=ILoutput>&lt;aa&gt;mukhi&lt;/aa&gt; <o:p></o:p></p>

<p class=ILoutput>&lt;/xxx&gt;<o:p></o:p></p>

<p class=ILoutput>&lt;/soap:Header&gt;<o:p></o:p></p>

<p class=ILbase><span style='color:windowtext'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=ILbase><span style='color:windowtext'>Though the above example may
span numerous pages, its sole purpose is to demonstrate the fundamental concept
that, the SOAP header packets get created in accordance with the attributes
placed before the function. Thus, the function that is called, determines the
SOAP headers that get sent across. <o:p></o:p></span></p>

<p class=ILbase><span style='color:windowtext'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=ILbase><span style='color:windowtext'>There are two classes, xxx and
yyy, both of which are derived from SoapHeader. Thereafter, two objects
representing the headers, viz. z and z1, are created when the SOAP payload
arrives from the client to the server. The names of these two variables are
inconsequential, and do not get reflected in the wsdl file. The Attribute
SoapHeader is most crucial, as this attribute determines what is to be sent
across. <o:p></o:p></span></p>

<p class=ILbase><span style='color:windowtext'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=ILbase><span style='color:windowtext'>The function abc utilizes this
attribute twice, and therefore, the contents of both the classes, yyy and xxx,
are sent across as headers. Thus, a call to the function abc will result in the
transmission of three elements in the header, viz. 'name', 'pass' and 'aa'. On
the other hand, the function pqr would have only a single element in the
header, i.e. 'aa', since it has only one SoapHeader attribute. <o:p></o:p></span></p>

<p class=ILbase><span style='color:windowtext'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=ILbase><span style='color:windowtext'>The wsdl file reinforces the
statement that we have just made. The function abc has two headers; hence, two
message elements named 'abcyyy' and 'abcxxx' are visible, unlike in the earlier
program. Since the function pqr has only a single header, a single part named
'pqrxxx' is visible. <o:p></o:p></span></p>

<p class=ILbase><span style='color:windowtext'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=ILbase><span style='color:windowtext'>Every function embodies its own
operation element. To begin with, the function abc in the input transmits two
headers across. Hence, the header element is displayed twice. The first is a
message 'abcyyy', while the second is 'abcxxx'. The output does not have any
headers. Thus, no header element exists. We could possibly have combined the
last two programs and sent only a single header across, using the direction
property.<span style="mso-spacerun: yes">  </span><o:p></o:p></span></p>

<p class=ILbase><span style='color:windowtext'>The operation called pqr has a
single header named xxx, which is to be sent across. The value of the direction
property is 'In', by default. We have not displayed the schemas, since they
fail to introduce anything innovative. The schemas that have been created for
yyy and xxx are identical. <o:p></o:p></span></p>

<p class=ILbase><span style='color:windowtext'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=ILbase><span style='color:windowtext'>The client program is acquainted
with the fact that there exist two objects. Hence, yyyValue and xxxValue are
created, to represent the objects z and z1, respectively. Then, using the
object 'a', the functions abc and pqr are called. In the proxy, we now have two
classes, yyy and xxx, which are derived from the SoapHeader class. <o:p></o:p></span></p>

<p class=ILbase><span style='color:windowtext'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=ILbase><span style='color:windowtext'>Correspondingly, we also have
two objects named xxxValue and yyyValue, to represent them. The proxy object is
very similar to the asmx file. The function abc sends two headers across. Thus,
it has two SoapHeaderAttribute attributes. The function pqr has only a single
SoapHeaderAttribute. <o:p></o:p></span></p>

<p class=ILbase><span style='color:windowtext'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=ILbase><span style='color:windowtext'>Here, a round trip gets
executed, in that, the asmx file gets converted to wsdl, which in turn, becomes
the proxy. The first SOAP request is that of the function abc. We are sending
two disparate headers from two different classes. Thus, the element 'aa'
becomes a part of the xxx class, while the 'name' and 'pass' members become
part of the yyy class. <o:p></o:p></span></p>

<p class=ILbase><span style='color:windowtext'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=ILbase><span style='color:windowtext'>The headers are not bundled and
sent across. Instead, they are dispatched depending upon the class that they
belong to. Therefore, they could enjoy the same names, and yet be
differentiated at the receiving end. The second packet represents the function
pqr, where only a single header is sent across. Each packet represents a single
function.<o:p></o:p></span></p>

<p class=ILbase><span style='color:windowtext'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=ILprg><u>a.asmx </u><o:p></o:p></p>

<p class=ILprg>&lt;%@ WebService Language=&quot;C#&quot; class=&quot;zzz&quot;
%&gt;<o:p></o:p></p>

<p class=ILprg>using System;<o:p></o:p></p>

<p class=ILprg>using System.Web.Services;<o:p></o:p></p>

<p class=ILprg>using System.Web.Services.Protocols;<o:p></o:p></p>

<p class=ILprg>public class zzz {<o:p></o:p></p>

<p class=ILprg>public yyy z;<o:p></o:p></p>

<p class=ILprg>[WebMethod]<o:p></o:p></p>

<p class=ILprg>[SoapHeader(&quot;z&quot;, Required=true)]<o:p></o:p></p>

<p class=ILprg>public void abc()<o:p></o:p></p>

<p class=ILprg>{<o:p></o:p></p>

<p class=ILprg>}<o:p></o:p></p>

<p class=ILprg>}<o:p></o:p></p>

<p class=ILprg>public class yyy : SoapHeader <o:p></o:p></p>

<p class=ILprg>{<o:p></o:p></p>

<p class=ILprg>public string name;<o:p></o:p></p>

<p class=ILprg>public string pass;<o:p></o:p></p>

<p class=ILprg>}<o:p></o:p></p>

<p class=ILprg><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=ILprg><u>aa.wsdl</u><o:p></o:p></p>

<p class=ILprg>&lt;soap:header n1:required=&quot;true&quot;
message=&quot;s0:abcyyy&quot; part=&quot;yyy&quot; use=&quot;literal&quot;
xmlns:n1=&quot;http://schemas.xmlsoap.org/wsdl/&quot; /&gt;<o:p></o:p></p>

<p class=ILprg><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=ILprg><u>a.cs</u><o:p></o:p></p>

<p class=ILprg>using System;<o:p></o:p></p>

<p class=ILprg>using System.Web.Services.Protocols;<o:p></o:p></p>

<p class=ILprg>using System.Web.Services;<o:p></o:p></p>

<p class=ILprg>public class aaa :
System.Web.Services.Protocols.SoapHttpClientProtocol<span style="mso-spacerun:
yes">  </span>{<span style="mso-spacerun: yes">        </span><o:p></o:p></p>

<p class=ILprg>public static void Main()<o:p></o:p></p>

<p class=ILprg>{<o:p></o:p></p>

<p class=ILprg>zzz a= new zzz();<o:p></o:p></p>

<p class=ILprg>a.abc();<o:p></o:p></p>

<p class=ILprg>}<o:p></o:p></p>

<p class=ILprg>}<o:p></o:p></p>

<p class=ILbase><span style='color:windowtext'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=ILbase><span style='color:windowtext'>The asmx file remains unaltered,
except that the function abc has the SOAP header set to the object 'z', and the
Required property set to 'true'. The value of default signifies that it is
mandatory for the client to send the header across, before it can send the
packet over. <o:p></o:p></span></p>

<p class=ILbase><span style='color:windowtext'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=ILbase><span style='color:windowtext'>The aa.wsdl file shows only a
single line, where the header element contains a 'Required' attribute. By
default, it is set to a value of 'true'. In the a.cs file, since an instance of
the yyyValue object is not created, an exception is thrown.<o:p></o:p></span></p>

<p class=ILbase><span style='color:windowtext'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=ILoutput><u>Output</u><o:p></o:p></p>

<p class=ILoutput>Unhandled Exception: System.Web.Services.Protocols.SoapHeaderException:
Required field/property zzz.yyyValue of SOAP header yyy was not set by the
client prior to making the call.<o:p></o:p></p>

<p class=ILbase><span style='color:windowtext'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=ILprg><u>a.asmx</u><o:p></o:p></p>

<p class=ILprg>[SoapHeader(&quot;z&quot;, Required=false)]<o:p></o:p></p>

<p class=ILprg><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=ILprg><u>aa.wsdl</u><o:p></o:p></p>

<p class=ILprg>&lt;soap:header message=&quot;s0:abcyyy&quot;
part=&quot;yyy&quot; use=&quot;literal&quot; /&gt;<o:p></o:p></p>

<p class=ILprg><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=ILprg><u>zzz.cs</u><o:p></o:p></p>

<p class=ILprg>[System.Web.Services.Protocols.SoapHeaderAttribute(&quot;yyyValue&quot;,
Required=false)]<o:p></o:p></p>

<p class=ILbase><span style='color:windowtext'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=ILoutput><u>soap request</u><o:p></o:p></p>

<p class=ILoutput>&lt;soap:Envelope
xmlns:soap=&quot;http://schemas.xmlsoap.org/soap/envelope/&quot;
xmlns:xsi=&quot;http://www.w3.org/2001/XMLSchema-instance&quot;
xmlns:xsd=&quot;http://www.w3.org/2001/XMLSchema&quot;&gt;<o:p></o:p></p>

<p class=ILoutput>&lt;soap:Body&gt;<o:p></o:p></p>

<p class=ILoutput><span style="mso-spacerun: yes">  </span>&lt;abc
xmlns=&quot;http://tempuri.org/&quot; /&gt; <o:p></o:p></p>

<p class=ILoutput><span style="mso-spacerun: yes">  </span>&lt;/soap:Body&gt;<o:p></o:p></p>

<p class=ILoutput><span style="mso-spacerun: yes"> 
</span>&lt;/soap:Envelope&gt;<o:p></o:p></p>

<p class=ILbase><span style='color:windowtext'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=ILbase><span style='color:windowtext'>As a result of transforming the
value of the Required attribute to 'false', the header element of the wsdl file
that gets generated, is by far much simpler, and contains very few attributes.
It does not have any attribute named Required. The client program remains
unchanged. <o:p></o:p></span></p>

<p class=ILbase><span style='color:windowtext'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=ILbase><span style='color:windowtext'>The proxy that is generated,
almost mirrors the asmx file. Hence, the Required attribute is visible, along
with the SoapHeader attribute, above the function abc. However, the SOAP
request does not specify any Header details. Thus, in the final analysis, the
value in the Required attribute determines whether a SOAP header should be sent
across or not.<o:p></o:p></span></p>

<p class=ILbase><span style='color:windowtext'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=ILbase><span style='color:windowtext'>Change the code in the Main
function within a.cs to the following<o:p></o:p></span></p>

<p class=ILbase><span style='color:windowtext'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=ILprg>public static void Main() {<o:p></o:p></p>

<p class=ILprg>zzz a= new zzz();<o:p></o:p></p>

<p class=ILprg>a.yyyValue = new yyy();<o:p></o:p></p>

<p class=ILprg>a.abc();<o:p></o:p></p>

<p class=ILprg>}<o:p></o:p></p>

<p class=ILoutput><u>soap request</u><o:p></o:p></p>

<p class=ILoutput>&lt;soap:Header&gt;<o:p></o:p></p>

<p class=ILoutput>&lt;yyy xmlns=&quot;http://tempuri.org/&quot;&gt;<o:p></o:p></p>

<p class=ILoutput><span style="mso-spacerun: yes">  </span>&lt;name
xsi:nil=&quot;true&quot; /&gt; <o:p></o:p></p>

<p class=ILoutput><span style="mso-spacerun: yes">  </span>&lt;pass
xsi:nil=&quot;true&quot; /&gt; <o:p></o:p></p>

<p class=ILoutput><span style="mso-spacerun: yes">  </span>&lt;/yyy&gt;<o:p></o:p></p>

<p class=ILoutput><span style="mso-spacerun: yes">  </span>&lt;/soap:Header&gt;<o:p></o:p></p>

<p class=ILbase><span style='color:windowtext'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=ILbase><span style='color:windowtext'>Earlier, since the yyyValue was
not initialized to any object, an exception was thrown. Now, a yyy object is
created, but none of the members are initialized. The SOAP packet discloses the
Header details, but it uses the 'nil' attribute to signify that they are empty
or null. If we change the Required attribute to 'true' in the asmx file, the
SOAP request displayed above, will be generated. <o:p></o:p></span></p>

<p class=ILbase><span style='color:windowtext'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=ILprg><u>a.asmx</u><o:p></o:p></p>

<p class=ILprg>&lt;%@ WebService Language=&quot;C#&quot; class=&quot;zzz&quot;
%&gt;<o:p></o:p></p>

<p class=ILprg>using System;<o:p></o:p></p>

<p class=ILprg>using System.Web.Services;<o:p></o:p></p>

<p class=ILprg>using System.Web.Services.Protocols;<o:p></o:p></p>

<p class=ILprg>public class zzz<o:p></o:p></p>

<p class=ILprg>{<o:p></o:p></p>

<p class=ILprg>[WebMethod]<o:p></o:p></p>

<p class=ILprg>public string abc()<o:p></o:p></p>

<p class=ILprg>{<o:p></o:p></p>

<p class=ILprg>return &quot;hell&quot;;<o:p></o:p></p>

<p class=ILprg>}<o:p></o:p></p>

<p class=ILprg>}<o:p></o:p></p>

<p class=ILprg><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=ILprg><u>a.cs</u><o:p></o:p></p>

<p class=ILprg>using System;<o:p></o:p></p>

<p class=ILprg>using System.Web.Services.Protocols;<o:p></o:p></p>

<p class=ILprg>using System.Web.Services;<o:p></o:p></p>

<p class=ILprg>public class aaa :
System.Web.Services.Protocols.SoapHttpClientProtocol<o:p></o:p></p>

<p class=ILprg>{<o:p></o:p></p>

<p class=ILprg>public yyy b;<o:p></o:p></p>

<p class=ILprg>public static void Main()<o:p></o:p></p>

<p class=ILprg>{<o:p></o:p></p>

<p class=ILprg>aaa a= new aaa();<o:p></o:p></p>

<p class=ILprg>a.b = new yyy();<o:p></o:p></p>

<p class=ILprg>a.b.name=&quot;vijay&quot; ;<o:p></o:p></p>

<p class=ILprg>a.b.pass=&quot;sonal&quot; ;<o:p></o:p></p>

<p class=ILprg>string i = a.abc();<o:p></o:p></p>

<p class=ILprg>Console.WriteLine(i);<o:p></o:p></p>

<p class=ILprg>}<o:p></o:p></p>

<p class=ILprg>[System.Web.Services.Protocols.SoapHeaderAttribute(&quot;b&quot;)]<o:p></o:p></p>

<p class=ILprg>[System.Web.Services.Protocols.SoapDocumentMethodAttribute(&quot;http://tempuri.org/abc&quot;)]<o:p></o:p></p>

<p class=ILprg>public string<span style="mso-spacerun: yes">  </span>abc() <o:p></o:p></p>

<p class=ILprg>{<o:p></o:p></p>

<p class=ILprg>object[] results = this.Invoke(&quot;abc&quot;, new object[0]);<o:p></o:p></p>

<p class=ILprg>return ((string)(results[0]));<o:p></o:p></p>

<p class=ILprg>}<o:p></o:p></p>

<p class=ILprg>public aaa()<o:p></o:p></p>

<p class=ILprg>{<o:p></o:p></p>

<p class=ILprg>this.Url = &quot;http://localhost:8080/a.asmx&quot;;<o:p></o:p></p>

<p class=ILprg>}<o:p></o:p></p>

<p class=ILprg>}<o:p></o:p></p>

<p class=ILprg>public class yyy : SoapHeader <o:p></o:p></p>

<p class=ILprg>{<o:p></o:p></p>

<p class=ILprg>public string name;<o:p></o:p></p>

<p class=ILprg>public string pass;<o:p></o:p></p>

<p class=ILprg>}<o:p></o:p></p>

<p class=ILbase><span style='color:windowtext'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=ILoutput><u>Output</u><o:p></o:p></p>

<p class=ILoutput>hell<o:p></o:p></p>

<p class=ILbase><span style='color:windowtext'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=ILbase><span style='color:windowtext'>The above program, which is a C#
client, is a near clone of the first C# program of the chapter. Any difference,
if at all, lies in the fact that the function abc returns a string. The above
program compiles by itself, without any wsdl file. <o:p></o:p></span></p>

<p class=ILbase><span style='color:windowtext'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=ILbase><span style='color:windowtext'>The salient point to be noted
here is that, despite sending a header across, the asmx file seems unable to
recognize or acknowledge the header's presence. Neither are there any errors
generated.<o:p></o:p></span></p>

<p class=ILbase><span style='color:windowtext'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=ILprg><u>a.asmx</u><o:p></o:p></p>

<p class=ILprg>&lt;%@ WebService Language=&quot;C#&quot; class=&quot;zzz&quot;
%&gt;<o:p></o:p></p>

<p class=ILprg>using System;<o:p></o:p></p>

<p class=ILprg>using System.Web.Services;<o:p></o:p></p>

<p class=ILprg>using System.Web.Services.Protocols;<o:p></o:p></p>

<p class=ILprg>public class zzz<o:p></o:p></p>

<p class=ILprg>{<o:p></o:p></p>

<p class=ILprg>public SoapUnknownHeader u;<o:p></o:p></p>

<p class=ILprg>[WebMethod]<o:p></o:p></p>

<p class=ILprg>[SoapHeader(&quot;u&quot;, Required=false)]<o:p></o:p></p>

<p class=ILprg>public string abc()<o:p></o:p></p>

<p class=ILprg>{<o:p></o:p></p>

<p class=ILprg>return u.Element.InnerXml + u.Element.Name;<o:p></o:p></p>

<p class=ILprg>}<o:p></o:p></p>

<p class=ILprg>}<o:p></o:p></p>

<p class=ILbase><span style='color:windowtext'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=ILoutput><u>Output</u><o:p></o:p></p>

<p class=ILoutput>&lt;name xmlns=&quot;http://tempuri.org/&quot;&gt;vijay&lt;/name&gt;<o:p></o:p></p>

<p class=ILoutput>&lt;pass
xmlns=&quot;http://tempuri.org/&quot;&gt;sonal&lt;/pass&gt;<o:p></o:p></p>

<p class=ILoutput>yyy<o:p></o:p></p>

<p class=ILbase><span style='color:windowtext'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=ILbase><span style='color:windowtext'>In our asmx program, an object
'u' of the class SoapUnknownHeader has been freshly appended. Therefore, before
the function abc gets called, this object contains all the headers that are not
known. This is on account of the SoapHeader attribute having the object name of
'u'. In our case, we have only a singular header named 'yyy'. <o:p></o:p></span></p>

<p class=ILbase><span style='color:windowtext'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=ILbase><span style='color:windowtext'>The value of the Required
parameter should be 'false', failing which, an unknown header would have to be
sent across manually. In the function, the contents of the header are
displayed, by merely employing the Element member of type XmlElement. This is
achieved by displaying the InnerXml member and the 'name' property that
retrieves the name of the header, i.e. yyy.<span style="mso-spacerun: yes"> 
</span><o:p></o:p></span></p>

<p class=ILbase><span style='color:windowtext'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=ILbase><span style='color:windowtext'>A property called DidUnderstand,
which accepts a boolean value, is set by the asmx file, in order to convey that
it has been able to comprehend the unknown header. This is not reflected in the
SOAP packet that is sent across.<o:p></o:p></span></p>

<p class=ILbase><span style='color:windowtext'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=ILbase><span style='color:windowtext'>Add the following property to
a.cs<o:p></o:p></span></p>

<p class=ILbase><span style='color:windowtext'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=ILprg>a.b.Actor=&quot;mukhi&quot; ;<o:p></o:p></p>

<p class=ILbase><span style='color:windowtext'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=ILoutput><u>Soap request</u><o:p></o:p></p>

<p class=ILoutput>&lt;soap:Header&gt;<o:p></o:p></p>

<p class=ILoutput>&lt;yyy soap:actor=&quot;mukhi&quot;
xmlns=&quot;http://tempuri.org/&quot;&gt;<o:p></o:p></p>

<p class=ILbase><span style='color:windowtext'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=ILbase><span style='color:windowtext'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=ILbase><span style='color:windowtext'>Now, we add one more property
called Actor, which is part of the SoapHeader class and initialize it to mukhi.
This results in the creation of an attribute named 'actor', in the SOAP request
packet. The 'actor' attribute is SOAP's way of determining who should be
reading and understanding the Header.<o:p></o:p></span></p>

<p class=ILbase><span style='color:windowtext'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=ILbase><span style='color:windowtext'>Here, we have assigned it a
value of 'mukhi', but in practical applications, it should contain a uri.<o:p></o:p></span></p>

<p class=ILbase><span style='color:windowtext'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=ILbase><span style='color:windowtext'>This is the final illustration
that carries out authentication by using an aspx file, instead of a client
program.<o:p></o:p></span></p>

<p class=ILbase><span style='color:windowtext'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=ILprg><u>a.aspx</u><o:p></o:p></p>

<p class=ILprg>&lt;%@ Page Language=&quot;C#&quot;%&gt;<o:p></o:p></p>

<p class=ILprg>&lt;%@ Import Namespace=&quot;Security&quot;%&gt;<o:p></o:p></p>

<p class=ILprg>&lt;%@ Import Namespace=&quot;System.Web.Services.Protocols&quot;
%&gt;<o:p></o:p></p>

<p class=ILprg>&lt;script runat=server&gt;<o:p></o:p></p>

<p class=ILprg>public void Page_Load()<o:p></o:p></p>

<p class=ILprg>{<o:p></o:p></p>

<p class=ILprg>s1.InnerHtml = &quot;&quot;;<o:p></o:p></p>

<p class=ILprg>}<o:p></o:p></p>

<p class=ILprg>public void abc(Object sender, EventArgs z)<o:p></o:p></p>

<p class=ILprg>{<o:p></o:p></p>

<p class=ILprg>zzz s = new zzz();<o:p></o:p></p>

<p class=ILprg>aaa a = new aaa();<o:p></o:p></p>

<p class=ILprg>a.User = us.Value;<o:p></o:p></p>

<p class=ILprg>a.Password = pass.Value;<o:p></o:p></p>

<p class=ILprg>s.aaaValue = a;<o:p></o:p></p>

<p class=ILprg>string r = s.abc();<o:p></o:p></p>

<p class=ILprg>s1.InnerHtml = r;<o:p></o:p></p>

<p class=ILprg>}<o:p></o:p></p>

<p class=ILprg>&lt;/script&gt;<o:p></o:p></p>

<p class=ILprg>&lt;form runat=server&gt;<o:p></o:p></p>

<p class=ILprg>Username: <o:p></o:p></p>

<p class=ILprg>&lt;input type=text id=us runat=server /&gt;<o:p></o:p></p>

<p class=ILprg>&lt;br&gt;<o:p></o:p></p>

<p class=ILprg>Password:<o:p></o:p></p>

<p class=ILprg>&lt;input type=text id=pass runat=server /&gt;<o:p></o:p></p>

<p class=ILprg>&lt;br&gt;<o:p></o:p></p>

<p class=ILprg>&lt;input type=submit runat=server OnServerClick=&quot;abc&quot;
value=&quot;Login&quot; /&gt;<o:p></o:p></p>

<p class=ILprg>&lt;/form&gt;<o:p></o:p></p>

<p class=ILprg>result: &lt;font color=red&gt;<o:p></o:p></p>

<p class=ILprg>&lt;span id=s1 runat=server /&gt;<o:p></o:p></p>

<p class=ILprg><u><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></u></p>

<p class=ILprg><u>a.asmx</u><o:p></o:p></p>

<p class=ILprg>&lt;%@ WebService Language=&quot;C#&quot; Class=&quot;zzz&quot;
%&gt;<o:p></o:p></p>

<p class=ILprg>using System;<o:p></o:p></p>

<p class=ILprg>using System.Web.Services;<o:p></o:p></p>

<p class=ILprg>using System.Web.Services.Protocols;<o:p></o:p></p>

<p class=ILprg>public class aaa : SoapHeader <o:p></o:p></p>

<p class=ILprg>{<o:p></o:p></p>

<p class=ILprg>public string User;<o:p></o:p></p>

<p class=ILprg>public string Password;<o:p></o:p></p>

<p class=ILprg>}<o:p></o:p></p>

<p class=ILprg>public class zzz : WebService<o:p></o:p></p>

<p class=ILprg>{<o:p></o:p></p>

<p class=ILprg>public aaa z;<o:p></o:p></p>

<p class=ILprg>[WebMethod]<o:p></o:p></p>

<p class=ILprg>[SoapHeader(&quot;z&quot;)]<o:p></o:p></p>

<p class=ILprg>public string abc()<o:p></o:p></p>

<p class=ILprg>{<o:p></o:p></p>

<p class=ILprg>if (z.User == &quot;vijay&quot; &amp;&amp;
z.Password==&quot;mukhi&quot;)<o:p></o:p></p>

<p class=ILprg>return &quot;all is okay&quot;;<o:p></o:p></p>

<p class=ILprg>if (z.User == &quot;sonal&quot; &amp;&amp;
z.Password==&quot;bad&quot;)<o:p></o:p></p>

<p class=ILprg>return &quot;all is not okay&quot;;<o:p></o:p></p>

<p class=ILprg>return &quot;somethings gone wrong&quot;;<o:p></o:p></p>

<p class=ILprg>}<o:p></o:p></p>

<p class=ILprg>}<o:p></o:p></p>

<p class=ILprg><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=ILprg><u>a.bat</u><o:p></o:p></p>

<p class=ILprg>del *.dll<o:p></o:p></p>

<p class=ILprg>wsdl a.wsdl /namespace:Security<o:p></o:p></p>

<p class=ILprg>csc.exe /t:library<span style="mso-spacerun: yes"> 
</span>zzz.cs<o:p></o:p></p>

<p class=ILprg>md c:\inetpub\wwwroot\bin<o:p></o:p></p>

<p class=ILprg>copy zzz.dll c:\inetpub\wwwroot\bin\<o:p></o:p></p>

<p class=ILbase><span style='color:windowtext'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=ILoutput><u>SOAP request</u><o:p></o:p></p>

<p class=ILoutput>&lt;soap:Header&gt;<o:p></o:p></p>

<p class=ILoutput>- &lt;aaa xmlns=&quot;http://tempuri.org/&quot;&gt;<o:p></o:p></p>

<p class=ILoutput><span style="mso-spacerun: yes"> 
</span>&lt;User&gt;sonal&lt;/User&gt; <o:p></o:p></p>

<p class=ILoutput><span style="mso-spacerun: yes"> 
</span>&lt;Password&gt;mukhi&lt;/Password&gt; <o:p></o:p></p>

<p class=ILoutput><span style="mso-spacerun: yes">  </span>&lt;/aaa&gt;<o:p></o:p></p>

<p class=ILoutput><span style="mso-spacerun: yes">  </span>&lt;/soap:Header&gt;<o:p></o:p></p>

<p class=ILoutput>- &lt;soap:Body&gt;<o:p></o:p></p>

<p class=ILoutput><span style="mso-spacerun: yes">  </span>&lt;abc
xmlns=&quot;http://tempuri.org/&quot; /&gt; <o:p></o:p></p>

<p class=ILoutput><span style="mso-spacerun: yes">  </span>&lt;/soap:Body&gt;<o:p></o:p></p>

<p class=ILbase><span style='color:windowtext'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=ILoutput><u>SOAP response</u><o:p></o:p></p>

<p class=ILoutput>&lt;abcResponse xmlns=&quot;http://tempuri.org/&quot;&gt;<o:p></o:p></p>

<p class=ILoutput><span style="mso-spacerun: yes"> 
</span>&lt;abcResult&gt;something gone wrong&lt;/abcResult&gt; <o:p></o:p></p>

<p class=ILoutput><span style="mso-spacerun: yes">  </span>&lt;/abcResponse&gt;<o:p></o:p></p>

<p class=ILbase><span style='color:windowtext'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=ILbase><span style='color:windowtext'>We commence by creating the file
a.aspx in the C:\inerpub\wwwroot folder. The language is explicitly specified
as C#, because the default language is VB. This is followed by a series of
unproductive Import statements, to enable you to abandon writing the namespace
names over and over again. The code will eventually emanate from the Namespace
Security. The whole world uses namespaces, so why should we be called the
nonconformists or the odd ones out? <o:p></o:p></span></p>

<p class=ILbase><span style='color:windowtext'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=ILbase><span style='color:windowtext'>The 'runat' attribute is
mandatory, although we are aware that everything runs only at the server end.
The Page_Load function gets called each time the page is sent from the server
to the client.<o:p></o:p></span></p>

<p class=ILbase><span style='color:windowtext'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=ILbase><span style='color:windowtext'>Thereafter, we simply initialize
the s1 element, which is a span element, to a blank value. We could have used a
label instead, but on a personal whim, we preferred the span element.<o:p></o:p></span></p>

<p class=ILbase><span style='color:windowtext'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=ILbase><span style='color:windowtext'>On the screen, the words
'username' and 'password' are displayed along with two textboxes, having ids of
'us' and 'pass', respectively. The user is expected to key-in a user id and a
password. The 'type' for the password box should be specified as 'password' to
avoid displaying the characters, since they are being entered. Moreover, there
is a button that calls the function abc on the server, every time the user
clicks on it.<o:p></o:p></span></p>

<p class=ILbase><span style='color:windowtext'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=ILbase><span style='color:windowtext'>Before advancing any further
with deciphering the code contained in the function abc, let us examine the
asmx file. The class zzz has a function named abc, which receives a soap header
called 'aaa', in the form of an object 'z'. This header class aaa has two
members, User and Password. <o:p></o:p></span></p>

<p class=ILbase><span style='color:windowtext'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=ILbase><span style='color:windowtext'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=ILbase><span style='color:windowtext'>The function abc ascertains
whether the User and Password contain specific pre-defined values or not. The
activity performed by this function has nothing in common with the function abc
of the aspx file. <o:p></o:p></span></p>

<p class=ILbase><span style='color:windowtext'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=ILbase><span style='color:windowtext'>If the username is entered as
'vijay', and the password is entered as 'mukhi', an OK message is received.
However, if the user name is specified as 'sonal', and the password is
specified as 'bad', an altogether different message is received. If any other
values are specified, a default message is displayed. In real life, the values
are compared with data contained in a database.<o:p></o:p></span></p>

<p class=ILbase><span style='color:windowtext'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=ILbase><span style='color:windowtext'>Once the asmx file is done with,
create a wsdl file as before, by entering the url of
http://localhost/a.asmx?WSDL in the browser. The only difference here is that
the wsdl file must be saved as 'a.wsdl' in the c:\inetpub\wwwroot\bin folder.
The batch file first calls the wsdl program, and the /namespace option places
all the code of the class zzz in the namespace security. Thereafter, zzz.cs is
compiled into a dll file, as before.<o:p></o:p></span></p>

<p class=ILbase><span style='color:windowtext'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=ILbase><span style='color:windowtext'>Once the stage is set, load the
browser and enter the url as http://localhost/a.aspx. In the textboxes, enter
the values for the userid and password, and then, click on the button. This
calls the function abc. <o:p></o:p></span></p>

<p class=ILbase><span style='color:windowtext'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=ILbase><span style='color:windowtext'>The function abc in the aspx
file first creates an object 's', which is an instance of the class zzz. The
rationale behind placing the class in the bin folder is that, the system
normally searches this location for classes. <o:p></o:p></span></p>

<p class=ILbase><span style='color:windowtext'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=ILbase><span style='color:windowtext'>Another object named aa is
created, which is an instance of the SoapHeader class. Then, the User and
Password members are initialized to the text specified in the textboxes,
identified with the ids of 'us' and 'pass', respectively. <o:p></o:p></span></p>

<p class=ILbase><span style='color:windowtext'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=ILbase><span style='color:windowtext'>Once this is accomplished, the
aaaValue member, which represents the header object in class zzz, is
initialized to 'a', which is an instance of the SoapHeader class. In this
manner, all the initialized values are passed to the header. <o:p></o:p></span></p>

<p class=ILbase><span style='color:windowtext'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=ILbase><span style='color:windowtext'>Thereafter, the function abc
sends the header across, and the value returned by the remoted function is
placed into the span's InnerHtml member. <o:p></o:p></span></p>

<p class=ILbase><span style='color:windowtext'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=MsoNormal>You can change the port number to 8080 in the wsdl file, in
order to observe the flow of packets in the trace program. Thus, the SOAP
request and response remain the same, irrespective of whether we work with a
client C# program or with an aspx file.</p>

<p class=MsoNormal><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

</div>

</body>


<!-- Mirrored from www.vijaymukhi.com/documents/books/xmlsoap/chap6.htm by HTTrack Website Copier/3.x [XR&CO'2014], Fri, 11 Oct 2024 13:57:57 GMT -->
</html>
