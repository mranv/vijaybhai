<html xmlns:v="urn:schemas-microsoft-com:vml"
xmlns:o="urn:schemas-microsoft-com:office:office"
xmlns:w="urn:schemas-microsoft-com:office:word"
xmlns="http://www.w3.org/TR/REC-html40">


<!-- Mirrored from www.vijaymukhi.com/documents/books/csclasses/chap4.htm by HTTrack Website Copier/3.x [XR&CO'2014], Fri, 11 Oct 2024 13:45:57 GMT -->
<head>
<meta http-equiv=Content-Type content="text/html; charset=windows-1252">
<meta name=ProgId content=Word.Document>
<meta name=Generator content="Microsoft Word 9">
<meta name=Originator content="Microsoft Word 9">
<link rel=File-List href="chap4_files/filelist.html">
<link rel=Edit-Time-Data href="chap4_files/editdata.html">
<!--[if !mso]>
<style>
v\:* {behavior:url(#default#VML);}
o\:* {behavior:url(#default#VML);}
w\:* {behavior:url(#default#VML);}
.shape {behavior:url(#default#VML);}
</style>
<![endif]-->
<title>C# Classes-Threads,WinForms and XML</title>
<!--[if gte mso 9]><xml>
 <o:DocumentProperties>
  <o:Author>Vijay Mukhi</o:Author>
  <o:LastAuthor>Vijay Mukhi</o:LastAuthor>
  <o:Revision>14</o:Revision>
  <o:TotalTime>172</o:TotalTime>
  <o:Created>2001-11-05T20:52:00Z</o:Created>
  <o:LastSaved>2001-11-06T21:08:00Z</o:LastSaved>
  <o:Pages>17</o:Pages>
  <o:Words>19988</o:Words>
  <o:Characters>113933</o:Characters>
  <o:Company>V.M.C.I.</o:Company>
  <o:Lines>949</o:Lines>
  <o:Paragraphs>227</o:Paragraphs>
  <o:CharactersWithSpaces>139917</o:CharactersWithSpaces>
  <o:Version>9.3821</o:Version>
 </o:DocumentProperties>
</xml><![endif]-->
<style>
<!--
 /* Font Definitions */
@font-face
	{font-family:Tahoma;
	panose-1:2 11 6 4 3 5 4 4 2 4;
	mso-font-charset:0;
	mso-generic-font-family:swiss;
	mso-font-pitch:variable;
	mso-font-signature:553679495 -2147483648 8 0 66047 0;}
@font-face
	{font-family:"Bookman Old Style";
	panose-1:2 5 6 4 5 5 5 2 2 4;
	mso-font-charset:0;
	mso-generic-font-family:roman;
	mso-font-pitch:variable;
	mso-font-signature:647 0 0 0 159 0;}
@font-face
	{font-family:"Monotype Corsiva";
	panose-1:3 1 1 1 1 2 1 1 1 1;
	mso-font-charset:0;
	mso-generic-font-family:script;
	mso-font-pitch:variable;
	mso-font-signature:647 0 0 0 159 0;}
@font-face
	{font-family:"Trebuchet MS";
	panose-1:2 11 6 3 2 2 2 2 2 4;
	mso-font-charset:0;
	mso-generic-font-family:swiss;
	mso-font-pitch:variable;
	mso-font-signature:7 0 0 0 19 0;}
 /* Style Definitions */
p.MsoNormal, li.MsoNormal, div.MsoNormal
	{mso-style-parent:"";
	margin:0in;
	margin-bottom:.0001pt;
	mso-pagination:widow-orphan;
	font-size:12.0pt;
	font-family:"Times New Roman";
	mso-fareast-font-family:"Times New Roman";}
p.ILbase, li.ILbase, div.ILbase
	{mso-style-name:ILbase;
	mso-style-parent:"";
	margin:0in;
	margin-bottom:.0001pt;
	text-align:justify;
	mso-pagination:widow-orphan;
	mso-layout-grid-align:none;
	text-autospace:none;
	font-size:10.0pt;
	font-family:"Bookman Old Style";
	mso-fareast-font-family:"Times New Roman";
	mso-bidi-font-family:"Times New Roman";
	color:black;}
p.ILprg, li.ILprg, div.ILprg
	{mso-style-name:ILprg;
	mso-style-parent:ILbase;
	mso-style-next:ILbase;
	margin-top:0in;
	margin-right:0in;
	margin-bottom:0in;
	margin-left:.5in;
	margin-bottom:.0001pt;
	mso-pagination:widow-orphan;
	mso-layout-grid-align:none;
	text-autospace:none;
	font-size:9.5pt;
	font-family:"Trebuchet MS";
	mso-fareast-font-family:"Times New Roman";
	mso-bidi-font-family:"Times New Roman";}
p.ILoutput, li.ILoutput, div.ILoutput
	{mso-style-name:ILoutput;
	mso-style-parent:ILbase;
	mso-style-next:ILbase;
	margin-top:0in;
	margin-right:0in;
	margin-bottom:0in;
	margin-left:.5in;
	margin-bottom:.0001pt;
	mso-pagination:widow-orphan;
	mso-layout-grid-align:none;
	text-autospace:none;
	font-size:9.5pt;
	font-family:Tahoma;
	mso-fareast-font-family:"Times New Roman";}
p.ILbullets, li.ILbullets, div.ILbullets
	{mso-style-name:ILbullets;
	mso-style-parent:ILbase;
	margin-top:0in;
	margin-right:0in;
	margin-bottom:0in;
	margin-left:.3in;
	margin-bottom:.0001pt;
	text-align:justify;
	mso-pagination:widow-orphan;
	mso-layout-grid-align:none;
	text-autospace:none;
	font-size:10.0pt;
	font-family:"Bookman Old Style";
	mso-fareast-font-family:"Times New Roman";
	mso-bidi-font-family:"Times New Roman";}
@page Section1
	{size:8.5in 11.0in;
	margin:1.0in 1.25in 1.0in 1.25in;
	mso-header-margin:.5in;
	mso-footer-margin:.5in;
	mso-paper-source:0;}
div.Section1
	{page:Section1;}
-->
</style>
</head>

<body lang=EN-US style='tab-interval:.5in'>

<div class=Section1>

<p class=MsoNormal><img width=64 height=48 id="_x0000_i1102" src=bpb.jpg></p>

<p class=MsoNormal><span style='font-size:24.0pt;font-family:"Monotype Corsiva";
color:black'>4<o:p></o:p></span></p>

<p class=MsoNormal><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=MsoNormal><span style='font-size:24.0pt;font-family:"Monotype Corsiva";
color:black'>Controls</span></p>

<p class=ILbase><span style='color:windowtext'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=ILbase><span style='color:windowtext'>Windows Forms or Winforms is a
contemporary Windows-based forms package that endows the Windows programmer
with an innovative methodology for creating aesthetic user interfaces and
interactive applications. We will not ramble on about the pros and cons of the
package, but commence the creation of the smallest GUI (Graphical User
Interface) application.<o:p></o:p></span></p>

<p class=ILbase><span style='color:windowtext'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=ILprg><u>a.cs</u></p>

<p class=ILprg>public class zzz</p>

<p class=ILprg>{</p>

<p class=ILprg>public static void Main() </p>

<p class=ILprg>{</p>

<p class=ILprg>zzz z = new zzz();</p>

<p class=ILprg>System.Windows.Forms.Application.Run(z);</p>

<p class=ILprg>}</p>

<p class=ILprg>}</p>

<p class=ILbase><span style='color:windowtext'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=ILoutput>Run the compiler as </p>

<p class=ILoutput>&gt;csc a.cs</p>

<p class=ILoutput><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=ILoutput><u>Compiler Error</u></p>

<p class=ILoutput>a.cs(6,1): error CS1502: The best overloaded method match for</p>

<p class=ILoutput><span style="mso-spacerun: yes">       
</span>'System.Windows.Forms.Application.Run(System.Windows.Forms.Form)' has
some invalid arguments</p>

<p class=ILoutput>a.cs(6,38): error CS1503: Argument '1': cannot convert from
'zzz' to 'System.Windows.Forms.Form'</p>

<p class=ILbase><span style='color:windowtext'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=ILbase><span style='color:windowtext'>An error is generated because,
Run, which is a static function in the Application class of the
System.Windows.Forms namespace, requires a Form object. The error distinctly
states its inability to convert a zzz to System.Windows.Forms.Form, which
proves that, an object that looks like Form is mandatory here, and not zzz. <o:p></o:p></span></p>

<p class=ILbase><span style='color:windowtext'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=ILprg><u>a.cs</u></p>

<p class=ILprg>using System.Windows.Forms;</p>

<p class=ILprg>public class zzz : Form</p>

<p class=ILprg>{</p>

<p class=ILprg>public static void Main() </p>

<p class=ILprg>{</p>

<p class=ILprg>Application.Run(new zzz());</p>

<p class=ILprg>}</p>

<p class=ILprg>}</p>

<p class=ILbase><span style='color:windowtext'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<table border=0 cellspacing=0 cellpadding=0 style='border-collapse:collapse;
 mso-padding-alt:0in 5.4pt 0in 5.4pt'>
 <tr>
  <td valign=top style='padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal><img width=300 height=300 id="_x0000_i1027"
  src="chap4img/Image1.jpg"></p>
  </td>
 </tr>
 <tr>
  <td valign=top style='padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal>Screen 4.1</p>
  </td>
 </tr>
</table>

<p class=ILbase><span style='color:windowtext'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=ILbase><span style='color:windowtext'>This program is not very
dissimilar from the previous one. The using keyword is employed to avoid the
inevitability of writing namespace with every object. The object z has no
efficacy here, since we are passing the zzz object directly to the Run
function. As the class zzz is derived from Form, no error is generated. <o:p></o:p></span></p>

<p class=ILbase><span style='color:windowtext'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=ILbase><span style='color:windowtext'>When we run the program, a small
blank window is displayed. You can click on the 'x' symbol to close it. The
output is substantial enough for a single line of code.<o:p></o:p></span></p>

<p class=ILbase><span style='color:windowtext'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=ILprg><u>a.cs</u></p>

<p class=ILprg>using System.Windows.Forms;</p>

<p class=ILprg>public class zzz: Form </p>

<p class=ILprg>{</p>

<p class=ILprg>public static void Main()</p>

<p class=ILprg>{</p>

<p class=ILprg>Application.Run(new zzz());</p>

<p class=ILprg>}</p>

<p class=ILprg>zzz() </p>

<p class=ILprg>{</p>

<p class=ILprg>Text = &quot;Vijay Mukhi&quot;;</p>

<p class=ILprg>}</p>

<p class=ILprg>}</p>

<p class=ILbase><span style='color:windowtext'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<table border=0 cellspacing=0 cellpadding=0 style='border-collapse:collapse;
 mso-padding-alt:0in 5.4pt 0in 5.4pt'>
 <tr>
  <td valign=top style='padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal><img width=300 height=300 id="_x0000_i1028"
  src="chap4img/Image2.jpg"></p>
  </td>
 </tr>
 <tr>
  <td valign=top style='padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal>Screen 4.2</p>
  </td>
 </tr>
</table>

<p class=ILbase><span style='color:windowtext'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=ILbase><span style='color:windowtext'>In the constructor of the zzz
class, we have initialized a member called Text to the string value 'Vijay
Mukhi'. When we run the program, to our amazement, our window, which earlier
was without a title, now possesses the title 'Vijay Mukhi'. <o:p></o:p></span></p>

<p class=ILbase><span style='color:windowtext'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=ILbase><span style='color:windowtext'>This is the introductory concept
of Windows Forms programming. The class called Form has abundant properties
such as Text etc., which have specific relevance in a window. Any modifications
to the properties get reflected immediately in the window. The changes depend
upon the properties that we modify. In this case, the property of Text changes
the Caption, text displayed in the title bar. <o:p></o:p></span></p>

<p class=ILbase><span style='color:windowtext'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=ILbase><span style='color:windowtext'>A Form represents a window
displayed by an application. An application can have different types of
windows, such as a standard, tool bar, borderless or floating window. The Form
class is versatile enough to handle all the above types of windows, as it is
derived from innumerable classes. A Dialog Box, which is used to accept input
from the user, is available in two modes viz. modal and modeless. Our
trustworthy Form class can also handle such Dialog boxes with equal aplomb. We
normally use the Form class as the preliminary class for building WinForms
Applications. <o:p></o:p></span></p>

<p class=ILbase><span style='color:windowtext'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=ILbase><span style='color:windowtext'>The Main method calls the Run
function and gives it the Form object. In the constructor, we can modify the
properties of the Form Class to give the window a<span style="mso-spacerun:
yes">  </span>desired appearance. Since these properties are not static, they
cannot be altered in Main, but can be modified in the constructor or in any
other function. <o:p></o:p></span></p>

<p class=ILbase><span style='color:windowtext'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=ILprg><u>a.cs</u></p>

<p class=ILprg>using System.Windows.Forms;</p>

<p class=ILprg>public class zzz</p>

<p class=ILprg>{</p>

<p class=ILprg>public static void Main()</p>

<p class=ILprg>{</p>

<p class=ILprg>Application.Run(new yyy());</p>

<p class=ILprg>}</p>

<p class=ILprg>}</p>

<p class=ILprg>class yyy : Form</p>

<p class=ILprg>{</p>

<p class=ILprg>public yyy() </p>

<p class=ILprg>{</p>

<p class=ILprg>Text = &quot;Vijay Mukhi&quot;;</p>

<p class=ILprg>}</p>

<p class=ILprg>}</p>

<p class=ILbase><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<table border=0 cellspacing=0 cellpadding=0 style='border-collapse:collapse;
 mso-padding-alt:0in 5.4pt 0in 5.4pt'>
 <tr>
  <td valign=top style='padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal><img width=300 height=300 id="_x0000_i1029"
  src="chap4img/Image3.jpg"></p>
  </td>
 </tr>
 <tr>
  <td valign=top style='padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal>Screen 4.3</p>
  </td>
 </tr>
</table>

<p class=ILbase><span style='color:windowtext'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=ILbase><span style='color:windowtext'>In this program, we have created
another class yyy that derives from the Form class. We have used this object as
a parameter to the function Run. The rules do not impel us to derive the class
zzz from Form. However, in all our programs, we shall follow the first approach
since we have decided to steer clear of controversy and stick to the rules. <o:p></o:p></span></p>

<p class=ILbase><span style='color:windowtext'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=ILprg><u>a.cs</u></p>

<p class=ILprg>using System.Windows.Forms;</p>

<p class=ILprg>public class zzz: Form </p>

<p class=ILprg>{</p>

<p class=ILprg>public static void Main()</p>

<p class=ILprg>{</p>

<p class=ILprg>Application.Run(new zzz());</p>

<p class=ILprg>}</p>

<p class=ILprg>zzz() </p>

<p class=ILprg>{</p>

<p class=ILprg>ClientSize = new System.Drawing.Size(300,600);</p>

<p class=ILprg>Size = new System.Drawing.Size(100,200);</p>

<p class=ILprg>}</p>

<p class=ILprg>}</p>

<p class=ILbase><span style='color:windowtext'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<table border=0 cellspacing=0 cellpadding=0 style='border-collapse:collapse;
 mso-padding-alt:0in 5.4pt 0in 5.4pt'>
 <tr>
  <td valign=top style='padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal><img width=149 height=267 id="_x0000_i1030"
  src="chap4img/Image4.jpg"></p>
  </td>
 </tr>
 <tr>
  <td valign=top style='padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal>Screen 4.4</p>
  </td>
 </tr>
</table>

<p class=ILbase><span style='color:windowtext'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=ILbase><span style='color:windowtext'>The above example sets two
properties of the Form class. The first, which is called ClientSize, is used by
Windows.Forms to decide how large our initial window would be. This property
has a default value, which can be overwritten by specifying the width and
height. As we need to furnish two values, we use a class called Size in the
namespace System.Drawing, which accepts two values. This class does not insist
on receiving meaningful values. The constructor is passed the width and height
of the desired window in pixels. <o:p></o:p></span></p>

<p class=ILbase><span style='color:windowtext'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=ILbase><span style='color:windowtext'>A graphics screen is divided
into small dots or pixels. Depending upon the configuration of the monitor and
graphics card, a computer can handle and display a certain number of pixels and
colors. The higher the configuration, the larger are the number of pixels and
colors that are available. <o:p></o:p></span></p>

<p class=ILbase><span style='color:windowtext'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=ILbase><span style='color:windowtext'>The size of the client area of
the form is computed as the size of the form minus the borders and the title
bar placed by Windows. They are not of our concern, since we shall be placing
our own controls in our form. ClientSize is a property with a default value,
and it gets updated automatically whenever the form is resized. <o:p></o:p></span></p>

<p class=ILbase><span style='color:windowtext'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=ILbase><span style='color:windowtext'>The next property is Size. The
user enjoys the flexibility of altering the size of the window at run time.
Size is initialized in manner similar to ClientSize. <o:p></o:p></span></p>

<p class=ILprg><u><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></u></p>

<p class=ILprg><u>a.cs </u><span style='mso-tab-count:1'>     </span></p>

<p class=ILprg>using System.Windows.Forms;</p>

<p class=ILprg>using System.Drawing;</p>

<p class=ILprg>public class zzz: Form </p>

<p class=ILprg>{</p>

<p class=ILprg>Button b;</p>

<p class=ILprg>public static void Main()</p>

<p class=ILprg>{</p>

<p class=ILprg>Application.Run(new zzz());</p>

<p class=ILprg>}</p>

<p class=ILprg>zzz() </p>

<p class=ILprg>{</p>

<p class=ILprg>b = new Button();</p>

<p class=ILprg>Controls.Add(b);</p>

<p class=ILprg>}</p>

<p class=ILprg>}</p>

<p class=ILbase><span style='color:windowtext'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<table border=0 cellspacing=0 cellpadding=0 style='border-collapse:collapse;
 mso-padding-alt:0in 5.4pt 0in 5.4pt'>
 <tr>
  <td valign=top style='padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal><img width=300 height=300 id="_x0000_i1031"
  src="chap4img/Image5.jpg"></p>
  </td>
 </tr>
 <tr>
  <td valign=top style='padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal>Screen 4.5</p>
  </td>
 </tr>
</table>

<p class=ILbase><span style='color:windowtext'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=ILbase><span style='color:windowtext'>We now see a small button at the
top left hand corner of our Window. How did we create this button? To do so, we
first, create an object b, that looks like a Button class. <o:p></o:p></span></p>

<p class=ILbase><span style='color:windowtext'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=ILbase><span style='color:windowtext'>The Form class has a large
number of properties such as ClientSize, Size etc. One of them is called
Controls, which is a read-only property since it contains only a Get. This
property returns a Control.Collection object, whose Add function adds the
control to the Client area of the window. We shall be sprucing up our button
shortly.<o:p></o:p></span></p>

<p class=ILbase><span style='color:windowtext'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=ILprg><u>a.cs</u></p>

<p class=ILprg>using System.Windows.Forms;</p>

<p class=ILprg>using System.Drawing;</p>

<p class=ILprg>public class zzz: Form </p>

<p class=ILprg>{</p>

<p class=ILprg>Button b;</p>

<p class=ILprg>public static void Main()</p>

<p class=ILprg>{</p>

<p class=ILprg>Application.Run(new zzz());</p>

<p class=ILprg>}</p>

<p class=ILprg>zzz() </p>

<p class=ILprg>{</p>

<p class=ILprg>b = new Button();</p>

<p class=ILprg>b.Location = new Point(100,200);</p>

<p class=ILprg>b.Size = new Size(100,50);</p>

<p class=ILprg>b.Text = &quot;Vijay Mukhi is smart&quot;;</p>

<p class=ILprg>Controls.Add(b);</p>

<p class=ILprg>}</p>

<p class=ILprg>}</p>

<p class=ILbase><span style='color:windowtext'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<table border=0 cellspacing=0 cellpadding=0 style='border-collapse:collapse;
 mso-padding-alt:0in 5.4pt 0in 5.4pt'>
 <tr>
  <td valign=top style='padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal><img width=300 height=300 id="_x0000_i1032"
  src="chap4img/Image6.jpg"></p>
  </td>
 </tr>
 <tr>
  <td valign=top style='padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal>Screen 4.6</p>
  </td>
 </tr>
</table>

<p class=ILbase><span style='color:windowtext'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=ILbase><span style='color:windowtext'>Anything that is placed on a
form is called a Control or a Widget. Similar to a Form, a button control,
popularly known as a command button, has numerous properties. One of them is
the Location property, which decides the position on the Client area where the
button will be positioned. <o:p></o:p></span></p>

<p class=ILbase><span style='color:windowtext'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=ILbase><span style='color:windowtext'>Here, we use the Point class and
not Size, even though both are objects that represent two numbers. By
convention, a Size object represents a width and a height and a Point object
has an x and y co-ordinate system, starting from the upper left corner. <o:p></o:p></span></p>

<p class=ILbase><span style='color:windowtext'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=ILbase><span style='color:windowtext'>Most properties have a default
value. Since this fact about default values has been reiterated numerous times,
we shall not repeat it again. The Size property determines the initial size of
the window and the string assigned to the Text property is displayed on the
button. <o:p></o:p></span></p>

<p class=ILbase><span style='color:windowtext'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=ILprg><u>a.cs</u></p>

<p class=ILprg>using System.Windows.Forms;</p>

<p class=ILprg>using System.Drawing;</p>

<p class=ILprg>public class zzz: Form </p>

<p class=ILprg>{</p>

<p class=ILprg>Button b;</p>

<p class=ILprg>public static void Main()<span style="mso-spacerun: yes"> 
</span>{</p>

<p class=ILprg>Application.Run(new zzz());</p>

<p class=ILprg>}</p>

<p class=ILprg>zzz() </p>

<p class=ILprg>{</p>

<p class=ILprg>b = new Button();</p>

<p class=ILprg>b.Location = new Point(100,200);</p>

<p class=ILprg>b.Size = new Size(100,50);</p>

<p class=ILprg>b.Text = &quot;Vijay Mukhi is smart&quot;;</p>

<p class=ILprg>b.Click += new System.EventHandler(abc);</p>

<p class=ILprg>Controls.Add(b);</p>

<p class=ILprg>}</p>

<p class=ILprg>public void abc(object s, System.EventArgs e)</p>

<p class=ILprg>{</p>

<p class=ILprg>MessageBox.Show(&quot;Hi&quot;);</p>

<p class=ILprg>}</p>

<p class=ILprg>}</p>

<p class=ILbase><span style='color:windowtext'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<table border=0 cellspacing=0 cellpadding=0 style='border-collapse:collapse;
 mso-padding-alt:0in 5.4pt 0in 5.4pt'>
 <tr>
  <td valign=top style='padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal><img width=129 height=123 id="_x0000_i1033"
  src="chap4img/Image7.jpg"></p>
  </td>
 </tr>
 <tr>
  <td valign=top style='padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal>Screen 4.7</p>
  </td>
 </tr>
</table>

<p class=ILbase><span style='color:windowtext'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=ILbase><span style='color:windowtext'>In the earlier example, clicking
on the button was an exercise in futility because the button did not achieve
anything. After augmenting the code of the program, when we click on the
button, we see a MessageBox that displays the greeting 'Hi'. The rationale
behind a button control is that, when we click on it, some code should get
executed, some action<span style="mso-spacerun: yes">  </span>should take
place.<o:p></o:p></span></p>

<p class=ILbase><span style='color:windowtext'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=ILbase><span style='color:windowtext'>The button class has an event
object called Click, which accepts an object of type EventHandler. The syntax
for events uses the += symbol to add a function that is to be called when the
event handler gets activated. The function name is given through the
EventHandler delegate. This delegate has been specially created only to handle
events that a control will generate. <o:p></o:p></span></p>

<p class=ILbase><span style='color:windowtext'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=ILbase><span style='color:windowtext'>Thus, the function abc, which is
passed as a parameter to the EventHandler delegate, must have a certain
signature. The first parameter is the generic object that could represent any
entity identifying the caller. The second parameter is an EventArgs object,
which we will explain shortly. Thus, each time we click on the button, the
function abc gets called. This function in turn calls the static function Show
from the MessageBox class to display 'Hi'.<o:p></o:p></span></p>

<p class=ILbase><span style='color:windowtext'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=ILprg><u>a.cs</u></p>

<p class=ILprg>using System.Windows.Forms;</p>

<p class=ILprg>using System.Drawing;</p>

<p class=ILprg>public class zzz: Form {</p>

<p class=ILprg>Button b;</p>

<p class=ILprg>public static void Main()</p>

<p class=ILprg>{</p>

<p class=ILprg>Application.Run(new zzz());</p>

<p class=ILprg>}</p>

<p class=ILprg>zzz() </p>

<p class=ILprg>{</p>

<p class=ILprg>b = new Button();</p>

<p class=ILprg>b.Location = new Point(100,200);</p>

<p class=ILprg>b.Size = new Size(100,50);</p>

<p class=ILprg>b.Text = &quot;Vijay Mukhi is smart&quot;;</p>

<p class=ILprg>b.Click += new System.EventHandler(abc);</p>

<p class=ILprg>b.Click += new System.EventHandler(pqr);</p>

<p class=ILprg>Controls.Add(b);</p>

<p class=ILprg>}</p>

<p class=ILprg>public void abc(object s, System.EventArgs e){</p>

<p class=ILprg>MessageBox.Show(&quot;Hi&quot;);</p>

<p class=ILprg>}</p>

<p class=ILprg>public void pqr(object s, System.EventArgs e)</p>

<p class=ILprg>{</p>

<p class=ILprg>MessageBox.Show(&quot;Bye&quot;);</p>

<p class=ILprg>}<span style="mso-spacerun: yes">   </span></p>

<p class=ILprg>}</p>

<p class=ILbase><span style='color:windowtext'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<table border=0 cellspacing=0 cellpadding=0 style='border-collapse:collapse;
 mso-padding-alt:0in 5.4pt 0in 5.4pt'>
 <tr>
  <td valign=top style='padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal><img width=129 height=123 id="_x0000_i1034"
  src="chap4img/Image8.jpg"></p>
  </td>
 </tr>
 <tr>
  <td valign=top style='padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal>Screen 4.8</p>
  </td>
 </tr>
</table>

<p class=ILbase><span style='color:windowtext'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=ILbase><span style='color:windowtext'>This program reveals the
veritable power of events and delegates. Two functions, abc and pqr, are called
whenever the button is clicked. To achieve this, all that we need to do in the
code is to call the Click event again, using the += symbol, followed by the
name of the new function. The -= symbol is used if we change our minds. This is
a type safe way of calling code in response to an event.<o:p></o:p></span></p>

<p class=ILprg><u><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></u></p>

<p class=ILprg><u>a.cs</u></p>

<p class=ILprg>using System.Windows.Forms;</p>

<p class=ILprg>using System.Drawing;</p>

<p class=ILprg>public class zzz: Form {</p>

<p class=ILprg>Button b;</p>

<p class=ILprg>TextBox t;</p>

<p class=ILprg>public static void Main() {</p>

<p class=ILprg>Application.Run(new zzz());</p>

<p class=ILprg>}</p>

<p class=ILprg>zzz() </p>

<p class=ILprg>{</p>

<p class=ILprg>b = new Button();</p>

<p class=ILprg>b.Location = new Point(100,200);</p>

<p class=ILprg>b.Size = new Size(100,50);</p>

<p class=ILprg>b.Text = &quot;Vijay Mukhi is smart&quot;;</p>

<p class=ILprg>b.Click += new System.EventHandler(abc);</p>

<p class=ILprg>t = new TextBox();</p>

<p class=ILprg>t.Text = &quot;Hell&quot;;</p>

<p class=ILprg>t.Location = new Point(10,20);</p>

<p class=ILprg>Controls.Add(b);</p>

<p class=ILprg>Controls.Add(t);</p>

<p class=ILprg>}</p>

<p class=ILprg>public void abc(object s, System.EventArgs e)</p>

<p class=ILprg>{</p>

<p class=ILprg>MessageBox.Show(t.Text + &quot; &quot; + ClientSize );</p>

<p class=ILprg>}</p>

<p class=ILprg>}</p>

<p class=ILbase><span style='color:windowtext'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<table border=0 cellspacing=0 cellpadding=0 style='border-collapse:collapse;
 mso-padding-alt:0in 5.4pt 0in 5.4pt'>
 <tr>
  <td valign=top style='padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal><img width=300 height=300 id="_x0000_i1035"
  src="chap4img/Image9.jpg"></p>
  </td>
 </tr>
 <tr>
  <td valign=top style='padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal>Screen 4.9</p>
  </td>
 </tr>
</table>

<p class=ILbase><span style='color:windowtext'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=ILbase><span style='color:windowtext'>In the Forms Window, we now see
two controls: a Button and a TextBox object that lets us enter some text. The
textbox widget also has a large number of properties associated with it. We
shall not be repeating this obvious fact for all the other controls. The
properties Location and Size work in a similar manner when used with any
Control, but the property Text differs, depending upon the object in use. For a
button, it represents the caption, whereas for a text box, it represents the
text that is entered. Thus, some of the properties play different roles when
used in different controls. <o:p></o:p></span></p>

<p class=ILbase><span style='color:windowtext'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<table border=0 cellspacing=0 cellpadding=0 style='border-collapse:collapse;
 mso-padding-alt:0in 5.4pt 0in 5.4pt'>
 <tr>
  <td valign=top style='padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal><img width=230 height=128 id="_x0000_i1036"
  src="chap4img/Image10.jpg"></p>
  </td>
 </tr>
 <tr>
  <td valign=top style='padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal>Screen 4.10</p>
  </td>
 </tr>
</table>

<p class=ILbase><span style='color:windowtext'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=ILbase><span style='color:windowtext'>Each time the button is clicked,
we would like to display the text that has been entered by the user in the text
box. In the eventhandler function abc, the property Text reveals the text
entered into the textbox.<span style="mso-spacerun: yes">  </span>The
MessageBox class is used to display the value, along with the size of the
client area. <o:p></o:p></span></p>

<p class=ILbase><span style='color:windowtext'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=ILbase><span style='color:windowtext'>You can change the size of the
window or change the contents of the text box and observe the contents of the
MessageBox changing dynamically.<o:p></o:p></span></p>

<p class=ILbase><span style='color:windowtext'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=ILprg><u>a.cs</u></p>

<p class=ILprg>using System.Windows.Forms;</p>

<p class=ILprg>using System.Drawing;</p>

<p class=ILprg>public class zzz: Form </p>

<p class=ILprg>{</p>

<p class=ILprg>public static void Main()</p>

<p class=ILprg>{</p>

<p class=ILprg>Application.Run(new zzz());</p>

<p class=ILprg>}</p>

<p class=ILprg>public override void Dispose()</p>

<p class=ILprg>{</p>

<p class=ILprg>base.Dispose();</p>

<p class=ILprg>MessageBox.Show( &quot;hi &quot; + ClientSize );</p>

<p class=ILprg>}</p>

<p class=ILprg>}</p>

<p class=ILbase><span style='color:windowtext'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=ILbase><span style='color:windowtext'>This program displays our
ability to invoke code at a specific point in time, which in this case, is at
the stage when the user closes the window or when the application quits out. It
is akin to fulfilling the last wishes of the program.<o:p></o:p></span></p>

<p class=ILbase><span style='color:windowtext'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<table border=0 cellspacing=0 cellpadding=0 style='border-collapse:collapse;
 mso-padding-alt:0in 5.4pt 0in 5.4pt'>
 <tr>
  <td valign=top style='padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal><img width=230 height=128 id="_x0000_i1037"
  src="chap4img/Image11.jpg"></p>
  </td>
 </tr>
 <tr>
  <td valign=top style='padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal>Screen 4.11</p>
  </td>
 </tr>
</table>

<p class=ILbase><span style='color:windowtext'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=ILbase><span style='color:windowtext'>As the application is quitting,
it calls a function called Dispose. So, if you ever want code to be called at
the point when an application is about to quit out, you must place it in the
Dispose function. This code could be used to close files or do anything else
that the programmer desires. <o:p></o:p></span></p>

<p class=ILbase><span style='color:windowtext'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=ILbase><span style='color:windowtext'>It is not mandatory to call
Dispose of the base class, but it is always a good programming practice to call
the base class function first, and then augment it with your own code. In this
particular case, it is inconsequential, but under different circumstances,
things may go out of hand if this advice is not heeded.<o:p></o:p></span></p>

<p class=ILbase><span style='color:windowtext'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=ILprg><u>a.cs</u></p>

<p class=ILprg>using System.Windows.Forms;</p>

<p class=ILprg>using System.Drawing;</p>

<p class=ILprg>public class zzz: Form<span style="mso-spacerun: yes">  </span>{</p>

<p class=ILprg>public static void Main()</p>

<p class=ILprg>{</p>

<p class=ILprg>Application.Run(new zzz());</p>

<p class=ILprg>}</p>

<p class=ILprg>Brush b; int ii = 0;</p>

<p class=ILprg>protected override void OnPaint(PaintEventArgs e)</p>

<p class=ILprg>{</p>

<p class=ILprg>Graphics g = e.Graphics;</p>

<p class=ILprg>b = new SolidBrush(Color.Blue);</p>

<p class=ILprg>ii++;</p>

<p class=ILprg>g.DrawString(&quot;Vijay Mukhi &quot; + ii, Font, b ,1,25);</p>

<p class=ILprg>}</p>

<p class=ILprg>}</p>

<p class=ILbase><span style='color:windowtext'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=ILbase><span style='color:windowtext'>In this program, we are
overriding a function called OnPaint, which is present in the Form class. The
OnPaint function gets called each time the window has to be redrawn. Therefore,
all code that is to be written to the screen must be written in this function.
This code cannot be placed anywhere else in the program. <o:p></o:p></span></p>

<p class=ILbase><span style='color:windowtext'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=ILbase><span style='color:windowtext'>Our next endeavor is to create
an object that has functions which display text on the screen or draw a
picture. The class that contains these display functions is called Graphics.
Thus, we create an object g that looks like Graphics. As an object that looks
like Graphics cannot be instantiated, WinForms provides us with an object of
type PaintEventArgs with the OnPaint Function. This class contains members
required for graphical display. Hence, g is initialized to the Graphics member
in e. <o:p></o:p></span></p>

<p class=ILbase><span style='color:windowtext'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=ILbase><span style='color:windowtext'>As mentioned earlier, OnPaint
gets called whenever our window has to be redrawn. Whenever OnPaint gets
called, it creates an object that looks like PaintEventArgs and then passes it
as a parameter to the function. This object has a member called Graphics, which
contains functions used for drawing in our client area. The DrawString function
requires the text that is to be displayed and its Font. <o:p></o:p></span></p>

<p class=ILbase><span style='color:windowtext'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=ILbase><span style='color:windowtext'>The Form class provides us with
the object called Font. Thereafter, the text color, or to be more precise, the
brush is to be specified. Here, we want a solid Brush like object. So, we
create an object b, and give it a color in which the text should be displayed.
There is a static object Blue in the class Color that stands for the color
blue. The spelling of 'color' is as per the American usage. Finally, the x and
y co-ordinates on the screen are specified. <o:p></o:p></span></p>

<p class=ILbase><span style='color:windowtext'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=ILbase><span style='color:windowtext'>This positions the text in the
window at these specified co-ordinates. <o:p></o:p></span></p>

<p class=ILbase><span style='color:windowtext'>Thus, the function has a total
of 5 parameters:-<o:p></o:p></span></p>

<p class=ILbullets><span style='mso-bidi-font-size:12.0pt;font-family:"Times New Roman"'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=ILbullets><span style='mso-bidi-font-size:12.0pt;font-family:"Times New Roman"'>•<span
style='mso-tab-count:1'>     </span></span>The text to be displayed. </p>

<p class=ILbullets><span style='mso-bidi-font-size:12.0pt;font-family:"Times New Roman"'>•<span
style='mso-tab-count:1'>     </span></span>The font in which the text is to be
displayed. </p>

<p class=ILbullets><span style='mso-bidi-font-size:12.0pt;font-family:"Times New Roman"'>•<span
style='mso-tab-count:1'>     </span></span>The text color or the brush.</p>

<p class=ILbullets><span style='mso-bidi-font-size:12.0pt;font-family:"Times New Roman"'>•<span
style='mso-tab-count:1'>     </span></span>The x co-ordinate. </p>

<p class=ILbullets><span style='mso-bidi-font-size:12.0pt;font-family:"Times New Roman"'>•<span
style='mso-tab-count:1'>     </span></span>The y co-ordinate.</p>

<p class=ILbase><span style='color:windowtext'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=ILbase><span style='color:windowtext'>Here, we have specified certain
values, but every time we use DrawString, we can conveniently specify different
values for these parameters. Thus, the second DrawString function can display
different text and use a different font or brush. As the system does not have a
default brush or font, we call it a Stateless Model. <o:p></o:p></span></p>

<p class=ILbase><span style='color:windowtext'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<table border=0 cellspacing=0 cellpadding=0 style='border-collapse:collapse;
 mso-padding-alt:0in 5.4pt 0in 5.4pt'>
 <tr>
  <td valign=top style='padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal><img width=300 height=300 id="_x0000_i1038"
  src="chap4img/Image12.jpg"></p>
  </td>
 </tr>
 <tr>
  <td valign=top style='padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal>Screen 4.12</p>
  </td>
 </tr>
</table>

<p class=ILbase><span style='color:windowtext'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=ILbase><span style='color:windowtext'>Along with 'Vijay Mukhi', we
have used a variable called ii, which has been initialized to 0. In the OnPaint
function, we increment this variable by 1. Before the window is displayed,
function OnPaint gets called. Thereafter, OnPaint gets called whenever the
'minimize' and 'maximize' buttons of the window are clicked. <o:p></o:p></span></p>

<p class=ILbase><span style='color:windowtext'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=ILbase><span style='color:windowtext'>The function OnPaint gets called
whenever our client area has to be redrawn due to any action carried out by the
user. This function has to be marked with the modifier named protected. This is
because the original function in the Form class is tagged with this modifier.
We can override a function of the base class, provided we do not change any of
the modifiers. By making OnPaint protected, only derived classes can use the
OnPaint function.<o:p></o:p></span></p>

<p class=ILbase><span style='color:windowtext'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=ILprg><u>a.cs</u></p>

<p class=ILprg>using System.Windows.Forms;</p>

<p class=ILprg>using System.Drawing;</p>

<p class=ILprg>public class zzz: Form {</p>

<p class=ILprg>public static void Main()</p>

<p class=ILprg>{</p>

<p class=ILprg>Application.Run(new zzz());</p>

<p class=ILprg>}</p>

<p class=ILprg>Brush b; int ii = 0;</p>

<p class=ILprg>protected override void OnPaint(PaintEventArgs e)</p>

<p class=ILprg>{</p>

<p class=ILprg>Graphics g = e.Graphics;</p>

<p class=ILprg>b = new SolidBrush(Color.Blue);</p>

<p class=ILprg>ii++;</p>

<p class=ILprg>g.DrawString(&quot;Vijay Mukhi &quot; + ii, Font, b ,1,25);</p>

<p class=ILprg>RectangleF r = new RectangleF(20, 60, 100, 25); </p>

<p class=ILprg>g.FillRectangle(new SolidBrush(Color.Gainsboro), r);</p>

<p class=ILprg>g.DrawString(&quot;Sonal Mukhi&quot;, Font, new
SolidBrush(Color.Red), r);</p>

<p class=ILprg>StringFormat f = new StringFormat();</p>

<p class=ILprg>f.Alignment=StringAlignment.Center;</p>

<p class=ILprg>RectangleF r1 = new RectangleF(20, 100, 100, 25); </p>

<p class=ILprg>g.DrawString(&quot;Sonal Mukhi&quot;, Font, new SolidBrush(Color.Black),
r1,f);</p>

<p class=ILprg>g.RotateTransform(-30);</p>

<p class=ILprg>g.TranslateTransform(0, 100);</p>

<p class=ILprg>g.DrawString(&quot;vijay mukhi&quot;, Font, new
SolidBrush(Color.Orange), 20, 40);</p>

<p class=ILprg>g.ResetTransform();</p>

<p class=ILprg>}</p>

<p class=ILprg>}</p>

<p class=ILbase><span style='color:windowtext'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<table border=0 cellspacing=0 cellpadding=0 style='border-collapse:collapse;
 mso-padding-alt:0in 5.4pt 0in 5.4pt'>
 <tr>
  <td valign=top style='padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal><img width=300 height=300 id="_x0000_i1039"
  src="chap4img/Image13.jpg"></p>
  </td>
 </tr>
 <tr>
  <td valign=top style='padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal>Screen 4.13</p>
  </td>
 </tr>
</table>

<p class=ILbase><span style='color:windowtext'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=ILbase><span style='color:windowtext'>The output of this program is a
window with text displayed haphazardly. This output is nothing to write home
about, but is useful in elucidating numerous concepts. <o:p></o:p></span></p>

<p class=ILbase><span style='color:windowtext'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=ILbase><span style='color:windowtext'>A rectangleF structure stores
two point objects i.e. it specifies a rectangular area of the window. We start
at one corner, where the x and y co-ordinates are 20 and 60, and the opposite
corner where the x and y co-ordinates are 100 and 25 respectively. The function
FillRectangle from the Graphics class is used to create and fill the above
rectangular portion of the screen with the color Gainsboro. The DrawString
function is overloaded to take not only x and y as the last two parameters, but
also a rectangular area into which it will draw a string. <o:p></o:p></span></p>

<p class=ILbase><span style='color:windowtext'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=ILbase><span style='color:windowtext'>We would now like to center the
above string in the rectangular area. This is easier said than done, because,
it entails creation of an object that looks like StringFormat with the
Alignment property set as Center. The documentation specifies many more options
that can be implemented. The StringFormat object is passed as the last
parameter to the DrawString function, resulting in the string being shown as
centered, instead of being Left aligned, which is the default setting.<o:p></o:p></span></p>

<p class=ILbase><span style='color:windowtext'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=ILbase><span style='color:windowtext'>If we want to rotate the image
by 30 degrees, we just have to call a function named RotateTransform from the
Graphics class and pass as a parameter, the amount of rotation that is
required. You can then watch the image get displayed at the specified angle.
Beware, too acute an angle may sprain your neck! The next function, named
TranslateTransform, is optional. It is used to move the text around in the
client area horizontally or vertically. Whenever we transform something, it
stays in the transformed position. But thereafter, if we do not want the other
objects to be in this form, we need to use the function ResetTranform to undo
the transform. However, it is optional.<o:p></o:p></span></p>

<p class=ILbase><span style='color:windowtext'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=ILprg><u>a.cs</u></p>

<p class=ILprg>using System.Windows.Forms;</p>

<p class=ILprg>using System.Drawing;</p>

<p class=ILprg>public class zzz: Form </p>

<p class=ILprg>{</p>

<p class=ILprg>public static void Main()</p>

<p class=ILprg>{</p>

<p class=ILprg>Application.Run(new zzz());</p>

<p class=ILprg>}</p>

<p class=ILprg>Brush b; </p>

<p class=ILprg>protected override void OnPaint(PaintEventArgs e)</p>

<p class=ILprg>{</p>

<p class=ILprg>Graphics g = e.Graphics;</p>

<p class=ILprg>b = new SolidBrush(Color.FromArgb(180, Color.Black));</p>

<p class=ILprg>RectangleF r = new RectangleF(20, 20, 50, 50); </p>

<p class=ILprg>g.FillRectangle(b, r);</p>

<p class=ILprg>}</p>

<p class=ILprg>}</p>

<p class=ILbase><span style='color:windowtext'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<table border=0 cellspacing=0 cellpadding=0 style='border-collapse:collapse;
 mso-padding-alt:0in 5.4pt 0in 5.4pt'>
 <tr>
  <td valign=top style='padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal><img width=300 height=300 id="_x0000_i1040"
  src="chap4img/Image14.jpg"></p>
  </td>
 </tr>
 <tr>
  <td valign=top style='padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal>Screen 4.14</p>
  </td>
 </tr>
</table>

<p class=ILbase><span style='color:windowtext'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=ILbase><span style='color:windowtext'>The topic of Brushes is so
exhaustive that a thesis can well be written on it. In this program, we use a
special brush to fill up a rectangular area on our screen. <o:p></o:p></span></p>

<p class=ILbase><span style='color:windowtext'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=ILbase><span style='color:windowtext'>Here, we specify not only a
color, but also a number, which is the alpha value and has a range from 0 to
255. The larger the value, the darker will be the color. To put it technically,
the larger the value, the lesser will be the translucence and vice-versa.<o:p></o:p></span></p>

<p class=ILbase><span style='color:windowtext'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=ILprg><u>a.cs</u></p>

<p class=ILprg>using System.Windows.Forms;</p>

<p class=ILprg>using System.Drawing;</p>

<p class=ILprg>public class zzz: Form </p>

<p class=ILprg>{</p>

<p class=ILprg>public static void Main()</p>

<p class=ILprg>{</p>

<p class=ILprg>Application.Run(new zzz());</p>

<p class=ILprg>}</p>

<p class=ILprg>Brush b; </p>

<p class=ILprg>protected override void OnPaint(PaintEventArgs e)</p>

<p class=ILprg>{</p>

<p class=ILprg>Graphics g = e.Graphics;</p>

<p class=ILprg>b = new SolidBrush(Color.Black);</p>

<p class=ILprg>Font f = new Font(&quot;Times New Roman&quot;, 30);</p>

<p class=ILprg>g.DrawString(&quot;Vijay Mukhi &quot; , f , b ,1,25);</p>

<p class=ILprg>}</p>

<p class=ILprg>}</p>

<p class=ILbase><span style='color:windowtext'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<table border=0 cellspacing=0 cellpadding=0 style='border-collapse:collapse;
 mso-padding-alt:0in 5.4pt 0in 5.4pt'>
 <tr>
  <td valign=top style='padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal><img width=300 height=300 id="_x0000_i1041"
  src="chap4img/Image15.jpg"></p>
  </td>
 </tr>
 <tr>
  <td valign=top style='padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal>Screen 4.15</p>
  </td>
 </tr>
</table>

<p class=ILbase><span style='color:windowtext'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=ILbase><span style='color:windowtext'>In this program, we will shed
light on Fonts. When you read a newspaper or magazine, the style of the letters
looks different in each of them. This difference is due to the Font or the
Typeface used. There are numerous fonts in the world of letters. <o:p></o:p></span></p>

<p class=ILbase><span style='color:windowtext'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=ILbase><span style='color:windowtext'>While displaying text, we can be
very specific about the way in which the letters look. To enhance their visual
appeal, we create an object that looks like Font. Then, in the constructor, the
Name of the font is specified along with the Size in points. Remember that 72
points make an inch. Thus my name, Vijay Mukhi, now gets displayed in a size
that is bigger than normal.<o:p></o:p></span></p>

<p class=ILbase><span style='color:windowtext'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=ILprg><u>a.cs</u></p>

<p class=ILprg>using System.Windows.Forms;</p>

<p class=ILprg>using System.Drawing;</p>

<p class=ILprg>public class zzz: Form </p>

<p class=ILprg>{</p>

<p class=ILprg>public static void Main()</p>

<p class=ILprg>{</p>

<p class=ILprg>Application.Run(new zzz());</p>

<p class=ILprg>}</p>

<p class=ILprg>protected override void OnPaint(PaintEventArgs e)</p>

<p class=ILprg>{</p>

<p class=ILprg>Graphics g = e.Graphics;</p>

<p class=ILprg>Image i;</p>

<p class=ILprg>i = new Bitmap(&quot;sample.jpg&quot;);</p>

<p class=ILprg>g.DrawImage(i, 29, 20, 283, 212);</p>

<p class=ILprg>}</p>

<p class=ILprg>}</p>

<p class=ILbase><span style='color:windowtext'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<table border=0 cellspacing=0 cellpadding=0 style='border-collapse:collapse;
 mso-padding-alt:0in 5.4pt 0in 5.4pt'>
 <tr>
  <td valign=top style='padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal><img width=300 height=300 id="_x0000_i1042"
  src="chap4img/Image16.jpg"></p>
  </td>
 </tr>
 <tr>
  <td valign=top style='padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal>Screen 4.16</p>
  </td>
 </tr>
</table>

<p class=ILbase><span style='color:windowtext'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=ILbase><span style='color:windowtext'>The above program merely
displays an image. A file with a jpg or a gif extension contains images or
pictures. To display images, we use a class called Image that can recognize
pictures. Even though i is an image object, we initialize it to an object that
looks like Bitmap. An Image class is an abstract class and the class Bitmap
derives from it. <o:p></o:p></span></p>

<p class=ILbase><span style='color:windowtext'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=ILbase><span style='color:windowtext'>An Image class could represent a
picture, which is not just an image, but could also be a cursor, icon etc. The
DrawImage function accepts an image object as the first parameter, followed by
the screen co-ordinates at which the image has to be positioned. The above .jpg
file is part of the samples offered while installing the .NET SDK. So, search
for the file and copy it to the current working directory. Like the text
sample, this picture can also be rotated, transformed etc. <o:p></o:p></span></p>

<p class=ILbase><span style='color:windowtext'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=ILprg><u>a.cs</u></p>

<p class=ILprg>using System.Windows.Forms;</p>

<p class=ILprg>using System.Drawing;</p>

<p class=ILprg>public class zzz: Form </p>

<p class=ILprg>{</p>

<p class=ILprg>public static void Main()</p>

<p class=ILprg>{</p>

<p class=ILprg>Application.Run(new zzz());</p>

<p class=ILprg>}</p>

<p class=ILprg>protected override void OnPaint(PaintEventArgs e)</p>

<p class=ILprg>{</p>

<p class=ILprg>Graphics g = e.Graphics;</p>

<p class=ILprg>Image i = new Bitmap(&quot;colorbars.jpg&quot;);</p>

<p class=ILprg>Brush b = new TextureBrush(i);</p>

<p class=ILprg>g.DrawString(&quot;Vijay Mukhi is very smart&quot; , Font, b
,1,25);</p>

<p class=ILprg>}</p>

<p class=ILprg>}</p>

<p class=ILbase><span style='color:windowtext'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<table border=0 cellspacing=0 cellpadding=0 style='border-collapse:collapse;
 mso-padding-alt:0in 5.4pt 0in 5.4pt'>
 <tr>
  <td valign=top style='padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal><img width=300 height=300 id="_x0000_i1043"
  src="chap4img/Image17.jpg"></p>
  </td>
 </tr>
 <tr>
  <td valign=top style='padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal>Screen 4.17</p>
  </td>
 </tr>
</table>

<p class=ILbase><span style='color:windowtext'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=ILbase><span style='color:windowtext'>By combining a Brush and an
image, we can create a multicolor brush. In one of the earlier programs, we had
used a Solid brush. Here, we are using a Texture brush. This brush fills the
interiors of a shape with a picture. <o:p></o:p></span></p>

<p class=ILbase><span style='color:windowtext'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=ILbase><span style='color:windowtext'>Thus, the text gets reflected in
a brush, which reminds us of a rainbow. You can enhance the aesthetic appeal of
your applications by using this facility.<o:p></o:p></span></p>

<p class=ILbase><span style='color:windowtext'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=ILprg><u>a.cs</u></p>

<p class=ILprg>using System.Windows.Forms;</p>

<p class=ILprg>using System.Drawing;</p>

<p class=ILprg>using System.Drawing.Drawing2D;</p>

<p class=ILprg>public class zzz: Form {</p>

<p class=ILprg>public static void Main()</p>

<p class=ILprg>{</p>

<p class=ILprg>Application.Run(new zzz());</p>

<p class=ILprg>}</p>

<p class=ILprg>protected override void OnPaint(PaintEventArgs e)</p>

<p class=ILprg>{</p>

<p class=ILprg>Graphics g = e.Graphics;</p>

<p class=ILprg>Pen p = new Pen(Color.FromArgb(150, Color.Purple), 20);</p>

<p class=ILprg>p.DashStyle = DashStyle.Dash;</p>

<p class=ILprg>p.StartCap = LineCap.Round;</p>

<p class=ILprg>Point [] pp = new Point[] {new Point(200, 140),new Point(700,
240),new Point(500, 340)};</p>

<p class=ILprg>g.DrawCurve(p,pp);</p>

<p class=ILprg>}</p>

<p class=ILprg>}</p>

<p class=ILbase><span style='color:windowtext'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<table border=0 cellspacing=0 cellpadding=0 style='border-collapse:collapse;
 mso-padding-alt:0in 5.4pt 0in 5.4pt'>
 <tr>
  <td valign=top style='padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal><img width=570 height=409 id="_x0000_i1044"
  src="chap4img/Image18.jpg"></p>
  </td>
 </tr>
 <tr>
  <td valign=top style='padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal>Screen 4.18</p>
  </td>
 </tr>
</table>

<p class=ILbase><span style='color:windowtext'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=ILbase><span style='color:windowtext'>The above program introduces
freehand drawing. A pen is like an artist's brush, which is used to draw any
shape that permeates the mind. In our program, we commence by creating a Pen object
p. It is initialized to a particular alpha color using FromArgb function from
the Color class, and to a specified width. <o:p></o:p></span></p>

<p class=ILbase><span style='color:windowtext'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=ILbase><span style='color:windowtext'>The constructor can also be
provided with other parameters, such as a brush. A pen is used to draw lines
and curves. <o:p></o:p></span></p>

<p class=ILbase><span style='color:windowtext'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=ILbase><span style='color:windowtext'>A Pen can also draw a line of a
specified width and style. The default DashStyle is Continuous. If we change
the DashStyle to Dash, the starting point becomes a rounded edge. The default
is a Straight Edge. The line drawn by a pen is very versatile, and can employ a
variety of fill styles, colors and textures. The DrawCurve function paints a
pen object that specifies how to draw a curve. It has an array of points with
the individual three point objects specifying where the curved line should be
drawn.<o:p></o:p></span></p>

<p class=ILbase><span style='color:windowtext'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=ILprg><u>a.cs</u></p>

<p class=ILprg>using System.Windows.Forms;</p>

<p class=ILprg>using System.Drawing;</p>

<p class=ILprg>using System.Drawing.Drawing2D;</p>

<p class=ILprg>public class zzz: Form {</p>

<p class=ILprg>public static void Main() {</p>

<p class=ILprg>Application.Run(new zzz());</p>

<p class=ILprg>}</p>

<p class=ILprg>protected override void OnPaint(PaintEventArgs e)</p>

<p class=ILprg>{</p>

<p class=ILprg>Graphics g = e.Graphics;</p>

<p class=ILprg>Image i= new Bitmap(&quot;BoilingPoint.jpg&quot;);</p>

<p class=ILprg>Brush pb = new TextureBrush(i);</p>

<p class=ILprg>Pen p= new Pen(pb, 75);</p>

<p class=ILprg>g.DrawLine(p,1,5,150,200);</p>

<p class=ILprg>}</p>

<p class=ILprg>}</p>

<p class=ILbase><span style='color:windowtext'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<table border=0 cellspacing=0 cellpadding=0 style='border-collapse:collapse;
 mso-padding-alt:0in 5.4pt 0in 5.4pt'>
 <tr>
  <td valign=top style='padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal><img width=300 height=300 id="_x0000_i1045"
  src="chap4img/Image19.jpg"></p>
  </td>
 </tr>
 <tr>
  <td valign=top style='padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal>Screen 4.19</p>
  </td>
 </tr>
</table>

<p class=ILbase><span style='color:windowtext'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=ILbase><span style='color:windowtext'>We can use a brush that looks
like an image and create a pen that will draw lines in the garb of a picture.
The DrawLine function accepts two sets of numbers, the x-y co-ordinates of the
starting point and the x-y co-ordinates of the ending point. It draws a thick
line joining these two points. Thus, we can use this function to draw any
possible shape.<o:p></o:p></span></p>

<p class=ILbase><span style='color:windowtext'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=ILprg><u>a.cs</u></p>

<p class=ILprg>using System.Windows.Forms;</p>

<p class=ILprg>using System.Drawing;</p>

<p class=ILprg>using System.Drawing.Drawing2D;</p>

<p class=ILprg>public class zzz: Form </p>

<p class=ILprg>{</p>

<p class=ILprg>public static void Main()</p>

<p class=ILprg>{</p>

<p class=ILprg>Application.Run(new zzz());</p>

<p class=ILprg>}</p>

<p class=ILprg>protected override void OnPaint(PaintEventArgs e)</p>

<p class=ILprg>{</p>

<p class=ILprg>Graphics g = e.Graphics;</p>

<p class=ILprg>HatchBrush b = new HatchBrush(HatchStyle.ForwardDiagonal,
Color.Green, Color.FromArgb(100, Color.Yellow));</p>

<p class=ILprg>g.FillEllipse(b, 250, 10, 100, 100);</p>

<p class=ILprg>Rectangle r = new Rectangle(300, 250, 100, 100);</p>

<p class=ILprg>LinearGradientBrush lb = new LinearGradientBrush(r, Color.Red,
Color.Yellow,LinearGradientMode.BackwardDiagonal);</p>

<p class=ILprg>g.FillRectangle(lb, r);</p>

<p class=ILprg>}</p>

<p class=ILprg>}</p>

<p class=ILbase><span style='color:windowtext'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<table border=0 cellspacing=0 cellpadding=0 style='border-collapse:collapse;
 mso-padding-alt:0in 5.4pt 0in 5.4pt'>
 <tr>
  <td valign=top style='padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal><img width=570 height=409 id="_x0000_i1046"
  src="chap4img/Image20.jpg"></p>
  </td>
 </tr>
 <tr>
  <td valign=top style='padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal>Screen 4.20</p>
  </td>
 </tr>
</table>

<p class=ILbase><span style='color:windowtext'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=ILbase><span style='color:windowtext'>On maximizing the screen, we see
two figures; one is a filled circle, while the other is a rectangular block. We
are equipped with a large number of brushes akin to those in the artistic
world. One of them is a HatchBrush. The constructor of HatchBrush accepts a
hatch style and two colors, viz. a background color and a foreground color.<o:p></o:p></span></p>

<p class=ILbase><span style='color:windowtext'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=ILbase><span style='color:windowtext'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=ILbase><span style='color:windowtext'>The first parameter is the hatch
style, which can be one of six possible hatch styles. The foreground color, in
this case, green, defines the color of the lines to be drawn and the background
color defines the color for the gaps between the lines. <o:p></o:p></span></p>

<p class=ILbase><span style='color:windowtext'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=ILbase><span style='color:windowtext'>The FillEllipse function in
Graphics fills up the shape to display the effect of the brush. We could have
used the Rectangle function also, but as we are trying to be as akin as
possible to the samples provided by Microsoft, we have used the Ellipse
function.<o:p></o:p></span></p>

<p class=ILbase><span style='color:windowtext'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=ILbase><span style='color:windowtext'>A LinearGradientBrush can
represent color gradients and multi-color gradients. A gradient represents a
transformation from one color to another. A linear gradient is defined
alongside a line that is specified by the width of a rectangle or by any two
points. Thus, a two-color gradient will commence with a starting color and
conclude with the ending color. The blend from one color to the next can be
customized. First, we specify the object that is to be colored, which is a
rectangle in this case. The gradient starts with the left corner and ends at
the lower right corner. Thereafter, we follow with the starting color followed by
the ending color. Finally, the angle measured in degrees in the clockwise
direction is mentioned, starting from the x-axis. This defines the orientation
of the gradient. You can change the angle and witness the spectacular effects.<o:p></o:p></span></p>

<p class=ILbase><u><span style='mso-bidi-font-size:12.0pt;color:windowtext'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></u></p>

<p class=ILbase><u><span style='mso-bidi-font-size:12.0pt;color:windowtext'>Menus
</span></u><span style='color:windowtext'><o:p></o:p></span></p>

<p class=ILbase><span style='color:windowtext'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=ILprg><u>a.cs</u></p>

<p class=ILprg>using System.Windows.Forms;</p>

<p class=ILprg>using System.Drawing;</p>

<p class=ILprg>using System.Drawing.Drawing2D;</p>

<p class=ILprg>public class zzz: Form </p>

<p class=ILprg>{</p>

<p class=ILprg>public static void Main()</p>

<p class=ILprg>{</p>

<p class=ILprg>Application.Run(new zzz());</p>

<p class=ILprg>}</p>

<p class=ILprg>MainMenu m;</p>

<p class=ILprg>public zzz()</p>

<p class=ILprg>{</p>

<p class=ILprg>m = new MainMenu();</p>

<p class=ILprg>MenuItem mi= m.MenuItems.Add(&quot;<span style='font-family:
"Bookman Old Style"'>&amp;</span>File&quot;);</p>

<p class=ILprg>Menu = m;</p>

<p class=ILprg>}</p>

<p class=ILprg>}</p>

<p class=ILbase><span style='color:windowtext'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<table border=0 cellspacing=0 cellpadding=0 style='border-collapse:collapse;
 mso-padding-alt:0in 5.4pt 0in 5.4pt'>
 <tr>
  <td valign=top style='padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal><img width=300 height=300 id="_x0000_i1047"
  src="chap4img/Image21.jpg"></p>
  </td>
 </tr>
 <tr>
  <td valign=top style='padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal>Screen 4.21</p>
  </td>
 </tr>
</table>

<p class=ILbase><span style='color:windowtext'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=ILbase><span style='color:windowtext'>Let us now build a menu. We have
created an object m, which symbolizes the MainMenu. MainMenu is called a
control and represents the menu structure for a Form. It is the root of the
menu. <o:p></o:p></span></p>

<p class=ILbase><span style='color:windowtext'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=ILbase><span style='color:windowtext'>A menu consists of various menu
items, which are displayed horizontally across the menu. We want to create a
menu item that displays the word 'File For this, we need another class called
MenuItem. A MenuItem can represent either an individual menu item depicting a
command, or it can cascade to another popup of menu items. <o:p></o:p></span></p>

<p class=ILbase><span style='color:windowtext'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=ILbase><span style='color:windowtext'>MenuItems is a read-only
property in MainMenu that gives a reference to all the MenuItems currently
available in the menu. We have none so far. This CollectionObject also has a
function called Add, which is used to add menu items. To do so, the text of the
item that is to be displayed must be stated as the parameter to the Add
function. We can also remove any menu item that has been previously added.<o:p></o:p></span></p>

<p class=ILbase><span style='color:windowtext'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=ILbase><span style='color:windowtext'>The variable mi stores the
MenuItem object returned by the Add function. Thereafter, Menu, which is an
object of type MainMenu, available in Form, is initialized to the menu that we
desire. The appearance of the menu depends upon the menu object stored in
Menu.<span style="mso-spacerun: yes">  </span><o:p></o:p></span></p>

<p class=ILbase><span style='color:windowtext'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=ILbase><span style='color:windowtext'>When we run the program, we see
the word File displayed in the top left corner. At this stage, nothing happens
when we click on it. On pressing the Alt key, F is displayed as underlined
since the symbol &amp; underlines the character it is preceded with.<o:p></o:p></span></p>

<p class=ILbase><span style='color:windowtext'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=ILprg><u>a.cs</u></p>

<p class=ILprg>using System.Windows.Forms;</p>

<p class=ILprg>using System.Drawing;</p>

<p class=ILprg>using System.Drawing.Drawing2D;</p>

<p class=ILprg>public class zzz: Form {</p>

<p class=ILprg>public static void Main() {</p>

<p class=ILprg>Application.Run(new zzz());</p>

<p class=ILprg>}</p>

<p class=ILprg>MainMenu m;</p>

<p class=ILprg>public zzz() {</p>

<p class=ILprg>m = new MainMenu();</p>

<p class=ILprg>MenuItem mi= m.MenuItems.Add(&quot;<span style='font-family:
"Bookman Old Style"'>&amp;</span>File&quot;);</p>

<p class=ILprg>mi.MenuItems.Add(&quot;Hi&quot;);</p>

<p class=ILprg>mi.MenuItems.Add(&quot;-&quot;);</p>

<p class=ILprg>mi.MenuItems.Add(&quot;Bye&quot;);</p>

<p class=ILprg>Menu = m;</p>

<p class=ILprg>}<span style="mso-spacerun: yes">   </span>}</p>

<p class=ILbase><span style='color:windowtext'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<table border=0 cellspacing=0 cellpadding=0 style='border-collapse:collapse;
 mso-padding-alt:0in 5.4pt 0in 5.4pt'>
 <tr>
  <td valign=top style='padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal><img width=300 height=300 id="_x0000_i1048"
  src="chap4img/Image22.jpg"></p>
  </td>
 </tr>
 <tr>
  <td valign=top style='padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal>Screen 4.22</p>
  </td>
 </tr>
</table>

<p class=ILbase><span style='color:windowtext'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=ILbase><span style='color:windowtext'>Now things look more visually
attractive. When we click on File or use the accelerator Alt-F, a menu pops up
with the word 'Hi', followed by a separator and then finally by the word 'Bye'.
<o:p></o:p></span></p>

<p class=ILbase><span style='color:windowtext'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=ILbase><span style='color:windowtext'>A separator is used to logically
group menus together. However, when we click on 'hi' or 'bye', nothing happens.
This situation needs to be redressed, since a menu should activate some code.<o:p></o:p></span></p>

<p class=ILbase><span style='color:windowtext'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=ILprg><u>a.cs</u></p>

<p class=ILprg>using System.Windows.Forms;</p>

<p class=ILprg>using System.Drawing;</p>

<p class=ILprg>using System.Drawing.Drawing2D;</p>

<p class=ILprg>public class zzz: Form </p>

<p class=ILprg>{</p>

<p class=ILprg>public static void Main()</p>

<p class=ILprg>{</p>

<p class=ILprg>Application.Run(new zzz());</p>

<p class=ILprg>}</p>

<p class=ILprg>MainMenu m;</p>

<p class=ILprg>public zzz()</p>

<p class=ILprg>{</p>

<p class=ILprg>m = new MainMenu();</p>

<p class=ILprg>MenuItem mi= m.MenuItems.Add(&quot;<span style='font-family:
"Bookman Old Style"'>&amp;</span>File&quot;);</p>

<p class=ILprg>MenuItem m1;</p>

<p class=ILprg>m1 = new MenuItem(&quot;Hi&quot;, new System.EventHandler(abc),
Shortcut.CtrlF11);</p>

<p class=ILprg>mi.MenuItems.Add(m1);</p>

<p class=ILprg>mi.MenuItems.Add(&quot;Bye&quot;);</p>

<p class=ILprg>Menu = m;</p>

<p class=ILprg>}</p>

<p class=ILprg>void abc(object sender, System.EventArgs e) </p>

<p class=ILprg>{</p>

<p class=ILprg>MessageBox.Show(&quot;hell&quot;);</p>

<p class=ILprg>}</p>

<p class=ILprg>}</p>

<p class=ILbase><span style='color:windowtext'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<table border=0 cellspacing=0 cellpadding=0 style='border-collapse:collapse;
 mso-padding-alt:0in 5.4pt 0in 5.4pt'>
 <tr>
  <td valign=top style='padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal><img width=300 height=300 id="_x0000_i1049"
  src="chap4img/Image23.jpg"></p>
  </td>
  <td valign=top style='padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal><img width=129 height=123 id="_x0000_i1053"
  src="chap4img/Image24.jpg"></p>
  <p class=MsoNormal>Screen 4.24</p>
  </td>
 </tr>
 <tr>
  <td valign=top style='padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal>Screen 4.23</p>
  </td>
  <td valign=top style='padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>
  </td>
 </tr>
</table>

<p class=ILbase><span style='color:windowtext'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=ILbase><span style='color:windowtext'>Now, whether you either click on
File and then on the word 'Hi', or you press Control+F11, you will see a
message box with the word &quot;hell&quot; displayed in it. <o:p></o:p></span></p>

<p class=ILbase><span style='color:windowtext'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=ILbase><span style='color:windowtext'>The MenuItem constructor is
overloaded. The first parameter is the text to be displayed. The second
parameter is a delegate that encompasses the function to be called whenever
this menu item is activated. Just as the pen is mightier than the sword, under
some circumstances, the keyboard is certainly mightier than the mouse. At
times, it is faster to use a keyboard shortcut, instead of using the mouse.
Thus, the last parameter is the keyboard shortcut key, which is part of an
enumerator. This MenuItem object is passed to the Add function, that either
accepts a string or a MenuItem object.<o:p></o:p></span></p>

<p class=ILbase><span style='color:windowtext'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=ILprg><u>a.cs</u></p>

<p class=ILprg>using System.Windows.Forms;</p>

<p class=ILprg>using System.Drawing;</p>

<p class=ILprg>using System.Drawing.Drawing2D;</p>

<p class=ILprg>public class zzz: Form </p>

<p class=ILprg>{</p>

<p class=ILprg>public static void Main()</p>

<p class=ILprg>{</p>

<p class=ILprg>Application.Run(new zzz());</p>

<p class=ILprg>}</p>

<p class=ILprg>MainMenu m;</p>

<p class=ILprg>public zzz()</p>

<p class=ILprg>{</p>

<p class=ILprg>m = new MainMenu();</p>

<p class=ILprg>MenuItem mi= m.MenuItems.Add(&quot;<span style='font-family:
"Bookman Old Style"'>&amp;</span>File&quot;);</p>

<p class=ILprg>MenuItem a = new MenuItem(&quot;One&quot;,new
System.EventHandler(abc));</p>

<p class=ILprg>MenuItem b = new MenuItem(&quot;two&quot;,new
System.EventHandler(abc));</p>

<p class=ILprg>mi.MenuItems.Add(&quot;hell&quot;,(new MenuItem[]{ a, b })</p>

<p class=ILprg>);</p>

<p class=ILprg>Menu = m;</p>

<p class=ILprg>}</p>

<p class=ILprg>void abc(object sender, System.EventArgs e) </p>

<p class=ILprg>{</p>

<p class=ILprg>MessageBox.Show(&quot;hell&quot;);</p>

<p class=ILprg>}</p>

<p class=ILprg>}</p>

<p class=ILbase><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<table border=0 cellspacing=0 cellpadding=0 style='border-collapse:collapse;
 mso-padding-alt:0in 5.4pt 0in 5.4pt'>
 <tr>
  <td valign=top style='padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal><img width=300 height=300 id="_x0000_i1054"
  src="chap4img/Image25.jpg"></p>
  </td>
  <td valign=top style='padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal><img width=129 height=123 id="_x0000_i1055"
  src="chap4img/Image26.jpg"></p>
  <p class=MsoNormal>Screen 4.26</p>
  </td>
 </tr>
 <tr>
  <td valign=top style='padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal>Screen 4.25</p>
  </td>
  <td valign=top style='padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>
  </td>
 </tr>
</table>

<p class=ILbase><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=ILbase><span style='color:windowtext'>Here, we have a popup within a
popup. When you click on File, you will see the word 'hell' displayed. You will
also see an arrow pointing to the right, along with the menu item. If you move
the mouse over the arrow, a popup is displayed, containing the two menu items
'one' and 'two'. If we click on them, a message box with the word 'hell' gets
displayed.<o:p></o:p></span></p>

<p class=ILbase><span style='color:windowtext'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=ILbase><span style='color:windowtext'>In the program, with a single
statement, we have created two menu items, a and b, followed by an array of
menu items. This array is then passed as the last parameter to the Add
function. Thus, all the menus become sub-menus. In this case, the event handler
is associated with the submenu options, since clicking on the menu item
displays the sub-menu.<o:p></o:p></span></p>

<p class=ILbase><span style='color:windowtext'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=ILprg><u>a.cs</u></p>

<p class=ILprg>using System.Windows.Forms;</p>

<p class=ILprg>using System.Drawing;</p>

<p class=ILprg>using System.Drawing.Drawing2D;</p>

<p class=ILprg>public class zzz: Form </p>

<p class=ILprg>{</p>

<p class=ILprg>public static void Main()</p>

<p class=ILprg>{</p>

<p class=ILprg>Application.Run(new zzz());</p>

<p class=ILprg>}</p>

<p class=ILprg>MainMenu m;</p>

<p class=ILprg>public zzz()</p>

<p class=ILprg>{</p>

<p class=ILprg>m = new MainMenu();</p>

<p class=ILprg>MenuItem mi= m.MenuItems.Add(&quot;<span style='font-family:
"Bookman Old Style"'>&amp;</span>File&quot;);</p>

<p class=ILprg>mi.MenuItems.Add( &quot;hell&quot;,new
System.EventHandler(abc));</p>

<p class=ILprg>mi.MenuItems.Add( &quot;Bye&quot;,new System.EventHandler(abc));</p>

<p class=ILprg>Menu = m;</p>

<p class=ILprg>}</p>

<p class=ILprg>void abc(object s, System.EventArgs e) </p>

<p class=ILprg>{</p>

<p class=ILprg>MenuItem m = (MenuItem) s;</p>

<p class=ILprg>if ( m.Checked)</p>

<p class=ILprg>m.Checked = false;</p>

<p class=ILprg>else</p>

<p class=ILprg>m.Checked = true;</p>

<p class=ILprg>}</p>

<p class=ILprg>}</p>

<p class=ILbase><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<table border=0 cellspacing=0 cellpadding=0 style='border-collapse:collapse;
 mso-padding-alt:0in 5.4pt 0in 5.4pt'>
 <tr>
  <td valign=top style='padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal><img width=300 height=300 id="_x0000_i1056"
  src="chap4img/Image27.jpg"></p>
  </td>
  <td valign=top style='padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal><img width=300 height=300 id="_x0000_i1057"
  src="chap4img/Image28.jpg"></p>
  </td>
 </tr>
 <tr>
  <td valign=top style='padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal>Screen 4.27</p>
  </td>
  <td valign=top style='padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal>Screen 4.28</p>
  </td>
 </tr>
</table>

<p class=ILbase><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=ILbase><span style='color:windowtext'>We add two menu items, 'hell'
and 'Bye' to our File menu and assign the same function abc to handle their
events. Clicking on any one of the menu options results in a call to the
function abc. This function takes two parameters. The first parameter s,
represents the menu item that was clicked on. If the first menu option 'hell'
is clicked, then the parameter s is not an object, but a menu item representing
'hell' and vice versa. <o:p></o:p></span></p>

<p class=ILbase><span style='color:windowtext'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=ILbase><span style='color:windowtext'>Every MenuItem has an option
called Checked, which if True, will display a tick mark on the menu item. Thus,
you can Check or Uncheck a menu option by clicking on it. You may click on each
menu option to observe this effect.<o:p></o:p></span></p>

<p class=ILbase><span style='color:windowtext'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=ILprg><u>a.cs</u></p>

<p class=ILprg>using System.Windows.Forms;</p>

<p class=ILprg>using System.Drawing;</p>

<p class=ILprg>using System.Drawing.Drawing2D;</p>

<p class=ILprg>public class zzz: Form </p>

<p class=ILprg>{</p>

<p class=ILprg>public static void Main()</p>

<p class=ILprg>{</p>

<p class=ILprg>Application.Run(new zzz());</p>

<p class=ILprg>}</p>

<p class=ILprg>MainMenu m;</p>

<p class=ILprg>public zzz()</p>

<p class=ILprg>{</p>

<p class=ILprg>m = new MainMenu();</p>

<p class=ILprg>MenuItem mi= m.MenuItems.Add(&quot;<span style='font-family:
"Bookman Old Style"'>&amp;</span>File&quot;);</p>

<p class=ILprg>mi.MenuItems.Add( &quot;hell&quot;,new
System.EventHandler(abc));</p>

<p class=ILprg>mi.MenuItems.Add( &quot;Bye&quot;,new System.EventHandler(abc));</p>

<p class=ILprg>Label l = new Label();</p>

<p class=ILprg>ContextMenu lm;</p>

<p class=ILprg>lm = new ContextMenu();</p>

<p class=ILprg>l.ContextMenu = lm;</p>

<p class=ILprg>l.Text = &quot;Vijay Mukhi&quot;;</p>

<p class=ILprg>lm.MenuItems.Add(mi.CloneMenu());</p>

<p class=ILprg>Controls.Add(l );</p>

<p class=ILprg>Menu = m;</p>

<p class=ILprg>}</p>

<p class=ILprg>void abc(object s, System.EventArgs e) </p>

<p class=ILprg>{</p>

<p class=ILprg>MenuItem m = (MenuItem) s ;</p>

<p class=ILprg>if ( m.Checked)</p>

<p class=ILprg>m.Checked = false;</p>

<p class=ILprg>else</p>

<p class=ILprg>m.Checked = true;</p>

<p class=ILprg>}</p>

<p class=ILprg>}</p>

<p class=ILbase><span style='color:windowtext'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=ILbase><span style='color:windowtext'>The program output will display
the same menu - File, as seen in the earlier program. The text Vijay Mukhi will
also be visible. If you place the mouse on this text and right click the mouse,
you will see the same menu as seen with the File option. <o:p></o:p></span></p>

<p class=ILbase><span style='color:windowtext'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<table border=0 cellspacing=0 cellpadding=0 style='border-collapse:collapse;
 mso-padding-alt:0in 5.4pt 0in 5.4pt'>
 <tr>
  <td valign=top style='padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal><img width=300 height=300 id="_x0000_i1058"
  src="chap4img/Image29.jpg"></p>
  </td>
  <td valign=top style='padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal><img width=300 height=300 id="_x0000_i1059"
  src="chap4img/Image30.jpg"></p>
  </td>
 </tr>
 <tr>
  <td valign=top style='padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal>Screen 4.29</p>
  </td>
  <td valign=top style='padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal>Screen 4.30</p>
  </td>
 </tr>
</table>

<p class=ILbase><span style='color:windowtext'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=ILbase><span style='color:windowtext'>This is called a Context
Sensitive Menu. These two menus, however, are different. If you Check a menu
option in this menu by clicking on it, it does not carry the tick mark to the
other menu.<o:p></o:p></span></p>

<p class=ILbase><span style='color:windowtext'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=ILbase><span style='color:windowtext'>We first create two objects:<o:p></o:p></span></p>

<p class=ILbullets><span style='mso-bidi-font-size:12.0pt;font-family:"Times New Roman"'>•<span
style='mso-tab-count:1'>     </span></span>The first is lm, which looks like a
ContextMenu. </p>

<p class=ILbullets><span style='mso-bidi-font-size:12.0pt;font-family:"Times New Roman"'>•<span
style='mso-tab-count:1'>     </span></span>The second is l, which looks like a
label. </p>

<p class=ILbase><span style='color:windowtext'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<table border=0 cellspacing=0 cellpadding=0 style='border-collapse:collapse;
 mso-padding-alt:0in 5.4pt 0in 5.4pt'>
 <tr>
  <td valign=top style='padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal><img width=300 height=300 id="_x0000_i1060"
  src="chap4img/Image31.jpg"></p>
  </td>
 </tr>
 <tr>
  <td valign=top style='padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal>Screen 4.31</p>
  </td>
 </tr>
</table>

<p class=ILbase><span style='color:windowtext'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=ILbase><span style='color:windowtext'>Every label has a member called
ContextMenu, wherein we can specify a Context Sensitive menu. This member is
initialized to lm. As we have already created a menu item mi, we can reuse this
menu item. <o:p></o:p></span></p>

<p class=ILbase><span style='color:windowtext'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=ILbase>However, a menu item cannot be used twice. Hence, calling the
function CloneMenu off MenuItem creates a clone. This clone menu is then passed
to the Add function of MenuItems in the ContextMenu.</p>

<p class=ILbase><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=ILbase><u><span style='mso-bidi-font-size:12.0pt;color:windowtext'>Writing
Controls</span></u><span style='color:windowtext'><o:p></o:p></span></p>

<p class=ILbase><span style='color:windowtext'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=ILbase><span style='color:windowtext'>Let us start by creating the
simplest control that money can buy. We create the following files:<o:p></o:p></span></p>

<p class=ILbase><span style='color:windowtext'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=ILprg><u>c.cs</u></p>

<p class=ILprg>using System.Windows.Forms;</p>

<p class=ILprg>using System.Drawing;</p>

<p class=ILprg>public class yyy : Control</p>

<p class=ILprg>{</p>

<p class=ILprg>}</p>

<p class=ILprg><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=ILprg><u>h.cs</u></p>

<p class=ILprg>using System.Windows.Forms;</p>

<p class=ILprg>public class zzz : System.Windows.Forms.Form</p>

<p class=ILprg>{</p>

<p class=ILprg>yyy a;</p>

<p class=ILprg>public zzz()</p>

<p class=ILprg>{</p>

<p class=ILprg>a = new yyy();</p>

<p class=ILprg>Controls.Add(a);</p>

<p class=ILprg>}</p>

<p class=ILprg>public static void Main() {</p>

<p class=ILprg>Application.Run(new zzz());</p>

<p class=ILprg>}</p>

<p class=ILprg>}</p>

<p class=ILbase><span style='color:windowtext'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=ILprg><u>a.bat</u></p>

<p class=ILprg>del *.exe</p>

<p class=ILprg>del *.dll</p>

<p class=ILprg>csc.exe /t:library c.cs</p>

<p class=ILprg>csc.exe /r:c.dll h.cs</p>

<p class=ILprg>h</p>

<p class=ILbase><span style='color:windowtext'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=ILbase><span style='color:windowtext'>The file c.cs contains our very
first custom control. In order to create our own user-defined control, we
create a class yyy and derive it from the Control class. The Control class
implements the basic code required by classes to implement the behavior of a
control or a widget. This code can handle user input with a keyboard or a
pointing device, such as a mouse. Message handling and security features are
also supported.<o:p></o:p></span></p>

<p class=ILbase><span style='color:windowtext'>At the end of the day, all
controls are merely child windows. The Control class defines the area or bounds
of a control along with the fonts, colors and images. This class allows
painting, context menus and anchoring with docking behavior. <o:p></o:p></span></p>

<p class=ILbase><span style='color:windowtext'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=ILbase><span style='color:windowtext'>Earlier, we had displayed scores
of controls in our containers, written by the Microsoft developers. All these
controls were derived from the Control class. <o:p></o:p></span></p>

<p class=ILbase><span style='color:windowtext'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<table border=0 cellspacing=0 cellpadding=0 style='border-collapse:collapse;
 mso-padding-alt:0in 5.4pt 0in 5.4pt'>
 <tr>
  <td valign=top style='padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal><img width=300 height=300 id="_x0000_i1061"
  src="chap4img/Image32.jpg"></p>
  </td>
 </tr>
 <tr>
  <td valign=top style='padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal>Screen 4.32</p>
  </td>
 </tr>
</table>

<p class=ILbase><span style='color:windowtext'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=ILbase><span style='color:windowtext'>Thus, a user control like yyy is
an instance of a Control class, which is added to the Form using the Add
function off the Controls collection. It can't get any simpler. On running the
executable, we see no output. Yet, since no error was generated, we presume
that all went well. <o:p></o:p></span></p>

<p class=ILbase><span style='color:windowtext'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=ILbase><span style='color:windowtext'>The major difference between the
Microsoft controls and our controls is, the file in which the code for the
control is finally placed. We have placed our control code in assembly c.dll,
whereas, Microsoft controls are placed in System.Windows.Forms.dll.<o:p></o:p></span></p>

<p class=ILbase><span style='color:windowtext'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=ILprg><u>c.cs </u></p>

<p class=ILprg>using System.Windows.Forms;</p>

<p class=ILprg>using System.Drawing;</p>

<p class=ILprg>public class yyy : Control </p>

<p class=ILprg>{</p>

<p class=ILprg>protected override void OnPaint(PaintEventArgs e)</p>

<p class=ILprg>{</p>

<p class=ILprg>e.Graphics.DrawString(Text,Font, new SolidBrush(ForeColor),
ClientRectangle);</p>

<p class=ILprg>}</p>

<p class=ILprg>}</p>

<p class=ILbase><span style='color:windowtext'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=ILprg><u>h.cs</u></p>

<p class=ILprg>using System.Windows.Forms;</p>

<p class=ILprg>public class zzz : System.Windows.Forms.Form{</p>

<p class=ILprg>yyy a;</p>

<p class=ILprg>public zzz() {</p>

<p class=ILprg>a = new yyy();</p>

<p class=ILprg>a.Size = new System.Drawing.Size(600, 450);</p>

<p class=ILprg>a.Text = &quot;Vijay Mukhi&quot;;</p>

<p class=ILprg>Controls.Add(a);</p>

<p class=ILprg>}</p>

<p class=ILprg>public static void Main() {</p>

<p class=ILprg>Application.Run(new zzz());</p>

<p class=ILprg>}</p>

<p class=ILprg>}</p>

<p class=ILbase><span style='color:windowtext'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<table border=0 cellspacing=0 cellpadding=0 style='border-collapse:collapse;
 mso-padding-alt:0in 5.4pt 0in 5.4pt'>
 <tr>
  <td valign=top style='padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal><img width=300 height=300 id="_x0000_i1062"
  src="chap4img/Image33.jpg"></p>
  </td>
 </tr>
 <tr>
  <td valign=top style='padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal>Screen 4.33</p>
  </td>
 </tr>
</table>

<p class=ILbase><span style='color:windowtext'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=ILbase><span style='color:windowtext'>In the above example, we have
overridden a function called OnPaint in the Control class. This function gets
called whenever a control is to be redrawn on the screen. It is passed a
PaintEventArgs object as a parameter, from where we summon the DrawString
function to paint a string in a specified font and color, at a particular
location. The first parameter, Text, is a property, which refers to the string
to be displayed. The string 'Vijay Mukhi' is presently displayed in the window.
<o:p></o:p></span></p>

<p class=ILbase><span style='color:windowtext'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=ILbase><span style='color:windowtext'>In the container h.cs, we have
initialized the property Text contained in the Control class to 'Vijay Mukhi'.
The Size property is also initialized, so that our control has a specific size
in the container. <o:p></o:p></span></p>

<p class=ILbase><span style='color:windowtext'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=ILprg><u>h.cs</u></p>

<p class=ILprg>using System.Drawing;</p>

<p class=ILprg>using System.Windows.Forms;</p>

<p class=ILprg>public class zzz : Form {</p>

<p class=ILprg>Button b;</p>

<p class=ILprg>ccc c;</p>

<p class=ILprg>public zzz() {</p>

<p class=ILprg>b = new Button();</p>

<p class=ILprg>c = new ccc();</p>

<p class=ILprg>b.Anchor = System.Windows.Forms.AnchorStyles.Bottom;</p>

<p class=ILprg>b.DialogResult = System.Windows.Forms.DialogResult.OK;</p>

<p class=ILprg>b.FlatStyle = System.Windows.Forms.FlatStyle.Flat;</p>

<p class=ILprg>b.Size = new System.Drawing.Size(96, 24);</p>

<p class=ILprg>b.Text = &quot;<span style='font-family:"Bookman Old Style"'>&amp;</span>Save&quot;;</p>

<p class=ILprg>b.Location = new System.Drawing.Point(8, 328);</p>

<p class=ILprg>b.Click += new System.EventHandler(abc);</p>

<p class=ILprg>Text = &quot;Sonal Mukhi&quot;;</p>

<p class=ILprg>AcceptButton = b;</p>

<p class=ILprg>ClientSize = new System.Drawing.Size(400, 373);</p>

<p class=ILprg>c.Anchor=AnchorStyles.Top | AnchorStyles.Bottom |
AnchorStyles.Left | AnchorStyles.Right;</p>

<p class=ILprg>c.AutoScrollMinSize = new System.Drawing.Size(0, 0);</p>

<p class=ILprg>c.Size = new System.Drawing.Size(400, 310);</p>

<p class=ILprg>c.Text = &quot;Vijay Mukhi&quot;;</p>

<p class=ILprg>Controls.Add(b);</p>

<p class=ILprg>Controls.Add(c);</p>

<p class=ILprg>c.cust = ddd.rrr();</p>

<p class=ILprg>Size = new Size(400, (373 + SystemInformation.CaptionHeight));</p>

<p class=ILprg>}</p>

<p class=ILprg>void abc(object sender, System.EventArgs e) </p>

<p class=ILprg>{</p>

<p class=ILprg>c.aaa();</p>

<p class=ILprg>MessageBox.Show(&quot;vijay &quot;+ c.cust);</p>

<p class=ILprg>}</p>

<p class=ILprg>public static void Main(string[] args)</p>

<p class=ILprg>{</p>

<p class=ILprg>Application.Run(new zzz());</p>

<p class=ILprg>}</p>

<p class=ILprg>}</p>

<p class=ILprg><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=ILprg><u>c.cs</u></p>

<p class=ILprg>using System;</p>

<p class=ILprg>using System.Windows.Forms;</p>

<p class=ILprg>using System.Drawing;</p>

<p class=ILprg>public class ccc : UserControl</p>

<p class=ILprg>{</p>

<p class=ILprg>TextBox t;</p>

<p class=ILprg>TextBox ID;</p>

<p class=ILprg>Label l;</p>

<p class=ILprg>ddd c;</p>

<p class=ILprg>public ccc()</p>

<p class=ILprg>{</p>

<p class=ILprg>t = new TextBox();</p>

<p class=ILprg>l = new Label();</p>

<p class=ILprg>ID = new TextBox();</p>

<p class=ILprg>Text = &quot;Vijay Mukhi&quot;;</p>

<p class=ILprg>Size = new System.Drawing.Size(384, 304);</p>

<p class=ILprg>t.Size = new System.Drawing.Size(88, 20);</p>

<p class=ILprg>t.Location = new System.Drawing.Point(88, 70);</p>

<p class=ILprg>l.Size = new System.Drawing.Size(64, 16);</p>

<p class=ILprg>l.Location = new System.Drawing.Point(8, 32);</p>

<p class=ILprg>l.Text = &quot;ID:&quot;;</p>

<p class=ILprg>ID.ReadOnly = true;</p>

<p class=ILprg>ID.Size = new System.Drawing.Size(200, 20);</p>

<p class=ILprg>ID.Location = new System.Drawing.Point(88, 30);</p>

<p class=ILprg>ID.Enabled = false;</p>

<p class=ILprg>Controls.Add(t);</p>

<p class=ILprg>Controls.Add(ID);</p>

<p class=ILprg>Controls.Add(l);</p>

<p class=ILprg>}</p>

<p class=ILprg>public ddd cust</p>

<p class=ILprg>{</p>

<p class=ILprg>get</p>

<p class=ILprg>{</p>

<p class=ILprg>return c;</p>

<p class=ILprg>}</p>

<p class=ILprg>set</p>

<p class=ILprg>{</p>

<p class=ILprg>c=value;</p>

<p class=ILprg>ID.Text = c.ID;</p>

<p class=ILprg>t.Text = c.ti;</p>

<p class=ILprg>}</p>

<p class=ILprg>}</p>

<p class=ILprg>public void aaa()</p>

<p class=ILprg>{</p>

<p class=ILprg>c.ti = t.Text;</p>

<p class=ILprg>}</p>

<p class=ILprg>}</p>

<p class=ILbase><span style='color:windowtext'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=ILprg><u>cc.cs</u></p>

<p class=ILprg>using System;</p>

<p class=ILprg>using System.ComponentModel;</p>

<p class=ILprg>using System.IO;</p>

<p class=ILprg>public class ddd : Component</p>

<p class=ILprg>{</p>

<p class=ILprg>string i ;</p>

<p class=ILprg>string t ;</p>

<p class=ILprg>public static ddd rrr()</p>

<p class=ILprg>{</p>

<p class=ILprg>ddd c = new ddd(&quot;111&quot;);</p>

<p class=ILprg>c.ti = &quot;Vijay&quot;;</p>

<p class=ILprg>return c;</p>

<p class=ILprg>}</p>

<p class=ILprg>internal ddd(string s): base()</p>

<p class=ILprg>{</p>

<p class=ILprg>i = s ;<span style="mso-spacerun: yes">    </span></p>

<p class=ILprg>}</p>

<p class=ILprg>public string ID</p>

<p class=ILprg>{</p>

<p class=ILprg>get</p>

<p class=ILprg>{</p>

<p class=ILprg>return i ;</p>

<p class=ILprg>}</p>

<p class=ILprg>}</p>

<p class=ILprg>public string ti</p>

<p class=ILprg>{</p>

<p class=ILprg>get</p>

<p class=ILprg>{</p>

<p class=ILprg>return t ;</p>

<p class=ILprg>}</p>

<p class=ILprg>set</p>

<p class=ILprg>{</p>

<p class=ILprg>t = value ;</p>

<p class=ILprg>}</p>

<p class=ILprg>}</p>

<p class=ILprg>public override string ToString()</p>

<p class=ILprg>{</p>

<p class=ILprg>StringWriter sb = new StringWriter() ;</p>

<p class=ILprg>sb.WriteLine(&quot;Sonal \n&quot;);</p>

<p class=ILprg>sb.WriteLine(i);</p>

<p class=ILprg>sb.Write(t);</p>

<p class=ILprg>return sb.ToString();</p>

<p class=ILprg>}</p>

<p class=ILprg>}</p>

<p class=ILprg><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=ILbase><span style='color:windowtext'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=ILprg><u>a.bat</u></p>

<p class=ILprg>del *.exe</p>

<p class=ILprg>del *.dll</p>

<p class=ILprg>csc.exe /t:library /out:c.dll c.cs cc.cs </p>

<p class=ILprg>csc.exe /R:c.dll h.cs</p>

<p class=ILprg>h</p>

<p class=ILbase><span style='color:windowtext'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=ILbase><span style='color:windowtext'>This program is a rather
protracted one. As usual, we start with the container in h.cs. In the zzz
constructor, we first create a button b and an object c that is an instance of
our user control ccc. The control is present in the assembly c.dll. What this
class presently does is not significant. We begin by initializing a large
number of properties in the button.<o:p></o:p></span></p>

<p class=ILbase><span style='color:windowtext'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=ILbase><span style='color:windowtext'>The Anchor property decides as
to which edges of the control are to be anchored with the edges of the
container. Here, we have chosen the Bottom edge. <o:p></o:p></span></p>

<p class=ILbase><span style='color:windowtext'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=ILbase><span style='color:windowtext'>The DialogResult property is the
value that is returned to the parent form when we click on the button. The
value returned is OK.<o:p></o:p></span></p>

<p class=ILbase><span style='color:windowtext'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=ILbase><span style='color:windowtext'>The FlatStyle property belongs
to the ButtonBase class and is one of the numerous properties that influence
the flat style appearance of the button. Knowledge of GUI programming implies
cognizance and comprehension about all the facets of making your application more
comely and pleasing to the eye. The Size, Text and Location properties were
explained earlier. <o:p></o:p></span></p>

<p class=ILbase><span style='color:windowtext'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=ILbase><span style='color:windowtext'>Each time we click on the
button, the function abc gets called. The Text property decides on the title of
the windows. The AcceptButton property requires an object that represents a
button. Every form has a feature, which associates the Enter key with a button.
The resultant effect is that pressing the Enter key on the keyboard simulates a
click on the associated button. Thus, in the above form, pressing Enter or
clicking on the button would result in a call to the function abc. The
ClientSize property decides the size of the windows. <o:p></o:p></span></p>

<p class=ILbase><span style='color:windowtext'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=ILbase><span style='color:windowtext'>Our User Control too can
initialize properties since they belong to the Control class. In the program,
we have set the Anchor, AutoScrollMinSize, Size and Text properties of our
user-defined control class ccc, even though our control may not have
implemented these properties directly. <o:p></o:p></span></p>

<p class=ILbase><span style='color:windowtext'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=ILbase><span style='color:windowtext'>Using the Add function, we have
then added the button and the control ccc to the form.<span
style="mso-spacerun: yes">  </span>Finally, we have called a static function
rrr from the class ddd that initializes a property cust from our user-defined
control. <o:p></o:p></span></p>

<p class=ILbase><span style='color:windowtext'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=ILbase><span style='color:windowtext'>When we run this program, we see
two text boxes, a label and a button. It is obvious that other than the button,
the other widgets were created by the class ccc. This provides ample credence
to our belief that our user-defined control can do its biding. <o:p></o:p></span></p>

<p class=ILbase><span style='color:windowtext'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<table border=0 cellspacing=0 cellpadding=0 style='border-collapse:collapse;
 mso-padding-alt:0in 5.4pt 0in 5.4pt'>
 <tr>
  <td valign=top style='padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal><img width=523 height=513 id="_x0000_i1063"
  src="chap4img/Image34.jpg"></p>
  </td>
  <td valign=top style='padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal><img width=137 height=183 id="_x0000_i1067"
  src="chap4img/Image35.jpg"></p>
  <p class=MsoNormal>Screen 4.35</p>
  </td>
 </tr>
 <tr>
  <td valign=top style='padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal>Screen 4.34</p>
  </td>
  <td valign=top style='padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>
  </td>
 </tr>
</table>

<p class=ILbase><span style='color:windowtext'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=ILbase><span style='color:windowtext'>We shall now endeavor to
comprehend what the constructor of class ccc in file c.cs is attempting to do.
The constructor contains two text boxes, one called ID to store the id of the
user, and the other called t to store the user's name. The label </span><span
style='font-family:"Trebuchet MS";color:windowtext'>l </span><span
style='color:windowtext'>is used to display a simple descriptive message. Since
we do not want the user to change the value contained in ID, we assign the
value true to its ReadOnly property and assign the value false to its Enabled
property. Thereafter, we add these three widgets to the form. Hence, we can now
see four widgets on the screen.<o:p></o:p></span></p>

<p class=ILbase><span style='color:windowtext'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=ILbase><span style='color:windowtext'>In the container h.cs, we call a
static function, rrr off class ddd. The ddd class is created in cc.cs and is
derived from Component. In the rrr function, we create an object c, which looks
like ddd and pass a value of 111 to the constructor. The constructor of class
ddd initializes an instance variable i to the value contained in s. The
variable i stands for the user id.<span style="mso-spacerun: yes">  </span><o:p></o:p></span></p>

<p class=ILbase><span style='color:windowtext'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=ILbase><span style='color:windowtext'>Class ddd has a property called
ti, which is initialized to my name, Vijay. This property ti sets another
instance variable t to the value 'Vijay'. Thus, we have initialized two instance
members of class ddd to specific values. <o:p></o:p></span></p>

<p class=ILbase><span style='color:windowtext'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=ILbase><span style='color:windowtext'>The value returned on calling
the rrr function is stored in the cust property of the control c. The class ccc
contains the property having type ddd.<o:p></o:p></span></p>

<p class=ILbase><span style='color:windowtext'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=ILbase><span style='color:windowtext'>The property Cust stores the ddd
object in the variable c for later use. It also initializes the Text property
of the text boxes to the ID and Name of the user that the two properties in the
class ddd were initialized to. Thus, we see '111' and 'Vijay' displayed in the
text boxes.<o:p></o:p></span></p>

<p class=ILbase><span style='color:windowtext'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=ILbase><span style='color:windowtext'>When we click on the button
labeled 'Save', the function abc gets called. This function first calls the
function aaa from class ccc using the object c. In aaa, we initialize the ti
property of the control to the value present in the textbox. The ID property is
dimmed out, and hence its value can never be changed. The object c represents
the ddd object in class ccc. <o:p></o:p></span></p>

<p class=ILbase><span style='color:windowtext'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=ILbase><span style='color:windowtext'>To display a string, an object,
whose data type is not a string, has to call the ToString function in the
datatype. The cust property in class ccc has the type of ddd, which contains
the ToString function. This function uses the StringWriter class to concatenate
the word 'Sonal' with the value of the instance variables i and t, which
eventually get displayed in the MessageBox. <o:p></o:p></span></p>

<p class=ILbase><span style='color:windowtext'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=ILbase><span style='color:windowtext'>The above program demonstrates
two crucial points:<o:p></o:p></span></p>

<p class=ILbullets>(a) All the code that refers to the user has been
encapsulated in class ddd. </p>

<p class=ILbullets>(b) The user interface code is entered in class ccc. </p>

<p class=ILbase><span style='color:windowtext'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=ILbase><span style='color:windowtext'>The container is oblivious to
these classes and does not bother to verify whether there are two classes or
one. While the class ccc contains code pertaining to User Interface interaction
only, the class ddd contains code relating to the actual object. <o:p></o:p></span></p>

<p class=ILbase><span style='color:windowtext'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=ILprg><u>h.cs</u></p>

<p class=ILprg>using System.Drawing;</p>

<p class=ILprg>using System.Windows.Forms;</p>

<p class=ILprg>public class zzz : Form<span style="mso-spacerun: yes"> 
</span>{</p>

<p class=ILprg>RadioButton r1,r2;</p>

<p class=ILprg>GroupBox g1;</p>

<p class=ILprg>sss s;</p>

<p class=ILprg>public zzz()</p>

<p class=ILprg>{</p>

<p class=ILprg>r1 = new System.Windows.Forms.RadioButton();</p>

<p class=ILprg>r2 = new System.Windows.Forms.RadioButton();</p>

<p class=ILprg>r1.Location = new System.Drawing.Point(24, 24);</p>

<p class=ILprg>r1.Size = new System.Drawing.Size(128, 24);</p>

<p class=ILprg>r1.Text = &quot;Vijay&quot;;</p>

<p class=ILprg>r1.Checked = true;</p>

<p class=ILprg>r1.CheckedChanged += new System.EventHandler(r1f);</p>

<p class=ILprg>r2.Location = new System.Drawing.Point(24, 64);</p>

<p class=ILprg>r2.Size = new System.Drawing.Size(128, 24);</p>

<p class=ILprg>r2.Text = &quot;Mukhi&quot;;</p>

<p class=ILprg>r2.CheckedChanged += new System.EventHandler(r2f);</p>

<p class=ILprg>g1 = new System.Windows.Forms.GroupBox();</p>

<p class=ILprg>g1.Size = new System.Drawing.Size(192, 152);</p>

<p class=ILprg>g1.Text = &quot;Sonal&quot;;</p>

<p class=ILprg>g1.Location = new System.Drawing.Point(320, 16);</p>

<p class=ILprg>s = new sss();</p>

<p class=ILprg>Text = &quot;Control Example&quot;;</p>

<p class=ILprg>ClientSize = new System.Drawing.Size(528, 325);</p>

<p class=ILprg>s.Size = new System.Drawing.Size(304, 328);</p>

<p class=ILprg>s.TabIndex = 0;</p>

<p class=ILprg>s.Anchor = AnchorStyles.Left | AnchorStyles.Right;</p>

<p class=ILprg>s.Font = new System.Drawing.Font(&quot;TAHOMA&quot;, 16f,
System.Drawing.FontStyle.Bold, System.Drawing.GraphicsUnit.World);</p>

<p class=ILprg>s.Text = &quot;Simple Control&quot;;</p>

<p class=ILprg>s.dmc += new System.EventHandler(sf);</p>

<p class=ILprg>Controls.Add(g1);</p>

<p class=ILprg>Controls.Add(s);</p>

<p class=ILprg>g1.Controls.Add(r2);</p>

<p class=ILprg>g1.Controls.Add(r1);</p>

<p class=ILprg>}</p>

<p class=ILprg>void r2f(object sender, System.EventArgs e)</p>

<p class=ILprg>{</p>

<p class=ILprg>if (r2.Checked)</p>

<p class=ILprg>{</p>

<p class=ILprg>s.dm = ddd.a2;</p>

<p class=ILprg>}</p>

<p class=ILprg>}</p>

<p class=ILprg>void r1f(object sender, System.EventArgs e)</p>

<p class=ILprg>{</p>

<p class=ILprg>if (r1.Checked)</p>

<p class=ILprg>{</p>

<p class=ILprg>s.dm = ddd.a1;</p>

<p class=ILprg>}</p>

<p class=ILprg>}</p>

<p class=ILprg>void sf(object sender, System.EventArgs e)</p>

<p class=ILprg>{</p>

<p class=ILprg>if (s.dm ==<span style="mso-spacerun: yes">  </span>ddd.a1)</p>

<p class=ILprg>MessageBox.Show(&quot;hi&quot;);</p>

<p class=ILprg>if (s.dm ==<span style="mso-spacerun: yes">  </span>ddd.a2)</p>

<p class=ILprg>MessageBox.Show(&quot;bye&quot;);</p>

<p class=ILprg>}</p>

<p class=ILprg>public static void Main()</p>

<p class=ILprg>{</p>

<p class=ILprg>Application.Run(new zzz());</p>

<p class=ILprg>}</p>

<p class=ILprg>}</p>

<p class=ILbase><span style='color:windowtext'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=ILprg><u>c.cs</u></p>

<p class=ILprg>using System;</p>

<p class=ILprg>using System.ComponentModel;</p>

<p class=ILprg>using System.Windows.Forms;</p>

<p class=ILprg>using System.Drawing;</p>

<p class=ILprg>[DefaultProperty(&quot;dm&quot;),DefaultEvent(&quot;dmc&quot;),]</p>

<p class=ILprg>public class sss : Control</p>

<p class=ILprg>{</p>

<p class=ILprg>ddd d;</p>

<p class=ILprg>EventHandler eee; </p>

<p class=ILprg>public sss() :base()</p>

<p class=ILprg>{</p>

<p class=ILprg>d = ddd.a1;</p>

<p class=ILprg>ccc();</p>

<p class=ILprg>SetStyle(ControlStyles.ResizeRedraw, true);</p>

<p class=ILprg>}</p>

<p class=ILprg>[Category(&quot;Appearance&quot;),Description(&quot;Controls how
the control paints&quot;),DefaultValue(ddd.a1),Bindable(true),]</p>

<p class=ILprg>public ddd dm</p>

<p class=ILprg>{</p>

<p class=ILprg>get</p>

<p class=ILprg>{</p>

<p class=ILprg>return d;</p>

<p class=ILprg>}</p>

<p class=ILprg>set</p>

<p class=ILprg>{</p>

<p class=ILprg>d=value;</p>

<p class=ILprg>ccc();</p>

<p class=ILprg>dmf(EventArgs.Empty);</p>

<p class=ILprg>}</p>

<p class=ILprg>}</p>

<p class=ILprg>protected override void OnPaint(PaintEventArgs e)</p>

<p class=ILprg>{</p>

<p class=ILprg>e.Graphics.FillRectangle(new SolidBrush(BackColor),
ClientRectangle);</p>

<p class=ILprg>Size textSize = e.Graphics.MeasureString(Text, Font).ToSize();</p>

<p class=ILprg>float x = (ClientRectangle.Width/2) - (textSize.Width/2);</p>

<p class=ILprg>float y = (ClientRectangle.Height/2) - (textSize.Height/2);</p>

<p class=ILprg>e.Graphics.DrawString(Text,Font,new SolidBrush(ForeColor),x, y);</p>

<p class=ILprg>}</p>

<p class=ILprg>protected override void OnTextChanged(EventArgs e) {</p>

<p class=ILprg><span style="mso-spacerun: yes">     
</span>base.OnTextChanged(e);</p>

<p class=ILprg><span style="mso-spacerun: yes">      </span>Invalidate();</p>

<p class=ILprg>}</p>

<p class=ILprg>[Description(&quot;Raised when the DrawingMode changes&quot;)]</p>

<p class=ILprg>public event EventHandler dmc</p>

<p class=ILprg>{</p>

<p class=ILprg>add {</p>

<p class=ILprg><span style="mso-spacerun: yes">              </span>eee +=
value;</p>

<p class=ILprg><span style="mso-spacerun: yes">       </span>}</p>

<p class=ILprg>remove {</p>

<p class=ILprg><span style="mso-spacerun: yes">              </span>eee -=
value;</p>

<p class=ILprg><span style="mso-spacerun: yes">      </span>}</p>

<p class=ILprg>}</p>

<p class=ILprg>protected virtual void dmf(EventArgs e)</p>

<p class=ILprg>{</p>

<p class=ILprg>Invalidate();</p>

<p class=ILprg>if (eee != null)</p>

<p class=ILprg>eee.Invoke(this, e);</p>

<p class=ILprg>}</p>

<p class=ILprg>void ccc()</p>

<p class=ILprg>{</p>

<p class=ILprg>if ( d == ddd.a1)</p>

<p class=ILprg>{</p>

<p class=ILprg>base.BackColor = Color.Yellow ;</p>

<p class=ILprg>base.ForeColor = Color.Green ;</p>

<p class=ILprg>}</p>

<p class=ILprg>if ( d == ddd.a2)</p>

<p class=ILprg>{</p>

<p class=ILprg>base.BackColor = Color.LightSlateGray ;</p>

<p class=ILprg>base.ForeColor = Color.White ;</p>

<p class=ILprg>}</p>

<p class=ILprg>}</p>

<p class=ILprg>}</p>

<p class=ILprg>public enum ddd</p>

<p class=ILprg>{</p>

<p class=ILprg>a1 = 0,</p>

<p class=ILprg>a2 = 1,</p>

<p class=ILprg>}</p>

<p class=ILbase><span style='color:windowtext'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=ILoutput><u>a.bat</u></p>

<p class=ILoutput>del *.exe</p>

<p class=ILoutput>del *.dll</p>

<p class=ILoutput>csc /t:library c.cs</p>

<p class=ILoutput>csc h.cs /r:c.dll</p>

<p class=ILoutput>h </p>

<p class=ILbase><span style='color:windowtext'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=ILbase><span style='color:windowtext'>Let us now write a control that
is considerably intricate. In the container h.cs, we start with two radio
buttons r1 and r2. Each time we select a radio button, depending upon the
option selected, either of the functions r1f or r2f will get called.
Thereafter, we create a group box called g1. The radio buttons are added to the
group box, and the group box is added to the Controls collections. Apart from
these controls, one more user control named s, which is an instance of class
sss, is added to the Controls collection. <o:p></o:p></span></p>

<p class=ILbase><span style='color:windowtext'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<table border=0 cellspacing=0 cellpadding=0 style='border-collapse:collapse;
 mso-padding-alt:0in 5.4pt 0in 5.4pt'>
 <tr>
  <td valign=top style='padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal><img width=516 height=317 id="_x0000_i1068"
  src="chap4img/Image36.jpg"></p>
  </td>
  <td valign=top style='padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal><img width=516 height=317 id="_x0000_i1069"
  src="chap4img/Image37.jpg"></p>
  </td>
 </tr>
 <tr>
  <td valign=top style='padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal>Screen 4.36</p>
  </td>
  <td valign=top style='padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal>Screen 4.37</p>
  </td>
 </tr>
</table>

<p class=ILbase><span style='color:windowtext'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=ILbase><span style='color:windowtext'>Prior to this, we initialize
various properties of this control such as TabIndex, Font, Size, Anchor, Text
etc. to some meaningful values. Besides these, a property called dmc in the
user control is initialized to an EventHandler that calls function sf. Thus,
whenever the event represented by dmc is triggered, the function sf gets
called. <o:p></o:p></span></p>

<p class=ILbase><span style='color:windowtext'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=ILbase><span style='color:windowtext'>The code implementing our user
control s, resides in the file c.cs. The user control s is an instance of sss
and is derived from the Control class. At the outset, the constructor of class
sss calls the constructor of the base class using the keyword base, even though
this is optional, because the base class constructor invariably gets called.<o:p></o:p></span></p>

<p class=ILbase><span style='color:windowtext'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=ILbase><span style='color:windowtext'>The class ddd is an enum, with
two members a1 and a2, having values 0 and 1 respectively. We could
conveniently have used numbers directly instead of an enum, but since the
original example used an enum, we have also done so. We set the object d to the
value 0 and call function ccc from class sss. The main objective of placing
code in a function is to enable the code to be called several times.<o:p></o:p></span></p>

<p class=ILbase><span style='color:windowtext'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=ILbase><span style='color:windowtext'>In the function ccc, we start by
checking the value of the object d. If it is a1 i.e. 0, we change the value of
the two properties BackColor and ForeColor to Yellow and Green respectively. If
the object has a value of a2, then another pair of colors is assigned to these
properties. The properties are changed in the base class using the keyword
base. The function SetStyle ensures that the form gets redrawn when it is
resized. <o:p></o:p></span></p>

<p class=ILbase><span style='color:windowtext'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=ILbase><span style='color:windowtext'>We have already learnt that the
OnPaint function is called whenever the window needs to be redrawn. In this function,
we first use the property BackColor to fill the form background. Next, we use
the width of the currently selected font, to calculate the midpoint of our
screen, and then, we write the value contained in the text property in the
center of the window.<o:p></o:p></span></p>

<p class=ILbase><span style='color:windowtext'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=ILbase><span style='color:windowtext'>When the second radio button is
selected, function r2f gets called. In this function, the program checks
whether the radio button is already checked. If so, it initializes the property
dm, whose data type is ddd, to a2. <o:p></o:p></span></p>

<p class=ILbase><span style='color:windowtext'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=ILbase><span style='color:windowtext'>Similarly, when the first radio
button is selected, function r1f gets called. This function first ascertains if
the radio button is already checked.<span style="mso-spacerun: yes">  </span>If
so, it initializes the property dm to a1. <o:p></o:p></span></p>

<p class=ILbase><span style='color:windowtext'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=ILbase><span style='color:windowtext'>Now, we shall focus our
attention on the property dm. In the set accessor of property dm, the ddd
object named d is initialized to either a1 or a2. Following this action, a call
is made to function ccc, which changes the background and foreground color,
depending on the value contained in d. The effect is observed when the function
OnPaint gets called. A call is made to the function dmf with a parameter of an
Empty event.<o:p></o:p></span></p>

<p class=ILbase><span style='color:windowtext'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=ILbase><span style='color:windowtext'>In function dmf, we first call
Invalidate, which in turn, calls the OnPaint function. Just as life offers no
guarantees whatsoever, in much the same way, the calls made to the OnPaint
function are unpredictable. The Invalidate function instantly calls the OnPaint
function.<o:p></o:p></span></p>

<p class=ILbase><span style='color:windowtext'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=ILbase><span style='color:windowtext'>You may recall that in h.cs, the
property dmc was initialized with the name of the function sf. This property
dmc is an event type that stores the EventHandler or function sf in an instance
object eee. So, the value in the object eee is checked. If the value is not
null, the function Invoke is called off the object eee with two parameters. The
first parameter is a reference to itself, i.e. 'this', and the second parameter
is a null EventArgs object. The function Invoke, in turn, calls function sf in
the container, h.cs. The function sf displays a message box, depending upon the
value of the ddd object. <o:p></o:p></span></p>

<p class=ILbase><span style='color:windowtext'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=ILbase><span style='color:windowtext'>The main idea behind this
exercise is to demonstrate that clicking on a radio button in the container
initializes a property in the user control. This in turn, raises a property
changed event, thus resulting in a call to a function registered with a
property of the control. The function resides in the container and not in the
user control. <o:p></o:p></span></p>

<p class=ILbase><span style='color:windowtext'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=ILbase><span style='color:windowtext'>This is a circuitous route for
accomplishing results. The Invoke function is not aware of and could not care
less about the functions that it is calling. <o:p></o:p></span></p>

<p class=ILbase><span style='color:windowtext'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=ILbase><span style='color:windowtext'>All the other attributes in the
code can be safely ignored, since they are mainly meant for external tools or
programs that display the metadata.<o:p></o:p></span></p>

<p class=ILbase><span style='color:windowtext'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=ILprg><u>h.cs</u></p>

<p class=ILprg>using System.Drawing;</p>

<p class=ILprg>using System.Windows.Forms;</p>

<p class=ILprg>public class zzz : Form</p>

<p class=ILprg>{</p>

<p class=ILprg>TextBox t;</p>

<p class=ILprg>Button b;</p>

<p class=ILprg>hhh h;</p>

<p class=ILprg>public zzz()</p>

<p class=ILprg>{</p>

<p class=ILprg>h = new hhh();</p>

<p class=ILprg>b = new Button();</p>

<p class=ILprg>t = new TextBox();</p>

<p class=ILprg>b.Size = new System.Drawing.Size(104, 40);</p>

<p class=ILprg>b.Text = &quot;Vijay&quot;;</p>

<p class=ILprg>b.Location = new System.Drawing.Point(336, 56);</p>

<p class=ILprg>ClientSize = new System.Drawing.Size(448, 157);</p>

<p class=ILprg>t.Location = new System.Drawing.Point(80, 16);</p>

<p class=ILprg>t.Text = &quot;Vijay Mukhi&quot;;</p>

<p class=ILprg>h.Dock = System.Windows.Forms.DockStyle.Bottom;</p>

<p class=ILprg>h.Size = new System.Drawing.Size(448, 40);</p>

<p class=ILprg>h.Location = new System.Drawing.Point(0, 117);</p>

<p class=ILprg>h.Text = &quot;none&quot;;</p>

<p class=ILprg>h.ppp(t, &quot;TextBox selected&quot;);</p>

<p class=ILprg>h.ppp(b, &quot;Button Selected&quot;);</p>

<p class=ILprg>Controls.Add(t);</p>

<p class=ILprg>Controls.Add(b);</p>

<p class=ILprg>Controls.Add(h);</p>

<p class=ILprg>}</p>

<p class=ILprg>public static void Main(string[] args)</p>

<p class=ILprg>{</p>

<p class=ILprg>Application.Run(new zzz());</p>

<p class=ILprg>}</p>

<p class=ILprg>}</p>

<p class=ILprg><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=ILprg><u>c.cs</u></p>

<p class=ILprg>using System;</p>

<p class=ILprg>using System.Collections;</p>

<p class=ILprg>using System.ComponentModel;</p>

<p class=ILprg>using System.Drawing;</p>

<p class=ILprg>using System.Windows.Forms;</p>

<p class=ILprg>public class hhh : Control</p>

<p class=ILprg>{</p>

<p class=ILprg>Hashtable h;</p>

<p class=ILprg>Control a;</p>

<p class=ILprg>public hhh()</p>

<p class=ILprg>{</p>

<p class=ILprg>h = new Hashtable();</p>

<p class=ILprg>BackColor = SystemColors.Info;</p>

<p class=ILprg>}</p>

<p class=ILprg>[Browsable(false),
DesignerSerializationVisibility(DesignerSerializationVisibility.Hidden) ]</p>

<p class=ILprg>public override string Text</p>

<p class=ILprg>{</p>

<p class=ILprg>get</p>

<p class=ILprg>{</p>

<p class=ILprg>return base.Text;</p>

<p class=ILprg>}</p>

<p class=ILprg><span style="mso-spacerun: yes"> </span>set</p>

<p class=ILprg>{</p>

<p class=ILprg>base.Text = value;</p>

<p class=ILprg>}</p>

<p class=ILprg>}</p>

<p class=ILprg>private void ce(object s, EventArgs e)</p>

<p class=ILprg>{</p>

<p class=ILprg>a = (Control)s;</p>

<p class=ILprg>Invalidate();</p>

<p class=ILprg>}</p>

<p class=ILprg>private void cl(object s, EventArgs e)</p>

<p class=ILprg>{</p>

<p class=ILprg>if (s == a)</p>

<p class=ILprg>{</p>

<p class=ILprg>a = null;</p>

<p class=ILprg>Invalidate();</p>

<p class=ILprg>}</p>

<p class=ILprg>}</p>

<p class=ILprg>public void ppp(Control c, string v)</p>

<p class=ILprg>{</p>

<p class=ILprg>if (v == null)</p>

<p class=ILprg>{</p>

<p class=ILprg>v = string.Empty;</p>

<p class=ILprg>}</p>

<p class=ILprg>if (v.Length == 0)</p>

<p class=ILprg>{</p>

<p class=ILprg>h.Remove(c);</p>

<p class=ILprg>c.Enter -= new EventHandler(ce);</p>

<p class=ILprg>c.Leave -= new EventHandler(cl);</p>

<p class=ILprg>}</p>

<p class=ILprg>else</p>

<p class=ILprg>{</p>

<p class=ILprg>h[c] = v;</p>

<p class=ILprg>c.Enter += new EventHandler(ce);</p>

<p class=ILprg>c.Leave += new EventHandler(cl);</p>

<p class=ILprg>}</p>

<p class=ILprg>if (c == a)</p>

<p class=ILprg>{</p>

<p class=ILprg>Invalidate();</p>

<p class=ILprg>}</p>

<p class=ILprg>}</p>

<p class=ILprg>protected override void OnPaint(PaintEventArgs pe)</p>

<p class=ILprg>{</p>

<p class=ILprg>base.OnPaint(pe);</p>

<p class=ILprg>Rectangle rect = ClientRectangle;</p>

<p class=ILprg>Pen borderPen = new Pen(ForeColor);</p>

<p class=ILprg>pe.Graphics.DrawRectangle(borderPen, rect);</p>

<p class=ILprg>borderPen.Dispose();</p>

<p class=ILprg>if (a != null)</p>

<p class=ILprg>{</p>

<p class=ILprg>string te = (string)h[a];</p>

<p class=ILprg>if (te != null <span style='font-family:"Bookman Old Style"'>&amp;&amp;</span>
te.Length &gt; 0)</p>

<p class=ILprg>{</p>

<p class=ILprg>rect.Inflate(-2, -2);</p>

<p class=ILprg>Brush brush = new SolidBrush(ForeColor);</p>

<p class=ILprg>pe.Graphics.DrawString(te, Font, brush, rect);</p>

<p class=ILprg>brush.Dispose();</p>

<p class=ILprg>}</p>

<p class=ILprg>}</p>

<p class=ILprg>}</p>

<p class=ILprg>}</p>

<p class=ILbase><span style='color:windowtext'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=ILbase><span style='color:windowtext'>In this program, we have three
controls: a user control h, contained in class hhh, a TextBox t and a Button b.
The basic properties like Size, Text and Location for the Button and the Text
box are set to the specified initial values. Thereafter, the properties of the
user control h are initialized. The DockStyle for the Dock property is set to
the Bottom of the form, and the Size and the Location are specified.<span
style="mso-spacerun: yes">  </span>The Text property is also initialized. <o:p></o:p></span></p>

<p class=ILbase><span style='color:windowtext'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=ILbase><span style='color:windowtext'>The user control h has a
property called ppp, which accepts two parameters, a control and a string. We
call it twice. When it is called for the first time, the first parameter passed
is a text box control. The next time it is called, the first parameter passed
is a button control. The button and the text box are displayed on the screen
and a yellow colored label with the word 'TextBox selected' in the bottom pane.
<o:p></o:p></span></p>

<p class=ILbase><span style='color:windowtext'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<table border=0 cellspacing=0 cellpadding=0 style='border-collapse:collapse;
 mso-padding-alt:0in 5.4pt 0in 5.4pt'>
 <tr>
  <td valign=top style='padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal><img width=546 height=202 id="_x0000_i1070"
  src="chap4img/Image38.jpg"></p>
  </td>
 </tr>
 <tr>
  <td valign=top style='padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal>Screen 4.38</p>
  </td>
 </tr>
</table>

<p class=ILbase><span style='color:windowtext'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=ILbase><span style='color:windowtext'>When we click on the button, the
words in the label change to 'Button selected'. <o:p></o:p></span></p>

<p class=ILbase><span style='color:windowtext'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<table border=0 cellspacing=0 cellpadding=0 style='border-collapse:collapse;
 mso-padding-alt:0in 5.4pt 0in 5.4pt'>
 <tr>
  <td valign=top style='padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal><img width=546 height=202 id="_x0000_i1071"
  src="chap4img/Image39.jpg"></p>
  </td>
 </tr>
 <tr>
  <td valign=top style='padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal>Screen 4.39</p>
  </td>
 </tr>
</table>

<p class=ILbase><span style='color:windowtext'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=ILbase><span style='color:windowtext'>Thus, depending upon the control
selected, our user control displays a help message which we have registered
using the property ppp.<o:p></o:p></span></p>

<p class=ILbase><span style='color:windowtext'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=ILbase><span style='color:windowtext'>The user control h in file c.cs,
has two instance variables, a HashTable h and a Control a. The HashTable class
stores values based on a certain key. This helps in retrieving the value
efficiently on being provided with the key. In the constructor of class hhh, an
instance h of the HashTable is created. The property BackColor is initialized to
a Read Only Color property from the class SystemColors. This property
represents the tool tip background color. On our machine, it happens to be
Yellow, and thus, we see a yellow color label.<o:p></o:p></span></p>

<p class=ILbase><span style='color:windowtext'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=ILbase><span style='color:windowtext'>There is a property called Text
in the Control class. In order to implement our property, we must override the
existing one. Presently, in our property, we are merely accessing the original
Text in the base class. <o:p></o:p></span></p>

<p class=ILbase><span style='color:windowtext'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=ILbase><span style='color:windowtext'>The attributes make interesting
reading even though they have little use in the current example. The Browsable
attribute with a parameter of False prevents this property from showing up in
the Property Browser. Also, the value assigned to the property is not saved on
disk. We are not doing anything useful in the Text property at all.<o:p></o:p></span></p>

<p class=ILbase><span style='color:windowtext'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=ILbase><span style='color:windowtext'>The property ppp is called twice
in the control, because the container has two property initialization
statements. Good programming style incorporates comprehensive error checks. <o:p></o:p></span></p>

<p class=ILbase><span style='color:windowtext'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=ILbase><span style='color:windowtext'>We first check for a string
value in the second parameter v. If it is null, we initialize the variable v to
an empty string. If the string is not empty, we add the string contained in v
to the hash table using the control parameter c as the key. Thus, in a hash
table, any data type can be used as a key to insert or retrieve values. <o:p></o:p></span></p>

<p class=ILbase><span style='color:windowtext'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=ILbase><span style='color:windowtext'>The control class has Events
called Enter and Leave. We use the += syntax to register the function ce
whenever the Event Enter gets fired. In the same manner, the function </span><span
style='font-family:"Trebuchet MS";color:windowtext'>cl</span><span
style='color:windowtext'> gets called whenever the Event Leave gets fired. <o:p></o:p></span></p>

<p class=ILbase><span style='color:windowtext'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=ILbase><span style='color:windowtext'>If the user calls the property
without a string, it signifies that the control has to be removed from the hash
table and the list of functions in the events has to be called. Thus, we use
the Remove function of the HashTable class to remove the key c from the hash
table. The -= syntax of the Events and Delegates is employed to remove the
functions registered with the Enter and Leave events.<o:p></o:p></span></p>

<p class=ILbase><span style='color:windowtext'>In the OnPaint function, we have
drawn a label and displayed some text in it. There is one rule that must never
be violated: 'Call the function in the base class first.' This is because we
are unaware of what the overridden function accomplishes. <o:p></o:p></span></p>

<p class=ILbase><span style='color:windowtext'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=ILbase><span style='color:windowtext'>A Pen is created from the color
stored in ForeColor. This color is the default color stored in the Control
class. The Background color is initialized in the constructor of hhh class. A
rectangle that is drawn using this pen displays yellow as the background color,
with the size defaulting to the value stored in the ClientRectangle property in
the control class. The pen is then disposed off, to enable the system to retrieve
the resources consumed by it. A check is thereafter performed on the value in
the Control object. It should be null since the control has not been
initialized in the beginning. <o:p></o:p></span></p>

<p class=ILbase><span style='color:windowtext'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=ILbase><span style='color:windowtext'>Before the OnPaint function gets
called, a lot of activities get executed in the background, i.e. many functions
get called and numerous events get triggered. On entering a field, the event
OnControlEnter gets triggered and the function that is registered with the
Enter event is called. In our case, function ce is called. The first parameter
to this function is a handle to the control that caused the event. In our case,
it is the Text Box. We initialize the object a to the Text Box control. Thus,
in OnPaint, the value of control a is a Text Box.<o:p></o:p></span></p>

<p class=ILbase><span style='color:windowtext'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=ILbase><span style='color:windowtext'>We then retrieve the string
stored in the hash table using the control as the key. We then ascertain that
the value contained in the string te is not null and its length is greater than
zero. <o:p></o:p></span></p>

<p class=ILbase><span style='color:windowtext'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=ILbase><span style='color:windowtext'>The Rect structure contains the
size of the rectangle. We can then inflate or deflate the rectangle using the
Inflate method. As a result, the position and the size of the Rectangle change.
The X and Y properties are changed by the amount specified and the Width and
Height are modified to twice the amount specified.<span style="mso-spacerun:
yes">  </span>The final outcome is that the size of the rectangle is inflated
without moving its geometric center. In our case, since the numbers are
negative, the rectangular will be deflated. Following this, a solid brush is
created using the property ForeColor. A string is drawn using the DrawString function
in the Pen class. Thereafter, we dispose of the brush.<span
style="mso-spacerun: yes">  </span><o:p></o:p></span></p>

<p class=ILbase><span style='color:windowtext'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=ILbase><span style='color:windowtext'>When we leave the control, the
event handler named Leave is called. The function associated with this
eventhandler is cl, which ascertains whether the control in 'a' and the one
passed as parameter i.e. 's' is the same. If so, then 'a' is initialized to a
Null value and the OnPaint function is called. The value contained in 'a' is
the deciding factor on whether we are inside a control or not. <o:p></o:p></span></p>

<p class=ILbase><span style='color:windowtext'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=ILprg><u>h.cs</u></p>

<p class=ILprg>using System.Drawing;</p>

<p class=ILprg>using System.Windows.Forms;</p>

<p class=ILprg>public class zzz : Form</p>

<p class=ILprg>{</p>

<p class=ILprg>fff f;</p>

<p class=ILprg>public zzz()</p>

<p class=ILprg>{</p>

<p class=ILprg>f = new fff();</p>

<p class=ILprg>f.Dock = System.Windows.Forms.DockStyle.Fill;</p>

<p class=ILprg>f.ForeColor = System.Drawing.Color.White;</p>

<p class=ILprg>f.BackColor = System.Drawing.Color.Black;</p>

<p class=ILprg>f.Size = new System.Drawing.Size(600, 450);</p>

<p class=ILprg>f.vvv = 73;</p>

<p class=ILprg>f.Text = &quot;Vijay Mukhi&quot;;</p>

<p class=ILprg>ClientSize = new System.Drawing.Size(600, 450);</p>

<p class=ILprg>Controls.Add(f);</p>

<p class=ILprg>}</p>

<p class=ILprg>public static void Main()</p>

<p class=ILprg>{</p>

<p class=ILprg>Application.Run(new zzz());</p>

<p class=ILprg>}</p>

<p class=ILprg>}</p>

<p class=ILprg><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=ILprg><u>c.cs</u></p>

<p class=ILprg>using System;</p>

<p class=ILprg>using System.Drawing;</p>

<p class=ILprg>using System.Drawing.Drawing2D;</p>

<p class=ILprg>using System.Windows.Forms;</p>

<p class=ILprg>public class fff : Control {</p>

<p class=ILprg>int vvv1 = 0;</p>

<p class=ILprg>public int Min = 0;</p>

<p class=ILprg>public int Max = 100;</p>

<p class=ILprg>public bool ShowValue = false;</p>

<p class=ILprg>int dv = 0;</p>

<p class=ILprg>bool d = false;</p>

<p class=ILprg>public Color cs = Color.Red;</p>

<p class=ILprg>public<span style="mso-spacerun: yes">  </span>Color ce =
Color.LimeGreen;</p>

<p class=ILprg>Brush bb = null;</p>

<p class=ILprg>Brush bd = null;</p>

<p class=ILprg>public int vvv</p>

<p class=ILprg>{</p>

<p class=ILprg>get</p>

<p class=ILprg>{</p>

<p class=ILprg>if (d)</p>

<p class=ILprg>{</p>

<p class=ILprg>return dv;</p>

<p class=ILprg>}</p>

<p class=ILprg>return vvv1;</p>

<p class=ILprg>}</p>

<p class=ILprg>set</p>

<p class=ILprg>{</p>

<p class=ILprg>vvv1 = value;</p>

<p class=ILprg>}</p>

<p class=ILprg>}</p>

<p class=ILprg>protected override void OnPaint(PaintEventArgs e)</p>

<p class=ILprg>{</p>

<p class=ILprg>base.OnPaint(e);</p>

<p class=ILprg>bb=new LinearGradientBrush(new Point(0, 0),</p>

<p class=ILprg><span style="mso-spacerun: yes">        </span>new
Point(ClientSize.Width, 0),cs,ce);</p>

<p class=ILprg>bd = new SolidBrush(Color.FromArgb(200, Color.Black));</p>

<p class=ILprg>e.Graphics.FillRectangle(bb, ClientRectangle);</p>

<p class=ILprg>Rectangle r = ClientRectangle;</p>

<p class=ILprg>float p = ((float)vvv / ((float)Max - (float)Min));</p>

<p class=ILprg>int a = (int)(p * (float)r.Width);</p>

<p class=ILprg>r.X += a;</p>

<p class=ILprg>r.Width -= a;</p>

<p class=ILprg>e.Graphics.FillRectangle(bd, r);</p>

<p class=ILprg>e.Graphics.Flush();</p>

<p class=ILprg>RectangleF r1 = new RectangleF();</p>

<p class=ILprg>SizeF ts = e.Graphics.MeasureString(Text, Font);</p>

<p class=ILprg>r1.Width = ts.Width;</p>

<p class=ILprg>r1.Height = ts.Height;</p>

<p class=ILprg>r1.X = (ClientRectangle.Width - r1.Width) / 2;</p>

<p class=ILprg>r1.Y = (ClientRectangle.Height - r1.Height) / 2;</p>

<p class=ILprg>e.Graphics.DrawString(Text, Font, new SolidBrush(ForeColor),
r1);</p>

<p class=ILprg>}</p>

<p class=ILprg>protected override void OnMouseDown(MouseEventArgs e)</p>

<p class=ILprg>{</p>

<p class=ILprg>base.OnMouseDown(e);</p>

<p class=ILprg>Capture = true;</p>

<p class=ILprg>d = true;</p>

<p class=ILprg>sss(new Point(e.X, e.Y));</p>

<p class=ILprg>}</p>

<p class=ILprg>protected override void OnMouseMove(MouseEventArgs e)</p>

<p class=ILprg>{</p>

<p class=ILprg>base.OnMouseMove(e);</p>

<p class=ILprg>if ( !d) </p>

<p class=ILprg>return;</p>

<p class=ILprg>sss(new Point(e.X, e.Y));</p>

<p class=ILprg>}</p>

<p class=ILprg>protected override void OnMouseUp(MouseEventArgs e)</p>

<p class=ILprg>{</p>

<p class=ILprg>base.OnMouseUp(e);</p>

<p class=ILprg>if ( !d) </p>

<p class=ILprg>return;</p>

<p class=ILprg>Capture = false;</p>

<p class=ILprg>d = false;</p>

<p class=ILprg>vvv = dv;</p>

<p class=ILprg>}</p>

<p class=ILprg>void sss(Point l) {</p>

<p class=ILprg>Rectangle r = ClientRectangle;</p>

<p class=ILprg>float p = (float)l.X / (float)r.Width;</p>

<p class=ILprg>int a = (int)(p * (float)(Max - Min));</p>

<p class=ILprg>int o = dv;</p>

<p class=ILprg>dv = a;</p>

<p class=ILprg>float op = ((float)o / ((float)Max - (float)Min));</p>

<p class=ILprg>int ol = (int)(op * (float)r.Width);</p>

<p class=ILprg>float np = ((float)dv / ((float)Max - (float)Min));</p>

<p class=ILprg>int nl = (int)(np * (float)r.Width);</p>

<p class=ILprg>int mi = Math.Min(ol, nl);</p>

<p class=ILprg>int ma = Math.Max(ol, nl);</p>

<p class=ILprg>Rectangle r1 = new Rectangle(r.X + mi, r.Y, ma - mi, r.Height);</p>

<p class=ILprg>Invalidate(r1);</p>

<p class=ILprg>}</p>

<p class=ILprg>}</p>

<p class=ILbase><span style='color:windowtext'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=ILbase><span style='color:windowtext'>When we run the above program,
we see a myriad of colors such as red, green and black. We also see 'Vijay
Mukhi' displayed in the center. On clicking the mouse, more of the color black
will be introduced upto the point of the mouse click on the screen, whereas
dragging the mouse will extend or diminish the colors accordingly. This
certainly is a sight for sore eyes! <o:p></o:p></span></p>

<p class=ILbase><span style='color:windowtext'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<table border=0 cellspacing=0 cellpadding=0 style='border-collapse:collapse;
 mso-padding-alt:0in 5.4pt 0in 5.4pt'>
 <tr>
  <td valign=top style='padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal><img width=371 height=329 id="_x0000_i1072"
  src="chap4img/Image40.jpg"></p>
  </td>
  <td valign=top style='padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal><img width=371 height=329 id="_x0000_i1073"
  src="chap4img/Image41.jpg"></p>
  </td>
 </tr>
 <tr>
  <td valign=top style='padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal>Screen 4.40</p>
  </td>
  <td valign=top style='padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal>Screen 4.41</p>
  </td>
 </tr>
</table>

<p class=ILbase><span style='color:windowtext'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=ILbase><span style='color:windowtext'>We have to admit that the folks
at Microsoft who worked on this sample did a truly marvelous job. Our task here
is to explain the program that they have written, in absolute layman terms. <o:p></o:p></span></p>

<p class=ILbase><span style='color:windowtext'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=ILbase><span style='color:windowtext'>The h.cs file contains code that
is already explained in the earlier program. As always, along with the
properties that are present in Control, we have also initialized one of our own
properties, vvv for control fff. The user-defined property vvv is assigned a
value of 73. The value contained in the Text property is displayed at the
center of the screen. <o:p></o:p></span></p>

<p class=ILbase><span style='color:windowtext'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=ILbase><span style='color:windowtext'>We now focus the spotlight on
the actual code of our control fff that resides in the file c.cs.<o:p></o:p></span></p>

<p class=ILbase><span style='color:windowtext'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=ILbase><span style='color:windowtext'>The container sets the value of
the property vvv to 73. Therefore, in the control, the property vvv gets called
initially. The set accessor initializes the int variable vvv1 to 73. <o:p></o:p></span></p>

<p class=ILbase><span style='color:windowtext'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=ILbase><span style='color:windowtext'>The function OnPaint is
responsible for drawing the rainbow of colors on the screen. In this function,
we first call the original OnPaint function. Then, we create two brushes to
obtain the desired effect. The first brush is a LinearGradientBrush, which can
be accessed using the Brush object bb.<span style="mso-spacerun: yes"> 
</span>The last parameter to the constructor of this brush is the starting
color cs, which has been initialized to Red, and an ending color ce that is
initialized to a value of LimeGreen. The second brush is a SolidBrush bd, which
is created to fill up any shape. The function FromArgb of the Color class
creates a new color, where the first parameter is an alpha value 200 and the
second parameter is the base color.<o:p></o:p></span></p>

<p class=ILbase><span style='color:windowtext'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=ILbase><span style='color:windowtext'>The Graphics property of
PaintEventArgs merely returns a Graphics object when we call function
FillRectangle. The two parameters to this function are : a Brush that
represents a gradient and the Size of the window whose value is stored in the
ClientRectangle property. If we stop at this stage, the red and the green
gradients will stand out glaringly. <o:p></o:p></span></p>

<p class=ILbase><span style='color:windowtext'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=ILbase><span style='color:windowtext'>Now, let us draw the black
rectangle separating the red and green colors. We create a temporary variable r
to store the dimensions of the window.<o:p></o:p></span></p>

<p class=ILbase><span style='color:windowtext'>Two instance variables, Max and
Min having a value of 100 and 0 respectively, are used to decide the factor by
which the property vvv should be divided. Since we need to retrieve the value
for the property, the get accessor is called.<span style="mso-spacerun: yes"> 
</span>The value contained in d decides on the value to be assigned to the
property. Initially d is false, so the value 73 contained in vvv1 is returned. <o:p></o:p></span></p>

<p class=ILbase><span style='color:windowtext'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=ILbase><span style='color:windowtext'>The float variable p now has a
value of .73. The Width of the window in our case is 600 pixels. Thus, the
variable 'a' is assigned a value of 438. You can use the WriteLine function to
display these values. The Width of the rectangle is reduced by this amount and
the X position is shifted by 438 pixels. Next, we draw the black rectangle
using the function FillRectangle by providing it with a black brush and the new
Rectangle object r. Modifying the value of the property vvv from 73 to 3 will
result in displaying the entire screen in black color. Thus, the vvv parameter
decides the size of the black rectangle; the smaller its value, the larger will
be the size of the rectangle. The Flush function ensures that all pending
graphic operations on the stack are executed immediately. If we stop here, the
gradient and the rectangle will be displayed, but no text will be displayed in
the center of the screen. <o:p></o:p></span></p>

<p class=ILbase><span style='color:windowtext'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=ILbase><span style='color:windowtext'>The Rectangular structure r1
stores the size and location of the rectangular region that our string
requires. The MeasureString function takes two parameters:<o:p></o:p></span></p>

<p class=ILbullets><span style='mso-bidi-font-size:12.0pt;font-family:"Times New Roman"'>•<span
style='mso-tab-count:1'>     </span></span>The first is a string value that is
stored in our property Text.</p>

<p class=ILbullets><span style='mso-bidi-font-size:12.0pt;font-family:"Times New Roman"'>•<span
style='mso-tab-count:1'>     </span></span>The second is a Font object. </p>

<p class=ILbase><span style='color:windowtext'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=ILbase><span style='color:windowtext'>The default Font property is
supplied for the second parameter. The function returns a SizeF object, whose
Width and Height determine the display region that the string requires. The
width and height of rectangle r1 is initialized to the Width and Height of the
string. As the string is to be displayed in the center of the form, objects X
and Y, which are the members of rectangle r1, are given the following values:<o:p></o:p></span></p>

<p class=ILbullets><span style='mso-bidi-font-size:12.0pt;font-family:"Times New Roman"'>•<span
style='mso-tab-count:1'>     </span></span>The Width of the form = the width of
the string divided by 2. </p>

<p class=ILbullets><span style='mso-bidi-font-size:12.0pt;font-family:"Times New Roman"'>•<span
style='mso-tab-count:1'>     </span></span>The Height of the form = the height
of the string divided by 2. </p>

<p class=ILbase><span style='color:windowtext'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=ILbase><span style='color:windowtext'>We then use the DrawString
function to display the text. This function takes the following parameters in
the specified order:<o:p></o:p></span></p>

<p class=ILbullets><span style='mso-bidi-font-size:12.0pt;font-family:"Times New Roman"'>•<span
style='mso-tab-count:1'>     </span></span>A string that is stored in the Text
property.</p>

<p class=ILbullets><span style='mso-bidi-font-size:12.0pt;font-family:"Times New Roman"'>•<span
style='mso-tab-count:1'>     </span></span>The default font.</p>

<p class=ILbullets><span style='mso-bidi-font-size:12.0pt;font-family:"Times New Roman"'>•<span
style='mso-tab-count:1'>     </span></span>The color of the brush that is
stored in the property ForeColor.</p>

<p class=ILbullets><span style='mso-bidi-font-size:12.0pt;font-family:"Times New Roman"'>•<span
style='mso-tab-count:1'>     </span></span>The region, which is stored in
object r1.</p>

<p class=ILbase><span style='color:windowtext'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=ILbase><span style='color:windowtext'>We have three mouse events that
trigger off three functions. They are as follows:<o:p></o:p></span></p>

<p class=ILbullets><span style='mso-bidi-font-size:12.0pt;font-family:"Times New Roman"'>•<span
style='mso-tab-count:1'>     </span></span>OnMouseMove: When we move the mouse.
</p>

<p class=ILbullets><span style='mso-bidi-font-size:12.0pt;font-family:"Times New Roman"'>•<span
style='mso-tab-count:1'>     </span></span>OnMouseDown: When we click the left
mouse button, with the mouse cursor placed on the form.</p>

<p class=ILbullets><span style='mso-bidi-font-size:12.0pt;font-family:"Times New Roman"'>•<span
style='mso-tab-count:1'>     </span></span>OnMouseUp: When we release the left
mouse button. </p>

<p class=ILbase><span style='color:windowtext'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=ILbase><span style='color:windowtext'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=ILbase><span style='color:windowtext'>If we move the mouse around,
nothing happens. This is because the 'if' statement results in a value of true,
as the variable d has a value of false. So, the function practically achieves
nothing. Clicking the left mouse button toggles the value of the variable d to
true. Thus, if the variable d is True, we know that the user has clicked the
left mouse button, and when it reverts back to false, we know that the left
mouse button has been released. The OnMouseMove function does something
constructive and gainful only when the left mouse button is depressed.<o:p></o:p></span></p>

<p class=ILbase><span style='color:windowtext'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=ILbase><span style='color:windowtext'>The Capture property reveals
whether the control has been able to capture the mouse or not. This property is
optional. When we click within the window, the framework is informed about our
victory over the mouse, and the variable d is set to true. The next most
pertinent action is to call function sss with a Point object. This object
stores the position at which the mouse has been clicked. The MouseEventArgs
parameter e, has two members X and Y, which identify the current position of
the mouse. <o:p></o:p></span></p>

<p class=ILbase><span style='color:windowtext'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=ILbase><span style='color:windowtext'>The function sss is called yet
again when the mouse is moved. The OnMouseUp function changes the value of
Capture, and sets the value of the boolean variable d to false. It also
initializes the value of a property vvv to dv. <o:p></o:p></span></p>

<p class=ILbase><span style='color:windowtext'>The net achievement of the
function sss is that, it calls the function OnPaint using the Invalidate
function. The OnPaint function does not draw or paint the entire form or
window, but only the specific part that has been invalidated. This is done to
achieve optimum efficiency, since it is preposterous to waste effort in
redrawing areas that have not been invalidated. The Invalidate function is also
passed a Rect object as a parameter, which takes a decision on the area of the
client rectangle that is to be re-drawn. <o:p></o:p></span></p>

<p class=ILbase><span style='color:windowtext'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=ILbase><span style='color:windowtext'>Function sss is therefore, given
a smaller Rect object as a parameter, which informs the OnPaint function about
the specific part of the form that should be invalidated. The Point parameter
is employed to determine the area of the form, that must be redrawn.<span
style="mso-spacerun: yes">  </span><o:p></o:p></span></p>

<p class=ILbase><span style='color:windowtext'>The co-ordinates of the entire
screen are stored in ClientRectangle. We also calculate a percentage p,
depending upon our current position, i.e. l.X, divided by the Width of the
screen. Next, we multiply this percentage by 100 (the difference between Max
and Min). The value of dv is stored in variable o, since we are initializing dv
to 'a' in the next line. <o:p></o:p></span></p>

<p class=ILbase><span style='color:windowtext'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=ILbase><span style='color:windowtext'>Two new percentage values, op
and np have been calculated. They are merely the values of o and dv divided by
100. Thereafter, we calculate the minimum and maximum values of ol and nl. The
new rectangle created is the Client Rectangle, where the minimum value is added
to X, and Y is left untouched. The Width is set to the difference of ma and mi,
and the Height is left unaltered. <o:p></o:p></span></p>

<p class=ILbase><span style='color:windowtext'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=ILbase><span style='color:windowtext'>The difference between variables
ma and mi is negligible. Correspondingly, the width of the invalidated region
too is insignificantly small. Further, mi is used to decide the position at
which the X of the black rectangle should commence. Thus, if we replace r1 with
ClientRectangle, everything would be hunky dory, but the screen will flicker a
great deal, while the mouse is in motion. This is because the same screen has
to be displayed when the movement ceases. Thus, to thwart this flicker, we
redraw only the specific part of the screen that has been invalidated.<o:p></o:p></span></p>

<p class=ILbase><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=ILbase><u><span style='mso-bidi-font-size:12.0pt;color:windowtext'>ScrollBar
Control</span></u><span style='color:windowtext'><o:p></o:p></span></p>

<p class=ILbase><span style='color:windowtext'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=ILprg><u>a.cs</u></p>

<p class=ILprg>using System.Drawing;</p>

<p class=ILprg>using System.Windows.Forms;</p>

<p class=ILprg>public class zzz : Form</p>

<p class=ILprg>{</p>

<p class=ILprg>VScrollBar v;</p>

<p class=ILprg>HScrollBar h;</p>

<p class=ILprg>PictureBox p; </p>

<p class=ILprg>Label l2; </p>

<p class=ILprg>Label l1; </p>

<p class=ILprg>bool<span style="mso-spacerun: yes">  </span>d = false;</p>

<p class=ILprg>int<span style="mso-spacerun: yes">   </span>ox, oy;</p>

<p class=ILprg>float vm;</p>

<p class=ILprg>float vp;</p>

<p class=ILprg>float hm;</p>

<p class=ILprg>float hp;</p>

<p class=ILprg>public zzz() </p>

<p class=ILprg>{</p>

<p class=ILprg>ClientSize = new System.Drawing.Size(520, 277);</p>

<p class=ILprg>l1 = new Label();</p>

<p class=ILprg>l1.Location = new System.Drawing.Point(408, 160);</p>

<p class=ILprg>l2 = new Label();</p>

<p class=ILprg>l2.Location = new Point(408, 184);</p>

<p class=ILprg>v = new VScrollBar();</p>

<p class=ILprg>v.Location = new Point(200, 24);</p>

<p class=ILprg>v.Size = new Size(16, 152);</p>

<p class=ILprg>v.Scroll += new ScrollEventHandler(vScroll);<span
style="mso-spacerun: yes">        </span></p>

<p class=ILprg>v.Minimum = -100;</p>

<p class=ILprg>h = new HScrollBar();</p>

<p class=ILprg>h.Location = new Point(16, 176);</p>

<p class=ILprg>h.Size = new Size(184, 16);</p>

<p class=ILprg>h.Scroll += new ScrollEventHandler(hScroll);</p>

<p class=ILprg>h.Minimum = -100;</p>

<p class=ILprg>p = new PictureBox();</p>

<p class=ILprg>Bitmap b = new Bitmap(&quot;water.bmp&quot;);</p>

<p class=ILprg>p.SizeMode = System.Windows.Forms.PictureBoxSizeMode.StretchImage;</p>

<p class=ILprg>p.Location = new Point(64, 32);</p>

<p class=ILprg>p.Size = new Size(96, 96);</p>

<p class=ILprg>p.Image = (Image)b;</p>

<p class=ILprg>p.MouseDown += new MouseEventHandler(pDown);</p>

<p class=ILprg>p.MouseUp += new MouseEventHandler(pUp);</p>

<p class=ILprg>p.MouseMove += new MouseEventHandler(pMove);</p>

<p class=ILprg>Controls.Add(l2);</p>

<p class=ILprg>Controls.Add(l1);</p>

<p class=ILprg>Controls.Add(h);</p>

<p class=ILprg>Controls.Add(v);</p>

<p class=ILprg>Controls.Add(p);</p>

<p class=ILprg>v.LargeChange = 20;</p>

<p class=ILprg>h.LargeChange = 20;</p>

<p class=ILprg>v.SmallChange = 1;</p>

<p class=ILprg>h.SmallChange = 1;</p>

<p class=ILprg>vmf();</p>

<p class=ILprg>hmf();</p>

<p class=ILprg>l1.Text = h.Value.ToString();</p>

<p class=ILprg>l2.Text = v.Value.ToString();</p>

<p class=ILprg>p.Cursor = Cursors.SizeAll;</p>

<p class=ILprg>}</p>

<p class=ILprg>void vmf()</p>

<p class=ILprg>{</p>

<p class=ILprg>float hsb = (float)(v.Height - p.Height);</p>

<p class=ILprg>float ticks = (float)(v.Maximum - v.Minimum);</p>

<p class=ILprg>vm = hsb / ticks;</p>

<p class=ILprg>}</p>

<p class=ILprg>void hmf()</p>

<p class=ILprg>{</p>

<p class=ILprg>float hsb = (float)(h.Width - p.Width) ;</p>

<p class=ILprg>float ticks = (float)(h.Maximum - h.Minimum) ;</p>

<p class=ILprg>hm = hsb / ticks ;</p>

<p class=ILprg>}</p>

<p class=ILprg>void vScroll(object sender, ScrollEventArgs e)</p>

<p class=ILprg>{</p>

<p class=ILprg>l2.Text = v.Value.ToString() ;</p>

<p class=ILprg>vp = (float)(v.Value- v.Minimum);</p>

<p class=ILprg>p.Top = v.Bottom - (int)(vm * vp) - p.Height;</p>

<p class=ILprg>}</p>

<p class=ILprg>void hScroll(object sender, ScrollEventArgs e)</p>

<p class=ILprg>{</p>

<p class=ILprg>l1.Text = h.Value.ToString() ;</p>

<p class=ILprg>hp = (float)(h.Value - h.Minimum);</p>

<p class=ILprg>p.Left = h.Right - (int)(hm * hp) - p.Width;</p>

<p class=ILprg>}</p>

<p class=ILprg>void pDown(object s, MouseEventArgs e)</p>

<p class=ILprg>{</p>

<p class=ILprg>d = true;</p>

<p class=ILprg>ox = e.X;</p>

<p class=ILprg>oy = e.Y;</p>

<p class=ILprg>}</p>

<p class=ILprg>void pMove(object s, MouseEventArgs e)</p>

<p class=ILprg>{</p>

<p class=ILprg>if (d)</p>

<p class=ILprg>{</p>

<p class=ILprg>int minY = v.Minimum;</p>

<p class=ILprg>int maxY = v.Maximum;</p>

<p class=ILprg>int minX = h.Minimum;</p>

<p class=ILprg>int maxX = h.Maximum;</p>

<p class=ILprg>int value = (int)(v.Value - (e.Y - oy)/vm);</p>

<p class=ILprg>if (value &lt; minY)</p>

<p class=ILprg>{</p>

<p class=ILprg>v.Value = minY;</p>

<p class=ILprg>}</p>

<p class=ILprg>else if (value &gt; maxY - v.LargeChange + 1)</p>

<p class=ILprg>{</p>

<p class=ILprg>v.Value = maxY - v.LargeChange + 1;</p>

<p class=ILprg>}</p>

<p class=ILprg>else</p>

<p class=ILprg>{</p>

<p class=ILprg>v.Value = value;</p>

<p class=ILprg>}</p>

<p class=ILprg>value = (int)(h.Value - (e.X - ox)/hm);</p>

<p class=ILprg>if (value &lt; minX)</p>

<p class=ILprg>{</p>

<p class=ILprg>h.Value = minX;</p>

<p class=ILprg>}</p>

<p class=ILprg>else if (value &gt; maxX - h.LargeChange + 1)</p>

<p class=ILprg>{</p>

<p class=ILprg>h.Value = maxX - h.LargeChange + 1;</p>

<p class=ILprg>}</p>

<p class=ILprg>else</p>

<p class=ILprg>{</p>

<p class=ILprg>h.Value = value;</p>

<p class=ILprg>}</p>

<p class=ILprg>l1.Text = h.Value.ToString() ;</p>

<p class=ILprg>l2.Text = v.Value.ToString() ;</p>

<p class=ILprg>value = p.Top + (e.Y - oy);</p>

<p class=ILprg>if (value &lt; v.Top)</p>

<p class=ILprg>{</p>

<p class=ILprg>value = v.Top;</p>

<p class=ILprg>}</p>

<p class=ILprg>else if (value &gt; v.Bottom - p.Height)</p>

<p class=ILprg>{</p>

<p class=ILprg>value = v.Bottom - p.Height;</p>

<p class=ILprg>}</p>

<p class=ILprg>p.Top = value;</p>

<p class=ILprg>value = p.Left + (e.X - ox);</p>

<p class=ILprg>if (value &lt; h.Left)</p>

<p class=ILprg>{</p>

<p class=ILprg>value = h.Left;</p>

<p class=ILprg>}</p>

<p class=ILprg>else if (value &gt; h.Right - p.Width)</p>

<p class=ILprg>{</p>

<p class=ILprg>value = h.Right - p.Width;</p>

<p class=ILprg>}</p>

<p class=ILprg>p.Left = value;</p>

<p class=ILprg>}</p>

<p class=ILprg>}</p>

<p class=ILprg>void pUp(object s, MouseEventArgs e)</p>

<p class=ILprg>{</p>

<p class=ILprg>d = false;</p>

<p class=ILprg>}</p>

<p class=ILprg>public static void Main()</p>

<p class=ILprg>{</p>

<p class=ILprg>Application.Run(new zzz());</p>

<p class=ILprg>}</p>

<p class=ILprg>}</p>

<p class=ILbase><span style='color:windowtext'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=ILoutput>&gt;csc a.cs</p>

<p class=ILbase><span style='color:windowtext'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=ILbase><span style='color:windowtext'>Before running the program, copy
the file water.bmp into the current directory. This file is provided along with
the samples in the installation program. The singular methodology to comprehend
large programs is by first examining their output, because the output will
motivate you to grasp the program. <o:p></o:p></span></p>

<p class=ILbase><span style='color:windowtext'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=ILbase><span style='color:windowtext'>We see two scrollbars, one
vertical and the other horizontal, with a picture within them. Clicking on the
scrollbars will move the picture in the direction of the scrollbar that is
clicked. Let us understand how this is achieved.<o:p></o:p></span></p>

<p class=ILbase><span style='color:windowtext'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<table border=0 cellspacing=0 cellpadding=0 style='border-collapse:collapse;
 mso-padding-alt:0in 5.4pt 0in 5.4pt'>
 <tr>
  <td valign=top style='padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal><img width=546 height=301 id="_x0000_i1074"
  src="chap4img/Image42.jpg"></p>
  </td>
 </tr>
 <tr>
  <td valign=top style='padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal>Screen 4.42</p>
  </td>
 </tr>
</table>

<p class=ILbase><span style='color:windowtext'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=ILbase><span style='color:windowtext'>We start by examining the
constructor of class zzz. The default client size is modified to the desired
size. Then, there are two labels </span><span style='font-family:"Trebuchet MS";
color:windowtext'>l1</span><span style='color:windowtext'> and </span><span
style='font-family:"Trebuchet MS";color:windowtext'>l2</span><span
style='color:windowtext'>, which display the current values of the two scroll
bars. A vertical scrollbar v is an instance of a class VScrollBar, and a
horizontal scrollbar h is an instance of a class HScrollBar. As is customary,
we provide a Location and a Size to the scrollbar. The Minimum and Maximum
properties decide the range of values that the user can select. Most controls such
as a Text box or a Combo box already have a scroll bar built into them. Hence,
they do not require this control. The Scroll event gets triggered whenever the
scroll button moves. The button can be moved either by using a mouse or by the
keyboard. Moving the vertical scroll button will call the vScroll function,
whereas moving the horizontal scroll button will call the hScroll function. <o:p></o:p></span></p>

<p class=ILbase><span style='color:windowtext'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=ILbase><span style='color:windowtext'>After setting the properties of
the Scroll Bar, we create an object p, which is an instance of a PictureBox
class. Next, we create a Bitmap object, and in the constructor, we pass the
file water.bmp to it. The SizeMode decides on the display of the image in the
Picture Box. The enum value of StretchImage stretches the image to fit it into
the PictureBox, whereas, the enum value of Normal places it in the upper left
corner.<o:p></o:p></span></p>

<p class=ILbase><span style='color:windowtext'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=ILbase><span style='color:windowtext'>The image property is assigned
to the picture or the bitmap that is to be displayed. Three event handlers are
attached to the image:<o:p></o:p></span></p>

<p class=ILbullets><span style='mso-bidi-font-size:12.0pt;font-family:"Times New Roman"'>•<span
style='mso-tab-count:1'>     </span></span>pDown : This is called each time we
click in the picture.</p>

<p class=ILbullets><span style='mso-bidi-font-size:12.0pt;font-family:"Times New Roman"'>•<span
style='mso-tab-count:1'>     </span></span>pUp : This is called when we release
the mouse button. </p>

<p class=ILbullets><span style='mso-bidi-font-size:12.0pt;font-family:"Times New Roman"'>•<span
style='mso-tab-count:1'>     </span></span>pMove : This is called when we move
the mouse within the picture. </p>

<p class=ILbase><span style='color:windowtext'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=ILbase><span style='color:windowtext'>Finally, all the controls i.e.
two labels, two scroll bars and one image, are appended to the Control class. <o:p></o:p></span></p>

<p class=ILbase><span style='color:windowtext'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=ILbase><span style='color:windowtext'>The property of LargeChange in
the scrollbar control decides on the magnitude of the change in the value of
the scroll bar, when the scroll bar is clicked. The SmallChange property is
associated with the arrows on the scroll bar. We have set the LargeChange
property to 20 and the SmallChange to 1.<o:p></o:p></span></p>

<p class=ILbase><span style='color:windowtext'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=ILbase><span style='color:windowtext'>To dispel the banality of the
somber explanation given above, let us digress slightly to present a small,
albeit important, elucidation on how Windows handles the art of scrolling. <o:p></o:p></span></p>

<p class=ILbase><span style='color:windowtext'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<table border=0 cellspacing=0 cellpadding=0 style='border-collapse:collapse;
 mso-padding-alt:0in 5.4pt 0in 5.4pt'>
 <tr>
  <td valign=top style='padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal><img width=546 height=301 id="_x0000_i1075"
  src="chap4img/Image43.jpg"></p>
  </td>
 </tr>
 <tr>
  <td valign=top style='padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal>Screen 4.43</p>
  </td>
 </tr>
</table>

<p class=ILbase><span style='color:windowtext'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=ILbase><span style='color:windowtext'>The value of the scrollbar
ranges between the minimum and the maximum. The maximum value is LargeChange+1.
The rationale behind this is that, the scrollbar has a property called Value,
which represents the position of the top of the thumb. The size of the
scrollbar's thumb is equal to the page value or LargeChange. When we reach the
last page, or when the thumb reaches the end of the scroll bar, whereupon, we
cannot scroll any further, the value property will always be shown less than
the maximum. <o:p></o:p></span></p>

<p class=ILbase><span style='color:windowtext'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=ILbase><span style='color:windowtext'>We shall now beguile you with
the concepts of the vertical scroll bars. The explanation for the horizontal
scroll bars is much the same. <o:p></o:p></span></p>

<p class=ILbase><span style='color:windowtext'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=ILbase><span style='color:windowtext'>The function vmf, which is
called from the constructor, initializes 3 variables. The Height of the
Vertical scroll bar is 152 pixels because the Size property of the scrollbar is
initialized to this value. The Height of the picture is 96 pixels because the
Size property of the picture is initialized to this value. The difference
between these two heights, which is 56 pixels, is stored in the variable
hsb.<span style="mso-spacerun: yes">  </span>The variable named ticks stores a
value, which is within a range that the vertical scroll bar can handle. <o:p></o:p></span></p>

<p class=ILbase><span style='color:windowtext'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=ILbase><span style='color:windowtext'>A Tick happens to be the
smallest increment that a scrollbar can make. In our case, as the Minimum is
-100 and the Maximum is 100, the range of value stored in ticks becomes 200.
This variable represents the ticks that the scroll bar needs in order to move
from one end to the other. In the same vein, the variable hsb denotes the
amount of pixels the image needs to be relocated from one end of the scroll bar
to another. This is calculated by subtracting the height of the image from the
height of the scroll bar. <o:p></o:p></span></p>

<p class=ILbase><span style='color:windowtext'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<table border=0 cellspacing=0 cellpadding=0 style='border-collapse:collapse;
 mso-padding-alt:0in 5.4pt 0in 5.4pt'>
 <tr>
  <td valign=top style='padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal><img width=546 height=301 id="_x0000_i1076"
  src="chap4img/Image44.jpg"></p>
  </td>
 </tr>
 <tr>
  <td valign=top style='padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal>Screen 4.44</p>
  </td>
 </tr>
</table>

<p class=ILbase><span style='color:windowtext'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=ILbase><span style='color:windowtext'>Dividing 56 (the number of
pixels to be moved) by 200 (the total number of ticks available), gives us a
value of .28. Thus, every tick moved by the scroll bar moves the image by .28
pixels. This value, known as the 'pixels per tick', is stored in vm. A similar
routine is followed for the hmf function while implementing a horizontal scroll
bar.<o:p></o:p></span></p>

<p class=ILbase><span style='color:windowtext'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=ILbase><span style='color:windowtext'>The labels initially display
zero, since this is the default value stored in the property value. The cursor
property of the picture is changed to SizeAll. As a result of this, whenever
the cursor moves into the picture, it's shape changes into a four-headed
monster. <o:p></o:p></span></p>

<p class=ILbase><span style='color:windowtext'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=ILbase><span style='color:windowtext'>At the outset, we want to move
the picture downwards. So, we click on the vertical scroll bar. This movement
calls the vScroll function. In this function, we initialize the Text property
of the label </span><span style='font-family:"Trebuchet MS";color:windowtext'>l2</span><span
style='color:windowtext'> to the Value property of the vertical scroll bar v.
Then, variable vp is calculated, whose value is the current value of the scroll
bar, i.e. the value of the Minimum property of the scroll bar. <o:p></o:p></span></p>

<p class=ILbase><span style='color:windowtext'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=ILbase><span style='color:windowtext'>Every downward movement of the
scroll bar increments the Value property by 1. This is because, the value of
property SmallChange has been initialized to 1. Thus, the value of vp will
commence at 100 and will keep escalating thereafter. The value stored in the
Bottom property of the scroll bar is 176 and the Height of the picture is 96
pixels. Thus, the picture will start at 52 pixels, and then, the distance
between the picture and the bottom property will start reducing.<o:p></o:p></span></p>

<p class=ILbase><span style='color:windowtext'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=ILbase><span style='color:windowtext'>The formula for computing the
top position where the picture should be placed is as follows: the Bottom of
the scroll bar, minus the pixels per tick, multiplied by the current value of
the property Value, minus the Height of the picture, plus the value of Minimum.
<o:p></o:p></span></p>

<p class=ILbase><span style='color:windowtext'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=ILbase><span style='color:windowtext'>Now, let us do the reverse i.e.
let us move the picture around and see how the scroll bars behave. Also, let us
observe the corresponding transformation in the values. To move the picture, we
first have to click on it with the left mouse button. This calls function
pDown. In this function, the value of variable d, which is a boolean, is set to
true. Simultaneously, in the function pUp, the value of variable d is set to
false. <o:p></o:p></span></p>

<p class=ILbase><span style='color:windowtext'>The parameter e of
MouseEventArgs has two members X and Y, which furnish the co-ordinates of the
mouse pointer with regard to the picture, rather than the window or form. We
save these values in the variables ox and oy, which will be utilized to
calculate the distance that the picture has been dragged. <o:p></o:p></span></p>

<p class=ILbase><span style='color:windowtext'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=ILbase><span style='color:windowtext'>The function pMove is the focus
of all attention since, this is where the real excitement action lies! We place
all the code in a large if statement, which results in true when the variable d
is true. This occurs only when the mouse button is depressed. Each time the
function is called, the minimum and maximum values of the scroll bars are
stored in 4 variables. This is futile, since the values always remain constant.<o:p></o:p></span></p>

<p class=ILbase><span style='color:windowtext'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=ILbase><span style='color:windowtext'>We calculate a variable called
Value as follows: <o:p></o:p></span></p>

<p class=ILbase><span style='color:windowtext'>The initial Y position of the
mouse before its dragging commenced, minus the current Y position of the mouse.
The result is then divided by the multiplier to convert the pixels into scroll
bar ticks. This simulates the scroll bar scrolling in the opposite direction. <o:p></o:p></span></p>

<p class=ILbase><span style='color:windowtext'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=ILbase><span style='color:windowtext'>If the new value of variable
Value is less than the minimum value allowed for the scroll bar, the property
of the scroll bar v is set to the minimum possible. If the value is larger than
the maximum permissible value, then it is initialized to the largest possible
value. This concept has been explained in the small note we earlier presented
on scrolling. If none of the above hold true, then we merely change the
property Value of the scroll bar to the variable Value. These are simple error
checks. The labels </span><span style='font-family:"Trebuchet MS";color:windowtext'>l1</span><span
style='color:windowtext'> and </span><span style='font-family:"Trebuchet MS";
color:windowtext'>l2</span><span style='color:windowtext'> are also updated. <o:p></o:p></span></p>

<p class=ILbase><span style='color:windowtext'>The above explanation is also
relevant for the horizontal scroll bar. <o:p></o:p></span></p>

<p class=ILbase><span style='color:windowtext'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=ILbase><span style='color:windowtext'>The property Top of the picture
has to be updated to take into account the new position. This is also stored in
the variable value and computed as follows: <o:p></o:p></span></p>

<p class=ILbase><span style='color:windowtext'>The original Top property value,
plus the current position of the mouse, minus the position of the mouse before
the dragging commenced. <o:p></o:p></span></p>

<p class=ILbase><span style='color:windowtext'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=ILbase><span style='color:windowtext'>Like before, we make sure that
we do not exceed the Top and Bottom limits of the scroll bar. The picture has
to be contained within the scroll bars. If it is smaller than the Top property
of the scroll bar, we change the value to that of the Top property. The same
holds true for the Bottom. Finally, we initialize the Top property of the
picture to Value and do the same for the Left property.<o:p></o:p></span></p>

<p class=ILbase><span style='color:windowtext'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=ILbase><u><span style='mso-bidi-font-size:12.0pt;color:windowtext'>Up
Down Control</span></u><span style='color:windowtext'><o:p></o:p></span></p>

<p class=ILbase><span style='color:windowtext'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=ILprg><u>a.cs</u></p>

<p class=ILprg>using System;</p>

<p class=ILprg>using System.Drawing;</p>

<p class=ILprg>using System.Windows.Forms;</p>

<p class=ILprg>public class zzz : Form {</p>

<p class=ILprg>DomainUpDown u; </p>

<p class=ILprg>NumericUpDown n;</p>

<p class=ILprg>DomainUpDown a;</p>

<p class=ILprg>public zzz() {</p>

<p class=ILprg>ClientSize = new Size(504, 352);</p>

<p class=ILprg>n = new NumericUpDown();</p>

<p class=ILprg>n.Location = new Point(132, 132);</p>

<p class=ILprg>n.Maximum = new System.Decimal(100d);</p>

<p class=ILprg>n.Minimum = new System.Decimal(0d);</p>

<p class=ILprg>n.DecimalPlaces = 2;</p>

<p class=ILprg>n.Text = &quot;0.00&quot;;</p>

<p class=ILprg>Controls.Add(n);</p>

<p class=ILprg>a = new DomainUpDown();</p>

<p class=ILprg>a.Location = new Point(152, 32);</p>

<p class=ILprg>a.Size = new Size(120, 23);</p>

<p class=ILprg>a.SelectedItemChanged += new EventHandler(abc);</p>

<p class=ILprg>Controls.Add(a);</p>

<p class=ILprg>u = new DomainUpDown();</p>

<p class=ILprg>u.Location = new Point(152, 64);</p>

<p class=ILprg>u.SelectedItemChanged += new EventHandler(pqr);</p>

<p class=ILprg>Controls.Add(u);</p>

<p class=ILprg>a.Items.Add(new yyy(&quot;Center&quot;,(int) HorizontalAlignment.Center));</p>

<p class=ILprg>a.Items.Add(new
yyy(&quot;Left&quot;,(int)HorizontalAlignment.Left));</p>

<p class=ILprg>a.Items.Add(new
yyy(&quot;Right&quot;,(int)HorizontalAlignment.Right));</p>

<p class=ILprg>u.Items.Add(new
yyy(&quot;Left&quot;,(int)LeftRightAlignment.Left));</p>

<p class=ILprg>u.Items.Add(new
yyy(&quot;Right&quot;,(int)LeftRightAlignment.Right));</p>

<p class=ILprg>u.SelectedIndex = 1;</p>

<p class=ILprg>}</p>

<p class=ILprg>void pqr(object s, EventArgs e)</p>

<p class=ILprg>{</p>

<p class=ILprg>yyy c = (yyy)(u.Items[u.SelectedIndex]) ;</p>

<p class=ILprg>n.UpDownAlign = (LeftRightAlignment)(c.i);</p>

<p class=ILprg>}</p>

<p class=ILprg>void abc(object s, EventArgs e)</p>

<p class=ILprg>{</p>

<p class=ILprg>yyy c = (yyy)(a.Items[a.SelectedIndex]) ;</p>

<p class=ILprg>n.TextAlign = (HorizontalAlignment)(c.i);</p>

<p class=ILprg>}</p>

<p class=ILprg>public static void Main()</p>

<p class=ILprg>{</p>

<p class=ILprg>Application.Run(new zzz());</p>

<p class=ILprg>}</p>

<p class=ILprg>class yyy</p>

<p class=ILprg>{</p>

<p class=ILprg>public string s;</p>

<p class=ILprg>public int i;</p>

<p class=ILprg>public yyy(string sz, int n)</p>

<p class=ILprg>{</p>

<p class=ILprg>s=sz;</p>

<p class=ILprg>i=n;</p>

<p class=ILprg>}</p>

<p class=ILprg>public override string ToString()</p>

<p class=ILprg>{</p>

<p class=ILprg>return s;</p>

<p class=ILprg>}</p>

<p class=ILprg>}</p>

<p class=ILprg>}</p>

<p class=ILbase><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<table border=0 cellspacing=0 cellpadding=0 style='border-collapse:collapse;
 mso-padding-alt:0in 5.4pt 0in 5.4pt'>
 <tr>
  <td valign=top style='padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal><img width=556 height=405 id="_x0000_i1077"
  src="chap4img/Image45.jpg"></p>
  </td>
 </tr>
 <tr>
  <td valign=top style='padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal>Screen 4.45</p>
  </td>
 </tr>
</table>

<p class=ILbase><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=ILbase><span style='color:windowtext'>In the above program, we have a
NumericUpDown control called n. A NumericUpDown control is used when we have a
single numeric value that<span style="mso-spacerun: yes">  </span>needs to be
incremented or decremented. <o:p></o:p></span></p>

<p class=ILbase><span style='color:windowtext'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<table border=0 cellspacing=0 cellpadding=0 style='border-collapse:collapse;
 mso-padding-alt:0in 5.4pt 0in 5.4pt'>
 <tr>
  <td valign=top style='padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal><img width=556 height=405 id="_x0000_i1078"
  src="chap4img/Image46.jpg"></p>
  </td>
 </tr>
 <tr>
  <td valign=top style='padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal>Screen 4.46</p>
  </td>
 </tr>
</table>

<p class=ILbase><span style='color:windowtext'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=ILbase><span style='color:windowtext'>This can be done by clicking on
the Up and Down buttons of the control respectively. This control has a
property called ReadOnly, which has a value of False by default. <o:p></o:p></span></p>

<p class=ILbase><span style='color:windowtext'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=ILbase><span style='color:windowtext'>This allows entry of a value
directly in the control if the user finds it too bothersome to click on the
buttons to do so. From this perspective, it operates akin to a text box. The
properties Minimum and Maximum specify the minimum and maximum values that the
control can accept. Under no circumstances will the control permit us to exceed
the range specified by the above two properties. Thus, error checking has been
built into the control. <o:p></o:p></span></p>

<p class=ILbase><span style='color:windowtext'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=ILbase><span style='color:windowtext'>A NumericUpDown control has a
large number of properties such as DecimalPlaces, Hexadecimal,
ThousandsSeparator etc. These properties format the value that is displayed
using the Text property. <o:p></o:p></span></p>

<p class=ILbase><span style='color:windowtext'>Their roles are as follows:<o:p></o:p></span></p>

<p class=ILbullets><span style='mso-bidi-font-size:12.0pt;font-family:"Times New Roman"'>•<span
style='mso-tab-count:1'>     </span></span>The DecimalPlaces property controls
the number of decimal places.</p>

<p class=ILbullets><span style='mso-bidi-font-size:12.0pt;font-family:"Times New Roman"'>•<span
style='mso-tab-count:1'>     </span></span>The Hexadecimal property displays
numbers in hexadecimal format. </p>

<p class=ILbullets><span style='mso-bidi-font-size:12.0pt;font-family:"Times New Roman"'>•<span
style='mso-tab-count:1'>     </span></span>The ThousandsSeparator property
decides on the character to be used to separate the 1000s. This is because the
comma is not the universally accepted separator. </p>

<p class=ILbase><span style='color:windowtext'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=ILbase><span style='color:windowtext'>The Increment property of the
control which has a default value of 1 decides on the amount of
increase/decrease in the number. each time we click on the up or down buttons.
n.Increment=10; will increase the number by 10. The two functions ParseEditText
and UpdateEditText get called with every change in the number. <o:p></o:p></span></p>

<p class=ILbase><span style='color:windowtext'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=ILbase><span style='color:windowtext'>Thereafter, two DomainUpDown
controls, which behave in a manner similar to a NumericUpDown control, are
created. These controls display a string instead of a number. Thus, the value
passed to this control can be of any class, since all classes are derived from
object. The user can also type in text directly. The value typed in must
obviously match an item in the collection. The ToString function of the object
is called, to display the value in the up-down control. <o:p></o:p></span></p>

<p class=ILbase><span style='color:windowtext'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=ILbase><span style='color:windowtext'>The DomainUpDown control has a
property called Items, that returns a DomainUpDown.DomainUpDownItems object.
This object represents the object collection. Thus, we can use the Add or
Remove methods from the above collection to add or remove the items
individually. The Sort property sorts the collection. We pass an object like
yyy to the Add function, which accepts a string and an enum called
HorizontalAlignment. The enum value is stored in the variable i to facilitate
its retrieval at a later stage.<o:p></o:p></span></p>

<p class=ILbase><span style='color:windowtext'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=ILbase><span style='color:windowtext'>Each time we click on the
control, function abc gets called. This is because the SelectedItemChanged
event has been initialized to this function. In this function, we use the
property SelectedIndex, which returns a number depicting the item that has been
selected. The property is used as an array index. It returns the yyy object at
that index. We store this object in c and then, access the variable i stored in
the object yyy. <o:p></o:p></span></p>

<p class=ILbase><span style='color:windowtext'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=ILbase><span style='color:windowtext'>Thus, the entire object yyy is
stored as part of the collection. The string and the int can both be accessed
together. If the SelectedIndex property is not set, it will not display any
value in the control.<o:p></o:p></span></p>

<p class=ILbase><span style='color:windowtext'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=ILbase><u><span style='mso-bidi-font-size:12.0pt;color:windowtext'>DateTimePicker
Control</span></u><span style='color:windowtext'><o:p></o:p></span></p>

<p class=ILbase><span style='color:windowtext'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=ILprg><u>a.cs</u></p>

<p class=ILprg>using System;</p>

<p class=ILprg>using System.Drawing;</p>

<p class=ILprg>using System.Windows.Forms;</p>

<p class=ILprg>public class zzz : Form {</p>

<p class=ILprg>DateTimePicker d;</p>

<p class=ILprg>public zzz() {</p>

<p class=ILprg>ClientSize = new Size(504, 293);</p>

<p class=ILprg>d = new DateTimePicker();</p>

<p class=ILprg>d.Location = new Point(24, 24);</p>

<p class=ILprg>d.CalendarFont = new Font(&quot;Times New Roman&quot;, 8f);</p>

<p class=ILprg>d.Size = new Size(200, 20);</p>

<p class=ILprg>d.CalendarForeColor = System.Drawing.SystemColors.WindowText;</p>

<p class=ILprg>d.ShowCheckBox = true;</p>

<p class=ILprg>d.ForeColor = System.Drawing.SystemColors.WindowText;</p>

<p class=ILprg>d.Format = System.Windows.Forms.DateTimePickerFormat.Custom;</p>

<p class=ILprg>d.BackColor = System.Drawing.SystemColors.Window;</p>

<p class=ILprg>d.CustomFormat = &quot;\'Date : \'yy MM d - HH\':\'mm\':\'s
ddd&quot;;</p>

<p class=ILprg>d.Anchor = AnchorStyles.Top|AnchorStyles.Right |
AnchorStyles.Left;</p>

<p class=ILprg>DateTime now = DateTime.Now;</p>

<p class=ILprg>d.Value = now;</p>

<p class=ILprg>Controls.Add(d);</p>

<p class=ILprg>}</p>

<p class=ILprg>public static void Main()</p>

<p class=ILprg>{</p>

<p class=ILprg>Application.Run(new zzz());</p>

<p class=ILprg>}</p>

<p class=ILprg>}</p>

<p class=ILbase><span style='color:windowtext'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<table border=0 cellspacing=0 cellpadding=0 style='border-collapse:collapse;
 mso-padding-alt:0in 5.4pt 0in 5.4pt'>
 <tr>
  <td valign=top style='padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal><img width=546 height=329 id="_x0000_i1079"
  src="chap4img/Image47.jpg"></p>
  </td>
  <td valign=top style='padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal><img width=546 height=329 id="_x0000_i1080"
  src="chap4img/Image48.jpg"></p>
  </td>
 </tr>
 <tr>
  <td valign=top style='padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal>Screen 4.47</p>
  </td>
  <td valign=top style='padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal>Screen 4.48</p>
  </td>
 </tr>
</table>

<p class=ILbase><span style='color:windowtext'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=ILbase><span style='color:windowtext'>On running the above program, we
see a listbox displaying a date. This date is the system date. You may wonder
as to what is the big deal about displaying a simple date. But, when you click
on the down arrow of the list box, a fine-looking calendar springs up! The
current date is shown highlighted in red. If you click on any date, it will be
instantly displayed in the list box. Once the date has been chosen, the
calendar vanishes. You can change the month by clicking on the arrows, which
are on the left and right of the month. <o:p></o:p></span></p>

<p class=ILbase><span style='color:windowtext'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=ILbase><span style='color:windowtext'>Now, let us get behind the
scenes and unravel the mysteries of this program. We first create an object d
as an instance of class DateTimePicker, thus encapsulating the standard Windows
date time picker control. The control has all the standard properties like
Location, Size, Color etc. The default size, in the case of the DateTimePicker,
is a width of 200 pixels and a height of 23 pixels. The colors of the control
can be changed using CalendarForeColor and ForeColor. The property CalendarFont
decides on the font to be used to display the dates.<o:p></o:p></span></p>

<p class=ILbase><span style='color:windowtext'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<table border=0 cellspacing=0 cellpadding=0 style='border-collapse:collapse;
 mso-padding-alt:0in 5.4pt 0in 5.4pt'>
 <tr>
  <td valign=top style='padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal><img width=546 height=329 id="_x0000_i1081"
  src="chap4img/Image49.jpg"></p>
  </td>
 </tr>
 <tr>
  <td valign=top style='padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal>Screen 4.49</p>
  </td>
 </tr>
</table>

<p class=ILbase><span style='color:windowtext'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=ILbase><span style='color:windowtext'>The ShowCheckBox property ,
which has the default value of false, is set to true, in order to display a
check box on the extreme left of the date displayed in the control. The
checkbox presently is checked.<span style="mso-spacerun: yes">  </span><o:p></o:p></span></p>

<p class=ILbase><span style='color:windowtext'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=ILbase><span style='color:windowtext'>If the checkbox is checked, the
date is valid. If not, the date is said to be unset.<o:p></o:p></span></p>

<p class=ILbase><span style='color:windowtext'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=ILbase><span style='color:windowtext'>The Format property of the
control, which is initialized to Custom, decides the display format of the date
and time in the control. This property can be initialized to any four of the
following enums: Custom, Short, Long and Time. The last three values use the
operating system's format options. <o:p></o:p></span></p>

<p class=ILbase><span style='color:windowtext'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=ILbase><span style='color:windowtext'>Since the Format property has
been given the value of Custom, the property CustomFormat decides on the
display format of the date in the control. This property is initialized as
follows: The word Date:, followed by the year, month and day separated by a
space, followed by a minus sign and finally, the time. The three ‘ddd’
represent the day of the week in words. <o:p></o:p></span></p>

<p class=ILbase><span style='color:windowtext'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=ILbase><span style='color:windowtext'>The Now property of the DateTime
class, that returns the current day, is finally assigned to the Value property
of the picker class, which then gets displayed in the control.<o:p></o:p></span></p>

<p class=ILbase><span style='color:windowtext'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=ILbase><u><span style='mso-bidi-font-size:12.0pt;color:windowtext'>LinkLabel
Control: </span></u><span style='color:windowtext'><o:p></o:p></span></p>

<p class=ILbase><span style='color:windowtext'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=ILprg><u>a.cs</u></p>

<p class=ILprg>using System;</p>

<p class=ILprg>using System.Windows.Forms;</p>

<p class=ILprg>using System.Drawing;</p>

<p class=ILprg>public class zzz : Form {</p>

<p class=ILprg>PropertyGrid pg;</p>

<p class=ILprg>LinkLabel l;</p>

<p class=ILprg>Panel p;</p>

<p class=ILprg>GroupBox g; </p>

<p class=ILprg>public zzz() {</p>

<p class=ILprg>l = new LinkLabel();</p>

<p class=ILprg>l.DisabledLinkColor = (Color)System.Drawing.Color.Blue;</p>

<p class=ILprg>l.ForeColor = (Color)System.Drawing.Color.Gainsboro;</p>

<p class=ILprg>l.Location = new System.Drawing.Point(32, 128);</p>

<p class=ILprg>l.BackColor = (Color)System.Drawing.Color.Transparent;</p>

<p class=ILprg>l.LinkArea = new LinkArea(13, 28);</p>

<p class=ILprg>l.Font = new System.Drawing.Font(&quot;Tahoma&quot;, 12f,
System.Drawing.FontStyle.Bold, System.Drawing.GraphicsUnit.World);</p>

<p class=ILprg>l.Text = &quot;please click on sonal to see a message box&quot;;</p>

<p class=ILprg>l.Size = new System.Drawing.Size(136, 96);</p>

<p class=ILprg>l.LinkClicked += new LinkLabelLinkClickedEventHandler(abc);</p>

<p class=ILprg>ClientSize = new System.Drawing.Size(504, 445);</p>

<p class=ILprg>pg = new PropertyGrid();</p>

<p class=ILprg>pg.Dock = System.Windows.Forms.DockStyle.Fill;</p>

<p class=ILprg>pg.Location = new System.Drawing.Point(3, 16);</p>

<p class=ILprg>pg.CommandsVisibleIfAvailable = true;</p>

<p class=ILprg>pg.Text = &quot;propertyGrid1&quot;;</p>

<p class=ILprg>pg.Size = new System.Drawing.Size(242, 405);</p>

<p class=ILprg>pg.SelectedObject = l ;</p>

<p class=ILprg>g = new GroupBox();</p>

<p class=ILprg>g.Location = new System.Drawing.Point(248, 16);</p>

<p class=ILprg>g.Anchor = AnchorStyles.Top|AnchorStyles.Right |
AnchorStyles.Left;</p>

<p class=ILprg>g.Text = &quot;LinkLabel Properties&quot;;</p>

<p class=ILprg>g.Size = new System.Drawing.Size(248, 424);</p>

<p class=ILprg>g.Controls.Add(pg);</p>

<p class=ILprg>Controls.Add(g);</p>

<p class=ILprg>p = new Panel();</p>

<p class=ILprg>p.Size = new System.Drawing.Size(200, 320);</p>

<p class=ILprg>p.Location = new System.Drawing.Point(24, 40);</p>

<p class=ILprg>p.BackgroundImage = (Bitmap) new
Bitmap(&quot;hikingboot.bmp&quot;);</p>

<p class=ILprg>p.Controls.Add(l);</p>

<p class=ILprg>Controls.Add(p);</p>

<p class=ILprg>}</p>

<p class=ILprg>void abc(object sender, LinkLabelLinkClickedEventArgs<span
style="mso-spacerun: yes">  </span>e)</p>

<p class=ILprg>{</p>

<p class=ILprg>MessageBox.Show(&quot;hi&quot;) ;</p>

<p class=ILprg>l.LinkVisited = true ;</p>

<p class=ILprg>}</p>

<p class=ILprg>public static void Main() {</p>

<p class=ILprg>Application.Run(new zzz());</p>

<p class=ILprg>}</p>

<p class=ILprg>}</p>

<p class=ILbase><span style='color:windowtext'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=ILbase><span style='color:windowtext'>To avoid any exception from
being thrown, you should copy the file hikingboot.bmp to the current directory.
Though the above program is not very sizeable, its achievements are
substantial. The output of this program shows our screen divided into two parts
as follows: <o:p></o:p></span></p>

<p class=ILbase><span style='color:windowtext'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=ILbase><span style='color:windowtext'>(a) The left pane has a picture
in the background with some text that behaves like a hyperlink. Clicking on the
hyperlink displays a message box with the message 'hi' and changes the color of
the hyper link. <o:p></o:p></span></p>

<p class=ILbase><span style='color:windowtext'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<table border=0 cellspacing=0 cellpadding=0 style='border-collapse:collapse;
 mso-padding-alt:0in 5.4pt 0in 5.4pt'>
 <tr>
  <td valign=top style='padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal><img width=576 height=531 id="_x0000_i1082"
  src="chap4img/Image50.jpg"></p>
  </td>
 </tr>
 <tr>
  <td valign=top style='padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal>Screen 4.50</p>
  </td>
 </tr>
</table>

<p class=ILbase><span style='color:windowtext'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=ILbase><span style='color:windowtext'>(b) On the right hand side, we
come across a large number of properties. When we click on the plus sign in
front of the font property, yet more properties get displayed. On varying the
Font, the font of the text displayed in the window on the left side changes.
You can experiment with the other properties too. <o:p></o:p></span></p>

<p class=ILbase><span style='color:windowtext'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=ILbase><span style='color:windowtext'>Thus, you can achieve a lot
without writing tons of code!<o:p></o:p></span></p>

<p class=ILbase><span style='color:windowtext'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=ILbase><span style='font-family:"Trebuchet MS";color:windowtext'>l</span><span
style='color:windowtext'> is an instance of LinkLabel, which relates to text
that can be displayed as a hyper link. The DisabledLinkColor property of
LinkLabel decides the color of the hyperlink when it is disabled. The ForeColor
and the BackColor specify the foreground and the background color of the
control respectively. <o:p></o:p></span></p>

<p class=ILbase><span style='color:windowtext'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=ILbase><span style='color:windowtext'>We may not intend to display the
entire string as a hyperlink. So, we use the LinkArea property to ascertain the
text that is to be hyper linked. The default position begins at 0,0. <o:p></o:p></span></p>

<p class=ILbase><span style='color:windowtext'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=ILbase><span style='color:windowtext'>The GraphicsUnit enumeration in
the Font property specifies a unit of measurement. The value displayed uses
1/75 of an inch, since the unit of measure selected is World. We could also use
any of the other 6 values in the enum, such as pixel, millimeter etc. <o:p></o:p></span></p>

<p class=ILbase><span style='color:windowtext'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<table border=0 cellspacing=0 cellpadding=0 style='border-collapse:collapse;
 mso-padding-alt:0in 5.4pt 0in 5.4pt'>
 <tr>
  <td valign=top style='padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal><img width=576 height=531 id="_x0000_i1083"
  src="chap4img/Image51.jpg"></p>
  </td>
 </tr>
 <tr>
  <td valign=top style='padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal>Screen 4.51</p>
  </td>
 </tr>
</table>

<p class=ILbase><span style='color:windowtext'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=ILbase><span style='color:windowtext'>The Text property is the most
significant property, as it decides the text to be displayed. The LinkClicked
is the event property that will call function abc each time we click on the
link. In this function, we display a Message Box and change the LinkVisited
property to True, which results in a change in the color of the hyper link. You
may observe that this LinkLabel instance l is not added to the form. Next, we
create an instance of a PropertyGrid class and store it in pg. <o:p></o:p></span></p>

<p class=ILbase><span style='color:windowtext'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=ILbase><span style='color:windowtext'>The Dock property decides on the
edge of the container that this property will be docked to. The usage of the
Fill style allows docking of the property on all sides. <o:p></o:p></span></p>

<p class=ILbase><span style='color:windowtext'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=ILbase><span style='color:windowtext'>The property
CommandsVisibleIfAvailable displays the command pane only for those objects
that expose verbs. As always, the Text property is initialized to some text
that does not get displayed. The property of SelectedObject is assigned the
LinkLabel control, thereby linking it into the grid and facilitating browsing
of the LinkLable control properties. This property also allows us to browse
multiple objects. Finally, we add this object to the Form, thereby indirectly
adding the hyperlink also.<o:p></o:p></span></p>

<p class=ILbase><span style='color:windowtext'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=ILbase><span style='color:windowtext'>A group box is merely an
anthology of other controls. The Group box control is the one that contains the
PropertyGrid object. We also create an instance of a Panel object, which, like
a GroupBox class, contains other controls. If the Enabled property in the
panels is set to False, all the controls within it will be disabled. The panel
control, by default, is drawn without any Borders. The BorderStyle property
provides us with two-dimensional or three-dimensional borders, to distinguish a
panel from other areas of the form. The Panel class can also contain
scrollbars.<o:p></o:p></span></p>

<p class=ILbase><span style='color:windowtext'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=ILbase><span style='color:windowtext'>The Panel class has a property
called BackgroundImage that selects the picture to be displayed in the panel.
This Panel class has the LinkLabel added to it, to which we add the Panel.
Thus, we have two controls that have been added directly to the form, the Panel
that has the LinkLabel and the GroupBox that has the PropertyGrid. <o:p></o:p></span></p>

<p class=ILbase><span style='color:windowtext'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=ILbase><u><span style='mso-bidi-font-size:12.0pt;color:windowtext'>ListBox
Control </span></u><span style='color:windowtext'><o:p></o:p></span></p>

<p class=ILbase><span style='color:windowtext'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=ILprg><u>a.cs</u></p>

<p class=ILprg>using System;</p>

<p class=ILprg>using System.Drawing;</p>

<p class=ILprg>using System.Windows.Forms;</p>

<p class=ILprg>public class zzz : Form</p>

<p class=ILprg>{</p>

<p class=ILprg>sss p;</p>

<p class=ILprg>ListBox l;</p>

<p class=ILprg>Button b;</p>

<p class=ILprg>ColorDialog c;</p>

<p class=ILprg>ImageList i;</p>

<p class=ILprg>public zzz()</p>

<p class=ILprg>{</p>

<p class=ILprg>b = new Button();</p>

<p class=ILprg>b.Location = new System.Drawing.Point(16, 200);</p>

<p class=ILprg>b.Text = &quot;Color&quot;;</p>

<p class=ILprg>b.Size = new System.Drawing.Size(75, 23);</p>

<p class=ILprg>b.Click += new EventHandler(abc);</p>

<p class=ILprg>Controls.Add(b);</p>

<p class=ILprg>c = new ColorDialog();</p>

<p class=ILprg>p = new sss();</p>

<p class=ILprg>p.Location = new System.Drawing.Point(64, 90);</p>

<p class=ILprg>p.Size = new System.Drawing.Size(64, 168);</p>

<p class=ILprg>Controls.Add(p);</p>

<p class=ILprg>i = new ImageList();</p>

<p class=ILprg>i.ImageSize = new Size(24, 22);</p>

<p class=ILprg>i.Images.Add(new Bitmap(&quot;club.bmp&quot;));</p>

<p class=ILprg>i.Images.Add(new Bitmap(&quot;diamond.bmp&quot;));</p>

<p class=ILprg>i.Images.Add(new Bitmap(&quot;heart.bmp&quot;));</p>

<p class=ILprg>i.Images.Add(new Bitmap(&quot;spade.bmp&quot;));</p>

<p class=ILprg>Size = new System.Drawing.Size(512, 320);</p>

<p class=ILprg>l = new ListBox();</p>

<p class=ILprg>l.ForeColor = (Color)System.Drawing.SystemColors.WindowText;</p>

<p class=ILprg>l.Location = new System.Drawing.Point(8, 24);</p>

<p class=ILprg>l.IntegralHeight = false;</p>

<p class=ILprg>l.Size = new System.Drawing.Size(232, 60);</p>

<p class=ILprg>l.ColumnWidth = 144;</p>

<p class=ILprg>l.SelectedIndexChanged += new EventHandler(pqr);</p>

<p class=ILprg>l.Items.AddRange (new object[] {&quot;a1&quot;, &quot;a2&quot;,
&quot;a3&quot;, &quot;a4&quot;});</p>

<p class=ILprg>l.SelectionMode = SelectionMode.MultiSimple;</p>

<p class=ILprg>Controls.Add(l);</p>

<p class=ILprg>}</p>

<p class=ILprg>void abc(object sender, EventArgs e)</p>

<p class=ILprg>{</p>

<p class=ILprg>if (c.ShowDialog() == DialogResult.OK)</p>

<p class=ILprg>{</p>

<p class=ILprg>l.ForeColor = c.Color;</p>

<p class=ILprg>}</p>

<p class=ILprg>}</p>

<p class=ILprg>void pqr(object sender, EventArgs e)</p>

<p class=ILprg>{</p>

<p class=ILprg>p.ci();</p>

<p class=ILprg>int[] se = new int[l.SelectedIndices.Count];</p>

<p class=ILprg>l.SelectedIndices.CopyTo(se, 0);</p>

<p class=ILprg>for (int i=0; i&lt;se.Length; i++)</p>

<p class=ILprg>{</p>

<p class=ILprg>int ind = se[i];</p>

<p class=ILprg>object it = l.Items[ind];</p>

<p class=ILprg>string s = it.ToString();</p>

<p class=ILprg>Image im = aaa(s);</p>

<p class=ILprg>p.ai(im);</p>

<p class=ILprg>}</p>

<p class=ILprg>p.Invalidate();</p>

<p class=ILprg>}</p>

<p class=ILprg>Image aaa(string b)</p>

<p class=ILprg>{</p>

<p class=ILprg>if (b.Equals(&quot;a1&quot;))</p>

<p class=ILprg>{</p>

<p class=ILprg>return i.Images[0];</p>

<p class=ILprg>}</p>

<p class=ILprg>else if (b.Equals(&quot;a2&quot;))</p>

<p class=ILprg>{</p>

<p class=ILprg>return i.Images[1];</p>

<p class=ILprg>}</p>

<p class=ILprg>else if (b.Equals(&quot;a3&quot;))</p>

<p class=ILprg>{</p>

<p class=ILprg>return i.Images[2];</p>

<p class=ILprg>}</p>

<p class=ILprg>else if (b.Equals(&quot;a4&quot;))</p>

<p class=ILprg>{</p>

<p class=ILprg>return i.Images[3];</p>

<p class=ILprg>}</p>

<p class=ILprg>else</p>

<p class=ILprg>{</p>

<p class=ILprg>return null;</p>

<p class=ILprg>}</p>

<p class=ILprg>}</p>

<p class=ILprg>public static void Main()</p>

<p class=ILprg>{</p>

<p class=ILprg>Application.Run(new zzz());</p>

<p class=ILprg>}</p>

<p class=ILprg>}</p>

<p class=ILprg>public class sss :<span style="mso-spacerun: yes">  </span>Panel</p>

<p class=ILprg>{</p>

<p class=ILprg>Image[] i = new Image[4];</p>

<p class=ILprg>int Cnt=0;</p>

<p class=ILprg>public virtual void ai(Image img)</p>

<p class=ILprg>{</p>

<p class=ILprg>i[Cnt++] = img;</p>

<p class=ILprg>}</p>

<p class=ILprg>protected override void OnPaint(PaintEventArgs pe)</p>

<p class=ILprg>{</p>

<p class=ILprg>base.OnPaint(pe);</p>

<p class=ILprg>for (int j=0; j&lt; Cnt; j++)</p>

<p class=ILprg>{</p>

<p class=ILprg>pe.Graphics.DrawImage(i[j], new System.Drawing.Point(0, 30 * j +
5));</p>

<p class=ILprg>}</p>

<p class=ILprg>}</p>

<p class=ILprg>public virtual void ci()</p>

<p class=ILprg>{</p>

<p class=ILprg>Cnt = 0;</p>

<p class=ILprg>}</p>

<p class=ILprg>}</p>

<p class=ILprg><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=ILbase><span style='color:windowtext'>Before running the executable
file, the 4 files with the 'bmp' extension must be copied from one of the
sample directories into the current directory. <o:p></o:p></span></p>

<p class=ILbase><span style='color:windowtext'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<table border=0 cellspacing=0 cellpadding=0 style='border-collapse:collapse;
 mso-padding-alt:0in 5.4pt 0in 5.4pt'>
 <tr>
  <td valign=top style='padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal><img width=546 height=329 id="_x0000_i1084"
  src="chap4img/Image52.jpg"></p>
  <p class=MsoNormal>Screen 4.52</p>
  </td>
  <td valign=top style='padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal><img width=296 height=432 id="_x0000_i1085"
  src="chap4img/Image53.jpg"></p>
  </td>
 </tr>
 <tr>
  <td valign=top style='padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>
  </td>
  <td valign=top style='padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal>Screen 4.53</p>
  </td>
 </tr>
</table>

<p class=ILbase><span style='color:windowtext'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=ILbase><span style='color:windowtext'>When we run the above program,
we see a list box with 4 values and a button labeled 'Color'. When we click on
the button, it displays a color dialog box, which permits us to choose from
amongst a plethora of colors. We can select a color and then, click on the OK
button. As a result, the color of the list box items changes to the selected
color. We are also allowed to create our own custom colors in the dialog box. <o:p></o:p></span></p>

<p class=ILbase><span style='color:windowtext'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<table border=0 cellspacing=0 cellpadding=0 style='border-collapse:collapse;
 mso-padding-alt:0in 5.4pt 0in 5.4pt'>
 <tr>
  <td valign=top style='padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal><img width=546 height=329 id="_x0000_i1086"
  src="chap4img/Image54.jpg"></p>
  </td>
  <td valign=top style='padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal><img width=546 height=329 id="_x0000_i1087"
  src="chap4img/Image55.jpg"></p>
  </td>
 </tr>
 <tr>
  <td valign=top style='padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal>Screen 4.54</p>
  </td>
  <td valign=top style='padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal>Screen 4.55</p>
  </td>
 </tr>
</table>

<p class=ILbase><span style='color:windowtext'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=ILbase><span style='color:windowtext'>Each time we select an item from
the list box, an image representing the item is displayed. If we reselect an
item that we had selected earlier, the currently selected image gets replaced
by the latest selected one.<o:p></o:p></span></p>

<p class=ILbase><span style='color:windowtext'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=ILbase><span style='color:windowtext'>In the program, a Button b is
created. It calls function abc whenever it is clicked. Then, an instance c of
class ColorDialog is created. We have created the class sss. It is derived from
the class Panel. It has a member i, which is an array of 4 images and an int
variable named Cnt. The variable Cnt is used as an index to access the images
in the array, and to store the count of the number of images. When we add the
sss object to our Form, nothing gets displayed in the window. This is because,
there are no controls in the panel. <o:p></o:p></span></p>

<p class=ILbase><span style='color:windowtext'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=ILbase><span style='color:windowtext'>Next, we create an ImageList
object called i. This class stores a collection of images that can be used by
other controls such as the Toolbar or ListView. Bitmaps or Icons are added to
this class so that they are available for exploitation by other controls.
Images is a property of type ImageList.ImageCollection, whose Add method is
used to add a bitmap to the collection. We add a total of 4 bitmaps to our
ImageList object. <o:p></o:p></span></p>

<p class=ILbase><span style='color:windowtext'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=ILbase><span style='color:windowtext'>The ListBox object </span><span
style='font-family:"Trebuchet MS";color:windowtext'>l</span><span
style='color:windowtext'> has a property ColumnWidth, that decides on the
width, in pixels, of each column in the ListBox. In a multi-column ListBox, the
ColumnWidth property refers to the width of each column. A value of zero is
connotative of the fact that each column has a default width, taking into
account the data displayed in them. The property IntegralHeight decides whether
partial items can be displayed or not. If the value is set to true, then only
complete items are displayed. In this case, the ListBox will be resized to
ensure that partial items are not displayed. <o:p></o:p></span></p>

<p class=ILbase><span style='color:windowtext'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=ILbase><span style='color:windowtext'>Each time we select an item, the
Event SelectedIndexChanged gets kick started. This event, in turn, calls
function pqr. Every list box has a property called Items, which is a collection
of items displayed in the list box. The data type of Items is
ListBox.ObjectCollection. It has a method called AddRange, which accepts an array
of Child Controls present in the list, sorted on the index. Since we want the
list box to display the text a1, a2, a3 and a4, we initialize the object array
to this array of strings.<o:p></o:p></span></p>

<p class=ILbase><span style='color:windowtext'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=ILbase><span style='color:windowtext'>The property SelectionMode
decides on the number of items that can be chosen or selected concomitantly. <o:p></o:p></span></p>

<p class=ILbase><span style='color:windowtext'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=ILbase><span style='color:windowtext'>Four options available: <o:p></o:p></span></p>

<p class=ILbullets><span style='mso-bidi-font-size:12.0pt;font-family:"Times New Roman"'>•<span
style='mso-tab-count:1'>     </span></span>None : This means that no items can
be selected. In effect, it disables the ListBox. </p>

<p class=ILbullets><span style='mso-bidi-font-size:12.0pt;font-family:"Times New Roman"'>•<span
style='mso-tab-count:1'>     </span></span>One : This allows us to select only
one item at a time, </p>

<p class=ILbullets><span style='mso-bidi-font-size:12.0pt;font-family:"Times New Roman"'>•<span
style='mso-tab-count:1'>     </span></span>MultiSimple : This lets us choose
multiple items at the same time </p>

<p class=ILbullets><span style='mso-bidi-font-size:12.0pt;font-family:"Times New Roman"'>•<span
style='mso-tab-count:1'>     </span></span>MultiExtended : This enables us to
choose multiple items at a time and allows us to use keys like SHIFT and
CONTROL combinations to select the multiple options. </p>

<p class=ILbase><span style='color:windowtext'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=ILbase><span style='color:windowtext'>We finally add the list box to
the Form. Clicking on the button labeled Color calls ShowDialog from the
ColorDialog class, which displays a dialog box with a zillion colors. Until we
click on the OK button or the Cancel button, we cannot leave the dialog box. <o:p></o:p></span></p>

<p class=ILbase><span style='color:windowtext'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=ILbase><span style='color:windowtext'>The button returns one of two
values:<o:p></o:p></span></p>

<p class=ILbullets><span style='mso-bidi-font-size:12.0pt;font-family:"Times New Roman"'>•<span
style='mso-tab-count:1'>     </span></span>DialogResult.OK if we click on OK
button.</p>

<p class=ILbullets><span style='mso-bidi-font-size:12.0pt;font-family:"Times New Roman"'>•<span
style='mso-tab-count:1'>     </span></span>DialogResult.CANCEL if we click on
the Cancel button. </p>

<p class=ILbase><span style='color:windowtext'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=ILbase><span style='color:windowtext'>If the user opts to click on the
OK button, the color selected is assigned to the ForeColor property of the
ListBox.<o:p></o:p></span></p>

<p class=ILbase><span style='color:windowtext'>The function pqr is the vortex
of action. The function is called when any item is selected or unselected from
the list box. We first call function ci from the class sss, which initializes
the variable Cnt to zero. <o:p></o:p></span></p>

<p class=ILbase><span style='color:windowtext'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=ILbase><span style='color:windowtext'>The SelectedIndices property
returns a collection object named ListBox.SelectedIndicesCollection, which
lists all the items that are currently selected in the list box. This is so
because we can select multiple items from the list box. First, an array called
se of type int is created, depending on the number of items selected.<span
style="mso-spacerun: yes">  </span>Then, the selected indices are copied to the
array. The variable ind in the for statement refers to each index selected. The
Items array returns an object that stores the value of each index. As we need
the string representation of the selected item, function ToString is used to convert
the object into a string. This facilitates the possibility of having a list box
containing pictures. <o:p></o:p></span></p>

<p class=ILbase><span style='color:windowtext'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=ILbase><span style='color:windowtext'>We then call the function aaa
that accepts a string representing the ListBox item selected, which can be
either a1, a2, a3 or a4. It returns an image representing the string. It then
checks the value of the string passed and returns an image stored in the
ImageList object. The function ai merely uses the variable Cnt to index the
array of images with a new picture. Thus, if we select three images, the array
i will contain three pictures. When the for loop terminates, we call the
function Invalidate. <o:p></o:p></span></p>

<p class=ILbase><span style='color:windowtext'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=ILbase><span style='color:windowtext'>As we had learnt earlier,
function OnPaint displays all the pictures. This is achieved using the Cnt
variable that contains the number of images stored in the Array. Thus, we use
the ImageList class to store the images and the array of images in the sss
class to store the images that need to be displayed each time.<o:p></o:p></span></p>

<p class=ILbase><span style='color:windowtext'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=ILbase><u><span style='mso-bidi-font-size:12.0pt;color:windowtext'>StatusBar
control</span></u><span style='color:windowtext'><o:p></o:p></span></p>

<p class=ILbase><span style='color:windowtext'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=ILprg><u>a.cs</u></p>

<p class=ILprg>using System;</p>

<p class=ILprg>using System.Drawing;</p>

<p class=ILprg>using System.Windows.Forms;<span style="mso-spacerun: yes">   
</span></p>

<p class=ILprg>public class zzz : Form {</p>

<p class=ILprg>System.ComponentModel.Container c;</p>

<p class=ILprg>StatusBar s;</p>

<p class=ILprg>StatusBarPanel s1;</p>

<p class=ILprg>StatusBarPanel s2;</p>

<p class=ILprg>StatusBarPanel s3;</p>

<p class=ILprg>Timer t;</p>

<p class=ILprg>public zzz()<span style="mso-spacerun: yes">  </span>{</p>

<p class=ILprg>c = new System.ComponentModel.Container();</p>

<p class=ILprg>s2 = new StatusBarPanel();</p>

<p class=ILprg>t = new Timer(c);</p>

<p class=ILprg>s = new StatusBar();</p>

<p class=ILprg>s3 = new StatusBarPanel();</p>

<p class=ILprg>s1 = new StatusBarPanel();</p>

<p class=ILprg>s2.AutoSize = (StatusBarPanelAutoSize)2;</p>

<p class=ILprg>s2.Alignment = HorizontalAlignment.Right;</p>

<p class=ILprg>s2.Width = 76;</p>

<p class=ILprg>s3.AutoSize = StatusBarPanelAutoSize.Contents;</p>

<p class=ILprg>s3.Width = 20;</p>

<p class=ILprg>s1.BorderStyle = StatusBarPanelBorderStyle.None;</p>

<p class=ILprg>s1.Icon = new Icon(&quot;status.ico&quot;);</p>

<p class=ILprg>s1.AutoSize = StatusBarPanelAutoSize.Contents;</p>

<p class=ILprg>s1.Width = 62;</p>

<p class=ILprg>s1.Text = &quot;sonal&quot;;</p>

<p class=ILprg>Size = new System.Drawing.Size(512, 320);</p>

<p class=ILprg>KeyUp += new KeyEventHandler(abc);</p>

<p class=ILprg>t.Interval = 1000;</p>

<p class=ILprg>t.Enabled = true;</p>

<p class=ILprg>t.Tick += new EventHandler(pqr);</p>

<p class=ILprg>s.Size = new Size(212, 20);</p>

<p class=ILprg>s.Location = new Point(0, 216);</p>

<p class=ILprg>s.BackColor = (Color)SystemColors.Control;</p>

<p class=ILprg>s.Text = &quot;Vijay Mukhi&quot;;</p>

<p class=ILprg>s.ShowPanels = true;</p>

<p class=ILprg>s.Panels.AddRange((StatusBarPanel[])new StatusBarPanel[] {s1,
s2, s3});</p>

<p class=ILprg>Controls.Add(s);</p>

<p class=ILprg>s3.Text = &quot;OVR&quot;;</p>

<p class=ILprg>}</p>

<p class=ILprg>void abc(object se, KeyEventArgs e)</p>

<p class=ILprg>{</p>

<p class=ILprg>if (e.KeyCode == Keys.Insert)</p>

<p class=ILprg>{</p>

<p class=ILprg>string s = this.s3.Text;</p>

<p class=ILprg>if (s.Equals(&quot;INS&quot;))</p>

<p class=ILprg>s3.Text = &quot;OVR&quot;;</p>

<p class=ILprg>else</p>

<p class=ILprg>s3.Text = &quot;INS&quot;;</p>

<p class=ILprg>}</p>

<p class=ILprg>}</p>

<p class=ILprg>void pqr(object se, EventArgs e)</p>

<p class=ILprg>{</p>

<p class=ILprg>DateTime t = DateTime.Now;</p>

<p class=ILprg>string s = t.ToLongTimeString() ;</p>

<p class=ILprg>s2.Text = s ;</p>

<p class=ILprg>}</p>

<p class=ILprg>public static void Main()</p>

<p class=ILprg>{</p>

<p class=ILprg>Application.Run(new zzz());</p>

<p class=ILprg>}</p>

<p class=ILprg>}</p>

<p class=ILbase><span style='color:windowtext'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=ILbase><span style='color:windowtext'>Every Windows application
displays a StatusBar control. This program is going to introduce the status bar
in our window. In order to accomplish this, the file status.ico needs to be
copied from one of the sample directories into the current directory. <o:p></o:p></span></p>

<p class=ILbase><span style='color:windowtext'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=ILbase><span style='color:windowtext'>The above program merely
presents a blank window with a status bar at the bottom. The status bar has the
following contents:<o:p></o:p></span></p>

<p class=ILbullets><span style='mso-bidi-font-size:12.0pt;font-family:"Times New Roman"'>•<span
style='mso-tab-count:1'>     </span></span>an icon.</p>

<p class=ILbullets><span style='mso-bidi-font-size:12.0pt;font-family:"Times New Roman"'>•<span
style='mso-tab-count:1'>     </span></span>the word 'sonal'.</p>

<p class=ILbullets><span style='mso-bidi-font-size:12.0pt;font-family:"Times New Roman"'>•<span
style='mso-tab-count:1'>     </span></span>the time ticking away in the middle.</p>

<p class=ILbullets><span style='mso-bidi-font-size:12.0pt;font-family:"Times New Roman"'>•<span
style='mso-tab-count:1'>     </span></span>the status of the Insert key. </p>

<p class=ILbase><span style='color:windowtext'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<table border=0 cellspacing=0 cellpadding=0 style='border-collapse:collapse;
 mso-padding-alt:0in 5.4pt 0in 5.4pt'>
 <tr>
  <td valign=top style='padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal><img width=546 height=329 id="_x0000_i1088"
  src="chap4img/Image56.jpg"></p>
  </td>
  <td valign=top style='padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal><img width=546 height=329 id="_x0000_i1089"
  src="chap4img/Image57.jpg"></p>
  </td>
 </tr>
 <tr>
  <td valign=top style='padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal>Screen 4.56</p>
  </td>
  <td valign=top style='padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal>Screen 4.57</p>
  </td>
 </tr>
</table>

<p class=ILbase><span style='color:windowtext'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=ILbase><span style='color:windowtext'>Each time we use the insert key,
the text toggles between INS and OVR. <o:p></o:p></span></p>

<p class=ILbase><span style='color:windowtext'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=ILbase><span style='color:windowtext'>The class Container encapsulates
zero to one or more components. We create three status bar objects s1, s2 and s3,
which are instances of class StatusBarPanel. This class, in turn, is derived
from class Component. It stores the StatusBar control panel information. The
object s is an instance of class StatusBar, which represents a Window status
bar control. This control has no panels by default. <o:p></o:p></span></p>

<p class=ILbase><span style='color:windowtext'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=ILbase><span style='color:windowtext'>The property AutoSize in the
StatusBarPanel class regulates the changes occurring in the panel of a status
bar, whenever the status bar is resized. The values are obtained from the
enumeration StatusBarPanelAutoSize that has the following three values:<o:p></o:p></span></p>

<p class=ILbullets><span style='mso-bidi-font-size:12.0pt;font-family:"Times New Roman"'>•<span
style='mso-tab-count:1'>     </span></span>Contents: As is evident from the
name, the contents of the status bar decide how its size will change. </p>

<p class=ILbullets><span style='mso-bidi-font-size:12.0pt;font-family:"Times New Roman"'>•<span
style='mso-tab-count:1'>     </span></span>None: The status bar panel does not
change whenever the status bar is resized.</p>

<p class=ILbullets><span style='mso-bidi-font-size:12.0pt;font-family:"Times New Roman"'>•<span
style='mso-tab-count:1'>     </span></span>Spring: The panel shares the
available space with all other panels having a setting of Spring, after
yielding space to the panels having either the Contents or None settings. </p>

<p class=ILbase><span style='color:windowtext'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=ILbase><span style='color:windowtext'>Text can be aligned in a status
bar panel in 3 ways with reference to the status bar, i.e. Left, Right and
Center. The Alignment property, by default, has a value of Left. For the status
bar panel s2, we have set it to Right. The default width is 100 pixels for a
status bar panel. An Icon can be specified along with the text that is
displayed. To do so, we initialize the Icon property to a .ico file. An .ico
file is a small transparent bitmap image. <o:p></o:p></span></p>

<p class=ILbase><span style='color:windowtext'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=ILbase><span style='color:windowtext'>The KeyUp Event is fired
whenever a key is released in the focused control. In our case, function pqr is
called. The Timer class, that implements a Windows timer, merely activates an
event at a particular time interval. This timer, which can be used in a window,
is designed for a single threaded environment only, where User Interface
threads are being executed. The Interval property decides the time, in
milliseconds, between timer ticks. The Enabled property sets the timer On. The
garbage collector does not interfere with the timer while it is running. The
Event Tick will call the function pqr whenever the time interval set in the
timer elapses. In our case, it is occurs after one second.<o:p></o:p></span></p>

<p class=ILbase><span style='color:windowtext'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=ILbase><span style='color:windowtext'>The StatusBar is made up of
panels. The ShowPanels property displays all the panels that are added using
the AddRange method, i.e. s1, s2 and s3. Finally, the text of the last panel is
set to OVR and the StatusBar object is added to the form.<o:p></o:p></span></p>

<p class=ILbase><span style='color:windowtext'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=ILbase><span style='color:windowtext'>The function abc gets called
each time we press a key in our form. This function is called with the
parameter e of KeyEventArgs, which has a member KeyCode, which contains a
number corresponding to the key pressed. As it is difficult to remember the numbers
assigned to every key, the enumeration Keys is used to represent the keys. If
the Insert key is pressed, the current Text displayed in the status bar panel
s3 is retrieved and the value gets toggled from OVR to INS. <o:p></o:p></span></p>

<p class=ILbase><span style='color:windowtext'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=ILbase><span style='color:windowtext'>On completion of the timer
interval, we use the Now property of the DateTime class to provide us with the
current time. This is then supplied to s2.Text, which updates the status bar
panel with the current time every second. What you can display in a status bar
is limited by your imagination. It is common to display the status of keys and
the time on the status bar.<o:p></o:p></span></p>

<p class=ILbase><span style='color:windowtext'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=ILbase><u><span style='mso-bidi-font-size:12.0pt;color:windowtext'>Tab
Control<o:p></o:p></span></u></p>

<p class=ILbase><span style='color:windowtext'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=ILprg><u>a.cs</u></p>

<p class=ILprg>using System;</p>

<p class=ILprg>using System.Drawing;</p>

<p class=ILprg>using System.Windows.Forms;</p>

<p class=ILprg>public class zzz : Form {</p>

<p class=ILprg>GroupBox g2;</p>

<p class=ILprg>GroupBox g1;</p>

<p class=ILprg>ImageList i; </p>

<p class=ILprg>TabPage t1; </p>

<p class=ILprg>TabPage t2;</p>

<p class=ILprg>TabControl t; </p>

<p class=ILprg>public zzz() </p>

<p class=ILprg>{</p>

<p class=ILprg>ClientSize = new Size(546, 293);</p>

<p class=ILprg>g1 = new GroupBox();</p>

<p class=ILprg>g1.Location = new Point(12, 16);</p>

<p class=ILprg>g1.Text = &quot;Sonal&quot;;</p>

<p class=ILprg>g1.Size = new Size(202, 144);</p>

<p class=ILprg>g2 = new GroupBox();</p>

<p class=ILprg>g2.Location = new Point(12, 16);</p>

<p class=ILprg>g2.Text = &quot;Vijay mukhi&quot;;</p>

<p class=ILprg>g2.Size = new Size(202, 128);</p>

<p class=ILprg>i = new ImageList();</p>

<p class=ILprg>t1 = new TabPage();</p>

<p class=ILprg>t2 = new TabPage();</p>

<p class=ILprg>t = new TabControl();</p>

<p class=ILprg>t1.Text = &quot;Mukhi&quot;;</p>

<p class=ILprg>t1.Size = new Size(224, 193);</p>

<p class=ILprg>t1.ImageIndex = 0;</p>

<p class=ILprg>t1.TabIndex = 0;</p>

<p class=ILprg>t2.Text = &quot;Vijay&quot;;</p>

<p class=ILprg>t2.ImageIndex = 1;</p>

<p class=ILprg>t2.TabIndex = 1;</p>

<p class=ILprg>t.Location = new Point(24, 32);</p>

<p class=ILprg>t.Size = new Size(232, 220);</p>

<p class=ILprg>t.SelectedIndex = 0;</p>

<p class=ILprg>t.ImageList = i;</p>

<p class=ILprg>i.Images.Add((Bitmap)new Bitmap(&quot;calendar.bmp&quot;));</p>

<p class=ILprg>i.Images.Add((Bitmap)new Bitmap(&quot;note.bmp&quot;));</p>

<p class=ILprg>t.ImageList = i;</p>

<p class=ILprg>Controls.Add(t);</p>

<p class=ILprg>t1.Controls.Add(g1);</p>

<p class=ILprg>t2.Controls.Add(g2);</p>

<p class=ILprg>t.Controls.Add(t1);</p>

<p class=ILprg>t.Controls.Add(t2);</p>

<p class=ILprg>}</p>

<p class=ILprg>public static void Main() </p>

<p class=ILprg>{</p>

<p class=ILprg>Application.Run(new zzz());</p>

<p class=ILprg>}</p>

<p class=ILprg>}</p>

<p class=ILbase><span style='color:windowtext'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=ILbase><span style='color:windowtext'>This program requires two
bitmaps called note.bmp and calendar.bmp. <o:p></o:p></span></p>

<p class=ILbase><span style='color:windowtext'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=ILbase><span style='color:windowtext'>We start by creating two
GroupBox controls named g1 and g2, and change the properties of Locations, Size
and Text. The ImageList i stores a list of images. We next create two TabPage
objects t1 and t2. A TabPage class implements a single page of the TabControl
class. It is a panel class having the properties of a TabItem.<o:p></o:p></span></p>

<p class=ILbase><span style='color:windowtext'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<table border=0 cellspacing=0 cellpadding=0 style='border-collapse:collapse;
 mso-padding-alt:0in 5.4pt 0in 5.4pt'>
 <tr>
  <td valign=top style='padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal><img width=576 height=332 id="_x0000_i1090"
  src="chap4img/Image58.jpg"></p>
  </td>
  <td valign=top style='padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal><img width=576 height=332 id="_x0000_i1091"
  src="chap4img/Image59.jpg"></p>
  </td>
 </tr>
 <tr>
  <td valign=top style='padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal>Screen 4.58</p>
  </td>
  <td valign=top style='padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal>Screen 4.59</p>
  </td>
 </tr>
</table>

<p class=ILbase><span style='color:windowtext'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=ILbase><span style='color:windowtext'>The string assigned to the Text
property is displayed as the tab page text. We can set it to a certain size.
The ImageIndex property is an index into the ImageList list object, which is associated
with the TabControl. The TabPage objects are added to the TabControl using the
Controls collection. The ImageList property is initialized to the list of
images denoted by the ImageList class. Thus, the ImageIndex member decides on
the image that will be displayed along with the Text in the TabControl. <o:p></o:p></span></p>

<p class=ILbase><span style='color:windowtext'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=ILbase><span style='color:windowtext'>A TabControl shows a list of
TabPages. Clicking on the tab activates them. A TabControl, in other words, is
like a series of Dialog boxes containing controls, organized in a logical
fashion. The controls that would earlier have appeared in one large dialog box,
are now placed in separate dialog boxes.<o:p></o:p></span></p>

<p class=ILbase><span style='color:windowtext'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=ILbase><span style='color:windowtext'>As mentioned earlier, we add the
GroupBox to the Control collection of the individual TabPage objects t1 and t2.
The controls that we require are added to the GroupBox. The GroupBox, in turn,
gets added to the TabPage. From then on, the TabControl takes over and we can
flick between TabPages with ease.<o:p></o:p></span></p>

<p class=ILbase><span style='color:windowtext'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=ILbase><u><span style='mso-bidi-font-size:12.0pt;color:windowtext'>ToolTip
Control</span></u><span style='color:windowtext'><o:p></o:p></span></p>

<p class=ILbase><span style='color:windowtext'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=ILprg><u>a.cs</u></p>

<p class=ILprg>using System;</p>

<p class=ILprg>using System.Drawing;</p>

<p class=ILprg>using System.Windows.Forms;</p>

<p class=ILprg>public class zzz : Form {</p>

<p class=ILprg>System.ComponentModel.Container c;</p>

<p class=ILprg>ToolTip t;</p>

<p class=ILprg>PictureBox p1;</p>

<p class=ILprg>PictureBox p2;</p>

<p class=ILprg>public zzz()</p>

<p class=ILprg>{</p>

<p class=ILprg>c = new System.ComponentModel.Container();</p>

<p class=ILprg>t = new ToolTip(c);</p>

<p class=ILprg>t.Active = true;</p>

<p class=ILprg>t.ShowAlways = true;</p>

<p class=ILprg>t.AutomaticDelay = 100;</p>

<p class=ILprg>t.AutoPopDelay = 100;</p>

<p class=ILprg>t.InitialDelay = 100;</p>

<p class=ILprg>t.ReshowDelay = 100;</p>

<p class=ILprg>p1 = new PictureBox();</p>

<p class=ILprg>p2 = new PictureBox();</p>

<p class=ILprg>Size = new Size(512, 300);</p>

<p class=ILprg>p1.Location = new Point(8, 7);</p>

<p class=ILprg>p1.Size = new Size(20, 20);</p>

<p class=ILprg>p1.Image = new Bitmap(&quot;open.bmp&quot;);</p>

<p class=ILprg>t.SetToolTip(p1, &quot;vijay&quot;);</p>

<p class=ILprg>Controls.Add(p1);</p>

<p class=ILprg>p2.Location = new Point(28, 7);</p>

<p class=ILprg>p2.Size = new Size(20, 20);</p>

<p class=ILprg>p2.Image = new Bitmap(&quot;new.bmp&quot;);</p>

<p class=ILprg>t.SetToolTip(p2, &quot;mukhi&quot;);</p>

<p class=ILprg>Controls.Add(p2);</p>

<p class=ILprg>}</p>

<p class=ILprg>public static void Main()</p>

<p class=ILprg>{</p>

<p class=ILprg>Application.Run(new zzz());</p>

<p class=ILprg>}</p>

<p class=ILprg>}</p>

<p class=ILbase><span style='color:windowtext'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=ILbase><span style='color:windowtext'>All of us need help at some
point in time. The ToolTip control is just the antidote for all maladies.
Before running the executable, copy the two bitmaps open.bmp and new.bmp to the
current directory.These two bitmaps will be displayed as two separate images on
our form. Whenever we move our cursor close to them, a yellow colored help text
comes into sight. <o:p></o:p></span></p>

<p class=ILbase><span style='color:windowtext'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=ILbase><span style='color:windowtext'>A ToolTip class gives us a small
window that contains a single line of text that describes what a control stands
for. The real productivity of Bitmaps and Icons can be fully harnessed only if we
are able to discern their functionality. The Active property, if set to false,
disables the ToolTip control. The ShowAlways property will show a ToolTip
despite the fact that the control it is assigned to, is currently disabled.<o:p></o:p></span></p>

<p class=ILbase><span style='color:windowtext'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<table border=0 cellspacing=0 cellpadding=0 style='border-collapse:collapse;
 mso-padding-alt:0in 5.4pt 0in 5.4pt'>
 <tr>
  <td valign=top style='padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal><img width=576 height=337 id="_x0000_i1092"
  src="chap4img/Image60.jpg"></p>
  </td>
  <td valign=top style='padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal><img width=576 height=337 id="_x0000_i1093"
  src="chap4img/Image61.jpg"></p>
  </td>
 </tr>
 <tr>
  <td valign=top style='padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal>Screen 4.60</p>
  </td>
  <td valign=top style='padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal>Screen 4.61</p>
  </td>
 </tr>
</table>

<p class=ILbase><span style='color:windowtext'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=ILbase><span style='color:windowtext'>The following four properties
have been set for the Tooltip control:<o:p></o:p></span></p>

<p class=ILbullets><span style='mso-bidi-font-size:12.0pt;font-family:"Times New Roman"'>•<span
style='mso-tab-count:1'>     </span></span>AutomaticDelay: It denotes the time
in milliseconds that elapses before the tool tip appears. The default is 500
milliseconds. </p>

<p class=ILbullets><span style='mso-bidi-font-size:12.0pt;font-family:"Times New Roman"'>•<span
style='mso-tab-count:1'>     </span></span>AutoPopDelay: It is the time in milliseconds
for which the ToolTip remains visible to the user while the mouse is stationary
on the control. Its default value is 10 times the value of the property
AutomaticDelay. </p>

<p class=ILbullets><span style='mso-bidi-font-size:12.0pt;font-family:"Times New Roman"'>•<span
style='mso-tab-count:1'>     </span></span>InitialDelay: It is the time in
milliseconds for which the mouse must remain fixed within the control, before
the tool tip becomes visible again. The default value is equal to that of
property AutomaticDelay. </p>

<p class=ILbullets><span style='mso-bidi-font-size:12.0pt;font-family:"Times New Roman"'>•<span
style='mso-tab-count:1'>     </span></span>ReshowDelay: It is the time in
milliseconds that elapses, as the mouse moves from one control to another. The
default is 1/5 of the property AutomaticDelay. </p>

<p class=ILbase><span style='color:windowtext'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=ILbase><span style='color:windowtext'>Any amendment made to the
property AutomaticDelay has an impact on the above properties. Thus, it is
advisable to first change the AutomaticDelay property, followed by the other
properties.<o:p></o:p></span></p>

<p class=ILbase><span style='color:windowtext'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=ILbase><span style='color:windowtext'>Two PictureBox controls have
been added in our window. We add these two pictures to the form. This class can
display all types of images, including bitmaps, icons, JPEG, GIF and many more.
The Image property decides on the image that gets displayed. By default, the
image has no borders and can be clipped too. <o:p></o:p></span></p>

<p class=ILbase><span style='color:windowtext'>The ToolTip class has a method
called SetToolTip, which accepts a control as the first parameter and the text
of the tool tip as the second. Henceforth, whenever the mouse is positioned on
that control, the tool tip will be displayed.<o:p></o:p></span></p>

<p class=ILbase><span style='color:windowtext'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=ILbase><u><span style='mso-bidi-font-size:12.0pt;color:windowtext'>TrackBar
Control</span></u><span style='color:windowtext'><o:p></o:p></span></p>

<p class=ILbase><span style='color:windowtext'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=ILprg><u>a.cs</u></p>

<p class=ILprg>using System;</p>

<p class=ILprg>using System.Drawing;</p>

<p class=ILprg>using System.Windows.Forms;</p>

<p class=ILprg>public class zzz : Form</p>

<p class=ILprg>{</p>

<p class=ILprg>TrackBar t;</p>

<p class=ILprg>Label l;</p>

<p class=ILprg>public zzz() {</p>

<p class=ILprg>Size = new Size(512, 320);</p>

<p class=ILprg>t = new TrackBar();</p>

<p class=ILprg>t.Location = new Point(8, 24);</p>

<p class=ILprg>t.Size = new Size(200, 42);</p>

<p class=ILprg>t.ValueChanged += new EventHandler(abc);</p>

<p class=ILprg>t.TickFrequency = 5;</p>

<p class=ILprg>t.Minimum = 0;</p>

<p class=ILprg>t.Maximum = 100;</p>

<p class=ILprg>t.SmallChange = 5;</p>

<p class=ILprg>t.LargeChange = 25;</p>

<p class=ILprg>t.Orientation = Orientation.Horizontal;</p>

<p class=ILprg>t.TickStyle = TickStyle.Both;</p>

<p class=ILprg>l = new Label();</p>

<p class=ILprg>l.Location = new Point(112, 192);</p>

<p class=ILprg>l.Text = t.Value.ToString();</p>

<p class=ILprg>Controls.Add(t);</p>

<p class=ILprg>Controls.Add(l);</p>

<p class=ILprg>}</p>

<p class=ILprg>void abc(object source, EventArgs e)</p>

<p class=ILprg>{</p>

<p class=ILprg>l.Text = t.Value.ToString();</p>

<p class=ILprg>}</p>

<p class=ILprg>public static void Main() {</p>

<p class=ILprg>Application.Run(new zzz());</p>

<p class=ILprg>}</p>

<p class=ILprg>}</p>

<p class=ILbase><span style='color:windowtext'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=ILbase><span style='color:windowtext'>The TrackBar class resembles a scroll
bar in many respects, but its interaction with the user is distinct. We can
configure values that the TrackBar represents and also define increments for
off-button clicks. The TrackBar can be positioned horizontally or vertically.
The number of ticks that are displayed can also be configured.<o:p></o:p></span></p>

<p class=ILbase><span style='color:windowtext'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=ILbase><span style='color:windowtext'>Each time that the value of the
TrackBar changes, the Event property ValueChanged calls the function abc. The
property TickFrequency specifies the number of ticks that will be drawn. The
lower limit of the range of the TrackBar is confined to a value decided by the
Minimum property, which in our case is 0. The upper limit of the range of the
TrackBar is confined to a value determined by the Maximum property, which in
our case is 100. <o:p></o:p></span></p>

<p class=ILbase><span style='color:windowtext'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<table border=0 cellspacing=0 cellpadding=0 style='border-collapse:collapse;
 mso-padding-alt:0in 5.4pt 0in 5.4pt'>
 <tr>
  <td valign=top style='padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal><img width=546 height=329 id="_x0000_i1094"
  src="chap4img/Image62.jpg"></p>
  </td>
  <td valign=top style='padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal><img width=546 height=329 id="_x0000_i1095"
  src="chap4img/Image63.jpg"></p>
  </td>
 </tr>
 <tr>
  <td valign=top style='padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal>Screen 4.62</p>
  </td>
  <td valign=top style='padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal>Screen 4.63</p>
  </td>
 </tr>
</table>

<p class=ILbase><span style='color:windowtext'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=ILbase><span style='color:windowtext'>We may not want to draw 100
ticks to represent all the values. So, we specify a value such as 5 as the
TickFrequency. This will draw a tick mark at a spacing of 5, resulting in a total
of 20 ticks. Thus, each tick will represent 5 units of the TrackBar's range of
values.<o:p></o:p></span></p>

<p class=ILbase><span style='color:windowtext'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=ILbase><span style='color:windowtext'>The property SmallChange decides
on the magnitude of change that occurs in the TrackBar, whenever the user
presses the Up arrow key or the Down arrow key to move the TrackBar thumb. The
value assigned to the LargeChange property is used whenever we click on the
side, or use the Page Up and Page Down keys. <o:p></o:p></span></p>

<p class=ILbase><span style='color:windowtext'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=ILbase><span style='color:windowtext'>The Orientation property can
take only two values i.e. horizontal or vertical. The TickStyle property uses
an enumeration that can have four values:<o:p></o:p></span></p>

<p class=ILbullets><span style='mso-bidi-font-size:12.0pt;font-family:"Times New Roman"'>•<span
style='mso-tab-count:1'>     </span></span>None: for no tick marks. </p>

<p class=ILbullets><span style='mso-bidi-font-size:12.0pt;font-family:"Times New Roman"'>•<span
style='mso-tab-count:1'>     </span></span>Both: for tick marks on both sides
of the control. </p>

<p class=ILbullets><span style='mso-bidi-font-size:12.0pt;font-family:"Times New Roman"'>•<span
style='mso-tab-count:1'>     </span></span>BottomRight: for tick marks at the
bottom for a horizontal control, and on the right for a vertical control .</p>

<p class=ILbullets><span style='mso-bidi-font-size:12.0pt;font-family:"Times New Roman"'>•<span
style='mso-tab-count:1'>     </span></span>TopLeft: this is the reverse of
BottomRight.</p>

<p class=ILbase><span style='color:windowtext'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=ILbase><span style='color:windowtext'>We then use a label to display
the value of the track bar on the form. This value is stored in the property
Value of the label class. Finally, we add the label and TrackBar. Function abc
merely updates the label to depict the current position of the TrackBar.<o:p></o:p></span></p>

<p class=ILbase><b><span style='mso-bidi-font-size:12.0pt;color:windowtext'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></b></p>

<p class=ILbase><u><span style='mso-bidi-font-size:12.0pt;color:windowtext'>Tree-Node
Control</span></u><span style='color:windowtext'><o:p></o:p></span></p>

<p class=ILbase><span style='color:windowtext'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=ILprg><u>a.cs</u></p>

<p class=ILprg>using System;</p>

<p class=ILprg>using System.IO;</p>

<p class=ILprg>using System.Resources;<span style="mso-spacerun: yes">  
</span></p>

<p class=ILprg>using System.ComponentModel;</p>

<p class=ILprg>using System.Drawing;</p>

<p class=ILprg>using System.Windows.Forms;</p>

<p class=ILprg>using System.Runtime.InteropServices;</p>

<p class=ILprg>public class zzz : Form</p>

<p class=ILprg>{</p>

<p class=ILprg>TreeView d;</p>

<p class=ILprg>ImageList i;</p>

<p class=ILprg>public zzz()</p>

<p class=ILprg>{</p>

<p class=ILprg>ClientSize = new System.Drawing.Size(502, 293);</p>

<p class=ILprg>i = new ImageList();</p>

<p class=ILprg>i.Images.Add(new Bitmap(&quot;clsdfold.bmp&quot;));</p>

<p class=ILprg>i.Images.Add(new Bitmap(&quot;openfold.bmp&quot;));</p>

<p class=ILprg>d = new TreeView();</p>

<p class=ILprg>d.ImageList = (ImageList)i;</p>

<p class=ILprg>d.ForeColor = (Color)System.Drawing.SystemColors.WindowText;</p>

<p class=ILprg>d.Location = new System.Drawing.Point(24, 16);</p>

<p class=ILprg>d.AllowDrop = true;</p>

<p class=ILprg>d.Indent = 19;</p>

<p class=ILprg>d.Text = &quot;treeView1&quot;;</p>

<p class=ILprg>d.SelectedImageIndex = 1;</p>

<p class=ILprg>d.Size = new System.Drawing.Size(200, 264);</p>

<p class=ILprg>d.AfterSelect += new TreeViewEventHandler(sss);</p>

<p class=ILprg>d.BeforeExpand += new TreeViewCancelEventHandler(eee);</p>

<p class=ILprg>Controls.Add(d);</p>

<p class=ILprg>string[] dr = Environment.GetLogicalDrives();</p>

<p class=ILprg>for (int ii = 0; ii &lt; dr.Length; ii++)</p>

<p class=ILprg>{</p>

<p class=ILprg>if (PlatformInvokeKernel32.GetDriveType(dr[ii]) == PlatformInvokeKernel32.DRIVE_FIXED)
</p>

<p class=ILprg>{</p>

<p class=ILprg>TreeNode c = new TreeNode(dr[ii]);</p>

<p class=ILprg>d.Nodes.Add(c);</p>

<p class=ILprg>ddd(c);</p>

<p class=ILprg>}</p>

<p class=ILprg>}</p>

<p class=ILprg>}</p>

<p class=ILprg>void ddd(TreeNode n)</p>

<p class=ILprg>{</p>

<p class=ILprg>DirectoryInfo dir = new DirectoryInfo(ppp(n));</p>

<p class=ILprg>DirectoryInfo[] e = dir.GetDirectories ();</p>

<p class=ILprg>for (int i = 0; i &lt; e.Length; i++)</p>

<p class=ILprg>{</p>

<p class=ILprg>string na = e[i].Name;<span style="mso-spacerun: yes">   
</span></p>

<p class=ILprg>if (!na.Equals(&quot;.&quot;) <span style='font-family:"Bookman Old Style"'>&amp;&amp;</span>
!na.Equals(&quot;..&quot;))</p>

<p class=ILprg>{</p>

<p class=ILprg>n.Nodes.Add(new TreeNode(na));</p>

<p class=ILprg>}</p>

<p class=ILprg>}</p>

<p class=ILprg>}</p>

<p class=ILprg><span style="mso-spacerun: yes"> </span>void sss(object source,
TreeViewEventArgs e)</p>

<p class=ILprg>{</p>

<p class=ILprg>Text = &quot;Windows.Forms File Explorer - &quot; + e.Node.Text;</p>

<p class=ILprg>}</p>

<p class=ILprg><span style="mso-spacerun: yes"> </span>void eee(object source,
TreeViewCancelEventArgs e)</p>

<p class=ILprg>{</p>

<p class=ILprg>TreeNode n = (TreeNode)e.Node;</p>

<p class=ILprg>for (int i = 0; i &lt; n.Nodes.Count; i++)</p>

<p class=ILprg>{</p>

<p class=ILprg>ddd(n.Nodes[i]);</p>

<p class=ILprg>}</p>

<p class=ILprg>}</p>

<p class=ILprg>string ppp(TreeNode node)</p>

<p class=ILprg>{</p>

<p class=ILprg>if (node.Parent == null)</p>

<p class=ILprg>{</p>

<p class=ILprg>return node.Text;</p>

<p class=ILprg>}</p>

<p class=ILprg>return Path.Combine(ppp(node.Parent), node.Text);</p>

<p class=ILprg>}</p>

<p class=ILprg>[STAThread]</p>

<p class=ILprg>public static void Main(string[] args) {</p>

<p class=ILprg>Application.Run(new zzz());</p>

<p class=ILprg>}</p>

<p class=ILprg>}</p>

<p class=ILprg><span style="mso-spacerun: yes">  </span>public class
PlatformInvokeKernel32 </p>

<p class=ILprg><span style="mso-spacerun: yes">    </span>{<span
style="mso-spacerun: yes">   </span></p>

<p class=ILprg><span style="mso-spacerun: yes">       
</span>[DllImport(&quot;KERNEL32&quot;,
CharSet=System.Runtime.InteropServices.CharSet.Auto)]</p>

<p class=ILprg><span style="mso-spacerun: yes">        </span>public static
extern int GetDriveType(string lpRootPathName);<span style="mso-spacerun:
yes">  </span></p>

<p class=ILprg><span style="mso-spacerun: yes">        </span>public const int
DRIVE_FIXED = 3;</p>

<p class=ILprg><span style="mso-spacerun: yes">    </span>}</p>

<p class=ILprg><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=ILbase><span style='color:windowtext'>Copy the two bmp files
clsdfold.bmp and openfold.bmp required for this program, from the samples
directory into your current directory. <o:p></o:p></span></p>

<p class=ILbase><span style='color:windowtext'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=ILbase><span style='color:windowtext'>Here, we first create a TreeView
control called d. A TreeView displays a list of items or nodes in a
hierarchical manner. A node consists of a caption and a bitmap; the bitmap is
optional. The user can select a node and collapse it or expand it by clicking
on the plus or minus sign, displayed alongside, respectively. <o:p></o:p></span></p>

<p class=ILbase><span style='color:windowtext'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=ILbase><span style='color:windowtext'>We have an ImageList control i
that represents two images. We initialize the ImageList property of the
TreeView control to the Image List. Thus, the TreeView can now use the images
stored in the ImageList. The AllowDrop property facilitates the use of the
control for events and Drag and Drop operations. <o:p></o:p></span></p>

<p class=ILbase><span style='color:windowtext'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=ILbase><span style='color:windowtext'>The property Indent decides the
indent in the pixels. The SelectedImageIndex determines as to which picture is
to be used from the ImageList when the user selects an item in the control. <o:p></o:p></span></p>

<p class=ILbase><span style='color:windowtext'>There are a large number of
events that get triggered off, but we are capturing only the following two:<o:p></o:p></span></p>

<p class=ILbullets><span style='mso-bidi-font-size:12.0pt;font-family:"Times New Roman"'>•<span
style='mso-tab-count:1'>     </span></span>AfterSelect, that calls function sss</p>

<p class=ILbullets><span style='mso-bidi-font-size:12.0pt;font-family:"Times New Roman"'>•<span
style='mso-tab-count:1'>     </span></span>BeforeExapnd, that calls functions
eee. </p>

<p class=ILbase><span style='color:windowtext'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=ILbase><span style='color:windowtext'>The EventHandler functions use
different delegate types.<span style="mso-spacerun: yes">  </span><o:p></o:p></span></p>

<p class=ILbase><span style='color:windowtext'>The class Environment has a
static function GetLogicalDrives that returns an array of strings, which
denotes the logical drives on our machine. If machine has three drives, C:\,
D:\and E:\, the for loop is repeated thrice. <o:p></o:p></span></p>

<p class=ILbase><span style='color:windowtext'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=ILbase><span style='color:windowtext'>Using the Platform invoke API,
we can call any code in any dll.<span style="mso-spacerun: yes">  </span>So, we
first call the external function GetDriveType and compare it with the value
retrieved for DRIVE_FIXED, which is 3 in this case.<o:p></o:p></span></p>

<p class=ILbase><span style='color:windowtext'>If there are 3 fixed drives then
the if statement is true for 3 of them, resulting in the display of 3 nodes
only. If you have only one fixed drive i.e. C, you will see only one node on
your screen.<o:p></o:p></span></p>

<p class=ILbase><span style='color:windowtext'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<table border=0 cellspacing=0 cellpadding=0 style='border-collapse:collapse;
 mso-padding-alt:0in 5.4pt 0in 5.4pt'>
 <tr>
  <td valign=top style='padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal><img width=441 height=403 id="_x0000_i1096"
  src="chap4img/Image64.jpg"></p>
  </td>
  <td valign=top style='padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal><img width=441 height=403 id="_x0000_i1097"
  src="chap4img/Image65.jpg"></p>
  </td>
 </tr>
 <tr>
  <td valign=top style='padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal>Screen 4.64</p>
  </td>
  <td valign=top style='padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal>Screen 4.65</p>
  </td>
 </tr>
</table>

<p class=ILbase><span style='color:windowtext'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=ILbase><span style='color:windowtext'>A TreeNode object is created,
which is used in the TreeView. The constructor is passed the drive name to enable
it to be displayed as a label for the node. A TreeView is made up of Nodes. It
has a property called Nodes, which is of type TreeNodeCollection. Using the Add
member of the collection, we add the tree node. Thereafter, function ddd is
called with this newly created and empty tree node object.<o:p></o:p></span></p>

<p class=ILbase><span style='color:windowtext'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=ILbase><span style='color:windowtext'>Function ppp is called with an
empty tree node. If the node has no parent, the text associated with the node
is returned. But if a parent exists, we use the static function Combine, of the
Path class, to combine the two strings together. The Combine function calls the
ppp function recursively. <o:p></o:p></span></p>

<p class=ILbase><span style='color:windowtext'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=ILbase><span style='color:windowtext'>To begin with, the value of
ppp(n) is C:\. The object dir represents directories in the C drive. To obtain
all the directories present on the drive, we call function GetDirectories,
which returns an array of DirectoryInfo objects. The Name member returns the
name of the directory. If the return value is not a . or .., we add the
directory name to the list of Nodes. <o:p></o:p></span></p>

<p class=ILbase><span style='color:windowtext'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=ILbase><span style='color:windowtext'>In the AfterSelect event,
function sss gets called. In this function, we change the Text of the form to
the node selected. This is possible because the node label is passed as a
parameter to TreeViewEventArgs. The function eee recovers the current active
node from the parameter passed to it. Using the Count property, we calculate
the number of nodes contained in the active node and thereafter, iterate
through each of these nodes. The same function ddd is called with every node. <o:p></o:p></span></p>

<p class=ILbase><span style='color:windowtext'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=ILbase><span style='color:windowtext'>This is how we can display the
sub-directories contained within directories and the files displayed within the
directories. Data is sent to the control, which merely returns the same data in
a tree like form. When we click on the first plus (+) sign of C:\, the function
ppp(n) returns the entire path name of each directory in a recursive fashion.<o:p></o:p></span></p>

<p class=ILbase><span style='color:windowtext'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=ILbase><u><span style='mso-bidi-font-size:12.0pt;color:windowtext'>Docking</span></u><u><span
style='color:windowtext'> </span></u><span style='color:windowtext'><o:p></o:p></span></p>

<p class=ILbase><span style='color:windowtext'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=ILprg><u>a.cs</u></p>

<p class=ILprg>using System;</p>

<p class=ILprg>using System.Drawing;</p>

<p class=ILprg>using System.Windows.Forms;</p>

<p class=ILprg>public class zzz :Form {</p>

<p class=ILprg>Panel p1;</p>

<p class=ILprg>Panel p2;</p>

<p class=ILprg>GroupBox g;</p>

<p class=ILprg>Button b;</p>

<p class=ILprg>RadioButton r1;<span style="mso-spacerun: yes">   </span></p>

<p class=ILprg>RadioButton r2;<span style="mso-spacerun: yes">    </span></p>

<p class=ILprg>RadioButton r3;<span style="mso-spacerun: yes">   </span></p>

<p class=ILprg>RadioButton r4; </p>

<p class=ILprg>RadioButton r5;<span style="mso-spacerun: yes">  </span></p>

<p class=ILprg>RadioButton r6;<span style="mso-spacerun: yes">    </span></p>

<p class=ILprg>RadioButton rs;</p>

<p class=ILprg>Splitter s;</p>

<p class=ILprg>public zzz () {</p>

<p class=ILprg>g = new GroupBox();</p>

<p class=ILprg>rs = new RadioButton();</p>

<p class=ILprg>r5 = new RadioButton();</p>

<p class=ILprg>s = new Splitter();</p>

<p class=ILprg>b = new Button();</p>

<p class=ILprg>r6 = new RadioButton();</p>

<p class=ILprg>r4 = new RadioButton();</p>

<p class=ILprg>r1 = new RadioButton();</p>

<p class=ILprg>r3 = new RadioButton();</p>

<p class=ILprg>p1 = new Panel();</p>

<p class=ILprg>p2 = new Panel();</p>

<p class=ILprg>r2 = new RadioButton();</p>

<p class=ILprg>Location = new Point(100, 100);</p>

<p class=ILprg>SizeGripStyle = SizeGripStyle.Show;</p>

<p class=ILprg>ClientSize = new Size(448, 400);</p>

<p class=ILprg>g.Location = new Point(16, 152);</p>

<p class=ILprg>g.TabStop = false;</p>

<p class=ILprg>g.Text = &quot;<span style='font-family:"Bookman Old Style"'>&amp;</span>Dock&quot;;</p>

<p class=ILprg>g.Size = new Size(88, 176);</p>

<p class=ILprg>s.BackColor = Color.Blue;</p>

<p class=ILprg>s.Dock = DockStyle.Right;</p>

<p class=ILprg>s.Location = new Point(325, 0);</p>

<p class=ILprg>s.Size = new Size(3, 400);</p>

<p class=ILprg>b.BackColor = SystemColors.Control;</p>

<p class=ILprg>b.FlatStyle = FlatStyle.Popup;</p>

<p class=ILprg>b.Anchor = AnchorStyles.None;</p>

<p class=ILprg>b.Text = &quot;Demo Button&quot;;</p>

<p class=ILprg>rs.Text = &quot;rs&quot;;</p>

<p class=ILprg>rs.Size = new Size(100, 23);</p>

<p class=ILprg>r5.Location = new Point(8, 120);</p>

<p class=ILprg>r5.Text = &quot;<span style='font-family:"Bookman Old Style"'>&amp;</span>Right&quot;;</p>

<p class=ILprg>r5.Size = new Size(72, 24);</p>

<p class=ILprg>r5.Click += new System.EventHandler(abc);</p>

<p class=ILprg>r6.Location = new Point(8, 144);</p>

<p class=ILprg>r6.Text = &quot;<span style='font-family:"Bookman Old Style"'>&amp;</span>Fill&quot;;</p>

<p class=ILprg>r6.Size = new Size(72, 24);</p>

<p class=ILprg>r6.Click += new System.EventHandler(abc);</p>

<p class=ILprg>r4.Location = new Point(8, 96);</p>

<p class=ILprg>r4.Text = &quot;<span style='font-family:"Bookman Old Style"'>&amp;</span>Bottom&quot;;</p>

<p class=ILprg>r4.Size = new Size(72, 24);</p>

<p class=ILprg>r4.Click += new System.EventHandler(abc);</p>

<p class=ILprg>r1.Checked = true;</p>

<p class=ILprg>r1.Location = new Point(8, 24);</p>

<p class=ILprg>r1.Text = &quot;<span style='font-family:"Bookman Old Style"'>&amp;</span>None&quot;;</p>

<p class=ILprg>r1.Size = new Size(72, 24);</p>

<p class=ILprg>r1.Click += new System.EventHandler(abc);</p>

<p class=ILprg>r3.Location = new Point(8, 72);</p>

<p class=ILprg>r3.Text = &quot;<span style='font-family:"Bookman Old Style"'>&amp;</span>Left&quot;;</p>

<p class=ILprg>r3.Size = new Size(72, 24);</p>

<p class=ILprg>r3.Click += new System.EventHandler(abc);</p>

<p class=ILprg>p1.Text = &quot;ButtonPanel&quot;;</p>

<p class=ILprg>p1.Size = new Size(325, 400);</p>

<p class=ILprg>p1.BorderStyle = System.Windows.Forms.BorderStyle.Fixed3D;</p>

<p class=ILprg>p1.Dock = DockStyle.Fill;</p>

<p class=ILprg>p1.BackColor = Color.Green;</p>

<p class=ILprg>p2.Location = new Point(328, 0);</p>

<p class=ILprg>p2.Text = &quot;ControlsPanel&quot;;</p>

<p class=ILprg>p2.Size = new Size(120, 400);</p>

<p class=ILprg>p2.BorderStyle = System.Windows.Forms.BorderStyle.Fixed3D;</p>

<p class=ILprg>p2.Dock = DockStyle.Right;</p>

<p class=ILprg>r2.Location = new Point(8, 48);</p>

<p class=ILprg>r2.Text = &quot;<span style='font-family:"Bookman Old Style"'>&amp;</span>Top&quot;;</p>

<p class=ILprg>r2.Click += new System.EventHandler(abc);</p>

<p class=ILprg>Controls.Add(p2);</p>

<p class=ILprg>Controls.Add(s);</p>

<p class=ILprg>Controls.Add(p1);</p>

<p class=ILprg>p1.Controls.Add(b);</p>

<p class=ILprg>p2.Controls.Add(g);</p>

<p class=ILprg>g.Controls.Add(r4);</p>

<p class=ILprg>g.Controls.Add(r3);</p>

<p class=ILprg>g.Controls.Add(r1);</p>

<p class=ILprg>g.Controls.Add(r5);</p>

<p class=ILprg>g.Controls.Add(r6);</p>

<p class=ILprg>g.Controls.Add(r2);</p>

<p class=ILprg>rs = r1;</p>

<p class=ILprg>aaa(); </p>

<p class=ILprg>}</p>

<p class=ILprg>void aaa() {</p>

<p class=ILprg>if (rs == r1) </p>

<p class=ILprg>b.Dock = DockStyle.None;</p>

<p class=ILprg>else if (rs == r2)</p>

<p class=ILprg>b.Dock = DockStyle.Top;</p>

<p class=ILprg>else if (rs == r3)</p>

<p class=ILprg>b.Dock = DockStyle.Left;</p>

<p class=ILprg>else if (rs == r4)</p>

<p class=ILprg>b.Dock = DockStyle.Bottom;</p>

<p class=ILprg>else if (rs == r5) </p>

<p class=ILprg>b.Dock = DockStyle.Right;</p>

<p class=ILprg>else </p>

<p class=ILprg>b.Dock = DockStyle.Fill;</p>

<p class=ILprg>}</p>

<p class=ILprg>protected void abc(object s, EventArgs e)</p>

<p class=ILprg>{</p>

<p class=ILprg>rs = (RadioButton)s;</p>

<p class=ILprg>aaa();</p>

<p class=ILprg>}</p>

<p class=ILprg>public static void Main() {</p>

<p class=ILprg>Application.Run(new zzz());</p>

<p class=ILprg>}</p>

<p class=ILprg>}</p>

<p class=ILbase><span style='color:windowtext'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=ILbase><span style='color:windowtext'>This program may be generously
proportioned, however it is very simple to comprehend. We have created seven
radio buttons, one GroupBox, two panels, one splitter and one button. The
SizeGripStyle property can have three values:<o:p></o:p></span></p>

<p class=ILbullets><span style='mso-bidi-font-size:12.0pt;font-family:"Times New Roman"'>•<span
style='mso-tab-count:1'>     </span></span>Show: that always shows the sizing
grip.</p>

<p class=ILbullets><span style='mso-bidi-font-size:12.0pt;font-family:"Times New Roman"'>•<span
style='mso-tab-count:1'>     </span></span>Hide : that always hides the sizing
grip.</p>

<p class=ILbullets><span style='mso-bidi-font-size:12.0pt;font-family:"Times New Roman"'>•<span
style='mso-tab-count:1'>     </span></span>Auto : that shows and hides the
sizing grip as necessary. </p>

<p class=ILbase><span style='color:windowtext'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=ILbase><span style='color:windowtext'>The sizing handle is always
shown at the right hand corner of the form. <o:p></o:p></span></p>

<p class=ILbase><span style='color:windowtext'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=ILbase><span style='color:windowtext'>The button has a FlatStyle of
Popup that determines the appearance of the button. Clicking on any of the
Radio Buttons results in a call to the function abc. This is as a consequence
of the Event property Click having been set to abc. Next, we add all the
controls to the Form. The repetitive code for adding the controls results in a
lengthy program.<o:p></o:p></span></p>

<p class=ILbase><span style='color:windowtext'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<table border=0 cellspacing=0 cellpadding=0 style='border-collapse:collapse;
 mso-padding-alt:0in 5.4pt 0in 5.4pt'>
 <tr>
  <td valign=top style='padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal><img width=516 height=479 id="_x0000_i1098"
  src="chap4img/Image66.jpg"></p>
  </td>
  <td valign=top style='padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal><img width=516 height=479 id="_x0000_i1099"
  src="chap4img/Image67.jpg"></p>
  </td>
 </tr>
 <tr>
  <td valign=top style='padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal>Screen 4.66</p>
  </td>
  <td valign=top style='padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal>Screen 4.67</p>
  </td>
 </tr>
</table>

<p class=ILbase><span style='color:windowtext'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=ILbase><span style='color:windowtext'>The function abc gets called.
Its first parameter is an object type. The object stands for the control that
calls the function. In function abc, the RadioButton that was clicked on, is represented
by s. The value contained in s is stored in another RadioButton called rs. The
function aaa is called thereafter. It compares the value contained in rs with
the 5 radio buttons r1 to r5. Depending upon the value that matches, the Dock
property of the button changes.<o:p></o:p></span></p>

<p class=ILbase><span style='color:windowtext'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<table border=0 cellspacing=0 cellpadding=0 style='border-collapse:collapse;
 mso-padding-alt:0in 5.4pt 0in 5.4pt'>
 <tr>
  <td valign=top style='padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal><img width=516 height=479 id="_x0000_i1100"
  src="chap4img/Image68.jpg"></p>
  </td>
  <td valign=top style='padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal><img width=516 height=479 id="_x0000_i1101"
  src="chap4img/Image69.jpg"></p>
  </td>
 </tr>
 <tr>
  <td valign=top style='padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal>Screen 4.68</p>
  </td>
  <td valign=top style='padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal>Screen 4.69</p>
  </td>
 </tr>
</table>

<p class=ILbase><span style='color:windowtext'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=ILbase><span style='color:windowtext'>When a control is docked to the
edge of a container, it will always take up a position flush against the edge,
if the control is resized. <o:p></o:p></span></p>

<p class=ILbase><span style='color:windowtext'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=ILbase><span style='color:windowtext'>The Left, Right, Top and Bottom
styles position the control towards the respective edge of the container. Fill
will fill upto all the sides of the control. <o:p></o:p></span></p>

<p class=ILbase><span style='color:windowtext'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=ILbase><span style='color:windowtext'>The control is resized to fill the
container's edges. The First dock style named None, ensures that the control
does not get docked at all.<o:p></o:p></span></p>

<p class=ILbase><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

</div>

</body>


<!-- Mirrored from www.vijaymukhi.com/documents/books/csclasses/chap4.htm by HTTrack Website Copier/3.x [XR&CO'2014], Fri, 11 Oct 2024 13:47:10 GMT -->
</html>
