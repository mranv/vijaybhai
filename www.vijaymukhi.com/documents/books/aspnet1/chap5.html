<html xmlns:v="urn:schemas-microsoft-com:vml"
xmlns:o="urn:schemas-microsoft-com:office:office"
xmlns:w="urn:schemas-microsoft-com:office:word"
xmlns="http://www.w3.org/TR/REC-html40">


<!-- Mirrored from www.vijaymukhi.com/documents/books/aspnet1/chap5.htm by HTTrack Website Copier/3.x [XR&CO'2014], Fri, 11 Oct 2024 13:42:24 GMT -->
<head>
<meta http-equiv=Content-Type content="text/html; charset=windows-1252">
<meta name=ProgId content=Word.Document>
<meta name=Generator content="Microsoft Word 9">
<meta name=Originator content="Microsoft Word 9">
<link rel=File-List href="chap5_files/filelist.html">
<link rel=Edit-Time-Data href="chap5_files/editdata.html">
<!--[if !mso]>
<style>
v\:* {behavior:url(#default#VML);}
o\:* {behavior:url(#default#VML);}
w\:* {behavior:url(#default#VML);}
.shape {behavior:url(#default#VML);}
</style>
<![endif]-->
<title>Database Controls - ASP.NET - Beta2</title>
<!--[if gte mso 9]><xml>
 <o:DocumentProperties>
  <o:Author>Vijay Mukhi</o:Author>
  <o:LastAuthor>Vijay Mukhi</o:LastAuthor>
  <o:Revision>39</o:Revision>
  <o:TotalTime>64</o:TotalTime>
  <o:Created>2001-09-26T10:48:00Z</o:Created>
  <o:LastSaved>2001-09-26T11:52:00Z</o:LastSaved>
  <o:Pages>70</o:Pages>
  <o:Words>22733</o:Words>
  <o:Characters>129580</o:Characters>
  <o:Company>V.M.C.I.</o:Company>
  <o:Lines>1079</o:Lines>
  <o:Paragraphs>259</o:Paragraphs>
  <o:CharactersWithSpaces>159133</o:CharactersWithSpaces>
  <o:Version>9.2720</o:Version>
 </o:DocumentProperties>
</xml><![endif]--><!--[if gte mso 9]><xml>
 <w:WordDocument>
  <w:HideSpellingErrors/>
 </w:WordDocument>
</xml><![endif]-->
<style>
<!--
 /* Font Definitions */
@font-face
	{font-family:"Bookman Old Style";
	panose-1:2 5 6 4 5 5 5 2 2 4;
	mso-font-charset:0;
	mso-generic-font-family:roman;
	mso-font-pitch:variable;
	mso-font-signature:647 0 0 0 159 0;}
@font-face
	{font-family:"Trebuchet MS";
	panose-1:2 11 6 3 2 2 2 2 2 4;
	mso-font-charset:0;
	mso-generic-font-family:swiss;
	mso-font-pitch:variable;
	mso-font-signature:7 0 0 0 19 0;}
@font-face
	{font-family:"Book Antiqua";
	panose-1:2 4 6 2 5 3 5 3 3 4;
	mso-font-charset:0;
	mso-generic-font-family:roman;
	mso-font-pitch:variable;
	mso-font-signature:647 0 0 0 159 0;}
 /* Style Definitions */
p.MsoNormal, li.MsoNormal, div.MsoNormal
	{mso-style-parent:"";
	margin:0in;
	margin-bottom:.0001pt;
	mso-pagination:widow-orphan;
	font-size:12.0pt;
	font-family:"Times New Roman";
	mso-fareast-font-family:"Times New Roman";}
h1
	{mso-style-next:Normal;
	margin:0in;
	margin-bottom:.0001pt;
	text-align:center;
	mso-pagination:widow-orphan;
	page-break-after:avoid;
	mso-outline-level:1;
	font-size:24.0pt;
	font-family:"Trebuchet MS";
	color:black;
	mso-font-kerning:0pt;
	font-weight:normal;}
p.Cprg, li.Cprg, div.Cprg
	{mso-style-name:"C\#prg";
	mso-style-parent:"C\#base";
	margin-top:0in;
	margin-right:0in;
	margin-bottom:0in;
	margin-left:.5in;
	margin-bottom:.0001pt;
	mso-pagination:widow-orphan;
	mso-layout-grid-align:none;
	text-autospace:none;
	font-size:9.5pt;
	font-family:"Trebuchet MS";
	mso-fareast-font-family:"Times New Roman";
	mso-bidi-font-family:"Times New Roman";}
p.Coutput, li.Coutput, div.Coutput
	{mso-style-name:"C\#output";
	mso-style-parent:"C\#base";
	margin-top:0in;
	margin-right:0in;
	margin-bottom:0in;
	margin-left:.5in;
	margin-bottom:.0001pt;
	mso-pagination:widow-orphan;
	mso-layout-grid-align:none;
	text-autospace:none;
	font-size:9.5pt;
	font-family:"Trebuchet MS";
	mso-fareast-font-family:"Times New Roman";
	mso-bidi-font-family:"Times New Roman";}
p.Cbullets, li.Cbullets, div.Cbullets
	{mso-style-name:"C\#bullets";
	mso-style-parent:"";
	margin-top:0in;
	margin-right:0in;
	margin-bottom:0in;
	margin-left:.3in;
	margin-bottom:.0001pt;
	text-align:justify;
	mso-pagination:widow-orphan;
	mso-layout-grid-align:none;
	text-autospace:none;
	font-size:10.0pt;
	font-family:"Bookman Old Style";
	mso-fareast-font-family:"Times New Roman";
	mso-bidi-font-family:"Times New Roman";}
p.Cbase, li.Cbase, div.Cbase
	{mso-style-name:"C\#base";
	mso-style-parent:"";
	margin:0in;
	margin-bottom:.0001pt;
	text-align:justify;
	mso-pagination:widow-orphan;
	mso-layout-grid-align:none;
	text-autospace:none;
	font-size:10.0pt;
	font-family:"Bookman Old Style";
	mso-fareast-font-family:"Times New Roman";
	mso-bidi-font-family:"Times New Roman";}
p.Subhead1, li.Subhead1, div.Subhead1
	{mso-style-name:"Subhead 1";
	mso-style-parent:Headline;
	margin:0in;
	margin-bottom:.0001pt;
	mso-pagination:widow-orphan;
	mso-layout-grid-align:none;
	text-autospace:none;
	font-size:18.0pt;
	font-family:"Times New Roman";
	mso-fareast-font-family:"Times New Roman";
	font-weight:bold;}
p.Headline, li.Headline, div.Headline
	{mso-style-name:Headline;
	mso-style-parent:"";
	margin:0in;
	margin-bottom:.0001pt;
	mso-pagination:widow-orphan;
	mso-layout-grid-align:none;
	text-autospace:none;
	font-size:30.0pt;
	font-family:"Times New Roman";
	mso-fareast-font-family:"Times New Roman";
	color:black;
	font-weight:bold;}
@page Section1
	{size:8.5in 11.0in;
	margin:1.0in 1.25in 1.0in 1.25in;
	mso-header-margin:.5in;
	mso-footer-margin:.5in;
	mso-paper-source:0;}
div.Section1
	{page:Section1;}
-->
</style>
</head>

<body lang=EN-US style='tab-interval:.5in'>

<div class=Section1>

<p class=MsoNormal><img width=64 height=48 id="_x0000_i1025" src=bpb.jpg></p>

<p class=MsoNormal><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=MsoNormal align=center style='text-align:center'><b>-5-</b></p>

<p class=MsoNormal><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<h1>Database Controls</h1>

<p class=Cbase><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=Cbase>This chapter, which is based on databases, will probe into the
rudiments of handling data from a database program, i.e. Microsoft's SQLServer.
To ensure that the programs work as per our explanation, this database server
must be installed along with the samples that are provided along with the .NET
package. The details have been given in the installation section in the
Introduction chapter, with the aim of assisting you in installing this product
and the samples.<o:p></o:p></p>

<p class=Cbase><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=Cprg><u>a.aspx</u><o:p></o:p></p>

<p class=Cprg>&lt;%@ Import Namespace=&quot;System.Data&quot; %&gt;<o:p></o:p></p>

<p class=Cprg>&lt;%@ Import Namespace=&quot;System.Data.SqlClient&quot; %&gt;<o:p></o:p></p>

<p class=Cprg>&lt;html&gt;<o:p></o:p></p>

<p class=Cprg>&lt;script language=&quot;C#&quot; runat=server&gt;<o:p></o:p></p>

<p class=Cprg>void abc(Object s, EventArgs e) <o:p></o:p></p>

<p class=Cprg>{<o:p></o:p></p>

<p class=Cprg>SqlConnection c = new
SqlConnection(&quot;server=localhost;uid=sa;pwd=;database=pubs&quot;);<o:p></o:p></p>

<p class=Cprg>SqlDataAdapter co = new SqlDataAdapter(&quot;select * from Titles
&quot;, c);<o:p></o:p></p>

<p class=Cprg>DataSet d = new DataSet();<o:p></o:p></p>

<p class=Cprg>int i = co.Fill(d, &quot;zzz&quot;);<o:p></o:p></p>

<p class=Cprg>Response.Write(i.ToString());<o:p></o:p></p>

<p class=Cprg>l.DataSource = d.Tables[&quot;zzz&quot;].DefaultView;<o:p></o:p></p>

<p class=Cprg>l.DataBind();<o:p></o:p></p>

<p class=Cprg>}<o:p></o:p></p>

<p class=Cprg>&lt;/script&gt;<o:p></o:p></p>

<p class=Cprg>&lt;body&gt;<o:p></o:p></p>

<p class=Cprg>&lt;form action=&quot;a.aspx&quot; runat=&quot;server&quot;&gt;<o:p></o:p></p>

<p class=Cprg>&lt;asp:button type=submit text=&quot;Fetch&quot;
OnClick=&quot;abc&quot; runat=&quot;server&quot;/&gt;<o:p></o:p></p>

<p class=Cprg>&lt;ASP:DataGrid id=&quot;l&quot; runat=&quot;server&quot;/&gt;<o:p></o:p></p>

<p class=Cprg>&lt;/form&gt;<o:p></o:p></p>

<p class=Cprg>&lt;/body&gt;<o:p></o:p></p>

<p class=Cprg>&lt;/html&gt;<o:p></o:p></p>

<p class=Cbase><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=Cbase>When the file a.aspx is loaded on, by providing the URL
http://localhost/a.aspx, the browser displays a blank screen with only one
button labeled Fetch. If you now click on the button, the same window shall get
filled up with data, in a well-formatted tabular manner. <o:p></o:p></p>

<p class=Cbase><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=Cbase>Are you astonished? Well, the best way to comprehend the output
is, by analyzing the source file. In order to do so, we clicked on View-Source
and found that the program that we had run on the server, and the HTML file
generated, are as dissimilar as fish and fowl. <o:p></o:p></p>

<p class=Cbase><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=Cbase>The asp:button of type 'submit', generates a submit button which
calls the function abc on the server, whenever we click on it. This function
first creates an object c, which is an instance of the class SqlConnection. All
database handling classes either belong to the System.Data namespace or to the
System.Data.SqlClient namespace. <o:p></o:p></p>

<p class=Cbase><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=Cbase>The directive &lt;%@ Import Namespace= is the ASP+ equivalent of
the C# keyword 'using'. Since we believe in the adage that 'brevity is the soul
of wit', wemake use of this directive and initialize it to the
System.Data.SqlClient and System.Data namespaces. We can include as many Import
directives in the file as we want.<o:p></o:p></p>

<p class=Cbase><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=Cbase>To create an object of type SqlConnection, the constructor with
one parameter is called. This parameter is a string where we initialize some
words as follows:<o:p></o:p></p>

<p class=Cbase><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=Cbase><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=Cbullets><span style='mso-bidi-font-size:12.0pt;font-family:"Times New Roman"'>•<span
style='mso-tab-count:1'>     </span></span>server to localhost<o:p></o:p></p>

<p class=Cbullets><span style='mso-bidi-font-size:12.0pt;font-family:"Times New Roman"'>•<span
style='mso-tab-count:1'>     </span></span>uid to sa<o:p></o:p></p>

<p class=Cbullets><span style='mso-bidi-font-size:12.0pt;font-family:"Times New Roman"'>•<span
style='mso-tab-count:1'>     </span></span>pwd to nothing<o:p></o:p></p>

<p class=Cbullets><span style='mso-bidi-font-size:12.0pt;font-family:"Times New Roman"'>•<span
style='mso-tab-count:1'>     </span></span>database to pubs. <o:p></o:p></p>

<p class=Cbase><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=Cbase>The class uses these values internally. The server provides
relevant details about the machine on which the SQLServer database is running
to SqlConnection. The relevance of these values is explained below:<o:p></o:p></p>

<p class=Cbase><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=Cbase>Here, we have used localhost, which refers to the local machine
and not to a machine on the network. <o:p></o:p></p>

<p class=Cbase><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=Cbase>A database cannot be accessed unless we identify ourselves. In
order to do so, we have to provide it with a user id and a password. So, the
word uid is used, which refers to the user id, and the word pwd is used to
refer to the password. SQLServer has only one pre-built user in the system
called sa, which does not require a password. Hence, in this case, uid is
initialized to sa and pwd is not assigned any value.<o:p></o:p></p>

<p class=Cbase><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=Cbase>Finally, in general terms, a database is made up of tables where
all data is stored. In our program, we will be constantly working with only one
database called pubs. c now refers to this connection made to the pubs
database, on the local disk. Observe carefully that semi-colons separate the
name-value pairs in the string.<o:p></o:p></p>

<p class=Cbase><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=Cbase>The next task in the sequence is to fetch data from the
database. To accomplish this, we need to be well informed and conversant with a
language that can handle a database, and also fetch the desired data. This
language is called SQL or Structured Query Language. SQL is a universal
language that works on all database servers and is not a trademark of any
database vendor. Thus, Microsoft, Oracle or any other database vendor, do not
possess the ownership rights of SQL.<o:p></o:p></p>

<p class=Cbase><span style="mso-spacerun: yes"> </span><o:p></o:p></p>

<p class=Cbase>In the SQL language, a Select statement fetches data from a
database. As mentioned earlier, data is stored in a table within rows and
columns. A row of the table is called a record and the columns are identified
as fields. Further, every table has a name, and the fields in it signify the
type of data that is stored within them. <o:p></o:p></p>

<p class=Cbase><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=Cbase>The pubs database contains a table called titles. Writing an SQL
command as 'Select * from titles', will fetch us all the data from the titles
table. This is because the * signifies all the fields and records of a table.<o:p></o:p></p>

<p class=Cbase><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=Cbase>As we want to display all the records from this table in the
browser window, we have to use this SQL select statement in ASP+. Prior to
that, we need to create one more class that understands SQL commands. This
class is called SqlDataAdapter, which belongs to one of the namespaces imported
in the file.<o:p></o:p></p>

<p class=Cbase><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=Cbase>We call the constructor of SqlDataAdapter class with two
parameters; the SQL statement within double quotes i.e. &quot;select * from
Titles&quot;; and the connection object i.e. 'c'. This links up the SQL command
with the database connection. <o:p></o:p></p>

<p class=Cbase><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=Cbase>So far, we have created two objects, the first of which contains
the connection details and second holds the SQL command. As we need to
accommodate the data that we retrieve from the table somewhere, we need one
more object that is of type DataSet. This object deals with data that comprises
of multiple rows and columns.<o:p></o:p></p>

<p class=Cbase><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=Cbase>Now, we shall get down to real work. We need to fill up the
DataSet object with data. To do so, the SqlDataAdapter class provides us with a
function called Fill, which accepts two parameters. The first parameter is a
DataSet object 'd', and the second one is any string, zzz, which identifies the
table. This function returns an int, which informs us about the number of rows
added to the DataSet object. As there are 18 rows in the titles tables, Fill
stores 18 in the variable i. As before, we can use Response.Write function to
display the value stored in the variable i. But, since this function requires a
string, the ToString function from the int class is called to display this
value in the string format.<o:p></o:p></p>

<p class=Cbase><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=Cbase>In the aspx file, besides the asp button, we have introduced a
new tag called &lt;asp:DataGrid, having an id of <span style='font-family:"Trebuchet MS"'>l</span>.
This tag is capable of displaying data in a grid form. <o:p></o:p></p>

<p class=Cbase><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=Cbase>In the function abc, we are initializing the DataSource property
of<span style='font-family:"Trebuchet MS"'> l,</span> i.e. a DataGrid to the
data that it should display. The DataSet object 'd' has a member called
'Tables', which is assigned the value of zzz. If you recheck the program, you
will find that the string zzz was provided to identify the DataSet. The
DefaultView member of 'Tables', returns a view of the data. It is this series
of statements that connects our DataGrid to our DataSet. <o:p></o:p></p>

<p class=Cbase><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=Cbase>If we halt at this stage, no output will be displayed. To
display data on the screen, a function called DataBind from the DataGrid class,
has to be invoked. This function populates the DataGrid with data. <o:p></o:p></p>

<p class=Cbase><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=Cbase>The DataBind function internally performs numerous tasks. The
programmers who wrote the code for this function obviously possessed an
extremely high IQ, since, it is no mean task to write a function that is
endowed with such a high level of complexity. This function firstly ascertains
the number of rows and columns in the result set. Accordingly, it creates an
HTML table with the specified number of rows and columns. Thereafter, it
retrieves the values from the result set and fills the table with all the data.
Effortlessly, we can now view the data from a table in the database, simply by
using one function.<o:p></o:p></p>

<p class=Cbase><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=Cbase>In our opinion, the DataGrid control is extremely significant.
So, we shall spend a little more time in understanding this control in greater
detail, before shifting our focus to SQLServer. Since it is not our intention
to confuse you any further, we shall populate the Data Grid with static data.
We shall enter the data ourselves, rather than obtaining it from a database.<o:p></o:p></p>

<p class=Cbase><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=Cbase>This DataGrid server control not only displays data in a tabular
form, but also consents to perform certain basic operations on it, such as
select, sort, page, edit, etc. <o:p></o:p></p>

<p class=Cbase><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=Cbase>By default, the number of fields displayed in the control, are
equal to the number of columns found in the data source. The field names appear
at the top and all the values, irrespective of their data type, are rendered as
text labels in a default format.<o:p></o:p></p>

<p class=Cprg><u>a.aspx</u><o:p></o:p></p>

<p class=Cprg>&lt;%@ Import Namespace=&quot;System.Data&quot; %&gt;<o:p></o:p></p>

<p class=Cprg>&lt;html&gt;<o:p></o:p></p>

<p class=Cprg>&lt;script language=&quot;C#&quot; runat=&quot;server&quot;&gt;<o:p></o:p></p>

<p class=Cprg>void Page_Load(Object s, EventArgs e) <o:p></o:p></p>

<p class=Cprg>{<o:p></o:p></p>

<p class=Cprg>DataTable d = new DataTable();<o:p></o:p></p>

<p class=Cprg>DataColumn c = new DataColumn(&quot;Integer&quot;,
typeof(Int32));<o:p></o:p></p>

<p class=Cprg>DataColumnCollection c1 = d.Columns;<o:p></o:p></p>

<p class=Cprg>c1.Add(c);<o:p></o:p></p>

<p class=Cprg>d.Columns.Add(new DataColumn(&quot;Vijay&quot;, typeof(string)));<o:p></o:p></p>

<p class=Cprg>d.Columns.Add(new DataColumn(&quot;Sonal&quot;, typeof(bool)));<o:p></o:p></p>

<p class=Cprg>DataRow dr;<o:p></o:p></p>

<p class=Cprg>dr = d.NewRow();<o:p></o:p></p>

<p class=Cprg>dr[0] = 1;<o:p></o:p></p>

<p class=Cprg>dr[1] = &quot;vijay1&quot;;<o:p></o:p></p>

<p class=Cprg>dr[2] = true;<o:p></o:p></p>

<p class=Cprg>d.Rows.Add(dr);<o:p></o:p></p>

<p class=Cprg>dr = d.NewRow();<o:p></o:p></p>

<p class=Cprg>dr[0] = 2;<o:p></o:p></p>

<p class=Cprg>dr[1] = &quot;vijay2&quot;;<o:p></o:p></p>

<p class=Cprg>dr[2] = false;<o:p></o:p></p>

<p class=Cprg>d.Rows.Add(dr);<o:p></o:p></p>

<p class=Cprg>DataView dv = new DataView(d);<o:p></o:p></p>

<p class=Cprg>l.DataSource = dv;<o:p></o:p></p>

<p class=Cprg>l.DataBind();<o:p></o:p></p>

<p class=Cprg>}<o:p></o:p></p>

<p class=Cprg>&lt;/script&gt;<o:p></o:p></p>

<p class=Cprg>&lt;body&gt;<o:p></o:p></p>

<p class=Cprg>&lt;form runat=server&gt;<o:p></o:p></p>

<p class=Cprg>&lt;ASP:DataGrid id=&quot;l&quot; runat=&quot;server&quot;
BorderColor=&quot;red&quot; BorderWidth=&quot;1&quot;
GridLines=&quot;Both&quot; CellPadding=&quot;3&quot;
CellSpacing=&quot;4&quot;<span style="mso-spacerun: yes">  
</span>Font-Name=&quot;Verdana&quot;<span style="mso-spacerun: yes">  
</span>Font-Size=&quot;8pt&quot; HeaderStyle-BackColor=&quot;#aaaadd&quot;
/&gt;<o:p></o:p></p>

<p class=Cprg>&lt;/form&gt;<o:p></o:p></p>

<p class=Cprg>&lt;/body&gt;<o:p></o:p></p>

<p class=Cprg>&lt;/html&gt;<o:p></o:p></p>

<p class=Coutput><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=Coutput><u>Output</u><o:p></o:p></p>

<p class=Coutput><img width=152 height=95 id="_x0000_i1028"
src="chap5img/img1.bmp"><o:p></o:p></p>

<p class=Cbase><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=Cbase>As usual, the function Page_Load is called automatically. Here,
we first create an object d, which is an instance of the class DataTable. Since
every table has columns, a separate object c of type DataColumn class, is created
to represent a column. The constructor of the DataColumn class takes two
parameters: <o:p></o:p></p>

<p class=Cbase><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=Cbullets><span style='mso-bidi-font-size:12.0pt;font-family:"Times New Roman"'>•<span
style='mso-tab-count:1'>     </span></span>The first is the column name i.e.
Integer, enclosed within double quotes.<o:p></o:p></p>

<p class=Cbullets><span style='mso-bidi-font-size:12.0pt;font-family:"Times New Roman"'>•<span
style='mso-tab-count:1'>     </span></span>The second is the data type of the
column. <o:p></o:p></p>

<p class=Cbase><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=Cbase>The class int is internally known as Int32. The word 'typeof' is
a C# keyword, which returns an object of class Type. The syntax typeof(Int32)
places an object of class Type representing the Int32 datatype, as the second
parameter to the contructor.<o:p></o:p></p>

<p class=Cbase><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=Cbase>An extremely large number of columns can be displayed in the
DataGrid. Therefore, we need some mechanism to keep track of all these columns.
This is where the Columns property which is available in the class DataTable,
comes handy. This property returns an instance to the DataColumnCollection
Object, which is stored in object c1. The Add function is called off the object
c1, to store the column c. <o:p></o:p></p>

<p class=Cbase><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=Cbase>Similarly, we can add two or more columns to our Data Table. The
column named Vijay will contain data of type string, whereas, the column Sonal
can only hold the data of type bool. However this time, we sidestep the
DataColumnCollection statement and write these steps in one single statement.
You can choose whichever method you are most comfortable with.<o:p></o:p></p>

<p class=Cbase><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=Cbase>Once the columns have been added, we have to introduce the rows
containing data for each of the column. To achieve this, we now create an
object dr, which is an instance of the class DataRow, to represent a row of
data. This object is then added to the DataGrid. The NewRow function creates a
blank row. So, before adding it, we have to populate the three columns with
some data. <o:p></o:p></p>

<p class=Cbase><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=Cbase>The first column is represented by the variable dr[0], the
second by the variable dr[1], and<span style="mso-spacerun: yes">  </span>the
third by the variable dr[2]. The square brackets are part of the syntax.
Thereafter, we initialize the first column to an int value of 1, the second
column to a string value of 'Vijay' and the third column to a bool value of
True. Once the values are assigned to every column, the row is added to the
table by calling the Add function in the Rows class of the DataTable.<o:p></o:p></p>

<p class=Cbase><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=Cbase>We repeat the same procedure to add the second row. The
DataTable object now consists of three columns and two rows. <o:p></o:p></p>

<p class=Cbase><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=Cbase>We need one more object, which is a DataView object. The constructor
of this object is provided with a DataTable object called 'd'. The DataSource
property within DataGrid, accepts a DataView object and indirectly maps it to
the DataTable object. Finally, DataBind is called to display the data within
the table.<o:p></o:p></p>

<p class=Cbase><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=Cbase>The DataGrid control has many more attributes, such as,
foreground color, background color, spacing between columns, grid lines between
columns, and so on. These options are endless. You could spend a month
enhancing the look and feel of the DataGrid, however, we would advise you
against spending your quality time in this manner, at this stage. <o:p></o:p></p>

<p class=Cbase><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=Cprg><u>a.aspx</u><o:p></o:p></p>

<p class=Cprg>&lt;%@ Import Namespace=&quot;System.Data&quot; %&gt;<o:p></o:p></p>

<p class=Cprg>&lt;html&gt;<o:p></o:p></p>

<p class=Cprg>&lt;script language=&quot;C#&quot; runat=&quot;server&quot;&gt;<o:p></o:p></p>

<p class=Cprg>void Page_Load(Object s, EventArgs e) <o:p></o:p></p>

<p class=Cprg>{<o:p></o:p></p>

<p class=Cprg>DataTable d = new DataTable();<o:p></o:p></p>

<p class=Cprg>DataColumn c = new DataColumn(&quot;Integer&quot;,
typeof(Int32));<o:p></o:p></p>

<p class=Cprg>DataColumnCollection c1 = d.Columns;<o:p></o:p></p>

<p class=Cprg>c1.Add(c);<o:p></o:p></p>

<p class=Cprg>d.Columns.Add(new DataColumn(&quot;bad&quot;, typeof(double)));<o:p></o:p></p>

<p class=Cprg>DataRow dr;<o:p></o:p></p>

<p class=Cprg>dr = d.NewRow();<o:p></o:p></p>

<p class=Cprg>dr[0] = 11;<o:p></o:p></p>

<p class=Cprg>dr[1] = 1.234567;<o:p></o:p></p>

<p class=Cprg>d.Rows.Add(dr);<o:p></o:p></p>

<p class=Cprg>dr = d.NewRow();<o:p></o:p></p>

<p class=Cprg>dr[0] = 2;<o:p></o:p></p>

<p class=Cprg>dr[1] = 4.3;<o:p></o:p></p>

<p class=Cprg>d.Rows.Add(dr);<o:p></o:p></p>

<p class=Cprg>DataView dv = new DataView(d);<o:p></o:p></p>

<p class=Cprg>l.DataSource = dv;<o:p></o:p></p>

<p class=Cprg>l.DataBind();<o:p></o:p></p>

<p class=Cprg>}<o:p></o:p></p>

<p class=Cprg>&lt;/script&gt;<o:p></o:p></p>

<p class=Cprg>&lt;body&gt;<o:p></o:p></p>

<p class=Cprg>&lt;form runat=server&gt;<o:p></o:p></p>

<p class=Cprg>&lt;ASP:DataGrid id=&quot;l&quot; runat=&quot;server&quot;
BorderColor=&quot;black&quot; BorderWidth=&quot;1&quot;
GridLines=&quot;Both&quot; CellPadding=&quot;3&quot; CellSpacing=&quot;0&quot;<o:p></o:p></p>

<p class=Cprg><span style="mso-spacerun:
yes"> </span>AutoGenerateColumns=&quot;false&quot;&gt;<o:p></o:p></p>

<p class=Cprg>&lt;Columns&gt;<o:p></o:p></p>

<p class=Cprg>&lt;asp:BoundColumn HeaderText=&quot;Price&quot;
DataField=&quot;bad&quot; DataFormatString=&quot;{0:c}&quot;
ItemStyle-HorizontalAlign=&quot;right&quot; /&gt;<o:p></o:p></p>

<p class=Cprg>&lt;asp:BoundColumn HeaderText=&quot;vijay&quot;
DataField=&quot;Integer&quot; /&gt;<o:p></o:p></p>

<p class=Cprg>&lt;/Columns&gt;<o:p></o:p></p>

<p class=Cprg>&lt;/asp:DataGrid&gt;<o:p></o:p></p>

<p class=Cprg>&lt;/form&gt;<o:p></o:p></p>

<p class=Cprg>&lt;/body&gt;<o:p></o:p></p>

<p class=Cprg>&lt;/html&gt;<o:p></o:p></p>

<p class=Cbase><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=Coutput><u>Output</u><o:p></o:p></p>

<p class=Coutput><img width=79 height=75 id="_x0000_i1029"
src="chap5img/img2.bmp"><o:p></o:p></p>

<p class=Coutput><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=Cbase>Most of the code in the function Page_Load remains the same,
except that we have removed one column completely and renamed the other column.
This is to make the program smaller in size. The data type of the second column
is 'double'. Hence, we can store values having decimal points in this column.<o:p></o:p></p>

<p class=Cbase><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=Cbase>The &lt;asp:DataGrid tag is given the same id of<span
style='font-family:"Trebuchet MS"'> l,</span> alongwith the other attributes of
BorderColor, BorderWidth, and Autogeneratedcolumns. If you observe carefully,
you will realise that the DataGrid tag does not end on the same line. The
forward slash is now missing. Instead, we have closed the tag after a couple of
lines, just as we did in the case of an HTML tag, using &lt;/asp:DataGrid&gt;.<o:p></o:p></p>

<p class=Cbase><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=Cbase>All statements inserted within the opening and the closing tag
relate to the same object.<span style="mso-spacerun: yes">  </span>One of the
elements of the DataGrid object is 'property'. It is given the name Columns,
which is a reserved word with a special meaning, and it ends after two lines. <o:p></o:p></p>

<p class=Cbase><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=Cbase>Within the property tag, we have another control called
&lt;asp:BoundColumn, that represents the actual columns displayed. The new
values given here, override the Column properties created in the function abc.
The value given to HeaderText gets displayed as the column header, and
DataField represents the column name that is to be changed. The column called
'bad' has two additional properties:<o:p></o:p></p>

<p class=Cbase><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=Cbullets><span style='mso-bidi-font-size:12.0pt;font-family:"Times New Roman"'>•<span
style='mso-tab-count:1'>     </span></span>The first is DataFormatString, where
we want the currency field displayed, with two decimal places.<o:p></o:p></p>

<p class=Cbullets><span style='mso-bidi-font-size:12.0pt;font-family:"Times New Roman"'>•<span
style='mso-tab-count:1'>     </span></span>The second is
ItemStyle-HorizontalAlign, which aligns the data to the right. <o:p></o:p></p>

<p class=Cbase><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=Cbase>The control called BoundColumn influences the manner in which
columns are displayed.<o:p></o:p></p>

<p class=Cbase><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=Cprg><u>a.aspx</u><o:p></o:p></p>

<p class=Cprg>&lt;%@ Import Namespace=&quot;System.Data&quot; %&gt;<o:p></o:p></p>

<p class=Cprg>&lt;html&gt;<o:p></o:p></p>

<p class=Cprg>&lt;script language=&quot;C#&quot; runat=&quot;server&quot;&gt;<o:p></o:p></p>

<p class=Cprg>void Page_Load(Object s, EventArgs e) <o:p></o:p></p>

<p class=Cprg>{<o:p></o:p></p>

<p class=Cprg>DataTable d = new DataTable();<o:p></o:p></p>

<p class=Cprg>d.Columns.Add(new DataColumn(&quot;c1&quot;,
typeof(Int32)));<span style="mso-spacerun: yes">            </span><o:p></o:p></p>

<p class=Cprg>d.Columns.Add(new DataColumn(&quot;c2&quot;, typeof(string)));<o:p></o:p></p>

<p class=Cprg>DataRow dr;<o:p></o:p></p>

<p class=Cprg>dr = d.NewRow();<o:p></o:p></p>

<p class=Cprg>dr[0] = 11;<o:p></o:p></p>

<p class=Cprg>dr[1] = &quot;String 1&quot;;<o:p></o:p></p>

<p class=Cprg>d.Rows.Add(dr);<o:p></o:p></p>

<p class=Cprg>dr = d.NewRow();<o:p></o:p></p>

<p class=Cprg>dr[0] = 2;<o:p></o:p></p>

<p class=Cprg>dr[1] = &quot;String 2&quot;;<o:p></o:p></p>

<p class=Cprg>d.Rows.Add(dr);<o:p></o:p></p>

<p class=Cprg>DataView dv = new DataView(d);<o:p></o:p></p>

<p class=Cprg>l.DataSource = dv;<o:p></o:p></p>

<p class=Cprg>l.DataBind();<o:p></o:p></p>

<p class=Cprg>}<o:p></o:p></p>

<p class=Cprg>&lt;/script&gt;<o:p></o:p></p>

<p class=Cprg>&lt;body&gt;<o:p></o:p></p>

<p class=Cprg>&lt;form runat=server&gt;<o:p></o:p></p>

<p class=Cprg>&lt;ASP:DataGrid id=&quot;l&quot; runat=&quot;server&quot;
GridLines=&quot;Both&quot; AutoGenerateColumns=&quot;false&quot;&gt;<o:p></o:p></p>

<p class=Cprg>&lt;Columns&gt;<o:p></o:p></p>

<p class=Cprg>&lt;asp:HyperLinkColumn HeaderText=&quot;Text of Header&quot;
DataNavigateUrlField =&quot;c1&quot; DataNavigateUrlFormatString
=&quot;a1.aspx?mukhi={0}&quot;<o:p></o:p></p>

<p class=Cprg><span style="mso-spacerun: yes">               
</span>DataTextField =&quot;c2&quot; Target=&quot;_new&quot; /&gt;<o:p></o:p></p>

<p class=Cprg>&lt;/Columns&gt;<o:p></o:p></p>

<p class=Cprg>&lt;/asp:DataGrid&gt;<o:p></o:p></p>

<p class=Cprg>&lt;/form&gt;<o:p></o:p></p>

<p class=Cprg>&lt;/body&gt;<o:p></o:p></p>

<p class=Cprg>&lt;/html&gt;<o:p></o:p></p>

<p class=Cbase><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=Cprg><u>a1.aspx</u><o:p></o:p></p>

<p class=Cprg>&lt;html&gt;<o:p></o:p></p>

<p class=Cprg>&lt;head&gt;<o:p></o:p></p>

<p class=Cprg>&lt;script language=&quot;C#&quot; runat=&quot;server&quot;&gt;<o:p></o:p></p>

<p class=Cprg>string s;<o:p></o:p></p>

<p class=Cprg>void Page_Load(Object sender, EventArgs e) <o:p></o:p></p>

<p class=Cprg>{<o:p></o:p></p>

<p class=Cprg>s=Request.QueryString[&quot;mukhi&quot;];<o:p></o:p></p>

<p class=Cprg>}<o:p></o:p></p>

<p class=Cprg>&lt;/script&gt;<o:p></o:p></p>

<p class=Cprg>&lt;/head&gt;<o:p></o:p></p>

<p class=Cprg>&lt;body&gt;<o:p></o:p></p>

<p class=Cprg>You selected &lt;%= s %&gt;<o:p></o:p></p>

<p class=Cprg>&lt;/body&gt;<o:p></o:p></p>

<p class=Cprg>&lt;/html&gt;<o:p></o:p></p>

<p class=Cbase><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=Coutput><u>Output</u><o:p></o:p></p>

<p class=Coutput><img width=94 height=66 id="_x0000_i1030"
src="chap5img/img3.bmp"><o:p></o:p></p>

<p class=Coutput><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=Coutput><u>Output </u>:<u> when String 1 is selected</u><o:p></o:p></p>

<p class=Coutput>http://127.0.0.1/a1.aspx?mukhi=11<o:p></o:p></p>

<p class=Coutput>You selected 11<o:p></o:p></p>

<p class=Coutput><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=Coutput><u>Output </u>:<u> when String 2 is selected</u><o:p></o:p></p>

<p class=Coutput>http://127.0.0.1/a1.aspx?mukhi=2<o:p></o:p></p>

<p class=Coutput>You selected 2<o:p></o:p></p>

<p class=Cbase><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=Cbase>In the function Page_Load, we have two columns c1 and c2,
consisting of data types Int32 and string, respectively. Most of the code is
similar to the earlier program, except for a few changes in the variable names
and values. <o:p></o:p></p>

<p class=Cbase><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=Cbase>We now introduce a new tag called &lt;asp:HyperLinkColumn within
the property tag. The attribute HeaderText is used to display the column
heading. The most important attribute with the HyperLinkColumn control is
DataTextField, which is assigned a column name. The text in this column becomes
a hyperlink. DataTextField is initialized to the value of c2. Hence, String 1
and String 2 are displayed as hyperlinks on the table. <o:p></o:p></p>

<p class=Cbase><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=Cbase>When we click on any of the hyperlinks, a URL is required for
navigation. We can decide on the format of this url by initializing the
attribute DataNavigateUrlFormatString to a value. In this case, we have
provided the value a1.aspx?'mukhi'={0}.<o:p></o:p></p>

<p class=Cbase><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=Cbase>ASP+ automatically adds http://localhost/ to the value and
replaces {0} with the value of column c1. Thus, {0} is replaced by the contents
of column c1, depending on the string that is selected. In case of String 1,
the URL becomes http://localhost/a1.aspx?'mukhi'=11.<span style="mso-spacerun:
yes">  </span>Since Target is initialized to _new, it will open a new browser
window to display the contents of the file.<o:p></o:p></p>

<p class=Cbase><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=Cbase>The program a1.aspx displays the value of the parameter mukhi.
This value is retrieved by using Request.QueryString with the parameter name,
and then it is stored in a string called 's'. The value is then displayed on
the screen using &lt;%=. <o:p></o:p></p>

<p class=Cbase><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=Cbase>Thus, we can use the tag HyperLinkColumn to convert values in a
column of a DataGrid, into a hyperlink. Although we can use as many of such
Column types as we like, however presently, as we are still learning the
concept, we have restricted ourselves to only one Column type. Hence, we are
not using BoundColumn in the same example. However, nothing stops you from
doing so.<o:p></o:p></p>

<p class=Cbase><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=Cbase>By clicking on the hyperlink in the file a1.aspx, we could use
the value of 'mukhi' to load another series of records from a database. We can
add more code to the file a1.aspx if we so desire.<o:p></o:p></p>

<p class=Cbase><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=Cprg><u>a.aspx</u><o:p></o:p></p>

<p class=Cprg>&lt;%@ Import Namespace=&quot;System.Data&quot; %&gt;<o:p></o:p></p>

<p class=Cprg>&lt;html&gt;<o:p></o:p></p>

<p class=Cprg>&lt;script language=&quot;C#&quot; runat=&quot;server&quot;&gt;<o:p></o:p></p>

<p class=Cprg>void Page_Load(Object s, EventArgs e) <o:p></o:p></p>

<p class=Cprg>{<o:p></o:p></p>

<p class=Cprg>DataTable d = new DataTable();<o:p></o:p></p>

<p class=Cprg>d.Columns.Add(new DataColumn(&quot;c1&quot;,
typeof(Int32)));<span style="mso-spacerun: yes">            </span><o:p></o:p></p>

<p class=Cprg>d.Columns.Add(new DataColumn(&quot;c2&quot;, typeof(string)));<o:p></o:p></p>

<p class=Cprg>DataRow dr;<o:p></o:p></p>

<p class=Cprg>dr = d.NewRow();<o:p></o:p></p>

<p class=Cprg>dr[0] = 11;<o:p></o:p></p>

<p class=Cprg>dr[1] = &quot;String 1&quot;;<o:p></o:p></p>

<p class=Cprg>d.Rows.Add(dr);<o:p></o:p></p>

<p class=Cprg>dr = d.NewRow();<o:p></o:p></p>

<p class=Cprg>dr[0] = 2;<o:p></o:p></p>

<p class=Cprg>dr[1] = &quot;String 2&quot;;<o:p></o:p></p>

<p class=Cprg>d.Rows.Add(dr);<o:p></o:p></p>

<p class=Cprg>DataView dv = new DataView(d);<o:p></o:p></p>

<p class=Cprg>l.DataSource = dv;<o:p></o:p></p>

<p class=Cprg>l.DataBind();<o:p></o:p></p>

<p class=Cprg>}<o:p></o:p></p>

<p class=Cprg>&lt;/script&gt;<o:p></o:p></p>

<p class=Cprg>&lt;body&gt;<o:p></o:p></p>

<p class=Cprg>&lt;form runat=server&gt;<o:p></o:p></p>

<p class=Cprg>&lt;ASP:DataGrid id=&quot;l&quot; runat=&quot;server&quot;
GridLines=&quot;Both&quot; AutoGenerateColumns=&quot;true&quot;&gt;<o:p></o:p></p>

<p class=Cprg>&lt;Columns&gt;<o:p></o:p></p>

<p class=Cprg>&lt;asp:BoundColumn HeaderText=&quot;Vijay&quot;
DataField=&quot;c1&quot; /&gt;<o:p></o:p></p>

<p class=Cprg>&lt;asp:BoundColumn HeaderText=&quot;mukhi&quot;
DataField=&quot;c2&quot;/&gt;<o:p></o:p></p>

<p class=Cprg>&lt;/Columns&gt;<o:p></o:p></p>

<p class=Cprg>&lt;/asp:DataGrid&gt;<o:p></o:p></p>

<p class=Cprg>&lt;/form&gt;<o:p></o:p></p>

<p class=Cprg>&lt;/body&gt;<o:p></o:p></p>

<p class=Cprg>&lt;/html&gt;<o:p></o:p></p>

<p class=Cbase><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=Coutput><u>Output</u><o:p></o:p></p>

<p class=Coutput><img width=150 height=66 id="_x0000_i1031"
src="chap5img/img4.bmp"><o:p></o:p></p>

<p class=Cbase><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=Cbase>Instead of two columns, we are now presented with four columns,
because the property called AutoGenerateColumns is initialized to True. This
modifies our DataGrid completely. We first see our Bound Columns 'Vijay' and
'mukhi', and then the columns that we have created in our DataTable, c1 and c2.
<o:p></o:p></p>

<p class=Cbase><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=Cbase>If the attributeAutoGenerateColumns is assigned the value of
False, as was the case in the earlier programs, the columns originally placed
in the DataTable get overridden by the new ones.<o:p></o:p></p>

<p class=Cbase><span style="mso-spacerun: yes"> </span><o:p></o:p></p>

<p class=Cbase><b><span style='font-size:14.0pt;font-family:"Times New Roman"'>Session
Variables</span></b><o:p></o:p></p>

<p class=Cbase><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=Cprg><u>a.aspx</u><o:p></o:p></p>

<p class=Cprg>&lt;html&gt;<o:p></o:p></p>

<p class=Cprg>&lt;script language=&quot;C#&quot; runat=&quot;server&quot;&gt;<o:p></o:p></p>

<p class=Cprg>int i;<o:p></o:p></p>

<p class=Cprg>void Page_Load(Object sender, EventArgs e) <o:p></o:p></p>

<p class=Cprg>{<o:p></o:p></p>

<p class=Cprg>i = (int)Session[&quot;mukhi&quot;];<o:p></o:p></p>

<p class=Cprg>}<o:p></o:p></p>

<p class=Cprg>&lt;/script&gt;<o:p></o:p></p>

<p class=Cprg>&lt;body&gt;<o:p></o:p></p>

<p class=Cprg>&lt;form runat=server&gt;<o:p></o:p></p>

<p class=Cprg>&lt;%= i %&gt;<o:p></o:p></p>

<p class=Cprg>&lt;/form&gt;<o:p></o:p></p>

<p class=Cprg>&lt;/body&gt;<o:p></o:p></p>

<p class=Cprg>&lt;/html&gt;<o:p></o:p></p>

<p class=Cbase><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=Coutput><u>Output</u><o:p></o:p></p>

<p class=Coutput>Server Error in '/' Application.<o:p></o:p></p>

<p class=Coutput>-------------------------------------------------------------------------<o:p></o:p></p>

<p class=Coutput>Value null was found where an instance of an object was
required. <o:p></o:p></p>

<p class=Cbase><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=Cbase>When the file is loaded in the browser, we get an application
error. Let us understand the cause for this. <o:p></o:p></p>

<p class=Cbase><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=Cbase>We have used a free object called Session with the [] brackets,
to reference a word called 'mukhi'.The return value of this Statement is stored
in the variable i. Since it has generated a null reference error, it confirms
that the word 'mukhi' does not exist in the Session object. It can safely be
assumed that there is nothing wrong with our syntax.<o:p></o:p></p>

<p class=Cbase><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=Cprg><u>a.aspx</u><o:p></o:p></p>

<p class=Cprg>&lt;html&gt;<o:p></o:p></p>

<p class=Cprg>&lt;script language=&quot;C#&quot; runat=&quot;server&quot;&gt;<o:p></o:p></p>

<p class=Cprg>int i;<o:p></o:p></p>

<p class=Cprg>void Page_Load(Object sender, EventArgs e) <o:p></o:p></p>

<p class=Cprg>{<o:p></o:p></p>

<p class=Cprg>if ( Session[&quot;mukhi&quot;] == null)<o:p></o:p></p>

<p class=Cprg>{<o:p></o:p></p>

<p class=Cprg>Response.Write(&quot;one&lt;br&gt;&quot;);<o:p></o:p></p>

<p class=Cprg>i = 1;<o:p></o:p></p>

<p class=Cprg>Session[&quot;mukhi&quot;] = 20;<o:p></o:p></p>

<p class=Cprg>}<o:p></o:p></p>

<p class=Cprg>else<o:p></o:p></p>

<p class=Cprg>{<o:p></o:p></p>

<p class=Cprg>Response.Write(&quot;two&lt;br&gt;&quot;);<o:p></o:p></p>

<p class=Cprg>i = (int) Session[&quot;mukhi&quot;] ;<o:p></o:p></p>

<p class=Cprg>}<o:p></o:p></p>

<p class=Cprg>}<o:p></o:p></p>

<p class=Cprg>&lt;/script&gt;<o:p></o:p></p>

<p class=Cprg>&lt;body&gt;<o:p></o:p></p>

<p class=Cprg>&lt;form runat=server&gt;<o:p></o:p></p>

<p class=Cprg>&lt;%= i %&gt;<o:p></o:p></p>

<p class=Cprg>&lt;/form&gt;<o:p></o:p></p>

<p class=Cprg>&lt;/body&gt;<o:p></o:p></p>

<p class=Cprg>&lt;/html&gt;<o:p></o:p></p>

<p class=Coutput><span style='font-size:10.0pt;font-family:"Bookman Old Style"'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=Coutput><u>Output</u><o:p></o:p></p>

<p class=Coutput>one<o:p></o:p></p>

<p class=Coutput>1<o:p></o:p></p>

<p class=Cbase><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=Cbase>Let us try to understand this program step by step. We request
you to run this program in the manner that we want you to, otherwise, our
explanations may appear incomprehensible to you. When we run the aspx file in
our browser, we get the output as displayed above.<o:p></o:p></p>

<p class=Cbase><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=Cbase>The function Page_Load gets called, each time the page is sent
to the browser. The earlier program failed because the value returned by
Session[&quot;mukhi&quot;], was null. Continuing on these lines, in the current
program, the 'if' statement results in True, since Session[&quot;mukhi&quot;]
returns null. The Write function therefore displays one. Thereafter, the
variable i is given a new value of 1, and Session[&quot;mukhi&quot;] is
initialized to 20.<o:p></o:p></p>

<p class=Cbase><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=Cbase>Session['mukhi'] is initialized like any other variable, to a
value. Since it is not a variable, this statement creates a word or a variable
called 'mukhi', and links it with the running copy of your browser. <o:p></o:p></p>

<p class=Cbase>&lt;%= i %&gt; within the form tags, displays the value of i as
1. <o:p></o:p></p>

<p class=Cbase><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=Cbase>When you click on the Refresh Button in your browser, it will
restart the procedure of requesting for the current file a.aspx from the
server. Since the page is to be sent over, the function Page_Load is called
once again. It is all the same, but this time, the 'if' condition with
Session[&quot;mukhi&quot;], fails. Since we have assigned it a value of 20, the
session with 'mukhi' in square brackets, fetches the value of the variable
'mukhi'. Therefore, it is not null in this case. Hence, the output is as
follows:<o:p></o:p></p>

<p class=Cbase><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=Coutput><u>Output</u><o:p></o:p></p>

<p class=Coutput>two<o:p></o:p></p>

<p class=Coutput>20<o:p></o:p></p>

<p class=Cbase><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=Cbase>Since the 'else' block of 'if' statement is called, the value
two is displayed, and the value of i is displayed as 20, since 'mukhi' was
assigned this value earlier. <o:p></o:p></p>

<p class=Cbase><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=Cbase>To summarize, Session[&quot;mukhi&quot;'] creates a variable
called 'mukhi' in the first round, if it doesn't already exist. By default, the
value assigned to it is null, and hence, we have to initialize it to some
value. In future, 'mukhi'- the session variable can be used like any normal
variable. <o:p></o:p></p>

<p class=Cbase><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=Cbase>What is so special about creating variables? Have we not created
enough of them?<o:p></o:p></p>

<p class=Cbase><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=Cbase>It is important to realise that the session variables are
special. To prove this, start a fresh copy of the browser. To your utter
surprise, you will see One and 1 displayed on the screen again. When you click
on the Refresh button, you will see Two and 20. <o:p></o:p></p>

<p class=Cbase><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=Cbase>This implies that ASP+ keeps track of the browser copies you are
working with while accessing the same file. Each copy of the browser has a
different value for 'mukhi'. Thus, 'mukhi' is a variable, but with a dash of
lime. Every time we start a new copy of the browser, we get a new copy of this
variable too. As a new browser starts a new session, all variables like 'mukhi'
that are associated with a session, get reinitialized to their initial values. <o:p></o:p></p>

<p class=Cbase><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=Cbase>This functionality is akin to ASP+, having a million eyes to
monitor your activities, with every new copy of the browser. How it undertakes
supervision of this magnitude, is yet another story! <o:p></o:p></p>

<p class=Cbase><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=Cbase>Given below is another program designed to make the concept of
sessions, more comprehensible for you.<o:p></o:p></p>

<p class=Cbase><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=Cprg><u>a.aspx</u><o:p></o:p></p>

<p class=Cprg>&lt;html&gt;<o:p></o:p></p>

<p class=Cprg>&lt;script language=&quot;C#&quot; runat=&quot;server&quot;&gt;<o:p></o:p></p>

<p class=Cprg>int i;<o:p></o:p></p>

<p class=Cprg>void Page_Load(Object sender, EventArgs e) <o:p></o:p></p>

<p class=Cprg>{<o:p></o:p></p>

<p class=Cprg>if ( Session[&quot;mukhi&quot;] == null)<o:p></o:p></p>

<p class=Cprg>{<o:p></o:p></p>

<p class=Cprg>i = 0;<o:p></o:p></p>

<p class=Cprg>Session[&quot;mukhi&quot;] = (int)i;<o:p></o:p></p>

<p class=Cprg>}<o:p></o:p></p>

<p class=Cprg>else<o:p></o:p></p>

<p class=Cprg>{<o:p></o:p></p>

<p class=Cprg>i = (int) Session[&quot;mukhi&quot;] ;<o:p></o:p></p>

<p class=Cprg>i = i + 1;<o:p></o:p></p>

<p class=Cprg>Session[&quot;mukhi&quot;] = i;<o:p></o:p></p>

<p class=Cprg>}<o:p></o:p></p>

<p class=Cprg>}<o:p></o:p></p>

<p class=Cprg>&lt;/script&gt;<o:p></o:p></p>

<p class=Cprg>&lt;body&gt;<o:p></o:p></p>

<p class=Cprg>&lt;form runat=server&gt;<o:p></o:p></p>

<p class=Cprg>&lt;%= i %&gt;<o:p></o:p></p>

<p class=Cprg>&lt;/form&gt;<o:p></o:p></p>

<p class=Cprg>&lt;/body&gt;<o:p></o:p></p>

<p class=Cprg>&lt;/html&gt;<o:p></o:p></p>

<p class=Cbase><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=Coutput><u>Output</u><o:p></o:p></p>

<p class=Coutput>0<o:p></o:p></p>

<p class=Cbase><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=Cbase>When we load the above program, we get to see the number zero in
the browser window. In case you witness a value of 21, you need to start a new
copy of the browser. This is because the session variable 'mukhi' already
exists with the current copy of the browser. <o:p></o:p></p>

<p class=Cbase><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=Cbase>Each time we click on the Refresh button, the number displayed
is incremented by one. Once again, if you start a new copy of the browser, the
value displayed will again be zero. Now, click on the Refresh Button a couple
of times in the second copy, and then revert back to the first copy of the
browser. Here, the browser still displays the old value. Refresh will increment
this value, only by one. This confirms that there are two independent copies of
'mukhi', with their respective values associated with a particular copy of the
browser. <o:p></o:p></p>

<p class=Cbase><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=Cbase>The concept of sessions demonstrates the standalone behavior of
data variables, depending upon the instance of a browser. <o:p></o:p></p>

<p class=Cbase><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=Cbase><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=Subhead1><span style='font-size:14.0pt'>A Shopping Cart Example</span><!--[if supportFields]><span
style='font-size:14.0pt'><span style='mso-element:field-begin'></span></span><span
style='font-size:10.0pt;mso-bidi-font-size:18.0pt'>tc &quot;</span><span
style='font-size:14.0pt'>A Shopping Cart Example&quot;</span><![endif]--><!--[if supportFields]><span
style='font-size:14.0pt'><span style='mso-element:field-end'></span></span><![endif]--><span
style='font-size:14.0pt'><o:p></o:p></span></p>

<p class=Cbase><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=Cbase>We now apply this concept of sessions to create a shopping cart,
one of the most widely used applications on the Internet.<o:p></o:p></p>

<p class=Cbase><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=Cprg><u>a.aspx</u><o:p></o:p></p>

<p class=Cprg>&lt;%@ Import Namespace=&quot;System.Data&quot; %&gt;<o:p></o:p></p>

<p class=Cprg>&lt;html&gt;<o:p></o:p></p>

<p class=Cprg>&lt;script language=&quot;C#&quot; runat=&quot;server&quot;&gt;<o:p></o:p></p>

<p class=Cprg>DataTable Cart;<o:p></o:p></p>

<p class=Cprg>DataView cv;<o:p></o:p></p>

<p class=Cprg>void Page_Load(Object sender, EventArgs e) <o:p></o:p></p>

<p class=Cprg>{<o:p></o:p></p>

<p class=Cprg>if (Session[&quot;zzz&quot;] == null) <o:p></o:p></p>

<p class=Cprg>{<o:p></o:p></p>

<p class=Cprg>Cart = new DataTable();<o:p></o:p></p>

<p class=Cprg>Cart.Columns.Add(new DataColumn(&quot;Item&quot;, typeof(string)));<o:p></o:p></p>

<p class=Cprg>Cart.Columns.Add(new DataColumn(&quot;Price&quot;,
typeof(string)));<o:p></o:p></p>

<p class=Cprg>Session[&quot;zzz&quot;] = Cart;<o:p></o:p></p>

<p class=Cprg>}<o:p></o:p></p>

<p class=Cprg>else <o:p></o:p></p>

<p class=Cprg>{<o:p></o:p></p>

<p class=Cprg>Cart = (DataTable)Session[&quot;zzz&quot;];<o:p></o:p></p>

<p class=Cprg>}<span style="mso-spacerun: yes">    </span><o:p></o:p></p>

<p class=Cprg>cv = new DataView(Cart);<o:p></o:p></p>

<p class=Cprg>sc.DataSource = cv;<o:p></o:p></p>

<p class=Cprg>sc.DataBind();<o:p></o:p></p>

<p class=Cprg>if (!IsPostBack) <o:p></o:p></p>

<p class=Cprg>{<o:p></o:p></p>

<p class=Cprg>DataTable d = new DataTable();<o:p></o:p></p>

<p class=Cprg>d.Columns.Add(new DataColumn(&quot;c1&quot;, typeof(string)));<o:p></o:p></p>

<p class=Cprg>d.Columns.Add(new DataColumn(&quot;c2&quot;,
typeof(double)));<span style="mso-spacerun: yes">            </span><o:p></o:p></p>

<p class=Cprg>DataRow dr;<o:p></o:p></p>

<p class=Cprg>dr = d.NewRow();<o:p></o:p></p>

<p class=Cprg>dr[0] = &quot;Product 1&quot;;<o:p></o:p></p>

<p class=Cprg>dr[1] = 11.3;<o:p></o:p></p>

<p class=Cprg>d.Rows.Add(dr);<o:p></o:p></p>

<p class=Cprg>dr = d.NewRow();<o:p></o:p></p>

<p class=Cprg>dr[0] = &quot;Product 2&quot;;<o:p></o:p></p>

<p class=Cprg>dr[1] = 10.6;<o:p></o:p></p>

<p class=Cprg>d.Rows.Add(dr);<o:p></o:p></p>

<p class=Cprg>DataView dv = new DataView(d);<o:p></o:p></p>

<p class=Cprg>l.DataSource= dv;<o:p></o:p></p>

<p class=Cprg>l.DataBind();<o:p></o:p></p>

<p class=Cprg>}<o:p></o:p></p>

<p class=Cprg>}<o:p></o:p></p>

<p class=Cprg>void abc(Object sender, DataGridCommandEventArgs e) <o:p></o:p></p>

<p class=Cprg>{<o:p></o:p></p>

<p class=Cprg>DataRow dr = Cart.NewRow();<o:p></o:p></p>

<p class=Cprg>TableCell it = e.Item.Cells[2];<o:p></o:p></p>

<p class=Cprg>TableCell pr = e.Item.Cells[3];<o:p></o:p></p>

<p class=Cprg>string item = it.Text;<o:p></o:p></p>

<p class=Cprg>string price = pr.Text;<o:p></o:p></p>

<p class=Cprg>Response.Write(item + &quot; &quot; + price);<span
style="mso-spacerun: yes">        </span><o:p></o:p></p>

<p class=Cprg>if (((LinkButton)e.CommandSource).CommandName ==
&quot;AddToCart&quot;) <o:p></o:p></p>

<p class=Cprg>{<o:p></o:p></p>

<p class=Cprg>dr[0] = item;<o:p></o:p></p>

<p class=Cprg>dr[1] = price;<o:p></o:p></p>

<p class=Cprg>Cart.Rows.Add(dr);<o:p></o:p></p>

<p class=Cprg>}<o:p></o:p></p>

<p class=Cprg>else <o:p></o:p></p>

<p class=Cprg>{<o:p></o:p></p>

<p class=Cprg>cv.RowFilter = &quot;item='&quot;+item+&quot;'&quot;;<o:p></o:p></p>

<p class=Cprg>if (cv.Count &gt; 0) <o:p></o:p></p>

<p class=Cprg>{<span style="mso-spacerun: yes">    </span><o:p></o:p></p>

<p class=Cprg>cv.Delete(0);<o:p></o:p></p>

<p class=Cprg>}<o:p></o:p></p>

<p class=Cprg>cv.RowFilter = &quot;&quot;;<o:p></o:p></p>

<p class=Cprg>}<o:p></o:p></p>

<p class=Cprg>sc.DataBind();<o:p></o:p></p>

<p class=Cprg>}<o:p></o:p></p>

<p class=Cprg>&lt;/script&gt;<o:p></o:p></p>

<p class=Cprg>&lt;body&gt;<o:p></o:p></p>

<p class=Cprg>&lt;form runat=server&gt;<o:p></o:p></p>

<p class=Cprg>&lt;ASP:DataGrid id=&quot;l&quot; runat=&quot;server&quot;
AutoGenerateColumns=&quot;false&quot; OnItemCommand=&quot;abc&quot;&gt;<o:p></o:p></p>

<p class=Cprg>&lt;columns&gt;<o:p></o:p></p>

<p class=Cprg>&lt;asp:ButtonColumn HeaderText=&quot;Add to cart&quot; Text=&quot;Add&quot;
CommandName=&quot;AddToCart&quot; /&gt;<o:p></o:p></p>

<p class=Cprg>&lt;asp:ButtonColumn HeaderText=&quot;Remove from cart&quot;
Text=&quot;Remove&quot; CommandName=&quot;RemoveFromCart&quot; /&gt;<o:p></o:p></p>

<p class=Cprg>&lt;asp:BoundColumn HeaderText=&quot;Item&quot;
DataField=&quot;c1&quot;/&gt;<o:p></o:p></p>

<p class=Cprg>&lt;asp:BoundColumn HeaderText=&quot;Price&quot;
DataField=&quot;c2&quot; /&gt;<o:p></o:p></p>

<p class=Cprg>&lt;/Columns&gt;<o:p></o:p></p>

<p class=Cprg>&lt;/asp:DataGrid&gt;<o:p></o:p></p>

<p class=Cprg>&lt;ASP:DataGrid id=&quot;sc&quot; runat=&quot;server&quot;/&gt;<o:p></o:p></p>

<p class=Cprg>&lt;/form&gt;<o:p></o:p></p>

<p class=Cprg>&lt;/body&gt;<o:p></o:p></p>

<p class=Cprg>&lt;/html&gt;<o:p></o:p></p>

<p class=Cbase><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=Coutput><u>Output</u><o:p></o:p></p>

<p class=Coutput>Product 2 10.6<o:p></o:p></p>

<p class=Coutput><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=Coutput><img width=261 height=66 id="_x0000_i1032"
src="chap5img/img5.bmp"><o:p></o:p></p>

<p class=Coutput><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=Coutput><img width=94 height=83 id="_x0000_i1033"
src="chap5img/img6.bmp"><o:p></o:p></p>

<p class=Coutput><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=Cbase>We have a DataGrid with an id of<span style='font-family:"Trebuchet MS"'>
l,</span> and a property called OnItemCommand which is set to the function abc.
<o:p></o:p></p>

<p class=Cbase><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=Cbase>As before, we have the columns attribute followed by a tag
&lt;asp:ButtonColumn, that is repeated twice. It has three attributes:<o:p></o:p></p>

<p class=Cbase><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=Cbullets><span style='mso-bidi-font-size:12.0pt;font-family:"Times New Roman"'>•<span
style='mso-tab-count:1'>     </span></span>The HeaderText attribute signifies
the column header that should be displayed. Therefore, the first column in the
DataGrid control shows<span style="mso-spacerun: yes">  </span>'Add to Cart',
and the second one exhibits 'Remove from cart'. <o:p></o:p></p>

<p class=Cbullets><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=Cbullets><span style='mso-bidi-font-size:12.0pt;font-family:"Times New Roman"'>•<span
style='mso-tab-count:1'>     </span></span>Now that we are done with the column
heading, we concentrate on the data within the column. The second attribute
Text in the Button property decides the text that is to be displayed. This
value is repeated for all the rows of the table. Thus, the first column shows
Add and the second shows Remove. Every time we click on the text Add or Remove,
the function name stated in the attribute OnItemCommand, gets executed. Thus,
function abc is called. <o:p></o:p></p>

<p class=Cbullets><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=Cbullets><span style='mso-bidi-font-size:12.0pt;font-family:"Times New Roman"'>•<span
style='mso-tab-count:1'>     </span></span>Shouldn't there be a way to figure
out as to which Button Command was clicked? The third attribute in the Button
property i.e. CommandName, does exactly this. It assigns a name to a button,
which we can refer to in our code later, to figure out which button was chosen.<o:p></o:p></p>

<p class=Cbase><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=Cbase>Now, we proceed to the next two lines. We use the familiar
BoundColumn tag, which we had come across in one of the earlier programs. This
tag is used to add values contained in two columns c1 and c2 of the table, to
the DataGrid control. The HeaderText displays the column headings as Item and
Price, thus, resulting in a total of four columns. <o:p></o:p></p>

<p class=Cbase><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=Cbase>A point to be noted here is that, within the properties tag, any
tag that ends with the word Column, ends up being a column in the DataGrid. <o:p></o:p></p>

<p class=Cbase><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=Cbase>Another DataGrid Control having the id of sc, is added to the
page. You are free to add as many DataGrid controls as you like. The reason for
adding this control shall be explained in a short while.<o:p></o:p></p>

<p class=Cbase><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=Cbase>As usual, the server calls the Page_Load function. The first
line in this function checks for the existence of the zzz session variable.
Since it is null, an object called Cart, of type DataTable, is created. Two
columns are added to this table with the labels of Item and Price, to hold
string values. Following this, Session[&quot;zzz&quot;] = Cart; initializes the
zzz session variable to Cart. <o:p></o:p></p>

<p class=Cbase><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=Cbase>A session is required at this point, because the user will be
adding and eliminating items from his shopping cart. A record of the items
currently present in the shopping cart, has to be maintained.<o:p></o:p></p>

<p class=Cbase><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=Cbase>Since the first DataGrid control with the id of<span
style='font-family:"Trebuchet MS"'> l,</span> has a fixed number of records and
cannot be changed, the second DataGrid having the id of sc, is utilized to hold
the items added or removed by the user. The number of records contained in it,
keep varying constantly.<o:p></o:p></p>

<p class=Cbase><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=Cbase>It is imperative to maintain this state information from one
copy of the browser to another. Therefore, we had initially created a DataTable
object with the two Columns of Item and Price, and stored it in the cart
object. No data is added to or deleted from this DataTable, unless the user
clicks on the Add or Remove Text. Further, this DataTable has to be created
only once, at the very beginning, so that a blank DataTable is displayed when
the user loads this file for the first time. <o:p></o:p></p>

<p class=Cbase><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=Coutput><u>Output</u><o:p></o:p></p>

<p class=Coutput><img width=262 height=82 id="_x0000_i1034"
src="chap5img/img7.bmp"><o:p></o:p></p>

<p class=Cbase><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=Cbase>When the user clicks on the Refresh button, or the page is again
requested from the server, the 'else' block is called, which initializes the
cart object to the values contained in zzz. <o:p></o:p></p>

<p class=Cbase><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=Cbase>Irrespective of the statements being called, an object called
cv, which is an instance of the class DataView, is created every time. The
constructor of this class is called with the Cart object. The DataSource member
of the second DataGrid control named sc, is assigned to cv, thereby associating
the data within cv with the DataGrid Control. Since there are no records in the
shopping cart currently, DataGrid does not display any records.<o:p></o:p></p>

<p class=Cbase><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=Cbase>Before we explore about filling up data in the second DataGrid
control, in greater detail, we need to populate the first one with some data.
Two columns, c1 and c2 with two records, are added to the DataTable object
called 'd'. As this data is to be inserted only once, we can place it either in
the 'if' block when the session variable holds a null value, or when IsPostBack
returns a value of False.<o:p></o:p></p>

<p class=Cbase><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=Cbase>We prefer to employ the second method because the original
Microsoft sample uses it. You are at a liberty to choose whichever method suits
you. This is how the first DataGrid is supplied with data. Keep in mind that
this is a one-time activity. The GridControl displays these values on the
browser screen.<o:p></o:p></p>

<p class=Cbase><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=Cbase>Each time we click on the Add or Remove text, the function abc
gets called. The second parameter to this function i.e.
DataGridCommandEventArgs e, is of importance here.<o:p></o:p></p>

<p class=Cbase><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=Cbase>Since the text Add and Remove are repeated for every row, we
first need to identify the row that the user has clicked on.<o:p></o:p></p>

<p class=Cbase><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=Cbase>A DataGrid is made up of a number of rows and columns, and we
want to identify the specific column when the row is known to us.
DataGridCommandEventArgs has a member called Item, which represents a row.
Thus, using e.Item, we can identify the row that the user has clicked on. This
row has four columns. The first two are ButtonColumns and the next two are
BoundColumns. We are interested in the values contained in the last two
columns. As the column numbering start from zero, the Cells[0] member in Items,
represents the first column. In the same manner, Cells[2] denotes the third Column
which contains the name of the product, and Cells[3] represents the fourth
column, which contains the price of the product.<o:p></o:p></p>

<p class=Cbase><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=Cbase>The Cells member in Item, returns a TableCell object that
represents the data. Every TableCell object has a member called Text, which
returns the column value in the string format. Using Response.Write function,
we can display these column values in the browser.<o:p></o:p></p>

<p class=Cbase><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=Cbase>The values are not returned directly, since they can belong to
any data type. The parameter e also has a member called CommandSource. The
return value is cast to a LinkButton, as we want to access a member called
CommandName within it. CommandName contains either AddToCart or RemoveFromCart,
depending upon the button that the user clicked on. This value is acquired from
the CommandName attribute of the ButtonControls. Thus, we can find out the
button that was clicked.<o:p></o:p></p>

<p class=Cbase><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=Cbase>If the user clicks on Add, the newly created row with members
dr[0] and dr[1], is assigned the values held in item and price. Thereafter, the
Add function is used to add the row to the Cart object of DataTable.<o:p></o:p></p>

<p class=Cbase><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=Cbase>In case the user clicks on Remove, the RowFilter member of cv,
which is the DataView class, is used to filter out or remove all records from
the DataGrid that do not meet the specified condition.<o:p></o:p></p>

<p class=Cbase><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=Cbase>RowFilter takes a value in the form of 'fieldname = value'.
Hence, we have assigned it to 'item='Product 1' to ensure that DataGrid checks
records, matching this condition only. Once the records are filtered out, the
Count member in DataView is used to count the number of records present. If the
value is zero, then it signifies that there are no records matching the
condition. Hence, no changes are required to be made to the DataView.<o:p></o:p></p>

<p class=Cbase><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=Cbase>If Count has a value greater than 0, the first record in the
filtered set is deleted, using the Delete function in cv. Once the records have
been modified, the filter is reset to null, resulting in its removal. DataBind
thereafter redisplays all the records in the shopping cart after omitting the
record that was deleted.<o:p></o:p></p>

<p class=Cbase><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=Cbase>A filter does not physically remove any records. It merely hides
them for the moment. DataBind is used to redisplay the rows, excluding the
hidden ones. It is important to remember that all this happens on the server.
If it is hard for you to believe us, you can ascertain this for yourself, by
viewing the file received by the browser, by clicking on View-Source. <o:p></o:p></p>

<p class=Cbase><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=Cbase><b><span style='font-size:14.0pt;font-family:"Times New Roman"'>Templates<o:p></o:p></span></b></p>

<p class=Cbase><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=Cprg><u>a.aspx</u><o:p></o:p></p>

<p class=Cprg>&lt;%@ Import Namespace=&quot;System.Data&quot; %&gt;<o:p></o:p></p>

<p class=Cprg>&lt;html&gt;<o:p></o:p></p>

<p class=Cprg>&lt;script language=&quot;C#&quot; runat=&quot;server&quot;&gt;<o:p></o:p></p>

<p class=Cprg>DataTable Cart;<o:p></o:p></p>

<p class=Cprg>DataView cv;<o:p></o:p></p>

<p class=Cprg>void Page_Load(Object sender, EventArgs e) <o:p></o:p></p>

<p class=Cprg>{<o:p></o:p></p>

<p class=Cprg>if (Session[&quot;zzz&quot;] == null) <o:p></o:p></p>

<p class=Cprg>{<o:p></o:p></p>

<p class=Cprg>Cart = new DataTable();<o:p></o:p></p>

<p class=Cprg>Cart.Columns.Add(new DataColumn(&quot;Item&quot;, typeof(string)));<o:p></o:p></p>

<p class=Cprg>Cart.Columns.Add(new DataColumn(&quot;Price&quot;,
typeof(string)));<o:p></o:p></p>

<p class=Cprg>Session[&quot;zzz&quot;] = Cart;<o:p></o:p></p>

<p class=Cprg>}<o:p></o:p></p>

<p class=Cprg>else <o:p></o:p></p>

<p class=Cprg>{<o:p></o:p></p>

<p class=Cprg>Cart = (DataTable)Session[&quot;zzz&quot;];<o:p></o:p></p>

<p class=Cprg>}<span style="mso-spacerun: yes">    </span><o:p></o:p></p>

<p class=Cprg>cv = new DataView(Cart);<o:p></o:p></p>

<p class=Cprg>sc.DataSource = cv;<o:p></o:p></p>

<p class=Cprg>sc.DataBind();<o:p></o:p></p>

<p class=Cprg>if (!IsPostBack) <o:p></o:p></p>

<p class=Cprg>{<o:p></o:p></p>

<p class=Cprg>DataTable d = new DataTable();<o:p></o:p></p>

<p class=Cprg>d.Columns.Add(new DataColumn(&quot;c1&quot;, typeof(string)));<o:p></o:p></p>

<p class=Cprg>d.Columns.Add(new DataColumn(&quot;c2&quot;,
typeof(double)));<span style="mso-spacerun: yes">            </span><o:p></o:p></p>

<p class=Cprg>DataRow dr;<o:p></o:p></p>

<p class=Cprg>dr = d.NewRow();<o:p></o:p></p>

<p class=Cprg>dr[0] = &quot;Product 1&quot;;<o:p></o:p></p>

<p class=Cprg>dr[1] = 11.3;<o:p></o:p></p>

<p class=Cprg>d.Rows.Add(dr);<o:p></o:p></p>

<p class=Cprg>dr = d.NewRow();<o:p></o:p></p>

<p class=Cprg>dr[0] = &quot;Product 2&quot;;<o:p></o:p></p>

<p class=Cprg>dr[1] = 10.6;<o:p></o:p></p>

<p class=Cprg>d.Rows.Add(dr);<o:p></o:p></p>

<p class=Cprg>DataView dv = new DataView(d);<o:p></o:p></p>

<p class=Cprg>l.DataSource= dv;<o:p></o:p></p>

<p class=Cprg>l.DataBind();<o:p></o:p></p>

<p class=Cprg>}<o:p></o:p></p>

<p class=Cprg>}<o:p></o:p></p>

<p class=Cprg>void abc(Object sender, DataGridCommandEventArgs e) <o:p></o:p></p>

<p class=Cprg>{<o:p></o:p></p>

<p class=Cprg>DataRow dr = Cart.NewRow();<o:p></o:p></p>

<p class=Cprg>TableCell it = e.Item.Cells[1];<o:p></o:p></p>

<p class=Cprg>TableCell pr = e.Item.Cells[2];<o:p></o:p></p>

<p class=Cprg>string item = it.Text;<o:p></o:p></p>

<p class=Cprg>string price = pr.Text;<o:p></o:p></p>

<p class=Cprg>Response.Write(item + &quot; &quot; + price);<span
style="mso-spacerun: yes">        </span><o:p></o:p></p>

<p class=Cprg>if (((LinkButton)e.CommandSource).CommandName ==
&quot;AddToCart&quot;) <o:p></o:p></p>

<p class=Cprg>{<o:p></o:p></p>

<p class=Cprg>dr[0] = item;<o:p></o:p></p>

<p class=Cprg>dr[1] = price;<o:p></o:p></p>

<p class=Cprg>Cart.Rows.Add(dr);<o:p></o:p></p>

<p class=Cprg>}<o:p></o:p></p>

<p class=Cprg>else <o:p></o:p></p>

<p class=Cprg>{<o:p></o:p></p>

<p class=Cprg>cv.RowFilter = &quot;item='&quot;+item+&quot;'&quot;;<o:p></o:p></p>

<p class=Cprg>if (cv.Count &gt; 0) <o:p></o:p></p>

<p class=Cprg>{<span style="mso-spacerun: yes">    </span><o:p></o:p></p>

<p class=Cprg>cv.Delete(0);<o:p></o:p></p>

<p class=Cprg>}<o:p></o:p></p>

<p class=Cprg>cv.RowFilter = &quot;&quot;;<o:p></o:p></p>

<p class=Cprg>}<o:p></o:p></p>

<p class=Cprg>sc.DataBind();<o:p></o:p></p>

<p class=Cprg>}<o:p></o:p></p>

<p class=Cprg>&lt;/script&gt;<o:p></o:p></p>

<p class=Cprg>&lt;body&gt;<o:p></o:p></p>

<p class=Cprg>&lt;form runat=server&gt;<o:p></o:p></p>

<p class=Cprg>&lt;asp:DataGrid id=&quot;l&quot; runat=&quot;server&quot;
BorderColor=&quot;black&quot; BorderWidth=&quot;1&quot;
GridLines=&quot;Both&quot; CellPadding=&quot;3&quot; CellSpacing=&quot;0&quot;
Font-Name=&quot;Verdana&quot; Font-Size=&quot;8pt&quot; HeaderStyle-BackColor=&quot;#aaaadd&quot;
AutoGenerateColumns=&quot;false&quot; OnItemCommand=&quot;abc&quot;&gt;<o:p></o:p></p>

<p class=Cprg>&lt;columns&gt;<o:p></o:p></p>

<p class=Cprg>&lt;asp:TemplateColumn HeaderText=&quot;Add/Remove&quot;&gt;<o:p></o:p></p>

<p class=Cprg>&lt;ItemTemplate&gt;<o:p></o:p></p>

<p class=Cprg>&lt;asp:LinkButton ID=AddButton Text=&quot;Add&quot;
CommandName=&quot;AddToCart&quot; ForeColor=&quot;blue&quot;
runat=&quot;server&quot; /&gt;<o:p></o:p></p>

<p class=Cprg>&lt;asp:LinkButton ID=RemoveButton Text=&quot;Remove&quot;
CommandName=&quot;RemoveFromCart&quot; ForeColor=&quot;blue&quot;
runat=&quot;server&quot; /&gt;<o:p></o:p></p>

<p class=Cprg>&lt;/ItemTemplate&gt;<o:p></o:p></p>

<p class=Cprg>&lt;/asp:TemplateColumn&gt;<o:p></o:p></p>

<p class=Cprg>&lt;asp:BoundColumn HeaderText=&quot;Item&quot;
DataField=&quot;c1&quot;/&gt;<o:p></o:p></p>

<p class=Cprg>&lt;asp:BoundColumn HeaderText=&quot;Price&quot;
DataField=&quot;c2&quot; /&gt;<o:p></o:p></p>

<p class=Cprg>&lt;/columns&gt;<o:p></o:p></p>

<p class=Cprg>&lt;/asp:DataGrid&gt;<o:p></o:p></p>

<p class=Cprg>&lt;ASP:DataGrid id=&quot;sc&quot; runat=&quot;server&quot;/&gt;<o:p></o:p></p>

<p class=Cprg>&lt;/form&gt;<o:p></o:p></p>

<p class=Cprg>&lt;/body&gt;<o:p></o:p></p>

<p class=Cprg>&lt;/html&gt;<o:p></o:p></p>

<p class=Cbase><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=Coutput><u>Output</u><o:p></o:p></p>

<p class=Coutput><img width=185 height=97 id="_x0000_i1035"
src="chap5img/img8.bmp"><o:p></o:p></p>

<p class=Cbase><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=Cbase>This program is very large in size, however, nothing much has
really changed since the earlier program. We have the first DataGrid containing
a large number of attributes, to make it appear fancy. This is akin to the
process of pleasing our companion of the opposite sex, who likes to look great,
and fancies everything in the world that can enhance her good looks further.<o:p></o:p></p>

<p class=Cbase><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=Cbase>We have introduced a new tag called &lt;asp:TemplateColumn, in
place of ButtonColumn. As this is the first column in the properties, we will
see the HeaderText displayed as Add/Remove, in the first column of the text. A
template column has a name, and it contains other tags such as LinkButton. The
LinkButton has an ID and some text, that is to be displayed in the column. The
colour attribute is used for setting the colour of the font. The CommandName,
as we have already seen, is used to reveal the Button that had been clicked.
Thus, we can add a number of entities into one column, in order to have greater
flexibility in deciding the column contents.<o:p></o:p></p>

<p class=Cbase><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=Cbase>Thus, instead of having Add and Remove as two separate columns,
we have combined them in a single column, but with different Command Names.
Most of the code is not altered. The Cells parameter is reduced by one, as we
have one column less.<span style="mso-spacerun: yes">  </span>Thus, templates
give us more flexibility in designing our DataGrid.<o:p></o:p></p>

<p class=Cbase><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=Cprg><u>a.aspx</u><o:p></o:p></p>

<p class=Cprg>&lt;%@ Import Namespace=&quot;System.Data&quot; %&gt;<o:p></o:p></p>

<p class=Cprg>&lt;html&gt;<o:p></o:p></p>

<p class=Cprg>&lt;script language=&quot;C#&quot; runat=&quot;server&quot;&gt;<o:p></o:p></p>

<p class=Cprg>DataTable Cart;<o:p></o:p></p>

<p class=Cprg>DataView cv;<o:p></o:p></p>

<p class=Cprg>void Page_Load(Object sender, EventArgs e) <o:p></o:p></p>

<p class=Cprg>{<o:p></o:p></p>

<p class=Cprg>if (Session[&quot;zzz&quot;] == null)<span style="mso-spacerun:
yes">     </span><o:p></o:p></p>

<p class=Cprg>{<o:p></o:p></p>

<p class=Cprg>int nn;<o:p></o:p></p>

<p class=Cprg>Cart = new DataTable();<o:p></o:p></p>

<p class=Cprg>Cart.Columns.Add(new DataColumn(&quot;Qty&quot;,
typeof(string)));<o:p></o:p></p>

<p class=Cprg>Cart.Columns.Add(new DataColumn(&quot;Item&quot;,
typeof(string)));<o:p></o:p></p>

<p class=Cprg>Session[&quot;zzz&quot;] = Cart;<o:p></o:p></p>

<p class=Cprg>for (int i=1; i&lt;5; i++) <o:p></o:p></p>

<p class=Cprg>{<o:p></o:p></p>

<p class=Cprg>DataRow dr = Cart.NewRow();<o:p></o:p></p>

<p class=Cprg>nn=(i%2)+1;<o:p></o:p></p>

<p class=Cprg>dr[0] = nn.ToString();<o:p></o:p></p>

<p class=Cprg>dr[1] = &quot;Item &quot; + i.ToString();<o:p></o:p></p>

<p class=Cprg>Cart.Rows.Add(dr);<o:p></o:p></p>

<p class=Cprg>}<o:p></o:p></p>

<p class=Cprg>}<o:p></o:p></p>

<p class=Cprg>else <o:p></o:p></p>

<p class=Cprg>{<o:p></o:p></p>

<p class=Cprg>Cart = (DataTable)Session[&quot;zzz&quot;];<o:p></o:p></p>

<p class=Cprg>}<span style="mso-spacerun: yes">    </span><o:p></o:p></p>

<p class=Cprg>cv = new DataView(Cart);<o:p></o:p></p>

<p class=Cprg>if (!IsPostBack) <o:p></o:p></p>

<p class=Cprg>{<o:p></o:p></p>

<p class=Cprg>bbb();<o:p></o:p></p>

<p class=Cprg>}<span style="mso-spacerun: yes">    </span><o:p></o:p></p>

<p class=Cprg>}<o:p></o:p></p>

<p class=Cprg>public void Edit(Object sender, DataGridCommandEventArgs e) <o:p></o:p></p>

<p class=Cprg>{<o:p></o:p></p>

<p class=Cprg>l. EditItemIndex = (int) e.Item.ItemIndex;<o:p></o:p></p>

<p class=Cprg>bbb();<o:p></o:p></p>

<p class=Cprg>}<o:p></o:p></p>

<p class=Cprg>public void Cancel(Object sender, DataGridCommandEventArgs e) <o:p></o:p></p>

<p class=Cprg>{<o:p></o:p></p>

<p class=Cprg>l.EditItemIndex = -1;<o:p></o:p></p>

<p class=Cprg>bbb();<o:p></o:p></p>

<p class=Cprg>}<o:p></o:p></p>

<p class=Cprg>public void Update(Object sender, DataGridCommandEventArgs e) <o:p></o:p></p>

<p class=Cprg>{<o:p></o:p></p>

<p class=Cprg>string item = e.Item.Cells[1].Text;<o:p></o:p></p>

<p class=Cprg><span style="mso-spacerun: yes"> </span>string qty =
((TextBox)e.Item.Cells[2].Controls[0]).Text;<o:p></o:p></p>

<p class=Cprg>cv.RowFilter = &quot;Item='&quot;+item+&quot;'&quot;;<o:p></o:p></p>

<p class=Cprg>if (cv.Count &gt; 0) <o:p></o:p></p>

<p class=Cprg>{<o:p></o:p></p>

<p class=Cprg>cv.Delete(0);<o:p></o:p></p>

<p class=Cprg>}<span style="mso-spacerun: yes">    </span><o:p></o:p></p>

<p class=Cprg>cv.RowFilter = &quot;&quot;;<o:p></o:p></p>

<p class=Cprg>DataRow dr = Cart.NewRow();<o:p></o:p></p>

<p class=Cprg>dr[0] = qty;<o:p></o:p></p>

<p class=Cprg>dr[1] = item;<o:p></o:p></p>

<p class=Cprg>Cart.Rows.Add(dr);<o:p></o:p></p>

<p class=Cprg>l.EditItemIndex = -1;<o:p></o:p></p>

<p class=Cprg>bbb();<o:p></o:p></p>

<p class=Cprg>}<o:p></o:p></p>

<p class=Cprg>public void bbb() <o:p></o:p></p>

<p class=Cprg>{<o:p></o:p></p>

<p class=Cprg>l.DataSource = cv;<o:p></o:p></p>

<p class=Cprg>l.DataBind();<o:p></o:p></p>

<p class=Cprg>}<o:p></o:p></p>

<p class=Cprg>&lt;/script&gt;<o:p></o:p></p>

<p class=Cprg>&lt;form runat=&quot;server&quot;&gt;<o:p></o:p></p>

<p class=Cprg>&lt;asp:DataGrid id=&quot;l&quot; runat=&quot;server&quot;
BorderColor=&quot;black&quot; BorderWidth=&quot;1&quot;
CellPadding=&quot;3&quot; Font-Name=&quot;Verdana&quot;
Font-Size=&quot;8pt&quot; HeaderStyle-BackColor=&quot;#aaaadd&quot;
OnEditCommand=&quot;Edit&quot; OnCancelCommand=&quot;Cancel&quot;
OnUpdateCommand =&quot;Update&quot; AutoGenerateColumns=&quot;false&quot;&gt;<o:p></o:p></p>

<p class=Cprg>&lt;Columns&gt;<o:p></o:p></p>

<p class=Cprg>&lt;asp:EditCommandColumn EditText=&quot;Edit1&quot;
CancelText=&quot;Cancel1&quot; UpdateText=&quot;Update1&quot;
ItemStyle-Wrap=&quot;false&quot; HeaderText=&quot;Edit Command Column&quot;
HeaderStyle-Wrap=&quot;false&quot;/&gt;<o:p></o:p></p>

<p class=Cprg>&lt;asp:BoundColumn HeaderText=&quot;Item&quot;
ReadOnly=&quot;true&quot; DataField=&quot;Item&quot;/&gt;<o:p></o:p></p>

<p class=Cprg>&lt;asp:BoundColumn HeaderText=&quot;Quantity&quot;
DataField=&quot;Qty&quot;/&gt;<o:p></o:p></p>

<p class=Cprg>&lt;/columns&gt;<o:p></o:p></p>

<p class=Cprg>&lt;/asp:DataGrid&gt;<o:p></o:p></p>

<p class=Cprg>&lt;/form&gt;<o:p></o:p></p>

<p class=Cprg>&lt;/body&gt;<o:p></o:p></p>

<p class=Cprg>&lt;/html&gt;<o:p></o:p></p>

<p class=Cbase><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=Cbase>The above program allows us to edit data that is present in a
DataGrid. As usual, we have our DataGrid with an id of<span style='font-family:
"Trebuchet MS"'> l,</span> having a number of attributes. We have added three
more attributes in addition to the regular ones, which we shall elucidate while
discussing the program.<o:p></o:p></p>

<p class=Cbase><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=Cbase>In the property tag, we have a newly introduced tag called
&lt;asp:EditCommandColumn. As this is placed first in sequence in the column
definition, it is displayed as the first column of our DataGrid. The HeaderText
is displayed at the top of the column as the column header, and the other
attributes of EditText, UpdateText and CancelText have been assigned string
values. By default, the value 'Edit1' assigned to EditText, is displayed on the
screen.<o:p></o:p></p>

<p class=Cbase><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=Cbase>The other two columns are inserted using BoundColumns. We will
explain the attributes given to them, in a short while.<o:p></o:p></p>

<p class=Cbase><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=Cbase>As the Page_Load function is the first function to be called,
the DataGrid Control gets populated with values. There are four rows and three
columns. The EditCommandColumn gets repeated for every new row that is inserted
into the grid. <o:p></o:p></p>

<p class=Cbase><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=Cbase>The Item field has values displayed in a chronological order,
whereas, the Quantity field has values that depend on the result of dividing
the remainder value by 2 + 1. <o:p></o:p></p>

<p class=Cbase><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=Cbase>Numbers cannot be inserted into the columns, because the columns
are defined to contain string values. Thus, the ToString function is used to
convert the integer values into strings. The modus operandi of using a 'for'
loop to populate fields with values, has been borrowed from the Microsoft
samples.<o:p></o:p></p>

<p class=Cbase><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=Cbase>The output in browser window is shown below.<o:p></o:p></p>

<p class=Cbase><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=Coutput><u>Output</u><o:p></o:p></p>

<p class=Coutput><img width=242 height=121 id="_x0000_i1036"
src="chap5img/img9.bmp"><o:p></o:p></p>

<p class=Coutput><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=Cbase>If you click on Edit1 in any of the rows, the text will get
replaced with Update1 and Cancel1. These values were assigned to UpdateText and
CancelText attributes in the EditCommandControl. Further, instead of static
text being displayed, the value assigned to quantity in the current row, is
displayed in an editable textbox.<o:p></o:p></p>

<p class=Cbase><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=Coutput><u>Output</u><o:p></o:p></p>

<p class=Coutput><img width=275 height=131 id="_x0000_i1037"
src="chap5img/img10.bmp"><o:p></o:p></p>

<p class=Cbase><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=Cbase>The above output is displayed, since the function Edit, gets
called when we click on Edit1. This is so because the attribute OnEditCommand
is initialized to Edit in the DataGrid Control. This function has only one line<o:p></o:p></p>

<p class=Cbase><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=Cbullets>l. EditItemIndex = (int) e.Item.ItemIndex; <o:p></o:p></p>

<p class=Cbullets>It, thereafter, calls a function named bbb.<o:p></o:p></p>

<p class=Cbase><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=Cbase>Response.Write can be used to display the value of
e.Item.ItemIndex. This value displays the record number of the rows that we
clicked upon. So, as the numbering starts from 0, Item 1 will have a record number
of 0, Item 2 will have the ItemIndex of<span style="mso-spacerun: yes"> 
</span>1, and so on.<o:p></o:p></p>

<p class=Cbase><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=Cbase>The task assigned to the Edit function is to set the value of
the EditItemIndex member of the DataGrid to the record number. Hence, it is
initialized to the current record number. This allows editing of the fields in
the current row. The Quantity field is the only field that is currently
editable, since the readonly property of the item field, has been set to True.
Thereafter, the function bbb is called, which associates DataSource with the DataGrid
Control and calls DataBind. As we have to use this segment of code repeatedly
at various places in the program, we have placed it in a separate function. <o:p></o:p></p>

<p class=Cbase><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=Cbase>Any changes made to the Quantity field, are preserved when we
click on Update1. Update1 is connected with the function Update, using the
attribute OnUpdateCommand. We intend retrieving the values that the user
enters, and to add them to the DataGrid. <o:p></o:p></p>

<p class=Cbase>Thus, e.item.Cell[1].Text retrieves the text available in column
2, which is the Item column. Further, e.item.Cell[2].Text does the same for
column 3, which is the Quantity Column. <o:p></o:p></p>

<p class=Cbase><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=Cbase>Hence, assuming that you clicked on Update for Item 1,
e.item.Cell[1].Text will contain Item 1. But, to retrieve values from the
Quantity field, we will have to use one more level of indirection. This is
because the value is contained in an edit box. So, we use Controls[0] for the
control in this column. Thereafter, the Text member in the control, is used to
return the text contained in it.<o:p></o:p></p>

<p class=Cbase><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=Cbase>Thereafter, we use the same process as described earlier. That
is:<o:p></o:p></p>

<p class=Cbase><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=Cbullets><span style='mso-bidi-font-size:12.0pt;font-family:"Times New Roman"'>•<span
style='mso-tab-count:1'>     </span></span>filter the record that matches the
item, i.e. item=&quot;Item 1&quot;<o:p></o:p></p>

<p class=Cbullets><span style='mso-bidi-font-size:12.0pt;font-family:"Times New Roman"'>•<span
style='mso-tab-count:1'>     </span></span>delete the old record <o:p></o:p></p>

<p class=Cbullets><span style='mso-bidi-font-size:12.0pt;font-family:"Times New Roman"'>•<span
style='mso-tab-count:1'>     </span></span>add a new record at the end, with
the new values contained in the Item and Quantity fields. Since these values
remain the same, the resultant effect would be that the record would be moved
to the end.<o:p></o:p></p>

<p class=Cbase><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=Cbase>We set the value of EditItemIndex to -1 to avoid the values
being displayed in the edit textbox. Any value other than -1, will force ASP+
to display an editbox for the value 'long' with the record number, thereby,
allowing the text to be edited. <o:p></o:p></p>

<p class=Cbase><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=Cbase>When the user clicks on Cancel, the Cancel function is called.
It means that the changes incorporated by the user, are to be cancelled and not
to be displayed in the DataGrid. So, we simply set EditItemIndex to -1, to undo
any editing that has been carried out. <o:p></o:p></p>

<p class=Cbase><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=Cprg><u>a.aspx</u><o:p></o:p></p>

<p class=Cprg>&lt;%@ Import Namespace=&quot;System.Data&quot; %&gt;<o:p></o:p></p>

<p class=Cprg>&lt;html&gt;<o:p></o:p></p>

<p class=Cprg>&lt;script language=&quot;C#&quot; runat=&quot;server&quot;&gt;<o:p></o:p></p>

<p class=Cprg>void Page_Load(Object s, EventArgs e) <o:p></o:p></p>

<p class=Cprg>{<o:p></o:p></p>

<p class=Cprg>DataTable d = new DataTable();<o:p></o:p></p>

<p class=Cprg>d.Columns.Add(new DataColumn(&quot;c1&quot;,
typeof(Int32)));<span style="mso-spacerun: yes">            </span><o:p></o:p></p>

<p class=Cprg>d.Columns.Add(new DataColumn(&quot;c2&quot;, typeof(string)));<o:p></o:p></p>

<p class=Cprg>DataRow dr;<o:p></o:p></p>

<p class=Cprg>dr = d.NewRow();<o:p></o:p></p>

<p class=Cprg>dr[0] = 11;<o:p></o:p></p>

<p class=Cprg>dr[1] = &quot;String 1&quot;;<o:p></o:p></p>

<p class=Cprg>d.Rows.Add(dr);<o:p></o:p></p>

<p class=Cprg>dr = d.NewRow();<o:p></o:p></p>

<p class=Cprg>dr[0] = 2;<o:p></o:p></p>

<p class=Cprg>dr[1] = &quot;String 2&quot;;<o:p></o:p></p>

<p class=Cprg>d.Rows.Add(dr);<o:p></o:p></p>

<p class=Cprg>DataView dv = new DataView(d);<o:p></o:p></p>

<p class=Cprg>l.DataSource = dv;<o:p></o:p></p>

<p class=Cprg>l.DataBind();<o:p></o:p></p>

<p class=Cprg>}<o:p></o:p></p>

<p class=Cprg>void abc(Object sender, EventArgs e) <o:p></o:p></p>

<p class=Cprg>{<o:p></o:p></p>

<p class=Cprg>l.Columns[1].Visible = !l.Columns[1].Visible;<o:p></o:p></p>

<p class=Cprg>l1.Text = &quot;Column 1's visible property is<span
style="mso-spacerun: yes">  </span>&quot; + l.Columns[1].Visible.ToString();<o:p></o:p></p>

<p class=Cprg>}<o:p></o:p></p>

<p class=Cprg>&lt;/script&gt;<o:p></o:p></p>

<p class=Cprg>&lt;body&gt;<o:p></o:p></p>

<p class=Cprg><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=Cprg>&lt;form runat=server&gt;<o:p></o:p></p>

<p class=Cprg>&lt;ASP:DataGrid id=&quot;l&quot; runat=&quot;server&quot;
GridLines=&quot;Both&quot; AutoGenerateColumns=&quot;false&quot;&gt;<o:p></o:p></p>

<p class=Cprg>&lt;columns&gt;<o:p></o:p></p>

<p class=Cprg>&lt;asp:BoundColumn HeaderText=&quot;vijay&quot;
DataField=&quot;c1&quot; /&gt;<o:p></o:p></p>

<p class=Cprg>&lt;asp:BoundColumn HeaderText=&quot;mukhi&quot;
DataField=&quot;c2&quot;/&gt;<o:p></o:p></p>

<p class=Cprg>&lt;/columns&gt;<o:p></o:p></p>

<p class=Cprg>&lt;/asp:DataGrid&gt;<o:p></o:p></p>

<p class=Cprg>&lt;asp:Button Text=&quot;Change&quot; OnClick=&quot;abc&quot;
runat=&quot;server&quot; /&gt;<o:p></o:p></p>

<p class=Cprg>&lt;asp:Label id=&quot;l1&quot; runat=&quot;server&quot; /&gt;<o:p></o:p></p>

<p class=Cprg>&lt;/form&gt;<o:p></o:p></p>

<p class=Cprg>&lt;/body&gt;<o:p></o:p></p>

<p class=Cprg>&lt;/html&gt;<o:p></o:p></p>

<p class=Cbase><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=Coutput><u>Output</u><o:p></o:p></p>

<p class=Coutput><img width=84 height=96 id="_x0000_i1038"
src="chap5img/img11.bmp"><o:p></o:p></p>

<p class=Cbase><span style="mso-spacerun: yes"> </span><o:p></o:p></p>

<p class=Cbase>In the above example, we are altering the visibility of a
column. Just like before, we have two BoundColumns, c1 and c2 in a DataGrid<span
style='font-family:"Trebuchet MS"'> l,</span> having the column headings of
'vijay' and 'mukhi'. Further, a label<span style='font-family:"Trebuchet MS"'>
l1 </span>and a button with the label of 'Change', are added to the page.
Irrespective of whether column 1 is visible or not, the label<span
style='font-family:"Trebuchet MS"'> l1 </span>displays a text message. The
button calls the function abc whenever the user clicks on it. <o:p></o:p></p>

<p class=Cbase><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=Cbase>In the function abc, we access the columns in the
DataGridControl, by using the member Columns and stating the column number in
[] brackets. As the numbering within square brackets start from 0, Columns[1]
refers to the second column, which has the title of 'mukhi'. <o:p></o:p></p>

<p class=Cbase><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=Cbase>Every column object has a member called Visible, which is set to
True or False, depending upon whether we want that column to be visible or not.
The ! sign changes false to true and true to false. Initially, the Visible
member of Column 1 will be True, hence, the right hand side of the 'equal to'
sign returns True. The ! operator which precedes it now, makes it False. This
value is then reassigned to the Visible member, as a result of which, the column
now disappears from the screen. The text in the label also gets updated. <o:p></o:p></p>

<p class=Cbase><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=Coutput><u>Output</u><o:p></o:p></p>

<p class=Coutput><img width=60 height=96 id="_x0000_i1039"
src="chap5img/img12.bmp"><span style="mso-spacerun: yes">  </span>Column 1's
visible property is False<o:p></o:p></p>

<p class=Cbase><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=Cbase>If we click on the button again, the value of Visible property
gets toggled. Thus, we have complete control over the visibility of columns in
a DataGrid.<o:p></o:p></p>

<p class=Cbase><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=Cprg><u>a.aspx</u><o:p></o:p></p>

<p class=Cprg>&lt;%@ Import Namespace=&quot;System.Data&quot; %&gt;<o:p></o:p></p>

<p class=Cprg>&lt;html&gt;<o:p></o:p></p>

<p class=Cprg>&lt;script language=&quot;C#&quot; runat=&quot;server&quot;&gt;<o:p></o:p></p>

<p class=Cprg>string s ;<o:p></o:p></p>

<p class=Cprg>void Page_Load(Object sender, EventArgs e) <o:p></o:p></p>

<p class=Cprg>{<o:p></o:p></p>

<p class=Cprg>bbb();<o:p></o:p></p>

<p class=Cprg>}<o:p></o:p></p>

<p class=Cprg>void abc(Object sender, DataGridSortCommandEventArgs e) <o:p></o:p></p>

<p class=Cprg>{<o:p></o:p></p>

<p class=Cprg>s = (string)e.SortExpression;<o:p></o:p></p>

<p class=Cprg>bbb();<o:p></o:p></p>

<p class=Cprg>}<o:p></o:p></p>

<p class=Cprg>void bbb() <o:p></o:p></p>

<p class=Cprg>{<o:p></o:p></p>

<p class=Cprg>DataTable d = new DataTable();<o:p></o:p></p>

<p class=Cprg>d.Columns.Add(new DataColumn(&quot;c1&quot;,
typeof(Int32)));<span style="mso-spacerun: yes">       </span><span
style="mso-spacerun: yes">     </span><o:p></o:p></p>

<p class=Cprg>d.Columns.Add(new DataColumn(&quot;c2&quot;, typeof(string)));<o:p></o:p></p>

<p class=Cprg>DataRow dr;<o:p></o:p></p>

<p class=Cprg>dr = d.NewRow();<o:p></o:p></p>

<p class=Cprg>dr[0] = 1;<o:p></o:p></p>

<p class=Cprg>dr[1] = &quot;String 3&quot;;<o:p></o:p></p>

<p class=Cprg>d.Rows.Add(dr);<o:p></o:p></p>

<p class=Cprg>dr = d.NewRow();<o:p></o:p></p>

<p class=Cprg>dr[0] = 2;<o:p></o:p></p>

<p class=Cprg>dr[1] = &quot;String 2&quot;;<o:p></o:p></p>

<p class=Cprg>d.Rows.Add(dr);<o:p></o:p></p>

<p class=Cprg>dr = d.NewRow();<o:p></o:p></p>

<p class=Cprg>dr[0] = 3;<o:p></o:p></p>

<p class=Cprg>dr[1] = &quot;String 1&quot;;<o:p></o:p></p>

<p class=Cprg>d.Rows.Add(dr);<o:p></o:p></p>

<p class=Cprg>DataView dv = new DataView(d);<o:p></o:p></p>

<p class=Cprg>dv.Sort = s;<o:p></o:p></p>

<p class=Cprg>l.DataSource = dv;<o:p></o:p></p>

<p class=Cprg>l.DataBind();<o:p></o:p></p>

<p class=Cprg>}<o:p></o:p></p>

<p class=Cprg>&lt;/script&gt;<o:p></o:p></p>

<p class=Cprg>&lt;body&gt;<o:p></o:p></p>

<p class=Cprg>&lt;form runat=server&gt;<o:p></o:p></p>

<p class=Cprg>&lt;ASP:DataGrid id=&quot;l&quot; runat=&quot;server&quot;
AllowSorting=&quot;true&quot; OnSortCommand=&quot;abc&quot; /&gt;<o:p></o:p></p>

<p class=Cprg>&lt;/form&gt;<o:p></o:p></p>

<p class=Cprg>&lt;/body&gt;<o:p></o:p></p>

<p class=Cprg>&lt;/html&gt;<o:p></o:p></p>

<p class=Cbase><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=Coutput><u>Output</u><o:p></o:p></p>

<p class=Coutput><img width=69 height=172 id="_x0000_i1040"
src="chap5img/img13.bmp"><o:p></o:p></p>

<p class=Cbase><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=Cbase>The above example shows us how we can sort a particular column
in a DataGrid. The DataGrid control with the id of<span style='font-family:
"Trebuchet MS"'> l,</span> has an attribute called AllowSorting set to True.
Also, when the user clicks on the column, the function abc is called. Instead
of positioning all the code in Page_Load, we have placed it in a function
called bbb. Page_Load calls this function.<o:p></o:p></p>

<p class=Cbase><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=Cbase>In bbb, a DataTable consisting of two columns and three rows, is
created. A DataView instance 'dv' is created with the Data Table 'd' as a
parameter to its constructor. Once the object is created, we use a member of
this object called Sort, and initialize it to the value stored in the string s.
At the moment, there is no value in the string s. Hence, Sort is assigned a
value of null. <o:p></o:p></p>

<p class=Cbase><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=Cbase>Since the process of sorting is executed on columns, the column
names get underlined, i.e. they become hyperlinks when they are displayed. When
we click on the column c2, the function abc will get called. The parameter 'e'
of type DataGridSortCommandEventArgs has a member called SortExpression, which
contains the name of the column that we click on. We store this value in a
variable called 's', and then call the function bbb. <o:p></o:p></p>

<p class=Cbase><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=Cbase>Before redisplaying the data, the Sort member of DataView is
again initialized to 's', which now holds the column name, whose data is to be
sorted. Thus, the data within this column is shown in a sorted order in our
DataGrid.<o:p></o:p></p>

<p class=Cbase><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=Cbase><b><span style='font-size:14.0pt;font-family:"Times New Roman"'>Table
Cells<o:p></o:p></span></b></p>

<p class=Cbase><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=Cprg><u>a.aspx</u><o:p></o:p></p>

<p class=Cprg>&lt;html&gt;<o:p></o:p></p>

<p class=Cprg>&lt;head&gt;<o:p></o:p></p>

<p class=Cprg>&lt;script language=&quot;C#&quot; runat=&quot;server&quot;&gt;<o:p></o:p></p>

<p class=Cprg>void Page_Load(Object s, EventArgs e) <o:p></o:p></p>

<p class=Cprg>{<o:p></o:p></p>

<p class=Cprg>for (int j=0; j&lt;3; j++) <o:p></o:p></p>

<p class=Cprg>{<o:p></o:p></p>

<p class=Cprg>TableRow r = new TableRow();<o:p></o:p></p>

<p class=Cprg>for (int i=0; i&lt; 2; i++) <o:p></o:p></p>

<p class=Cprg>{<o:p></o:p></p>

<p class=Cprg>TableCell c = new TableCell();<o:p></o:p></p>

<p class=Cprg>c.Controls.Add(new LiteralControl(&quot;row no &quot; +
j.ToString() + &quot;, coll no &quot; + i.ToString()));<o:p></o:p></p>

<p class=Cprg>r.Cells.Add(c);<o:p></o:p></p>

<p class=Cprg>}<o:p></o:p></p>

<p class=Cprg>t.Rows.Add(r);<o:p></o:p></p>

<p class=Cprg>}<o:p></o:p></p>

<p class=Cprg>}<o:p></o:p></p>

<p class=Cprg>&lt;/script&gt;<o:p></o:p></p>

<p class=Cprg>&lt;/head&gt;<o:p></o:p></p>

<p class=Cprg>&lt;body&gt;<o:p></o:p></p>

<p class=Cprg>&lt;form runat=server&gt;<o:p></o:p></p>

<p class=Cprg>&lt;asp:Table id=&quot;t&quot; CellPadding=5 CellSpacing=0
BorderColor=&quot;black&quot; BorderWidth=&quot;1&quot;
Gridlines=&quot;Both&quot; runat=&quot;server&quot;/&gt;<o:p></o:p></p>

<p class=Cprg>&lt;/form&gt;<o:p></o:p></p>

<p class=Cprg>&lt;/body&gt;<o:p></o:p></p>

<p class=Cprg>&lt;/html&gt;<o:p></o:p></p>

<p class=Cbase><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=Coutput><u>Output</u><o:p></o:p></p>

<p class=Coutput><img width=237 height=90 id="_x0000_i1041"
src="chap5img/img14.bmp"><o:p></o:p></p>

<p class=Cbase><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=Cbase>The above program demonstrates how tables can be populated with
data in ASP+. We use &lt;asp:Table control, with an id of 't', to which rows
and columns are to be added. The spacing between the cells in the table, and
the other display features of tables are given by initializing the attributes
supported by this control.<o:p></o:p></p>

<p class=Cbase><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=Cbase>Page_Load function contains a 'for' loop that will be executed
thrice. Within this loop construct, a new object 'r' which looks like TableRow,
is created. Every row is made up of<span style="mso-spacerun: yes"> 
</span>columns or cells. A cell is created using an independent class called
TableCell. Here, since we require two cells per row, we have incorporated one
more for the loop, which repeats twice within the loop. This loop first creates
a TableCell called 'c'. Then, using the Add function of the TableCell member
Controls, the cell is assigned a string value or a literal. The Add function in
the Cell member of r called TableRow, adds this cell to the row. This is done
twice, as we want two cells per row. Once the row is ready, it is added to the
table, using the Add function of the Row member in the Table. Since the loop
has a count of 3, 3 rows are added to the Table. Thus, finally we obtain 3 rows
containing 2 columns each, with a literal for each of the columns. <o:p></o:p></p>

<p class=Cbase><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=Cbase>This is one more way to add data to a table. <o:p></o:p></p>

<p class=Cbase><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=Cbase><b><span style='font-size:14.0pt;font-family:"Times New Roman"'>Paging<o:p></o:p></span></b></p>

<p class=Cbase><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=Cprg><u>a.aspx</u><o:p></o:p></p>

<p class=Cprg>&lt;%@ Import Namespace=&quot;System.Data&quot; %&gt;<o:p></o:p></p>

<p class=Cprg>&lt;html&gt;<o:p></o:p></p>

<p class=Cprg>&lt;script language=&quot;C#&quot; runat=&quot;server&quot;&gt;<o:p></o:p></p>

<p class=Cprg>void Page_Load(Object sender, EventArgs e) <o:p></o:p></p>

<p class=Cprg>{<o:p></o:p></p>

<p class=Cprg>if (c.Checked) <o:p></o:p></p>

<p class=Cprg>l.PagerStyle.Mode=PagerMode.NumericPages;<o:p></o:p></p>

<p class=Cprg>else <o:p></o:p></p>

<p class=Cprg>l.PagerStyle.Mode=PagerMode.NextPrev;<o:p></o:p></p>

<p class=Cprg>bbb();<o:p></o:p></p>

<p class=Cprg>}<o:p></o:p></p>

<p class=Cprg>void abc(Object sender, DataGridPageChangedEventArgs e) <o:p></o:p></p>

<p class=Cprg>{<o:p></o:p></p>

<p class=Cprg>Response.Write(&quot;hi&quot;);<o:p></o:p></p>

<p class=Cprg>l.CurrentPageIndex = e.NewPageIndex;<o:p></o:p></p>

<p class=Cprg>bbb();<o:p></o:p></p>

<p class=Cprg>}<o:p></o:p></p>

<p class=Cprg>void bbb() <o:p></o:p></p>

<p class=Cprg>{<o:p></o:p></p>

<p class=Cprg>DataTable d = new DataTable();<o:p></o:p></p>

<p class=Cprg>d.Columns.Add(new DataColumn(&quot;c1&quot;,
typeof(Int32)));<span style="mso-spacerun: yes">            </span><o:p></o:p></p>

<p class=Cprg>d.Columns.Add(new DataColumn(&quot;c2&quot;, typeof(string)));<o:p></o:p></p>

<p class=Cprg>DataRow dr;<o:p></o:p></p>

<p class=Cprg>for (int i = 0; i &lt; 200; i++) <o:p></o:p></p>

<p class=Cprg>{<o:p></o:p></p>

<p class=Cprg>dr = d.NewRow();<o:p></o:p></p>

<p class=Cprg>dr[0] = i;<o:p></o:p></p>

<p class=Cprg>dr[1] = &quot;Item &quot; + i.ToString();<o:p></o:p></p>

<p class=Cprg>d.Rows.Add(dr);<o:p></o:p></p>

<p class=Cprg>}<o:p></o:p></p>

<p class=Cprg>DataView dv = new DataView(d);<o:p></o:p></p>

<p class=Cprg>l.DataSource = dv;<o:p></o:p></p>

<p class=Cprg><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=Cprg>l.DataBind();<o:p></o:p></p>

<p class=Cprg>l1.Text = &quot;CurrentPageIndex is &quot; + l.CurrentPageIndex +
&quot;PageCount is &quot; + l.PageCount;<o:p></o:p></p>

<p class=Cprg>}<o:p></o:p></p>

<p class=Cprg>&lt;/script&gt;<o:p></o:p></p>

<p class=Cprg>&lt;body&gt;<o:p></o:p></p>

<p class=Cprg>&lt;form runat=server&gt;<o:p></o:p></p>

<p class=Cprg>&lt;ASP:DataGrid id=&quot;l&quot; runat=&quot;server&quot;
AllowPaging=&quot;True&quot; PageSize=&quot;10&quot;
PagerStyle-Mode=&quot;NumericPages&quot;<o:p></o:p></p>

<p class=Cprg><span style="mso-spacerun:
yes"> </span>PagerStyle-HorizontalAlign=&quot;Right&quot;
PagerStyle-NextPageText=&quot;Next1&quot;
PagerStyle-PrevPageText=&quot;Prev1&quot; OnPageIndexChanged=&quot;abc&quot;<o:p></o:p></p>

<p class=Cprg><span style="mso-spacerun: yes"> </span>/&gt;<o:p></o:p></p>

<p class=Cprg>&lt;p&gt;<o:p></o:p></p>

<p class=Cprg>&lt;asp:Checkbox id=&quot;c&quot; runat=&quot;server&quot;
Text=&quot;Show numeric page navigation buttons&quot;
AutoPostBack=&quot;true&quot; /&gt;<o:p></o:p></p>

<p class=Cprg>&lt;p&gt;<o:p></o:p></p>

<p class=Cprg>&lt;asp:Label id=&quot;l1&quot; runat=&quot;server&quot;
/&gt;&lt;br&gt;<o:p></o:p></p>

<p class=Cprg>&lt;/form&gt;<o:p></o:p></p>

<p class=Cprg>&lt;/body&gt;<o:p></o:p></p>

<p class=Cprg>&lt;/html&gt;<o:p></o:p></p>

<p class=Cbase><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=Coutput><u>Output</u><o:p></o:p></p>

<p class=Coutput><img width=268 height=406 id="_x0000_i1042"
src="chap5img/img15.html"><o:p></o:p></p>

<p class=Cbase><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=Cbase>The DataGrid control contains a new set of attributes, two of
them being: <o:p></o:p></p>

<p class=Cbase><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=Cbullets><span style='mso-bidi-font-size:12.0pt;font-family:"Times New Roman"'>•<span
style='mso-tab-count:1'>     </span></span>AllowPaging, which is set to True.<o:p></o:p></p>

<p class=Cbullets><span style='mso-bidi-font-size:12.0pt;font-family:"Times New Roman"'>•<span
style='mso-tab-count:1'>     </span></span>PageSize, which is assigned a value
of 10. This controls the number of records that are displayed on one page. <o:p></o:p></p>

<p class=Cbase><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=Cbase>The function bbb called by Page_Load, has a<span
style="mso-spacerun: yes">  </span>'for' loop to facilitate addition of 200
records into our DataGrid. Then, the text in the label<span style='font-family:
"Trebuchet MS"'> l1 </span>is changed to display the value of two DataGrid
members, namely, the CurrentPageIndex and the PageCount. The PageCount member
contains the total number of pages. As the PageSize is 10, (i.e. 10 records are
to be displayed on one page), the total number of pages for 200 records becomes
20. Also, since paging has been allowed, the values given to the attributes of
PagerStyle-NextPageText and PagerStyle-PrevPageText, reflect Next1 and Prev1 as
hyperlinks in the table. <o:p></o:p></p>

<p class=Cbase><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=Cbase>A check box is displayed below the table and it is currently
unselected. Whenever we click on the checkbox, function Page_Load gets called,
since the AutoPostBack variable is set to True. The 'if' condition in
Page_Load, checks whether the checkbox has been checked or not. This is
verified by the value stored in the boolean member Checked. <o:p></o:p></p>

<p class=Cbullets><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=Cbullets><span style='mso-bidi-font-size:12.0pt;font-family:"Times New Roman"'>•<span
style='mso-tab-count:1'>     </span></span>If it is checked, then we set a
member of the DataGrid, PagerStyle.Mode to a value of PagerMode.NumericPages <o:p></o:p></p>

<p class=Cbullets><span style='mso-bidi-font-size:12.0pt;font-family:"Times New Roman"'>•<span
style='mso-tab-count:1'>     </span></span>If it is not checked, it is set to a
value of<span style="mso-spacerun: yes">  </span>PagerMode.NextPrev. <o:p></o:p></p>

<p class=Cbase><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=Cbase>This property decides as to which of the two pager styles is to
be used. Since the checkbox is initially unchecked, the default style is PagerMode.NextPrev,
where we see two hyperlinks named Next1 and Prev1, which help us to navigate
page by page. The second style uses page numbers to scroll through the pages.
Since we have 20 pages, the numbers 1 to 10 are displayed along with dots .... <o:p></o:p></p>

<p class=Cbase><span style='color:red'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=Cbase><span style='color:black'>As we keep clicking, the
CurrentyPageIndex that started at zero, either increases by one or decreases by
one, depending upon the link that we click on. </span><o:p></o:p></p>

<p class=Cbase><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=Cbase>The function abc has no significant role to play, since it calls
the function bbb once again, to display the new set of data. The object e<span
style='color:red'> </span><span style='color:black'>that looks like
DataGridPageChangedEventArgs has a member NewPageIndex that internally keeps a
record of the data it has currently displayed, and the set of data that is to
be displayed next. Hence the value contained in CurrentPageIndex changes as it
is initialised to NewPageIndex.</span><o:p></o:p></p>

<p class=Cbase><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=Cprg><u>a.aspx</u><o:p></o:p></p>

<p class=Cprg>&lt;%@ Import Namespace=&quot;System.Data&quot; %&gt;<o:p></o:p></p>

<p class=Cprg>&lt;html&gt;<o:p></o:p></p>

<p class=Cprg>&lt;script language=&quot;C#&quot; runat=&quot;server&quot;&gt;<o:p></o:p></p>

<p class=Cprg>void Page_Load(Object sender, EventArgs e) <o:p></o:p></p>

<p class=Cprg>{<o:p></o:p></p>

<p class=Cprg>bbb();<o:p></o:p></p>

<p class=Cprg>}<o:p></o:p></p>

<p class=Cprg>void pqr(Object sender, DataGridPageChangedEventArgs e) <o:p></o:p></p>

<p class=Cprg>{<o:p></o:p></p>

<p class=Cprg>l.CurrentPageIndex = e.NewPageIndex;<o:p></o:p></p>

<p class=Cprg>bbb();<o:p></o:p></p>

<p class=Cprg>}<o:p></o:p></p>

<p class=Cprg>void abc(Object s, EventArgs e) <o:p></o:p></p>

<p class=Cprg>{<o:p></o:p></p>

<p class=Cprg>String arg = ((LinkButton)s).CommandArgument;<o:p></o:p></p>

<p class=Cprg>if ( arg == &quot;next&quot;)<o:p></o:p></p>

<p class=Cprg>{<o:p></o:p></p>

<p class=Cprg>if (l.CurrentPageIndex &lt; (l.PageCount - 1))<o:p></o:p></p>

<p class=Cprg>l.CurrentPageIndex ++;<o:p></o:p></p>

<p class=Cprg>}<o:p></o:p></p>

<p class=Cprg>else if ( arg == &quot;prev&quot;)<o:p></o:p></p>

<p class=Cprg>{<o:p></o:p></p>

<p class=Cprg>if (l.CurrentPageIndex &gt; 0)<o:p></o:p></p>

<p class=Cprg>l.CurrentPageIndex --;<o:p></o:p></p>

<p class=Cprg>}<o:p></o:p></p>

<p class=Cprg>else if ( arg == &quot;last&quot;)<o:p></o:p></p>

<p class=Cprg>{<o:p></o:p></p>

<p class=Cprg>l.CurrentPageIndex = (l.PageCount - 1);<o:p></o:p></p>

<p class=Cprg>}<o:p></o:p></p>

<p class=Cprg>else<o:p></o:p></p>

<p class=Cprg>l.CurrentPageIndex = Convert.ToInt32(arg);<o:p></o:p></p>

<p class=Cprg><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=Cprg>bbb();<o:p></o:p></p>

<p class=Cprg>}<o:p></o:p></p>

<p class=Cprg>void bbb() <o:p></o:p></p>

<p class=Cprg>{<o:p></o:p></p>

<p class=Cprg>DataTable d = new DataTable();<o:p></o:p></p>

<p class=Cprg>d.Columns.Add(new DataColumn(&quot;c1&quot;,
typeof(Int32)));<span style="mso-spacerun: yes">            </span><o:p></o:p></p>

<p class=Cprg>d.Columns.Add(new DataColumn(&quot;c2&quot;, typeof(string)));<o:p></o:p></p>

<p class=Cprg>DataRow dr;<o:p></o:p></p>

<p class=Cprg>for (int i = 0; i &lt; 200; i++) <o:p></o:p></p>

<p class=Cprg>{<o:p></o:p></p>

<p class=Cprg>dr = d.NewRow();<o:p></o:p></p>

<p class=Cprg>dr[0] = i;<o:p></o:p></p>

<p class=Cprg>dr[1] = &quot;Item &quot; + i.ToString();<o:p></o:p></p>

<p class=Cprg>d.Rows.Add(dr);<o:p></o:p></p>

<p class=Cprg>}<o:p></o:p></p>

<p class=Cprg>DataView dv = new DataView(d);<o:p></o:p></p>

<p class=Cprg>l.DataSource = dv;<o:p></o:p></p>

<p class=Cprg>l.DataBind();<o:p></o:p></p>

<p class=Cprg>l1.Text = &quot;CurrentPageIndex is &quot; + l.CurrentPageIndex +
&quot;PageCount is &quot; + l.PageCount;<o:p></o:p></p>

<p class=Cprg>}<o:p></o:p></p>

<p class=Cprg>&lt;/script&gt;<o:p></o:p></p>

<p class=Cprg>&lt;body&gt;<o:p></o:p></p>

<p class=Cprg>&lt;form runat=server&gt;<o:p></o:p></p>

<p class=Cprg>&lt;ASP:DataGrid id=&quot;l&quot; runat=&quot;server&quot;
AllowPaging=&quot;True&quot; PageSize=&quot;10&quot;
OnPageIndexChanged=&quot;pqr&quot;/&gt;<o:p></o:p></p>

<p class=Cprg>&lt;p&gt;<o:p></o:p></p>

<p class=Cprg>&lt;asp:LinkButton runat=&quot;server&quot; Text=&quot;Previous
page&quot;<span style="mso-spacerun: yes"> 
</span>CommandArgument=&quot;prev&quot; OnClick=&quot;abc&quot; /&gt;<o:p></o:p></p>

<p class=Cprg>&lt;asp:LinkButton runat=&quot;server&quot; Text=&quot;Next
page&quot; CommandArgument=&quot;next&quot; OnClick=&quot;abc&quot; /&gt;<o:p></o:p></p>

<p class=Cprg>&lt;asp:LinkButton runat=&quot;server&quot; Text=&quot;Go to Page
8&quot; CommandArgument=&quot;7&quot; OnClick=&quot;abc&quot; /&gt;<o:p></o:p></p>

<p class=Cprg>&lt;asp:LinkButton runat=&quot;server&quot; Text=&quot;Go to the
first page&quot; CommandArgument=&quot;0&quot; OnClick=&quot;abc&quot; /&gt;<o:p></o:p></p>

<p class=Cprg>&lt;asp:LinkButton runat=&quot;server&quot; Text=&quot;Go to the
last page&quot; CommandArgument=&quot;last&quot; OnClick=&quot;abc&quot; /&gt;<o:p></o:p></p>

<p class=Cprg>&lt;p&gt;<o:p></o:p></p>

<p class=Cprg>&lt;asp:Label id=&quot;l1&quot; runat=&quot;server&quot;
/&gt;&lt;br&gt;<o:p></o:p></p>

<p class=Cprg>&lt;/form&gt;<o:p></o:p></p>

<p class=Cprg>&lt;/body&gt;<o:p></o:p></p>

<p class=Cprg>&lt;/html&gt;<o:p></o:p></p>

<p class=Cprg><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=Coutput><u>Output</u><o:p></o:p></p>

<p class=Coutput><img width=54 height=46 id="_x0000_i1043"
src="chap5img/img16.bmp"><o:p></o:p></p>

<p class=Coutput><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=Coutput><u>Previous page</u><span style="mso-spacerun: yes">  </span><u>Next
page</u><span style="mso-spacerun: yes">  </span><u>Go to Page 8</u><span
style="mso-spacerun: yes">  </span><u>Go to the first page</u><span
style="mso-spacerun: yes">  </span><u><o:p></o:p></u></p>

<p class=Coutput><u>Go to the last page </u><o:p></o:p></p>

<p class=Coutput><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=Coutput>CurrentPageIndex is 0PageCount is 20<o:p></o:p></p>

<p class=Cbase><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=Cbase>In the earlier example, the DataGridControl was totally in
command, since we had used the attributes that it contained. In this program,
we would like to build our own user interface for paging. <o:p></o:p></p>

<p class=Cbase><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=Cbase>To do so, we have five LinkButtons with different texts for
each, but we call the same function abc. In addition to this, there is a
CommandArgument attribute, which is initialized to a different value for each
of them.<o:p></o:p></p>

<p class=Cbase><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=Cbase>Thus, when the page is loaded with the values, the Text is
displayed as hyper links. <span style='color:red'><o:p></o:p></span></p>

<p class=Cbase><span style='color:red'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=Cbase><span style='color:black'>Notice that the DataGrid Control shows
the less than (&lt;) and greater than (&gt;) symbols, which too can be
imlemented to facilitate movement between pages. </span><o:p></o:p></p>

<p class=Cbase><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=Cbase>When we click on the Text defined for the LinkButton, the
function abc is called. In this function, we first need to extract the command
argument. To do so, the first paramter, s of type Object, is used. This object
is cast to a LinkButton class, and the data within the CommandArgument member
is retrieved. The value is stored in a String variable called arg. <o:p></o:p></p>

<p class=Cbase><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=Cbase>If we click on the first button labeled 'Previous page', the
variable arg will hold the value of prev, and so on. If the value of arg is
prev, a check is performed on the CurrentPageIndex to ascertain if it is
greater than zero. If so, its value is reduced by 1, thus, showing the records
on the previous page. <o:p></o:p></p>

<p class=Cbase><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=Cbase>Finally, it is the value that is stored in<span
style='font-family:"Trebuchet MS"'> l.</span>CurrentPageIndex, that displays
the relevant page. Thus, if we change the value in this member to 3, we will
see page 4 (number count starts from 0). For the last page, we pick up the
value in the PageCount member and reduce it by 1. Note, that the arg is a
string variable. Hence, to assign a value to CurrentPageIndex, the ToInt32
function from the Convert class has to be used.<o:p></o:p></p>

<p class=Cbase><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=Cbase>This feature proves to be very useful, when a table contains a
large number of records that are to be displayed. So, whenever we display
records from a database, it makes more sense to fetch the relevant data in
small chunks, instead of fetching them all in one stroke.<o:p></o:p></p>

<p class=Cbase><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=Cbase><b><span style='font-size:14.0pt;font-family:"Times New Roman"'>Data
Manipulation<o:p></o:p></span></b></p>

<p class=Cbase><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=Cprg><u>a.aspx</u><o:p></o:p></p>

<p class=Cprg>&lt;%@ Import Namespace=&quot;System.Data&quot; %&gt;<o:p></o:p></p>

<p class=Cprg>&lt;%@ Import Namespace=&quot;System.Data.SqlClient&quot; %&gt;<o:p></o:p></p>

<p class=Cprg>&lt;html&gt;<o:p></o:p></p>

<p class=Cprg>&lt;head&gt;<o:p></o:p></p>

<p class=Cprg>&lt;script language=&quot;C#&quot; runat=&quot;server&quot;&gt;<o:p></o:p></p>

<p class=Cprg>void abc(Object sender, EventArgs e) <o:p></o:p></p>

<p class=Cprg>{<o:p></o:p></p>

<p class=Cprg>SqlConnection c;<o:p></o:p></p>

<p class=Cprg>c = new
SqlConnection(&quot;server=localhost;uid=sa;pwd=;database=pubs&quot;);<o:p></o:p></p>

<p class=Cprg>SqlCommand co = new SqlCommand(&quot;Create Table a1 (name
char(10),vno int)&quot;, c);<o:p></o:p></p>

<p class=Cprg>c.Open();<o:p></o:p></p>

<p class=Cprg>co.ExecuteNonQuery();<o:p></o:p></p>

<p class=Cprg>}<o:p></o:p></p>

<p class=Cprg>&lt;/script&gt;<o:p></o:p></p>

<p class=Cprg>&lt;/head&gt;<o:p></o:p></p>

<p class=Cprg>&lt;body&gt;<o:p></o:p></p>

<p class=Cprg>&lt;form runat=server&gt;<o:p></o:p></p>

<p class=Cprg>&lt;asp:Button OnClick=&quot;abc&quot; text=&quot;click&quot;
runat=server/&gt;<o:p></o:p></p>

<p class=Cprg>&lt;/form&gt;<o:p></o:p></p>

<p class=Cprg>&lt;/body&gt;<o:p></o:p></p>

<p class=Cprg>&lt;/html&gt;<o:p></o:p></p>

<p class=Cbase><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=Cbase>Structured Query Language (SQL) is commonly used to work with
data in a database. The next few programs will concentrate on adding, modifying
and deleting data, using this language. We will start by creating a very simple
table. <o:p></o:p></p>

<p class=Cbase><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=Cbase>The above program, when loaded, shows a button in the browser
window. When we click on the button, nothing apparently happens. <o:p></o:p></p>

<p class=Cbase><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=Cbase>In the function abc, c is an SqlConnection object. All necessary
parameters are provided to establish a connection to the pubs database. Next,
an SQL command has to be given to create a table. For this, we need a Command
object called co, that accepts an SQL statement to be executed. Earlier, we
used a Select statement. Here, we use a Create table statement. <o:p></o:p></p>

<p class=Cbase><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=Cbase>In the SQL Create statement, we first specify the name of the
table that is to be created. In our case, the name is a1. Thereafter, we give
the names of the fields and the datatype for the values that are to be stored
within them, in brackets. In this case, the table is structured to contain two
fields called name and vno, and their data types are specified as character and
integer, respectively. Moreover, with the char datatype, we have specified the
number 10 in brackets, which signifies the length of the field. <o:p></o:p></p>

<p class=Cbase><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=Cbase>Once the ingredients are in place, we open a connection to the
database server, by calling a function called Open in the SqlConnection Object.
The function connects to the database residing on the server cited, and checks
whether we have a valid User id and password to use SQL Server or not. An error
check is normally performed here to determine success or failure. Since we have
decided to avoid error checks for the time being, we continue on the assumption
that the connection has been established successfully.<o:p></o:p></p>

<p class=Cbase><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=Cbase>Finally, the function ExecuteNonQuery from SqlCommand object, is
executed. This function executes the SQL Create command. The words NonQuery
signify that we are dealing with a SQL statement that does not return data, but
alters the database instead.<o:p></o:p></p>

<p class=Cbase><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=Cbase>To check whether our table has been created or not, we click on
Start, Programs, Microsoft SQL Server, Query Analyzer. Thereafter, we click on
the OK button in the 'Connect to SQL Server' dialog box. Once the connection
with the computer has been established, we see a window with a list of
databases in the left windowpane. Since our table has been created in a
database called pubs, we click on the + sign in front of the database pubs, and
then on the + in front of User Tables. Here, we catch sight of a list of tables
in which, a1 is displayed as the first table. The name given to the table is
dbo.a1. You will also witness the titles tables that we had used earlier, as
dbo.titles, which happens to be the last entry in the list. Click on the + of
a1, and then on Columns, to see the two columns given as name and vno.<o:p></o:p></p>

<p class=Cbase>When we click with the right mouse button on the table named a1,
a menu pops up. From this menu, select the option Open, to display the data in
the table. Our table has no data so far. <o:p></o:p></p>

<p class=Cbase><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=Cprg><u>a.aspx</u><o:p></o:p></p>

<p class=Cprg>&lt;%@ Import Namespace=&quot;System.Data&quot; %&gt;<o:p></o:p></p>

<p class=Cprg>&lt;%@ Import Namespace=&quot;System.Data.SqlClient&quot; %&gt;<o:p></o:p></p>

<p class=Cprg>&lt;html&gt;<o:p></o:p></p>

<p class=Cprg>&lt;head&gt;<o:p></o:p></p>

<p class=Cprg>&lt;script language=&quot;C#&quot; runat=&quot;server&quot;&gt;<o:p></o:p></p>

<p class=Cprg>void abc(Object sender, EventArgs e) <o:p></o:p></p>

<p class=Cprg>{<o:p></o:p></p>

<p class=Cprg>SqlConnection c;<o:p></o:p></p>

<p class=Cprg>c = new SqlConnection(&quot;server=localhost;uid=sa;pwd=;database=pubs&quot;);<o:p></o:p></p>

<p class=Cprg>SqlCommand co = new SqlCommand(&quot;Insert into a1 values
('vijay' , 2)&quot;, c);<o:p></o:p></p>

<p class=Cprg>c.Open();<o:p></o:p></p>

<p class=Cprg>co.ExecuteNonQuery();<o:p></o:p></p>

<p class=Cprg>}<o:p></o:p></p>

<p class=Cprg>&lt;/script&gt;<o:p></o:p></p>

<p class=Cprg>&lt;/head&gt;<o:p></o:p></p>

<p class=Cprg>&lt;body&gt;<o:p></o:p></p>

<p class=Cprg>&lt;form runat=server&gt;<o:p></o:p></p>

<p class=Cprg>&lt;asp:Button OnClick=&quot;abc&quot; text=&quot;click&quot;
runat=server/&gt;<o:p></o:p></p>

<p class=Cprg>&lt;/form&gt;<o:p></o:p></p>

<p class=Cprg>&lt;/body&gt;<o:p></o:p></p>

<p class=Cprg>&lt;/html&gt;<o:p></o:p></p>

<p class=Cbase><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=Cbase>The above program adds one record into the table a1. Use the
program Query Analyzer to verify the result. <o:p></o:p></p>

<p class=Cbase><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=Cbase>In this program, we have replaced the Create Table statement
with an Insert command. The syntax of this command makes it mandatory for us to
use the word 'into', followed by the name of the table, and finally followed by
the word 'values'. Thus, the statement becomes 'Insert into a1 values'.
Thereafter, the values to be inserted in the table are enclosed within
brackets. As the first field is a character field of length 10, we place its
value 'vijay' within single inverted commas. In the case of numbers, the single
quotes are not required. The data values are required to be separated by
commas. The final outcome is a new record with values 'vijay' and 2, added to
our table a1.<o:p></o:p></p>

<p class=Cbase><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=Cbase>These rules have been framed by the inventors of the SQL
language, and are to be strictly adhered to, if you want to use the language. <o:p></o:p></p>

<p class=Cbase><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=Cprg><u>a.aspx</u><o:p></o:p></p>

<p class=Cprg>&lt;%@ Import Namespace=&quot;System.Data&quot; %&gt;<o:p></o:p></p>

<p class=Cprg>&lt;%@ Import Namespace=&quot;System.Data.SqlClient&quot; %&gt;<o:p></o:p></p>

<p class=Cprg>&lt;html&gt;<o:p></o:p></p>

<p class=Cprg>&lt;head&gt;<o:p></o:p></p>

<p class=Cprg>&lt;script language=&quot;C#&quot; runat=&quot;server&quot;&gt;<o:p></o:p></p>

<p class=Cprg>void abc(Object sender, EventArgs e) <o:p></o:p></p>

<p class=Cprg>{<o:p></o:p></p>

<p class=Cprg>SqlConnection c;<o:p></o:p></p>

<p class=Cprg>c = new
SqlConnection(&quot;server=localhost;uid=sa;pwd=;database=pubs&quot;);<o:p></o:p></p>

<p class=Cprg>string s = &quot;Insert into a1 values ('&quot; + aa.Text +
&quot;' , &quot; + bb.Text + &quot;)&quot;;<o:p></o:p></p>

<p class=Cprg>Response.Write(s);<o:p></o:p></p>

<p class=Cprg>SqlCommand co = new SqlCommand(s, c);<o:p></o:p></p>

<p class=Cprg>c.Open();<o:p></o:p></p>

<p class=Cprg>co.ExecuteNonQuery();<o:p></o:p></p>

<p class=Cprg>}<o:p></o:p></p>

<p class=Cprg>&lt;/script&gt;<o:p></o:p></p>

<p class=Cprg>&lt;/head&gt;<o:p></o:p></p>

<p class=Cprg>&lt;body&gt;<o:p></o:p></p>

<p class=Cprg>&lt;form runat=server&gt;<o:p></o:p></p>

<p class=Cprg>First Name : &lt;asp:TextBox id=aa runat=server/&gt; &lt;br&gt;<o:p></o:p></p>

<p class=Cprg>Vno: &lt;asp:TextBox id=bb runat=server/&gt;&lt;br&gt;<o:p></o:p></p>

<p class=Cprg>&lt;asp:Button OnClick=&quot;abc&quot; text=&quot;click&quot;
runat=server/&gt;<o:p></o:p></p>

<p class=Cprg>&lt;/form&gt;<o:p></o:p></p>

<p class=Cprg>&lt;/body&gt;<o:p></o:p></p>

<p class=Cprg>&lt;/html&gt;<o:p></o:p></p>

<p class=Cbase><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=Coutput><u>Output</u><o:p></o:p></p>

<p class=Coutput>Insert into a1 values ('mukhi' , 22)<o:p></o:p></p>

<p class=Cbase><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=Cbase>Most of us detest static values, and seek excitement in things
that are dynamic and challenging. Programmers too prefer their code to be
dynamic.<o:p></o:p></p>

<p class=Cbase><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=Cbase>This program accepts data in two textboxes and adds them to the
database. The two textboxes have ids of aa and bb, respectively. The data
entered in them is 'mukhi' and 22. When the button is clicked, the function abc
is called. This function creates a string 's' that concatenates the Text
attributes of the textboxes, and passes it on to the Insert command. <o:p></o:p></p>

<p class=Cbase><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=Cbase>As a result, the values contained in the textboxes get placed as
the data values in the Insert command. This makes the insert statement dynamic,
wherein, the data that is entered in the text boxes, has now been added into
the database. To provide evidence of this fact, we have displayed the Insert
statement that is created internally in the browser.<o:p></o:p></p>

<p class=Cbase><span style="mso-spacerun: yes"> </span><o:p></o:p></p>

<p class=Cprg><u>a.aspx</u><o:p></o:p></p>

<p class=Cprg>&lt;%@ Import Namespace=&quot;System.Data&quot; %&gt;<o:p></o:p></p>

<p class=Cprg>&lt;%@ Import Namespace=&quot;System.Data.SqlClient&quot; %&gt;<o:p></o:p></p>

<p class=Cprg>&lt;html&gt;<o:p></o:p></p>

<p class=Cprg>&lt;head&gt;<o:p></o:p></p>

<p class=Cprg>&lt;script language=&quot;C#&quot; runat=&quot;server&quot;&gt;<o:p></o:p></p>

<p class=Cprg>void abc(Object sender, EventArgs e) <o:p></o:p></p>

<p class=Cprg>{<o:p></o:p></p>

<p class=Cprg>SqlConnection c;<o:p></o:p></p>

<p class=Cprg>c = new
SqlConnection(&quot;server=localhost;uid=sa;pwd=;database=pubs&quot;);<o:p></o:p></p>

<p class=Cprg>string s = &quot;Update a1 set name = '&quot;<span
style="mso-spacerun: yes">  </span>+ aa.Text + &quot;' where vno =&quot; +
bb.Text ;<o:p></o:p></p>

<p class=Cprg>Response.Write(s);<o:p></o:p></p>

<p class=Cprg>SqlCommand co = new SqlCommand(s, c);<o:p></o:p></p>

<p class=Cprg>c.Open();<o:p></o:p></p>

<p class=Cprg>co.ExecuteNonQuery();<o:p></o:p></p>

<p class=Cprg>}<o:p></o:p></p>

<p class=Cprg>&lt;/script&gt;<o:p></o:p></p>

<p class=Cprg>&lt;/head&gt;<o:p></o:p></p>

<p class=Cprg>&lt;body&gt;<o:p></o:p></p>

<p class=Cprg>&lt;form runat=server&gt;<o:p></o:p></p>

<p class=Cprg>First Name : &lt;asp:TextBox id=aa runat=server/&gt; &lt;br&gt;<o:p></o:p></p>

<p class=Cprg>Vno: &lt;asp:TextBox id=bb runat=server/&gt;&lt;br&gt;<o:p></o:p></p>

<p class=Cprg>&lt;asp:Button OnClick=&quot;abc&quot; text=&quot;click&quot;
runat=server/&gt;<o:p></o:p></p>

<p class=Cprg>&lt;/form&gt;<o:p></o:p></p>

<p class=Cprg>&lt;/body&gt;&lt;/html&gt;<o:p></o:p></p>

<p class=Coutput><u>Output</u><o:p></o:p></p>

<p class=Coutput>Update a1 set name = 'sonal' where vno =2<o:p></o:p></p>

<p class=Cbase><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=Cbase>This program is almost identical to the earlier one, except for
one single variation. An Update statement has now replaced the Insert
statement. <o:p></o:p></p>

<p class=Cbase><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=Cbase>This statement requires the name of the table, followed by the
name of the field that is to be changed, and finally, the value to which the
field is to be updated. If we do not use the<span style="mso-spacerun: yes"> 
</span>'where' clause, all records in the table will get modified to the new
value. Since this is not what is actually desired, we add the where clause,
which acts like a filter. Now, only those records that meet the specified
condition, get affected. So, the field vno that has a value of 2, will get
modified.<span style="mso-spacerun: yes">  </span><o:p></o:p></p>

<p class=Cbase><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=Cbase>In the same way, you can try the delete statement. Delete
removes records from a table. Thus, the SQL statement 'Delete from a1 where vno
= 2' will remove all records whose vno field has a value of 2.<o:p></o:p></p>

<p class=Cbase><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=Cprg><u>a.aspx</u><o:p></o:p></p>

<p class=Cprg>&lt;%@ Import Namespace=&quot;System.Data&quot; %&gt;<o:p></o:p></p>

<p class=Cprg>&lt;%@ Import Namespace=&quot;System.Data.SqlClient&quot; %&gt;<o:p></o:p></p>

<p class=Cprg>&lt;html&gt;<o:p></o:p></p>

<p class=Cprg>&lt;script language=&quot;C#&quot; runat=server&gt;<o:p></o:p></p>

<p class=Cprg>void abc(Object se, EventArgs e) <o:p></o:p></p>

<p class=Cprg>{<o:p></o:p></p>

<p class=Cprg>SqlConnection c = new
SqlConnection(&quot;server=localhost;uid=sa;pwd=;database=pubs&quot;);<o:p></o:p></p>

<p class=Cprg>string s = &quot;select * from authors where state = '&quot; +
aa.Value + &quot;'&quot;;<o:p></o:p></p>

<p class=Cprg>Response.Write(s);<o:p></o:p></p>

<p class=Cprg>SqlDataAdapter co = new SqlDataAdapter(s, c);<o:p></o:p></p>

<p class=Cprg>DataSet d = new DataSet();<o:p></o:p></p>

<p class=Cprg>co.Fill(d, &quot;zzz&quot;);<o:p></o:p></p>

<p class=Cprg>l.DataSource = d.Tables[&quot;zzz&quot;].DefaultView;<o:p></o:p></p>

<p class=Cprg>l.DataBind();<o:p></o:p></p>

<p class=Cprg>}<o:p></o:p></p>

<p class=Cprg>&lt;/script&gt;<o:p></o:p></p>

<p class=Cprg>&lt;body&gt;<o:p></o:p></p>

<p class=Cprg>&lt;form action=&quot;a.aspx&quot; runat=&quot;server&quot;&gt;<o:p></o:p></p>

<p class=Cprg>&lt;select id=&quot;aa&quot; runat=&quot;server&quot;&gt;<o:p></o:p></p>

<p class=Cprg>&lt;option&gt;CA&lt;/option&gt;<o:p></o:p></p>

<p class=Cprg>&lt;option&gt;IN&lt;/option&gt;<span style="mso-spacerun: yes"> 
</span><o:p></o:p></p>

<p class=Cprg>&lt;option&gt;KS&lt;/option&gt;<span style="mso-spacerun: yes"> 
</span><o:p></o:p></p>

<p class=Cprg>&lt;option&gt;MD&lt;/option&gt;<span style="mso-spacerun: yes"> 
</span><o:p></o:p></p>

<p class=Cprg>&lt;option&gt;MI&lt;/option&gt;<span style="mso-spacerun: yes"> 
</span><o:p></o:p></p>

<p class=Cprg>&lt;option&gt;OR&lt;/option&gt; <o:p></o:p></p>

<p class=Cprg>&lt;option&gt;TN&lt;/option&gt;<span style="mso-spacerun: yes"> 
</span><o:p></o:p></p>

<p class=Cprg>&lt;option&gt;UT&lt;/option&gt;<span style="mso-spacerun: yes"> 
</span><o:p></o:p></p>

<p class=Cprg>&lt;/select&gt;<o:p></o:p></p>

<p class=Cprg>&lt;asp:button type=submit text=&quot;Fetch&quot;
OnClick=&quot;abc&quot; runat=&quot;server&quot;/&gt;<o:p></o:p></p>

<p class=Cprg>&lt;ASP:DataGrid id=&quot;l&quot; runat=&quot;server&quot;/&gt;<o:p></o:p></p>

<p class=Cprg>&lt;/form&gt;<o:p></o:p></p>

<p class=Cprg>&lt;/body&gt;<o:p></o:p></p>

<p class=Cprg>&lt;/html&gt;<o:p></o:p></p>

<p class=Cbase><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=Coutput><u>Output</u><o:p></o:p></p>

<p class=Coutput>select * from authors where state = 'IN' <o:p></o:p></p>

<p class=Coutput><img width=424 height=77 id="_x0000_i1044"
src="chap5img/img17.bmp"><span style="mso-spacerun: yes">  </span><o:p></o:p></p>

<p class=Cbase><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=Cbase>Here, the earlier program has been made more dynamic. We used
the HTML tag called 'select', to fill up a listbox with the abbreviated names
of the states. When we choose a state and click on the button labeled 'Fetch',
the function abc gets called. We have used the Value attribute of the select
tag, to dynamically figure out the name of the state. This is then added to the
Select statement. Thus, depending upon the state that the user selects, the
records from the authors table that match the specified state, are displayed.<o:p></o:p></p>

<p class=Cbase><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=Cprg><u>a.aspx</u><o:p></o:p></p>

<p class=Cprg>&lt;%@ Import Namespace=&quot;System.Data&quot; %&gt;<o:p></o:p></p>

<p class=Cprg>&lt;%@ Import Namespace=&quot;System.Data.SqlClient&quot; %&gt;<o:p></o:p></p>

<p class=Cprg>&lt;html&gt;<o:p></o:p></p>

<p class=Cprg>&lt;script language=&quot;C#&quot; runat=server&gt;<o:p></o:p></p>

<p class=Cprg>void abc(Object se, EventArgs e) <o:p></o:p></p>

<p class=Cprg>{<o:p></o:p></p>

<p class=Cprg>SqlConnection c = new
SqlConnection(&quot;server=localhost;uid=sa;pwd=;database=pubs&quot;);<o:p></o:p></p>

<p class=Cprg>SqlDataAdapter co = new SqlDataAdapter(&quot;select * from
Authors where state = @zzz&quot;, c);<o:p></o:p></p>

<p class=Cprg>SqlParameter p = new SqlParameter(&quot;@zzz&quot;,
SqlDbType.VarChar, 2);<o:p></o:p></p>

<p class=Cprg>co.SelectCommand.Parameters.Add(p);<o:p></o:p></p>

<p class=Cprg>co.SelectCommand.Parameters[&quot;@zzz&quot;].Value = aa.Value;<o:p></o:p></p>

<p class=Cprg>DataSet d = new DataSet();<o:p></o:p></p>

<p class=Cprg>co.Fill(d, &quot;zzz&quot;);<o:p></o:p></p>

<p class=Cprg>l.DataSource = d.Tables[&quot;zzz&quot;].DefaultView;<o:p></o:p></p>

<p class=Cprg>l.DataBind();<o:p></o:p></p>

<p class=Cprg>}<o:p></o:p></p>

<p class=Cprg>&lt;/script&gt;<o:p></o:p></p>

<p class=Cprg>&lt;body&gt;<o:p></o:p></p>

<p class=Cprg>&lt;form action=&quot;a.aspx&quot; runat=&quot;server&quot;&gt;<o:p></o:p></p>

<p class=Cprg>&lt;select id=&quot;aa&quot; runat=&quot;server&quot;&gt;<o:p></o:p></p>

<p class=Cprg>&lt;option&gt;CA&lt;/option&gt;<o:p></o:p></p>

<p class=Cprg>&lt;option&gt;IN&lt;/option&gt;<span style="mso-spacerun: yes"> 
</span><o:p></o:p></p>

<p class=Cprg>&lt;option&gt;KS&lt;/option&gt;<span style="mso-spacerun: yes"> 
</span><o:p></o:p></p>

<p class=Cprg>&lt;option&gt;MD&lt;/option&gt;<span style="mso-spacerun: yes"> 
</span><o:p></o:p></p>

<p class=Cprg>&lt;option&gt;MI&lt;/option&gt;<span style="mso-spacerun: yes"> 
</span><o:p></o:p></p>

<p class=Cprg>&lt;option&gt;OR&lt;/option&gt; <o:p></o:p></p>

<p class=Cprg>&lt;option&gt;TN&lt;/option&gt;<span style="mso-spacerun: yes"> 
</span><o:p></o:p></p>

<p class=Cprg>&lt;option&gt;UT&lt;/option&gt;<span style="mso-spacerun: yes"> 
</span><o:p></o:p></p>

<p class=Cprg>&lt;/select&gt;<o:p></o:p></p>

<p class=Cprg>&lt;asp:button type=submit text=&quot;Fetch&quot;
OnClick=&quot;abc&quot; runat=&quot;server&quot;/&gt;<o:p></o:p></p>

<p class=Cprg>&lt;ASP:DataGrid id=&quot;l&quot; MaintainState=&quot;false&quot;
runat=&quot;server&quot;/&gt;<o:p></o:p></p>

<p class=Cprg>&lt;/form&gt;<o:p></o:p></p>

<p class=Cprg>&lt;/body&gt;<o:p></o:p></p>

<p class=Cprg>&lt;/html&gt;<o:p></o:p></p>

<p class=Cbase><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=Cbase>This program works in the same manner as the earlier program,
but theoretically, it is supposedly faster than the earlier program. Let us
understand the reasoning behind it.<o:p></o:p></p>

<p class=Cbase><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=Cbase>The select statement passed to the SqlDataAdapter has a 'where'
clause that contains a name zzz, beginning with an @ sign. Earlier, we had used
the value member of the TextBox. Any word that begins with @ is called a
placeholder. So, even though the name of the state has not been acquired at
this stage, we are free to pass an incomplete Select statement to the
constructor. <o:p></o:p></p>

<p class=Cbase><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=Cbase>Since the Select is incomplete, we create an object of type
SqlParameter, whose constructor requires three parameters: <o:p></o:p></p>

<p class=Cbase><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=Cbullets><span style='mso-bidi-font-size:12.0pt;font-family:"Times New Roman"'>•<span
style='mso-tab-count:1'>     </span></span>The first parameter is the
placeholder, zzz, used in the select statement. <o:p></o:p></p>

<p class=Cbullets><span style='mso-bidi-font-size:12.0pt;font-family:"Times New Roman"'>•<span
style='mso-tab-count:1'>     </span></span>The second parameter is the data
type of the field. In our case, since zzz is a placeholder for the state field,
and the data type of this column is VarChar, we enter the second parameter as
SqlDbType.VarChar. VarChar is another word for characters or a string. <o:p></o:p></p>

<p class=Cbullets><span style='mso-bidi-font-size:12.0pt;font-family:"Times New Roman"'>•<span
style='mso-tab-count:1'>     </span></span>The third last parameter is given
the value of 2, which represents the width of the column. <o:p></o:p></p>

<p class=Cbase><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=Cbase>We can have as many placeholders as we like, in a single select
statement. The only restriction here is that they must be registered or added,
using the Add function. <o:p></o:p></p>

<p class=Cbase><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=Cbase>The SqlDataAdapter class has a member called SelectCommand of
the SqlCommand datatype. This class has a member called Parameter of data type
SqlParameters, which contains a function called Add. Now that we have registered
our placeholder zzz, we need to assign it a value. The next line uses the []
brackets syntax to inform ASP+ about the placeholder @zzz, and also alerts it
to the fact that, it will be replaced by the value selected in the listbox
named aa.<o:p></o:p></p>

<p class=Cbase><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=Cbase>So, how does all the above, help our program run faster? It
should logically slow things down. <o:p></o:p></p>

<p class=Cbase><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=Cbase>When we submit a Select statement or for that matter, any SQL
statement, a lot of activity takes place behind the scene. SQLServer performs a
variety of checks. <o:p></o:p></p>

<p class=Cbase><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=Cbullets><span style='mso-bidi-font-size:12.0pt;font-family:"Times New Roman"'>•<span
style='mso-tab-count:1'>     </span></span>The syntax of the statement is check
to ascertain whether it abides by all the rules of SQL. This consumes some
time. <o:p></o:p></p>

<p class=Cbullets><span style='mso-bidi-font-size:12.0pt;font-family:"Times New Roman"'>•<span
style='mso-tab-count:1'>     </span></span>Then, it checks for the table given
in the statement in its database, eg. titles. <o:p></o:p></p>

<p class=Cbullets><span style='mso-bidi-font-size:12.0pt;font-family:"Times New Roman"'>•<span
style='mso-tab-count:1'>     </span></span>Next, the fields mentioned in the
statement are looked up, in the specified table. <o:p></o:p></p>

<p class=Cbullets><span style='mso-bidi-font-size:12.0pt;font-family:"Times New Roman"'>•<span
style='mso-tab-count:1'>     </span></span>Thereafter, it checks whether the
user, sa, has a right to access each of the entities.<o:p></o:p></p>

<p class=Cbullets><span style='mso-bidi-font-size:12.0pt;font-family:"Times New Roman"'>•<span
style='mso-tab-count:1'>     </span></span>Once the above entities are verified
and found to be satisfactory, the database server then figures out as to how
the select statement should be executed. This is called the execution plan. <o:p></o:p></p>

<p class=Cbase><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=Cbase>The intelligence of a database lies in the execution plan. Once
the plan is ready, the select statement is executed. This execution plan is
independent of the parameters passed to the 'where' clause. <o:p></o:p></p>

<p class=Cbase><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=Cbase>It is a much better idea to execute all the actions up to the
execution plan, only once. Thereafter, use it, for every SQL statement that
follows, rather than repeating it for every query. This is achieved by
implementing the concept of parameters. It saves on database time, since it
does not have to execute all the above actions over and over again. <o:p></o:p></p>

<p class=Cbase><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=Cbase>One more property called MaintanState has been added to our
DataGrid Control. It has been set to false, since it will not be beneficial for
the DataGrid to store the state information internally. When the data is
populated on every request, there is no reason to send it back to the server,
or on a round trip when the form is reposted. <o:p></o:p></p>

<p class=Cbase><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=Cbase>To maintain state, the data grid must store all its data. There
is no other alternative for achieving this. When the form is requested for,
with the method as post, this data gets transmitted to and fro. We turn it off
because of the large overheads it entails, which adversely affect the overall
performance.<o:p></o:p></p>

<p class=Cbase><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=Cprg><u>a.aspx</u><o:p></o:p></p>

<p class=Cprg>&lt;%@ Import Namespace=&quot;System.Data&quot; %&gt;<o:p></o:p></p>

<p class=Cprg>&lt;%@ Import Namespace=&quot;System.Data.SqlClient&quot; %&gt;<o:p></o:p></p>

<p class=Cprg>&lt;html&gt;<o:p></o:p></p>

<p class=Cprg>&lt;script language=&quot;C#&quot; runat=&quot;server&quot;&gt;<o:p></o:p></p>

<p class=Cprg>SqlConnection c;<o:p></o:p></p>

<p class=Cprg>void Page_Load(Object Src, EventArgs E) <o:p></o:p></p>

<p class=Cprg>{<o:p></o:p></p>

<p class=Cprg>c = new
SqlConnection(&quot;server=localhost;uid=sa;pwd=;database=pubs&quot;);<o:p></o:p></p>

<p class=Cprg>if (!IsPostBack) <o:p></o:p></p>

<p class=Cprg>{<o:p></o:p></p>

<p class=Cprg>SqlDataAdapter co = new SqlDataAdapter(&quot;select distinct
State from Authors&quot;, c);<o:p></o:p></p>

<p class=Cprg>DataSet ds = new DataSet();<o:p></o:p></p>

<p class=Cprg>co.Fill(ds, &quot;States&quot;);<o:p></o:p></p>

<p class=Cprg>l1.DataSource= ds.Tables[&quot;States&quot;].DefaultView;<o:p></o:p></p>

<p class=Cprg>l1.DataBind();<o:p></o:p></p>

<p class=Cprg>}<o:p></o:p></p>

<p class=Cprg>}<o:p></o:p></p>

<p class=Cprg>public void abc(Object sender, EventArgs E) <o:p></o:p></p>

<p class=Cprg>{<o:p></o:p></p>

<p class=Cprg>String s = &quot;select * from Authors where state = @zzz&quot;;<o:p></o:p></p>

<p class=Cprg>SqlConnection c1 = new
SqlConnection(&quot;server=localhost;uid=sa;pwd=;database=pubs&quot;);<o:p></o:p></p>

<p class=Cprg>SqlDataAdapter co1 = new SqlDataAdapter(s, c1);<o:p></o:p></p>

<p class=Cprg>co1.SelectCommand.Parameters.Add(new
SqlParameter(&quot;@zzz&quot;, SqlDbType.VarChar, 2));<o:p></o:p></p>

<p class=Cprg>co1.SelectCommand.Parameters[&quot;@zzz&quot;].Value = l1.Value;<o:p></o:p></p>

<p class=Cprg>DataSet ds = new DataSet();<o:p></o:p></p>

<p class=Cprg>co1.Fill(ds, &quot;Authors&quot;);<o:p></o:p></p>

<p class=Cprg>l.DataSource= ds.Tables[&quot;Authors&quot;].DefaultView;<o:p></o:p></p>

<p class=Cprg>l.DataBind();<o:p></o:p></p>

<p class=Cprg>}<o:p></o:p></p>

<p class=Cprg>&lt;/script&gt;<o:p></o:p></p>

<p class=Cprg>&lt;form runat=&quot;server&quot;&gt;<o:p></o:p></p>

<p class=Cprg>&lt;select id=&quot;l1&quot; DataTextField=&quot;State&quot;
runat=&quot;server&quot;/&gt;<o:p></o:p></p>

<p class=Cprg>&lt;input type=&quot;submit&quot; OnServerClick=&quot;abc&quot;
Value=&quot;Authors&quot; runat=&quot;server&quot;/&gt;&lt;p&gt;<o:p></o:p></p>

<p class=Cprg>&lt;ASP:DataGrid id=&quot;l&quot; runat=&quot;server&quot;
MaintainState=&quot;false&quot;/&gt;<o:p></o:p></p>

<p class=Cprg>&lt;/form&gt;<o:p></o:p></p>

<p class=Cprg>&lt;/body&gt;<o:p></o:p></p>

<p class=Cprg>&lt;/html&gt;<o:p></o:p></p>

<p class=Cbase><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=Cbase>Let us retrieve the same data as shown in the earlier example,
but in a more efficient manner. The Page_Load function gets called by the
server every time, but as explained earlier, the 'if' statement is executed
only once.<o:p></o:p></p>

<p class=Cbase><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=Cbase>Each time, a new SqlConnection object is created, but the state
data for the listbox that uses a DataSource, is generated only once. Fetching
data all the time, is an exercise in futility, if the final list is to remain
the same. The 'distinct' clause in the select statement will not give duplicate
records for the same state in the output. Thus, the list box<span
style='font-family:"Trebuchet MS"'> l1 </span>is being filled up in the same
way, as a DataGrid.<o:p></o:p></p>

<p class=Cbase><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=Cbase>Each time we click on the button, the function abc fills up the
DataGrid as shown earlier. The listbox data is initially statically
populatedusing SQL commands. It will not produce correct results, if the data
changes very frequently in the database.<span style="mso-spacerun: yes"> 
</span><o:p></o:p></p>

<p class=Cbase><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=Cbase>Thus, the above example indicates that if data is read from a
database, actual values should be avoided in our aspx file. Otherwise, with
every new entry on state, the aspx file will have to be changed.<o:p></o:p></p>

<p class=Cbase><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=Cbase>It is time for us to take a short diversion from databases, to
break the monotony. Instead, we shall refocus our attention on the issue of
error handling.<o:p></o:p></p>

<p class=Cbase><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=Cbase>We create a file called a.cs and then run the C# compiler on it,
using the command &gt;csc a.cs . We run the compiled C# code as<span
style="mso-spacerun: yes">  </span>&gt;a <o:p></o:p></p>

<p class=Cbase><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=Cprg><u>a.cs</u><o:p></o:p></p>

<p class=Cprg>public class zzz {<o:p></o:p></p>

<p class=Cprg>public static void Main()<o:p></o:p></p>

<p class=Cprg>{<o:p></o:p></p>

<p class=Cprg>yyy a = new yyy();<o:p></o:p></p>

<p class=Cprg>a.abc();<o:p></o:p></p>

<p class=Cprg>System.Console.WriteLine(&quot;After abc&quot;);<o:p></o:p></p>

<p class=Cprg>}<o:p></o:p></p>

<p class=Cprg>}<o:p></o:p></p>

<p class=Cprg>public class yyy<o:p></o:p></p>

<p class=Cprg>{<o:p></o:p></p>

<p class=Cprg>public void abc()<o:p></o:p></p>

<p class=Cprg>{<o:p></o:p></p>

<p class=Cprg>System.Console.WriteLine(&quot;Before throw&quot;);<o:p></o:p></p>

<p class=Cprg>throw new System.Exception();<o:p></o:p></p>

<p class=Cprg>System.Console.WriteLine(&quot;After throw&quot;);<o:p></o:p></p>

<p class=Cprg>}<o:p></o:p></p>

<p class=Cprg>}<o:p></o:p></p>

<p class=Coutput><u>Output </u><o:p></o:p></p>

<p class=Coutput>Before throw<o:p></o:p></p>

<p class=Coutput>Unhandled Exception: System.Exception: Exception of type
System.Exception was thrown.<o:p></o:p></p>

<p class=Coutput><span style="mso-spacerun: yes">   </span>at yyy.abc()<o:p></o:p></p>

<p class=Coutput><span style="mso-spacerun: yes">   </span>at zzz.Main()<o:p></o:p></p>

<p class=Cbase><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=Cbase>So far, we have learnt that the functions may return values.
However, they are not expected to return errors. But, there may be certain situations
in which the functions may end up returning errors. Let us study a few such
cases, which are demonstrated below:<o:p></o:p></p>

<p class=Cbase><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=Cbase>Constructors can consist of a large amount of code, but they are
prohibited from returning any values. What happens if the code fails? We shall
discover the answer in a moment.<o:p></o:p></p>

<p class=Cbase><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=Cbase>Under the assumption that constructors are prohibited from
returning any values, we open five files in a program. Every time we open a
file, we need to check for a variety of errors that may occur, while a file is
being opened. These errors could be of the form-<o:p></o:p></p>

<p class=Cbullets>file not found, <o:p></o:p></p>

<p class=Cbullets>read only file, etc.<o:p></o:p></p>

<p class=Cbase><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=Cbase>In these circumstances, errors also known as Exceptions, are
thrown by a function when an error occurs. Hence, the function abc first
displays the String given in WriteLine, and then throws an exception. <o:p></o:p></p>

<p class=Cbase><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=Cbase>An exception is an object that is either an instance of the
class Exception or it is derived from it. In the function abc, we have
consciously thrown an exception. But in real life situations, an exception is
generated, only when an error occurs. Further, depending upon the type of
error, different types of Exceptions are thrown. <o:p></o:p></p>

<p class=Cbase><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=Cbase>There are a couple of points to be kept in mind, while going
through the above program:<o:p></o:p></p>

<p class=Cbase><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=Cbase><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=Cbullets><span style='mso-bidi-font-size:12.0pt;font-family:"Times New Roman"'>•<span
style='mso-tab-count:1'>     </span></span>Any code that is written after a
point where the exception is thrown, does not get called. <o:p></o:p></p>

<p class=Cbullets><span style='mso-bidi-font-size:12.0pt;font-family:"Times New Roman"'>•<span
style='mso-tab-count:1'>     </span></span>In the case of an exception being
thrown, any code that follows the function call, does not get executed. Hence,
we encounter a warning when we compile the code.<o:p></o:p></p>

<p class=Cbullets><span style='mso-bidi-font-size:12.0pt;font-family:"Times New Roman"'>•<span
style='mso-tab-count:1'>     </span></span>When an Exception is thrown, a
Message Box is shown at runtime.<span style="mso-spacerun: yes">  </span><o:p></o:p></p>

<p class=Cbase><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=Cbase>The user would undoubtedly be scared out of his wits on seeing
the Message Box pop up infront of him. Thus, Exceptions that are thrown on the
occurence of an error have to be caught. The next program depicts how the
errors can be dealt with. <o:p></o:p></p>

<p class=Cbase><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=Cprg><u>a.cs</u><o:p></o:p></p>

<p class=Cprg>public class zzz<o:p></o:p></p>

<p class=Cprg>{<o:p></o:p></p>

<p class=Cprg>public static void Main()<o:p></o:p></p>

<p class=Cprg>{<o:p></o:p></p>

<p class=Cprg>yyy a = new yyy();<o:p></o:p></p>

<p class=Cprg>try<o:p></o:p></p>

<p class=Cprg>{<o:p></o:p></p>

<p class=Cprg>a.abc();<o:p></o:p></p>

<p class=Cprg>System.Console.WriteLine(&quot;After abc&quot;);<o:p></o:p></p>

<p class=Cprg>}<o:p></o:p></p>

<p class=Cprg>catch ( System.Exception e)<o:p></o:p></p>

<p class=Cprg>{<o:p></o:p></p>

<p class=Cprg>System.Console.WriteLine(&quot;In Exception &quot; );<o:p></o:p></p>

<p class=Cprg>}<o:p></o:p></p>

<p class=Cprg>System.Console.WriteLine(&quot;After catch&quot;);<o:p></o:p></p>

<p class=Cprg>}<o:p></o:p></p>

<p class=Cprg>}<o:p></o:p></p>

<p class=Cprg>public class yyy<o:p></o:p></p>

<p class=Cprg>{<o:p></o:p></p>

<p class=Cprg>public void abc()<o:p></o:p></p>

<p class=Cprg>{<o:p></o:p></p>

<p class=Cprg>System.Console.WriteLine(&quot;Before throw&quot;);<o:p></o:p></p>

<p class=Cprg>throw new System.Exception();<o:p></o:p></p>

<p class=Cprg>System.Console.WriteLine(&quot;After throw&quot;);<o:p></o:p></p>

<p class=Cprg>}<o:p></o:p></p>

<p class=Cprg>}<o:p></o:p></p>

<p class=Cbase><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=Coutput><u>Output </u><o:p></o:p></p>

<p class=Coutput>Before throw<o:p></o:p></p>

<p class=Coutput>In Exception <o:p></o:p></p>

<p class=Coutput>After catch<o:p></o:p></p>

<p class=Cbase><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=Cbase>In order to catch an Exception, all the code that is likely to
be thrown in an Exception, is placed in a 'try block'. Every 'try' is normally
followed by 'catch'. So, if an exception occurs, the code placed in the catch
block, gets executed. As there is no return statement in the catch block, the
statements that follow the catch block, will also get called. We have the
flexibility to decide as to how we propose to handle the error. <o:p></o:p></p>

<p class=Cbase><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=Cbase>Let us coalesce whatever we have learnt so far about Execptions,
with ASP+.<o:p></o:p></p>

<p class=Cbase><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=Cprg><u>a.aspx</u><o:p></o:p></p>

<p class=Cprg>&lt;%@ Import Namespace=&quot;System.Data&quot; %&gt;<o:p></o:p></p>

<p class=Cprg>&lt;%@ Import Namespace=&quot;System.Data.SqlClient&quot; %&gt;<o:p></o:p></p>

<p class=Cprg>&lt;html&gt;<o:p></o:p></p>

<p class=Cprg>&lt;script language=&quot;C#&quot; runat=&quot;server&quot;&gt;<o:p></o:p></p>

<p class=Cprg>SqlConnection c;<o:p></o:p></p>

<p class=Cprg>void Page_Load(Object Src, EventArgs E) <o:p></o:p></p>

<p class=Cprg>{<o:p></o:p></p>

<p class=Cprg>c = new SqlConnection(&quot;server=localhost;uid=sa;pwd=;database=pubs&quot;);<o:p></o:p></p>

<p class=Cprg>if (!IsPostBack)<o:p></o:p></p>

<p class=Cprg>bbb();<o:p></o:p></p>

<p class=Cprg>}<o:p></o:p></p>

<p class=Cprg>public void abc(Object sender, EventArgs E) <o:p></o:p></p>

<p class=Cprg>{<o:p></o:p></p>

<p class=Cprg>if (au_id.Value == &quot;&quot; || au_fname.Value == &quot;&quot;
|| au_lname.Value == &quot;&quot; || phone.Value == &quot;&quot;)<o:p></o:p></p>

<p class=Cprg>{<o:p></o:p></p>

<p class=Cprg>m.InnerHtml = &quot;ERROR: Null values not allowed for Author ID,
Name or Phone&quot;;<o:p></o:p></p>

<p class=Cprg>m.Style[&quot;color&quot;] = &quot;red&quot;;<o:p></o:p></p>

<p class=Cprg>bbb();<o:p></o:p></p>

<p class=Cprg>return;<o:p></o:p></p>

<p class=Cprg>}<o:p></o:p></p>

<p class=Cprg>String s = &quot;insert into Authors values (@Id, @LName, @FName,
@Phone, @Address, @City, @State, @Zip, @Contract)&quot;;<o:p></o:p></p>

<p class=Cprg>SqlCommand co = new SqlCommand(s, c);<o:p></o:p></p>

<p class=Cprg>co.Parameters.Add(new SqlParameter(&quot;@Id&quot;,
SqlDbType.VarChar, 11));<o:p></o:p></p>

<p class=Cprg>co.Parameters[&quot;@Id&quot;].Value = au_id.Value;<o:p></o:p></p>

<p class=Cprg>co.Parameters.Add(new SqlParameter(&quot;@LName&quot;,
SqlDbType.VarChar, 40));<o:p></o:p></p>

<p class=Cprg>co.Parameters[&quot;@LName&quot;].Value = au_lname.Value;<o:p></o:p></p>

<p class=Cprg>co.Parameters.Add(new SqlParameter(&quot;@FName&quot;,
SqlDbType.VarChar, 20));<o:p></o:p></p>

<p class=Cprg>co.Parameters[&quot;@FName&quot;].Value = au_fname.Value;<o:p></o:p></p>

<p class=Cprg>co.Parameters.Add(new SqlParameter(&quot;@Phone&quot;,
SqlDbType.Char, 12));<o:p></o:p></p>

<p class=Cprg>co.Parameters[&quot;@Phone&quot;].Value = phone.Value;<o:p></o:p></p>

<p class=Cprg>co.Parameters.Add(new SqlParameter(&quot;@Address&quot;, SqlDbType.VarChar,
40));<o:p></o:p></p>

<p class=Cprg>co.Parameters[&quot;@Address&quot;].Value = address.Value;<o:p></o:p></p>

<p class=Cprg>co.Parameters.Add(new SqlParameter(&quot;@City&quot;,
SqlDbType.VarChar, 20));<o:p></o:p></p>

<p class=Cprg>co.Parameters[&quot;@City&quot;].Value = city.Value;<o:p></o:p></p>

<p class=Cprg>co.Parameters.Add(new SqlParameter(&quot;@State&quot;,
SqlDbType.Char, 2));<o:p></o:p></p>

<p class=Cprg>co.Parameters[&quot;@State&quot;].Value = state.Value;<o:p></o:p></p>

<p class=Cprg>co.Parameters.Add(new SqlParameter(&quot;@Zip&quot;,
SqlDbType.Char, 5));<o:p></o:p></p>

<p class=Cprg>co.Parameters[&quot;@Zip&quot;].Value = zip.Value;<o:p></o:p></p>

<p class=Cprg>co.Parameters.Add(new SqlParameter(&quot;@Contract&quot;,
SqlDbType.VarChar,1));<o:p></o:p></p>

<p class=Cprg>co.Parameters[&quot;@Contract&quot;].Value = contract.Value;<o:p></o:p></p>

<p class=Cprg>c.Open();<o:p></o:p></p>

<p class=Cprg>try <o:p></o:p></p>

<p class=Cprg>{<o:p></o:p></p>

<p class=Cprg>co.ExecuteNonQuery ();<o:p></o:p></p>

<p class=Cprg>m.InnerHtml = &quot;&lt;b&gt;Record
Added&lt;/b&gt;&lt;br&gt;&quot; + s.ToString();<o:p></o:p></p>

<p class=Cprg>}<o:p></o:p></p>

<p class=Cprg>catch (SqlException e)<o:p></o:p></p>

<p class=Cprg>{<o:p></o:p></p>

<p class=Cprg>if (e.Number == 2627)<o:p></o:p></p>

<p class=Cprg>m.InnerHtml = &quot;ERROR: A record already exists with the same
primary key&quot;;<o:p></o:p></p>

<p class=Cprg>else<o:p></o:p></p>

<p class=Cprg>m.InnerHtml = &quot;ERROR: Could not add record, please ensure
the fields are correctly filled out&quot;;<o:p></o:p></p>

<p class=Cprg>m.Style[&quot;color&quot;] = &quot;red&quot;;<o:p></o:p></p>

<p class=Cprg>}<o:p></o:p></p>

<p class=Cprg>c.Close();<o:p></o:p></p>

<p class=Cprg>bbb();<o:p></o:p></p>

<p class=Cprg>}<o:p></o:p></p>

<p class=Cprg>public void bbb() <o:p></o:p></p>

<p class=Cprg>{<o:p></o:p></p>

<p class=Cprg>SqlDataAdapter co = new SqlDataAdapter(&quot;select * from
Authors&quot;, c);<o:p></o:p></p>

<p class=Cprg>DataSet ds = new DataSet();<o:p></o:p></p>

<p class=Cprg>co.Fill(ds, &quot;Authors&quot;);<o:p></o:p></p>

<p class=Cprg>l.DataSource=ds.Tables[&quot;Authors&quot;].DefaultView;<o:p></o:p></p>

<p class=Cprg>l.DataBind();<o:p></o:p></p>

<p class=Cprg>}<o:p></o:p></p>

<p class=Cprg>&lt;/script&gt;<o:p></o:p></p>

<p class=Cprg>&lt;body &gt;<o:p></o:p></p>

<p class=Cprg>&lt;form runat=&quot;server&quot;&gt;<o:p></o:p></p>

<p class=Cprg>&lt;ASP:DataGrid id=&quot;l&quot; runat=&quot;server&quot;
MaintainState=&quot;false&quot;/&gt;<o:p></o:p></p>

<p class=Cprg>Author ID: &lt;input type=&quot;text&quot; id=&quot;au_id&quot;
value=&quot;000-00-0000&quot; runat=&quot;server&quot;&gt;<o:p></o:p></p>

<p class=Cprg>Last Name: &lt;input type=&quot;text&quot;
id=&quot;au_lname&quot; value=&quot;Mukhi&quot; runat=&quot;server&quot;&gt;<o:p></o:p></p>

<p class=Cprg>First Name: &lt;input type=&quot;text&quot;
id=&quot;au_fname&quot; value=&quot;Vijay&quot; runat=&quot;server&quot;&gt;<o:p></o:p></p>

<p class=Cprg>Phone: &lt;input type=&quot;text&quot; id=&quot;phone&quot;
value=&quot;022 496-4339&quot; runat=&quot;server&quot;&gt;<o:p></o:p></p>

<p class=Cprg>Address: &lt;input type=&quot;text&quot; id=&quot;address&quot;
value=&quot;B13 Everest Tardeo&quot; runat=&quot;server&quot;&gt;<o:p></o:p></p>

<p class=Cprg>City: &lt;input type=&quot;text&quot; id=&quot;city&quot;
value=&quot;Bombay&quot; runat=&quot;server&quot;&gt;<o:p></o:p></p>

<p class=Cprg>State: <o:p></o:p></p>

<p class=Cprg>&lt;select id=&quot;state&quot; runat=&quot;server&quot;&gt;<o:p></o:p></p>

<p class=Cprg>&lt;option&gt;CA&lt;/option&gt;<o:p></o:p></p>

<p class=Cprg>&lt;option&gt;IN&lt;/option&gt;<span style="mso-spacerun: yes"> 
</span><o:p></o:p></p>

<p class=Cprg>&lt;option&gt;KS&lt;/option&gt;<span style="mso-spacerun: yes"> 
</span><o:p></o:p></p>

<p class=Cprg>&lt;option&gt;MD&lt;/option&gt;<span style="mso-spacerun: yes"> 
</span><o:p></o:p></p>

<p class=Cprg>&lt;option&gt;MI&lt;/option&gt;<span style="mso-spacerun: yes"> 
</span><o:p></o:p></p>

<p class=Cprg>&lt;option&gt;OR&lt;/option&gt; <o:p></o:p></p>

<p class=Cprg>&lt;option&gt;TN&lt;/option&gt;<span style="mso-spacerun: yes"> 
</span><o:p></o:p></p>

<p class=Cprg>&lt;option&gt;UT&lt;/option&gt;<span style="mso-spacerun: yes"> 
</span><o:p></o:p></p>

<p class=Cprg>&lt;/select&gt;<o:p></o:p></p>

<p class=Cprg>Zip Code: &lt;input type=&quot;text&quot; id=&quot;zip&quot;
value=&quot;400036&quot; runat=&quot;server&quot;&gt;<o:p></o:p></p>

<p class=Cprg>Contract: <o:p></o:p></p>

<p class=Cprg>&lt;select id=&quot;contract&quot; runat=&quot;server&quot;&gt;<o:p></o:p></p>

<p class=Cprg>&lt;option value=&quot;0&quot;&gt;False&lt;/option&gt;<o:p></o:p></p>

<p class=Cprg>&lt;option value=&quot;1&quot;&gt;True&lt;/option&gt;<o:p></o:p></p>

<p class=Cprg>&lt;/select&gt;<o:p></o:p></p>

<p class=Cprg>&lt;input type=&quot;submit&quot; OnServerClick=&quot;abc&quot;
value=&quot;Add Author&quot; runat=&quot;server&quot;&gt;<o:p></o:p></p>

<p class=Cprg>&lt;span id=&quot;m&quot; runat=&quot;server&quot;/&gt;<o:p></o:p></p>

<p class=Cprg>&lt;/form&gt;<o:p></o:p></p>

<p class=Cprg>&lt;/body&gt;<o:p></o:p></p>

<p class=Cprg>&lt;/html&gt;<o:p></o:p></p>

<p class=Cprg><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=Coutput><u>Output</u><o:p></o:p></p>

<p class=Coutput><img width=436 height=219 id="_x0000_i1047"
src="chap5img/img19.bmp"><o:p></o:p></p>

<p class=Coutput><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=Cbase>This program may appear very long, but when you work on real
life applications, you will be expected to write a code that looks like the
above program. This program adds one record to the authors table and also does
some error checking. <o:p></o:p></p>

<p class=Cbase><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=Cbase>In Page_Load, we create an SqlConnection object called 'c'. If
required, the function bbb is called. This function is solely responsible for
displaying data from the relevant table. Hence, it is constantly called by the
other functions in the code. In the function bbb, we first create an SQL select
statement to display all the records from the <span style='font-family:"Book Antiqua"'>authors</span>
table. Subsequently, a DataSet object is created, which is finally added to the
DataGrid. This constantly refreshes the DataGrid Control with data from the
authors table.<o:p></o:p></p>

<p class=Cbase><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=Cbase>The function abc is called when you click on the button labeled
'Add Record'. Here, the 'if' condtion checks for empty values in the following
text fields:<o:p></o:p></p>

<p class=Cbase><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=Cbullets><span style='mso-bidi-font-size:12.0pt;font-family:"Times New Roman"'>•<span
style='mso-tab-count:1'>     </span></span>au_id<o:p></o:p></p>

<p class=Cbullets><span style='mso-bidi-font-size:12.0pt;font-family:"Times New Roman"'>•<span
style='mso-tab-count:1'>     </span></span>au_fname<o:p></o:p></p>

<p class=Cbullets><span style='mso-bidi-font-size:12.0pt;font-family:"Times New Roman"'>•<span
style='mso-tab-count:1'>     </span></span>au_lname<o:p></o:p></p>

<p class=Cbullets><span style='mso-bidi-font-size:12.0pt;font-family:"Times New Roman"'>•<span
style='mso-tab-count:1'>     </span></span>phone number <o:p></o:p></p>

<p class=Cbase><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=Cbase>If any one of these is null or blank, the function bbb is called
to redisplay the values. The 'return' keyword ensures that the rest of the code
in the function abc does not get executed. <o:p></o:p></p>

<p class=Cbase><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=Cbase>Therefore, if any one of the above four fields is blank, no
record is added. This is because the function terminates with the return
statement. The main rationale behind this mechanism is that we do not want our
database to contain a record with blank values. <o:p></o:p></p>

<p class=Cbase><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=Cbase>The || sign introduces flexibility into the 'if' statement. Therefore,
whenever any of the conditions results in a true, i.e. if any of the fields is
blank, the statements in the block are executed. Without the || operator, we
would have been compelled to repeat the above code four times in the 'if'
statement. The resultant error message is displayed in red, using the Label
control 'm'.<o:p></o:p></p>

<p class=Cbase><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=Cbase>If we do not encounter any errors, a record gets added to our
database. Firstly, a string is created with the placeholders for the data. The
method that has been applied to one parameter in the earlier program, is
applied to all the parameters. Finally, the Insert statement is executed. The
function ExecuteNonQuery is placed in a try-catch block, since an error is
likely to occur at runtime while accessing the database. <o:p></o:p></p>

<p class=Cbase><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=Coutput><u>Output<o:p></o:p></u></p>

<p class=Coutput><u><img width=426 height=47 id="_x0000_i1048"
src="chap5img/img20.bmp"><o:p></o:p></u></p>

<p class=Coutput><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=Coutput>insert into Authors values (@Id, @LName, @FName, @Phone,
@Address, @City, @State, @Zip, @Contract)<o:p></o:p></p>

<p class=Cbase><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=Cbase>What is a runtime error ?<o:p></o:p></p>

<p class=Cbase><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=Cbase>Every database must hold atleast one field containing unique
values for all the records. This is essential to be able to uniquely identify
every record in a database. This field is called a Primary field. In the
authors table, the primary field is the au_id field. If we try and add a
record, where the value of au_id is the same as one of the existing values of
another record, an exception will be thrown. <o:p></o:p></p>

<p class=Cbase><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=Cbase>The exception that will be thrown is of type SqlException. This
exception is caused by the member Number. For e.g. if the value of Number is
2627, then it is a duplicate Primary Key error. The relevant error message is
displayed and then the connection is closed. When SQLServer has a problem in
handling the data provided to it, a runtime error is thrown.<o:p></o:p></p>

<p class=Cbase><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=Cbase>The rest of the code is simply a series of textboxes, whose
values are used to create the SQL insert statement. <o:p></o:p></p>

<p class=Cbase><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=Cbase>You should first add a valid record into the table and see it
appear in the DataGrid instantly. Then you should add another record, leaving
some of the fields blank. You will notice that the error appears in red. Now,
add a record with a duplicate Primary key, i.e. a record where the field au_id
contains a value present in another record. This is how error checks are built
into our application. <o:p></o:p></p>

<p class=Cbase>Let us now proceed further.<o:p></o:p></p>

<p class=Cbase><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=Cprg><u>a.aspx</u><o:p></o:p></p>

<p class=Cprg>&lt;%@ Import Namespace=&quot;System.Data&quot; %&gt;<o:p></o:p></p>

<p class=Cprg>&lt;%@ Import Namespace=&quot;System.Data.SqlClient&quot; %&gt;<o:p></o:p></p>

<p class=Cprg>&lt;html&gt;<o:p></o:p></p>

<p class=Cprg>&lt;script language=&quot;C#&quot; runat=&quot;server&quot;&gt;<o:p></o:p></p>

<p class=Cprg>SqlConnection c;<o:p></o:p></p>

<p class=Cprg>void Page_Load(Object Src, EventArgs E) <o:p></o:p></p>

<p class=Cprg>{<o:p></o:p></p>

<p class=Cprg>c = new
SqlConnection(&quot;server=localhost;uid=sa;pwd=;database=pubs&quot;);<o:p></o:p></p>

<p class=Cprg>if (!IsPostBack)<o:p></o:p></p>

<p class=Cprg>bbb();<o:p></o:p></p>

<p class=Cprg>}<o:p></o:p></p>

<p class=Cprg>public void abc(Object sender, EventArgs E) <o:p></o:p></p>

<p class=Cprg>{<o:p></o:p></p>

<p class=Cprg>String s = &quot;insert into Authors values (@Id, @LName, @FName,
@Phone, @Address, @City, @State, @Zip, @Contract)&quot;;<o:p></o:p></p>

<p class=Cprg>SqlCommand co = new SqlCommand(s, c);<o:p></o:p></p>

<p class=Cprg>co.Parameters.Add(new SqlParameter(&quot;@Id&quot;,
SqlDbType.VarChar, 11));<o:p></o:p></p>

<p class=Cprg>co.Parameters[&quot;@Id&quot;].Value = au_id.Value;<o:p></o:p></p>

<p class=Cprg>co.Parameters.Add(new SqlParameter(&quot;@LName&quot;,
SqlDbType.VarChar, 40));<o:p></o:p></p>

<p class=Cprg>co.Parameters[&quot;@LName&quot;].Value = au_lname.Value;<o:p></o:p></p>

<p class=Cprg>co.Parameters.Add(new SqlParameter(&quot;@FName&quot;,
SqlDbType.VarChar, 20));<o:p></o:p></p>

<p class=Cprg>co.Parameters[&quot;@FName&quot;].Value = au_fname.Value;<o:p></o:p></p>

<p class=Cprg>co.Parameters.Add(new SqlParameter(&quot;@Phone&quot;,
SqlDbType.Char, 12));<o:p></o:p></p>

<p class=Cprg>co.Parameters[&quot;@Phone&quot;].Value = phone.Value;<o:p></o:p></p>

<p class=Cprg>co.Parameters.Add(new SqlParameter(&quot;@Address&quot;,
SqlDbType.VarChar, 40));<o:p></o:p></p>

<p class=Cprg>co.Parameters[&quot;@Address&quot;].Value = address.Value;<o:p></o:p></p>

<p class=Cprg>co.Parameters.Add(new SqlParameter(&quot;@City&quot;,
SqlDbType.VarChar, 20));<o:p></o:p></p>

<p class=Cprg>co.Parameters[&quot;@City&quot;].Value = city.Value;<o:p></o:p></p>

<p class=Cprg>co.Parameters.Add(new SqlParameter(&quot;@State&quot;,
SqlDbType.Char, 2));<o:p></o:p></p>

<p class=Cprg>co.Parameters[&quot;@State&quot;].Value = state.Value;<o:p></o:p></p>

<p class=Cprg>co.Parameters.Add(new SqlParameter(&quot;@Zip&quot;,
SqlDbType.Char, 5));<o:p></o:p></p>

<p class=Cprg>co.Parameters[&quot;@Zip&quot;].Value = zip.Value;<o:p></o:p></p>

<p class=Cprg>co.Parameters.Add(new SqlParameter(&quot;@Contract&quot;,
SqlDbType.VarChar,1));<o:p></o:p></p>

<p class=Cprg>co.Parameters[&quot;@Contract&quot;].Value = contract.Value;<o:p></o:p></p>

<p class=Cprg>c.Open();<o:p></o:p></p>

<p class=Cprg>try <o:p></o:p></p>

<p class=Cprg>{<o:p></o:p></p>

<p class=Cprg>co.ExecuteNonQuery();<o:p></o:p></p>

<p class=Cprg>m.InnerHtml = &quot;&lt;b&gt;Record
Added&lt;/b&gt;&lt;br&gt;&quot; + s.ToString();<o:p></o:p></p>

<p class=Cprg>}<o:p></o:p></p>

<p class=Cprg>catch (SqlException e)<o:p></o:p></p>

<p class=Cprg>{<o:p></o:p></p>

<p class=Cprg>if (e.Number == 2627)<o:p></o:p></p>

<p class=Cprg>m.InnerHtml = &quot;ERROR: A record already exists with the same
primary key&quot;;<o:p></o:p></p>

<p class=Cprg>else<o:p></o:p></p>

<p class=Cprg>m.InnerHtml = &quot;ERROR: Could not add record, please ensure
the fields are correctly filled out&quot;;<o:p></o:p></p>

<p class=Cprg>m.Style[&quot;color&quot;] = &quot;red&quot;;<o:p></o:p></p>

<p class=Cprg>}<o:p></o:p></p>

<p class=Cprg>co.Connection.Close();<o:p></o:p></p>

<p class=Cprg>bbb();<o:p></o:p></p>

<p class=Cprg>}<o:p></o:p></p>

<p class=Cprg>public void bbb() <o:p></o:p></p>

<p class=Cprg>{<o:p></o:p></p>

<p class=Cprg>SqlDataAdapter co = new SqlDataAdapter(&quot;select * from
Authors&quot;, c);<o:p></o:p></p>

<p class=Cprg>DataSet ds = new DataSet();<o:p></o:p></p>

<p class=Cprg>co.Fill(ds, &quot;Authors&quot;);<o:p></o:p></p>

<p class=Cprg>l.DataSource=ds.Tables[&quot;Authors&quot;].DefaultView;<o:p></o:p></p>

<p class=Cprg>l.DataBind();<o:p></o:p></p>

<p class=Cprg>}<o:p></o:p></p>

<p class=Cprg>&lt;/script&gt;<o:p></o:p></p>

<p class=Cprg>&lt;body &gt;<o:p></o:p></p>

<p class=Cprg>&lt;form runat=&quot;server&quot;&gt;<o:p></o:p></p>

<p class=Cprg>&lt;ASP:DataGrid id=&quot;l&quot; runat=&quot;server&quot;
MaintainState=&quot;false&quot;/&gt;<o:p></o:p></p>

<p class=Cprg>Author ID: &lt;input type=&quot;text&quot; id=&quot;au_id&quot;
value=&quot;000-00-0000&quot; runat=&quot;server&quot;&gt;<o:p></o:p></p>

<p class=Cprg>&lt;asp:RequiredFieldValidator id=&quot;au_idReqVal&quot;
ControlToValidate=&quot;au_id&quot; runat=server&gt;<o:p></o:p></p>

<p class=Cprg>*<o:p></o:p></p>

<p class=Cprg>&lt;/asp:RequiredFieldValidator&gt;<o:p></o:p></p>

<p class=Cprg>Last Name: &lt;input type=&quot;text&quot;
id=&quot;au_lname&quot; value=&quot;Mukhi&quot; runat=&quot;server&quot;&gt;<o:p></o:p></p>

<p class=Cprg>&lt;asp:RequiredFieldValidator id=&quot;au_lnameReqVal&quot;
ControlToValidate=&quot;au_lname&quot; runat=server&gt;<o:p></o:p></p>

<p class=Cprg>*<o:p></o:p></p>

<p class=Cprg>&lt;/asp:RequiredFieldValidator&gt;<o:p></o:p></p>

<p class=Cprg>First Name: &lt;input type=&quot;text&quot; id=&quot;au_fname&quot;
value=&quot;Vijay&quot; runat=&quot;server&quot;&gt;<o:p></o:p></p>

<p class=Cprg>&lt;asp:RequiredFieldValidator id=&quot;au_fnameReqVal&quot;
ControlToValidate=&quot;au_fname&quot; runat=server&gt;<o:p></o:p></p>

<p class=Cprg>*<o:p></o:p></p>

<p class=Cprg>&lt;/asp:RequiredFieldValidator&gt;<o:p></o:p></p>

<p class=Cprg>Phone: &lt;input type=&quot;text&quot; id=&quot;phone&quot;
value=&quot;022 496-4339&quot; runat=&quot;server&quot;&gt;<o:p></o:p></p>

<p class=Cprg>&lt;asp:RequiredFieldValidator id=&quot;phoneReqVal&quot;
ControlToValidate=&quot;phone&quot; runat=server&gt;<o:p></o:p></p>

<p class=Cprg>*<o:p></o:p></p>

<p class=Cprg>&lt;/asp:RequiredFieldValidator&gt;<o:p></o:p></p>

<p class=Cprg>Address: &lt;input type=&quot;text&quot; id=&quot;address&quot;
value=&quot;B13 Everest Tardeo&quot; runat=&quot;server&quot;&gt;<o:p></o:p></p>

<p class=Cprg>City: &lt;input type=&quot;text&quot; id=&quot;city&quot;
value=&quot;Bombay&quot; runat=&quot;server&quot;&gt;<o:p></o:p></p>

<p class=Cprg>State: <o:p></o:p></p>

<p class=Cprg>&lt;select id=&quot;state&quot; runat=&quot;server&quot;&gt;<o:p></o:p></p>

<p class=Cprg>&lt;option&gt;CA&lt;/option&gt;<o:p></o:p></p>

<p class=Cprg>&lt;option&gt;IN&lt;/option&gt;<span style="mso-spacerun: yes"> 
</span><o:p></o:p></p>

<p class=Cprg>&lt;option&gt;KS&lt;/option&gt;<span style="mso-spacerun: yes"> 
</span><o:p></o:p></p>

<p class=Cprg>&lt;option&gt;MD&lt;/option&gt;<span style="mso-spacerun: yes"> 
</span><o:p></o:p></p>

<p class=Cprg>&lt;option&gt;MI&lt;/option&gt;<span style="mso-spacerun: yes"> 
</span><o:p></o:p></p>

<p class=Cprg>&lt;option&gt;OR&lt;/option&gt; <o:p></o:p></p>

<p class=Cprg>&lt;option&gt;TN&lt;/option&gt;<span style="mso-spacerun: yes"> 
</span><o:p></o:p></p>

<p class=Cprg>&lt;option&gt;UT&lt;/option&gt;<span style="mso-spacerun: yes"> 
</span><o:p></o:p></p>

<p class=Cprg>&lt;/select&gt;<o:p></o:p></p>

<p class=Cprg>Zip Code: &lt;input type=&quot;text&quot; id=&quot;zip&quot;
value=&quot;400036&quot; runat=&quot;server&quot;&gt;<o:p></o:p></p>

<p class=Cprg>&lt;asp:RegularExpressionValidator
id=&quot;RegularExpressionValidator1&quot;
ASPClass=&quot;RegularExpressionValidator&quot; <o:p></o:p></p>

<p class=Cprg>ControlToValidate=&quot;zip&quot;
ValidationExpression=&quot;[0-9]{5}&quot; runat=server&gt;<o:p></o:p></p>

<p class=Cprg>* Zip Code must be 5 numeric digits &lt;br&gt;<o:p></o:p></p>

<p class=Cprg>&lt;/asp:RegularExpressionValidator&gt;<o:p></o:p></p>

<p class=Cprg>Contract: <o:p></o:p></p>

<p class=Cprg>&lt;select id=&quot;contract&quot; runat=&quot;server&quot;&gt;<o:p></o:p></p>

<p class=Cprg>&lt;option value=&quot;0&quot;&gt;False&lt;/option&gt;<o:p></o:p></p>

<p class=Cprg>&lt;option value=&quot;1&quot;&gt;True&lt;/option&gt;<o:p></o:p></p>

<p class=Cprg>&lt;/select&gt;<o:p></o:p></p>

<p class=Cprg>&lt;input type=&quot;submit&quot; OnServerClick=&quot;abc&quot;
value=&quot;Add Author&quot; runat=&quot;server&quot;&gt;<o:p></o:p></p>

<p class=Cprg>&lt;span id=&quot;m&quot; runat=&quot;server&quot;/&gt;<o:p></o:p></p>

<p class=Cprg>&lt;asp:RegularExpressionValidator id=&quot;phoneRegexVal&quot;
ControlToValidate=&quot;phone&quot;<o:p></o:p></p>

<p class=Cprg><span style="mso-spacerun:
yes"> </span>ValidationExpression=&quot;[0-9]{3} [0-9]{3}-[0-9]{4}&quot;
runat=server&gt;<o:p></o:p></p>

<p class=Cprg>* Phone must be in form: XXX XXX-XXXX &lt;br&gt;<o:p></o:p></p>

<p class=Cprg>&lt;/asp:RegularExpressionValidator&gt;<o:p></o:p></p>

<p class=Cprg>&lt;asp:RegularExpressionValidator id=&quot;au_idRegexVal&quot;
ControlToValidate=&quot;au_id&quot;<o:p></o:p></p>

<p class=Cprg><span style="mso-spacerun:
yes"> </span>ValidationExpression=&quot;[0-9]{3}-[0-9]{2}-[0-9]{4}&quot;
Font-Name=&quot;Arial&quot; Font-Size=&quot;11&quot; runat=server&gt;<o:p></o:p></p>

<p class=Cprg>* Author ID must be digits: XXX-XX-XXXX &lt;br&gt;<o:p></o:p></p>

<p class=Cprg>&lt;/asp:RegularExpressionValidator&gt;<o:p></o:p></p>

<p class=Cprg>&lt;/form&gt;<o:p></o:p></p>

<p class=Cprg>&lt;/body&gt;<o:p></o:p></p>

<p class=Cprg>&lt;/html&gt;<o:p></o:p></p>

<p class=Cbase><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=Cbase>This example is enormous in size, and it includes some
exceptionally sophisticated error checks. It basically amalgamates all that we
have learnt so far. All the code, up to the closing tag of script
&lt;/script&gt;, remains unchanged. <o:p></o:p></p>

<p class=Cbase><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=Cbase>In the function abc, we have removed the 'if' statement that
carries out checks for fields which contain a null value, or which are blank.
Instead, we have used the validators that we had learnt in one of the earlier
chapters. Therefore, let us discern each error check, one at a time. <o:p></o:p></p>

<p class=Cbase><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=Cbase>The Primary Key au_id cannot be left blank, hence, the
RequiredFieldValidator is used for this field. Since au_lname, au_fname, phone,
city fields too cannot be blank, the same Validator is used for these fields as
well.<o:p></o:p></p>

<p class=Cbase><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=Cbase>In USA, a zip code is 5 digits long and comprises of numbers
only. For this reason, we use [0-9], which signifies that the input can be any
digit from 0 to 9. The syntax {5} signifies that there will be<span
style="mso-spacerun: yes">  </span>five digits that are to be matched in the
expression. <o:p></o:p></p>

<p class=Cbase><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=Cbase>The phone number must also comprise of numbers only. Here, we
want the first three numbers to be followed by a space, then by another two
numbers, followed by a - sign, and finally with four numbers at the end. For
example-<span style="mso-spacerun: yes">  </span>123 45-6789. <o:p></o:p></p>

<p class=Cbase><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=Cbase>We deliberately entered 6 digits for the zip code, so that we
could force an error when we clicked on the button. Thus, it is quite easy to
validate data in ASP+.</p>

<p class=Cbase><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=Coutput><u>Output</u><o:p></o:p></p>

<p class=Coutput><img width=422 height=120 id="_x0000_i1049"
src="chap5img/img21.bmp"><o:p></o:p></p>

<p class=Coutput><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=Cprg><u>a.aspx</u><o:p></o:p></p>

<p class=Cprg>&lt;%@ Import Namespace=&quot;System.Data&quot; %&gt;<o:p></o:p></p>

<p class=Cprg>&lt;%@ Import Namespace=&quot;System.Data.SqlClient&quot; %&gt;<o:p></o:p></p>

<p class=Cprg>&lt;html&gt;<o:p></o:p></p>

<p class=Cprg>&lt;script language=&quot;C#&quot; runat=&quot;server&quot;&gt;<o:p></o:p></p>

<p class=Cprg>SqlConnection c;<o:p></o:p></p>

<p class=Cprg>void Page_Load(Object Src, EventArgs E) <o:p></o:p></p>

<p class=Cprg>{<o:p></o:p></p>

<p class=Cprg>c = new
SqlConnection(&quot;server=localhost;uid=sa;pwd=;database=pubs&quot;);<o:p></o:p></p>

<p class=Cprg>if (!IsPostBack)<o:p></o:p></p>

<p class=Cprg>bbb();<o:p></o:p></p>

<p class=Cprg>}<o:p></o:p></p>

<p class=Cprg>public void Edit(Object sender, DataGridCommandEventArgs E)<o:p></o:p></p>

<p class=Cprg>{<o:p></o:p></p>

<p class=Cprg>l.EditItemIndex = (int)E.Item.ItemIndex;<o:p></o:p></p>

<p class=Cprg>bbb();<o:p></o:p></p>

<p class=Cprg>}<o:p></o:p></p>

<p class=Cprg>public void Cancel(Object sender, DataGridCommandEventArgs E)<o:p></o:p></p>

<p class=Cprg>{<o:p></o:p></p>

<p class=Cprg>l.EditItemIndex = -1;<o:p></o:p></p>

<p class=Cprg>bbb();<o:p></o:p></p>

<p class=Cprg>}<o:p></o:p></p>

<p class=Cprg>public void Update(Object sender, DataGridCommandEventArgs E)<o:p></o:p></p>

<p class=Cprg>{<o:p></o:p></p>

<p class=Cprg>String u = &quot;UPDATE Authors SET au_id = @Id, au_lname =
@LName, au_fname = @FName, phone = @Phone, &quot;<o:p></o:p></p>

<p class=Cprg><span style="mso-spacerun: yes">             </span>+
&quot;address = @Address, city = @City, state = @State, zip = @Zip, contract =
@Contract where au_id = @Id&quot;;<o:p></o:p></p>

<p class=Cprg>SqlCommand co = new SqlCommand(u, c);<o:p></o:p></p>

<p class=Cprg>co.Parameters.Add(new SqlParameter(&quot;@Id&quot;,
SqlDbType.VarChar, 11));<o:p></o:p></p>

<p class=Cprg>co.Parameters.Add(new SqlParameter(&quot;@LName&quot;,
SqlDbType.VarChar, 40));<o:p></o:p></p>

<p class=Cprg>co.Parameters.Add(new SqlParameter(&quot;@FName&quot;,
SqlDbType.VarChar, 20));<o:p></o:p></p>

<p class=Cprg>co.Parameters.Add(new SqlParameter(&quot;@Phone&quot;, SqlDbType.Char,
12));<o:p></o:p></p>

<p class=Cprg>co.Parameters.Add(new SqlParameter(&quot;@Address&quot;,
SqlDbType.VarChar, 40));<o:p></o:p></p>

<p class=Cprg>co.Parameters.Add(new SqlParameter(&quot;@City&quot;,
SqlDbType.VarChar, 20));<o:p></o:p></p>

<p class=Cprg>co.Parameters.Add(new SqlParameter(&quot;@State&quot;,
SqlDbType.Char, 2));<o:p></o:p></p>

<p class=Cprg>co.Parameters.Add(new SqlParameter(&quot;@Zip&quot;,
SqlDbType.Char, 5));<o:p></o:p></p>

<p class=Cprg>co.Parameters.Add(new SqlParameter(&quot;@Contract&quot;,
SqlDbType.VarChar,1));<o:p></o:p></p>

<p class=Cprg>Response.Write(l.DataKeys[(int)E.Item.ItemIndex].ToString());<o:p></o:p></p>

<p class=Cprg>co.Parameters[&quot;@Id&quot;].Value =
l.DataKeys[(int)E.Item.ItemIndex];<o:p></o:p></p>

<p class=Cprg>co.Parameters[&quot;@LNAME&quot;].Value =
((TextBox)E.Item.Cells[2].Controls[0]).Text;<o:p></o:p></p>

<p class=Cprg>co.Parameters[&quot;@FNAME&quot;].Value =
((TextBox)E.Item.Cells[3].Controls[0]).Text;<o:p></o:p></p>

<p class=Cprg>co.Parameters[&quot;@PHONE&quot;].Value =
((TextBox)E.Item.Cells[4].Controls[0]).Text;<o:p></o:p></p>

<p class=Cprg>co.Parameters[&quot;@Address&quot;].Value = ((TextBox)E.Item.Cells[5].Controls[0]).Text;<o:p></o:p></p>

<p class=Cprg>co.Parameters[&quot;@City&quot;].Value =
((TextBox)E.Item.Cells[6].Controls[0]).Text;<o:p></o:p></p>

<p class=Cprg>co.Parameters[&quot;@State&quot;].Value =
((TextBox)E.Item.Cells[7].Controls[0]).Text;<o:p></o:p></p>

<p class=Cprg>co.Parameters[&quot;@Zip&quot;].Value =
((TextBox)E.Item.Cells[8].Controls[0]).Text;<o:p></o:p></p>

<p class=Cprg>if (String.Compare(((TextBox)E.Item.Cells[9].Controls[0]).Text,
&quot;true&quot;, true)==0)<o:p></o:p></p>

<p class=Cprg>co.Parameters[&quot;@Contract&quot;].Value =<span
style="mso-spacerun: yes">  </span>&quot;1&quot;; <o:p></o:p></p>

<p class=Cprg>else<o:p></o:p></p>

<p class=Cprg>co.Parameters[&quot;@Contract&quot;].Value =<span
style="mso-spacerun: yes">  </span>&quot;0&quot;; <o:p></o:p></p>

<p class=Cprg>c.Open();<o:p></o:p></p>

<p class=Cprg>try <o:p></o:p></p>

<p class=Cprg>{<o:p></o:p></p>

<p class=Cprg>co.ExecuteNonQuery();<o:p></o:p></p>

<p class=Cprg>m.InnerHtml = &quot;&lt;b&gt;Record
Updated&lt;/b&gt;&lt;br&gt;&quot; + u;<o:p></o:p></p>

<p class=Cprg>l.EditItemIndex = -1;<o:p></o:p></p>

<p class=Cprg>}<o:p></o:p></p>

<p class=Cprg>catch (SqlException e)<o:p></o:p></p>

<p class=Cprg>{<o:p></o:p></p>

<p class=Cprg>if (e.Number == 2627)<o:p></o:p></p>

<p class=Cprg>m.InnerHtml = &quot;ERROR: A record already exists with the same
primary key&quot;;<o:p></o:p></p>

<p class=Cprg>else<o:p></o:p></p>

<p class=Cprg>m.InnerHtml = &quot;ERROR: Could not update record, please ensure
the fields are correctly filled out&quot;;<o:p></o:p></p>

<p class=Cprg>m.Style[&quot;color&quot;] = &quot;red&quot;;<o:p></o:p></p>

<p class=Cprg>}<o:p></o:p></p>

<p class=Cprg>c.Close();<o:p></o:p></p>

<p class=Cprg>bbb();<o:p></o:p></p>

<p class=Cprg>}<o:p></o:p></p>

<p class=Cprg>public void bbb() <o:p></o:p></p>

<p class=Cprg>{<o:p></o:p></p>

<p class=Cprg>SqlDataAdapter co = new SqlDataAdapter(&quot;select * from
Authors&quot;, c);<o:p></o:p></p>

<p class=Cprg>DataSet ds = new DataSet();<o:p></o:p></p>

<p class=Cprg>co.Fill(ds, &quot;Authors&quot;);<o:p></o:p></p>

<p class=Cprg>l.DataSource=ds.Tables[&quot;Authors&quot;].DefaultView;<o:p></o:p></p>

<p class=Cprg>l.DataBind();<o:p></o:p></p>

<p class=Cprg>}<o:p></o:p></p>

<p class=Cprg>&lt;/script&gt;<o:p></o:p></p>

<p class=Cprg>&lt;body &gt;<o:p></o:p></p>

<p class=Cprg>&lt;form runat=&quot;server&quot;&gt;<o:p></o:p></p>

<p class=Cprg>&lt;span id=&quot;m&quot; runat=&quot;server&quot;/&gt;&lt;p&gt;<o:p></o:p></p>

<p class=Cprg>&lt;ASP:DataGrid id=&quot;l&quot; runat=&quot;server&quot;
OnEditCommand=&quot;Edit&quot; OnCancelCommand=&quot;Cancel&quot;
OnUpdateCommand=&quot;Update&quot; DataKeyField=&quot;au_id&quot;&gt;<o:p></o:p></p>

<p class=Cprg>&lt;columns&gt;<o:p></o:p></p>

<p class=Cprg>&lt;asp:EditCommandColumn EditText=&quot;Edit1&quot;
CancelText=&quot;Cancel1&quot; UpdateText=&quot;Update1&quot;
ItemStyle-Wrap=&quot;false&quot;/&gt;<o:p></o:p></p>

<p class=Cprg>&lt;/columns&gt;<o:p></o:p></p>

<p class=Cprg>&lt;/ASP:DataGrid&gt;<o:p></o:p></p>

<p class=Cprg>&lt;/form&gt;<o:p></o:p></p>

<p class=Cprg>&lt;/body&gt;<o:p></o:p></p>

<p class=Cprg>&lt;/html&gt;<o:p></o:p></p>

<p class=Coutput><u><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></u></p>

<p class=Coutput><u>Output</u><o:p></o:p></p>

<p class=Coutput><img width=427 height=77 id="_x0000_i1050"
src="chap5img/img22.bmp"><o:p></o:p></p>

<p class=Cbase><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=Cbase>The above example shows us the same DataGrid control, but the
word Edit1 is displayed in the first column. We had shown you one example
earlier, which contained an Edit link. The same concept is applied to the data
that is retrieved from a database. <o:p></o:p></p>

<p class=Cbase><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=Cbase>Updating data in a database is no mean task.<span
style="mso-spacerun: yes">  </span>The head honchos at Microsoft were aware about
how tricky and important a database update could be. Hence, they made sure that
the DataGrid Control had in-built support for updating a database. Some of the
explanation given below is a repetition of what we had discussed earlier. <o:p></o:p></p>

<p class=Cbase><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=Cbase>A DataGrid supports a property called EditItemIndex. If the
value of this property is 10, then the DataGrid control lets the user edit
record number 10 of the database. Thus, instead of seeing simple text labels,
the user can actually change the data in the textboxes that are displayed. The
default value of<span style="mso-spacerun: yes">  </span>-1, prevents any
record from being edited.<o:p></o:p></p>

<p class=Cbase><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=Cbase>When the user clicks on Edit1, which is the text displayed in
the first column, a function called Edit is invoked, since the DataGrid's
OnEditCommand property is set to this function name. Similarly, the Update and
Cancel functions get called when their respective labels are clicked. <o:p></o:p></p>

<p class=Cbase><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=Cbase>When we click on Edit1, the ItemIndex member reveals the record
number of that record. So, we set the property EditItemIndex to this ItemIndex
value, as we want the user to edit the current record.<span
style="mso-spacerun: yes">  </span>When the user clicks on Cancel1, it means
that any changes that have been made, are to be undone. To execute this, we
give EditItemIndex a value of -1.<o:p></o:p></p>

<p class=Cbase><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=Cbase>Thus, Update is the most important option, since it has to
update the data in the database with the newly entered data. Hence, the
function Update is called.<o:p></o:p></p>

<p class=Cbase><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=Cbase>First, we create a string 'u' that contains the SQL Update
statement. In place of field values, the placeholders are inserted. Since the
primary key is most crucial in an update operation, we have a 'where clause'
with the primary key au_id initialized to the placeholder @id. The programmers
at Microsoft have allowed us access to the primary key. Thus, they have
provided us a member called DataKeys in the DataGrid. This member, when
supplied with the record number, returns the primary key of that record. We are
displaying this value using the Write function. You should be aware that the
primary key can be composite i.e. it can be made up of more than one field.<o:p></o:p></p>

<p class=Cbase><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=Cbase>We now need to initialize all the placeholders to their values.
Earlier, it was easy, since we had simple textboxes. To enable entering of a
value in the 'last name' field, we use E.Item.Cells[2].Controls[0].Text. This
field could be the first field in the database, but we need an offset of 2,
since we have one extra column named Cancel1, that is to be accounted for. The
rest of the code is the same as before.<o:p></o:p></p>

<p class=Cbase><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=Cbase>The last column shows a True or a False, but the value displayed
is either 1 or 0, respectively. So, we use an 'if' statement to check the value
contained in it. <o:p></o:p></p>

<p class=Cbase><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=Cprg><u>a.aspx</u><o:p></o:p></p>

<p class=Cprg>&lt;%@ Import Namespace=&quot;System.Data&quot; %&gt;<o:p></o:p></p>

<p class=Cprg>&lt;%@ Import Namespace=&quot;System.Data.SqlClient&quot; %&gt;<o:p></o:p></p>

<p class=Cprg>&lt;html&gt;<o:p></o:p></p>

<p class=Cprg>&lt;script language=&quot;C#&quot; runat=&quot;server&quot;&gt;<o:p></o:p></p>

<p class=Cprg>SqlConnection c;<o:p></o:p></p>

<p class=Cprg>void Page_Load(Object Src, EventArgs E) <o:p></o:p></p>

<p class=Cprg>{<o:p></o:p></p>

<p class=Cprg>c = new
SqlConnection(&quot;server=localhost;uid=sa;pwd=;database=pubs&quot;);<o:p></o:p></p>

<p class=Cprg>if (!IsPostBack)<o:p></o:p></p>

<p class=Cprg>bbb();<o:p></o:p></p>

<p class=Cprg>}<o:p></o:p></p>

<p class=Cprg>public void Edit(Object sender, DataGridCommandEventArgs E)<o:p></o:p></p>

<p class=Cprg>{<o:p></o:p></p>

<p class=Cprg>l.EditItemIndex = (int)E.Item.ItemIndex;<o:p></o:p></p>

<p class=Cprg>bbb();<o:p></o:p></p>

<p class=Cprg>}<o:p></o:p></p>

<p class=Cprg>public void Cancel(Object sender, DataGridCommandEventArgs E)<o:p></o:p></p>

<p class=Cprg>{<o:p></o:p></p>

<p class=Cprg>l.EditItemIndex = -1;<o:p></o:p></p>

<p class=Cprg>bbb();<o:p></o:p></p>

<p class=Cprg>}<o:p></o:p></p>

<p class=Cprg>public void Update(Object sender, DataGridCommandEventArgs E)<o:p></o:p></p>

<p class=Cprg>{<o:p></o:p></p>

<p class=Cprg>String u = &quot;UPDATE Authors SET au_id = @Id, au_lname =
@LName, au_fname = @FName, phone = @Phone, &quot;<o:p></o:p></p>

<p class=Cprg><span style="mso-spacerun: yes">             </span>+
&quot;address = @Address, city = @City, state = @State, zip = @Zip, contract =
@Contract where au_id = @Id&quot;;<o:p></o:p></p>

<p class=Cprg>SqlCommand co = new SqlCommand(u, c);<o:p></o:p></p>

<p class=Cprg>co.Parameters.Add(new SqlParameter(&quot;@Id&quot;,
SqlDbType.VarChar, 11));<o:p></o:p></p>

<p class=Cprg>co.Parameters.Add(new SqlParameter(&quot;@LName&quot;,
SqlDbType.VarChar, 40));<o:p></o:p></p>

<p class=Cprg>co.Parameters.Add(new SqlParameter(&quot;@FName&quot;,
SqlDbType.VarChar, 20));<o:p></o:p></p>

<p class=Cprg>co.Parameters.Add(new SqlParameter(&quot;@Phone&quot;,
SqlDbType.Char, 12));<o:p></o:p></p>

<p class=Cprg>co.Parameters.Add(new SqlParameter(&quot;@Address&quot;,
SqlDbType.VarChar, 40));<o:p></o:p></p>

<p class=Cprg>co.Parameters.Add(new SqlParameter(&quot;@City&quot;,
SqlDbType.VarChar, 20));<o:p></o:p></p>

<p class=Cprg>co.Parameters.Add(new SqlParameter(&quot;@State&quot;,
SqlDbType.Char, 2));<o:p></o:p></p>

<p class=Cprg>co.Parameters.Add(new SqlParameter(&quot;@Zip&quot;,
SqlDbType.Char, 5));<o:p></o:p></p>

<p class=Cprg>co.Parameters.Add(new SqlParameter(&quot;@Contract&quot;,
SqlDbType.VarChar,1));<o:p></o:p></p>

<p class=Cprg>Response.Write(l.DataKeys[(int)E.Item.ItemIndex].ToString());<o:p></o:p></p>

<p class=Cprg>co.Parameters[&quot;@Id&quot;].Value =
l.DataKeys[(int)E.Item.ItemIndex];<o:p></o:p></p>

<p class=Cprg>co.Parameters[&quot;@LNAME&quot;].Value =
((TextBox)E.Item.Cells[2].Controls[0]).Text;<o:p></o:p></p>

<p class=Cprg>co.Parameters[&quot;@FNAME&quot;].Value = ((TextBox)E.Item.Cells[3].Controls[0]).Text;<o:p></o:p></p>

<p class=Cprg>co.Parameters[&quot;@PHONE&quot;].Value =
((TextBox)E.Item.Cells[4].Controls[0]).Text;<o:p></o:p></p>

<p class=Cprg>co.Parameters[&quot;@Address&quot;].Value =
((TextBox)E.Item.Cells[5].Controls[0]).Text;<o:p></o:p></p>

<p class=Cprg>co.Parameters[&quot;@City&quot;].Value =
((TextBox)E.Item.Cells[6].Controls[0]).Text;<o:p></o:p></p>

<p class=Cprg>co.Parameters[&quot;@State&quot;].Value =
((TextBox)E.Item.Cells[7].Controls[0]).Text;<o:p></o:p></p>

<p class=Cprg>co.Parameters[&quot;@Zip&quot;].Value =
((TextBox)E.Item.Cells[8].Controls[0]).Text;<o:p></o:p></p>

<p class=Cprg>if (String.Compare(((TextBox)E.Item.Cells[9].Controls[0]).Text,
&quot;true&quot;, true)==0)<o:p></o:p></p>

<p class=Cprg>co.Parameters[&quot;@Contract&quot;].Value =<span
style="mso-spacerun: yes">  </span>&quot;1&quot;; <o:p></o:p></p>

<p class=Cprg>else<o:p></o:p></p>

<p class=Cprg>co.Parameters[&quot;@Contract&quot;].Value =<span
style="mso-spacerun: yes">  </span>&quot;0&quot;; <o:p></o:p></p>

<p class=Cprg>c.Open();<o:p></o:p></p>

<p class=Cprg>try <o:p></o:p></p>

<p class=Cprg>{<o:p></o:p></p>

<p class=Cprg>co.ExecuteNonQuery();<o:p></o:p></p>

<p class=Cprg>m.InnerHtml = &quot;&lt;b&gt;Record
Updated&lt;/b&gt;&lt;br&gt;&quot; + u;<o:p></o:p></p>

<p class=Cprg>l.EditItemIndex = -1;<o:p></o:p></p>

<p class=Cprg>}<o:p></o:p></p>

<p class=Cprg>catch (SqlException e)<o:p></o:p></p>

<p class=Cprg>{<o:p></o:p></p>

<p class=Cprg>if (e.Number == 2627)<o:p></o:p></p>

<p class=Cprg>m.InnerHtml = &quot;ERROR: A record already exists with the same
primary key&quot;;<o:p></o:p></p>

<p class=Cprg>else<o:p></o:p></p>

<p class=Cprg>m.InnerHtml = &quot;ERROR: Could not update record, please ensure
the fields are correctly filled out&quot;;<o:p></o:p></p>

<p class=Cprg>m.Style[&quot;color&quot;] = &quot;red&quot;;<o:p></o:p></p>

<p class=Cprg>}<o:p></o:p></p>

<p class=Cprg>c.Close();<o:p></o:p></p>

<p class=Cprg>bbb();<o:p></o:p></p>

<p class=Cprg>}<o:p></o:p></p>

<p class=Cprg>public void bbb() <o:p></o:p></p>

<p class=Cprg>{<o:p></o:p></p>

<p class=Cprg>SqlDataAdapter co = new SqlDataAdapter(&quot;select * from
Authors&quot;, c);<o:p></o:p></p>

<p class=Cprg>DataSet ds = new DataSet();<o:p></o:p></p>

<p class=Cprg>co.Fill(ds, &quot;Authors&quot;);<o:p></o:p></p>

<p class=Cprg>l.DataSource=ds.Tables[&quot;Authors&quot;].DefaultView;<o:p></o:p></p>

<p class=Cprg>l.DataBind();<o:p></o:p></p>

<p class=Cprg>}<o:p></o:p></p>

<p class=Cprg>&lt;/script&gt;<o:p></o:p></p>

<p class=Cprg>&lt;body &gt;<o:p></o:p></p>

<p class=Cprg>&lt;form runat=&quot;server&quot;&gt;<o:p></o:p></p>

<p class=Cprg>&lt;span id=&quot;m&quot; runat=&quot;server&quot;/&gt;&lt;p&gt;<o:p></o:p></p>

<p class=Cprg>&lt;ASP:DataGrid id=&quot;l&quot; runat=&quot;server&quot;
OnEditCommand=&quot;Edit&quot; OnCancelCommand=&quot;Cancel&quot;
OnUpdateCommand=&quot;Update&quot; DataKeyField=&quot;au_id&quot;
AutoGenerateColumns=&quot;false&quot;&gt;<o:p></o:p></p>

<p class=Cprg>&lt;columns&gt;<o:p></o:p></p>

<p class=Cprg>&lt;asp:EditCommandColumn EditText=&quot;Edit&quot;
CancelText=&quot;Cancel&quot; UpdateText=&quot;Update&quot;
ItemStyle-Wrap=&quot;false&quot;/&gt;<o:p></o:p></p>

<p class=Cprg>&lt;asp:BoundColumn HeaderText=&quot;au_id&quot;
SortExpression=&quot;au_id&quot; ReadOnly=&quot;True&quot;
DataField=&quot;au_id&quot; ItemStyle-Wrap=&quot;false&quot;/&gt;<o:p></o:p></p>

<p class=Cprg>&lt;asp:BoundColumn HeaderText=&quot;au_lname&quot;
SortExpression=&quot;au_lname&quot; DataField=&quot;au_lname&quot;/&gt;<o:p></o:p></p>

<p class=Cprg>&lt;asp:BoundColumn HeaderText=&quot;au_fname&quot;
SortExpression=&quot;au_fname&quot; DataField=&quot;au_fname&quot;/&gt;<o:p></o:p></p>

<p class=Cprg>&lt;asp:BoundColumn HeaderText=&quot;phone&quot;
SortExpression=&quot;phone&quot; DataField=&quot;phone&quot;/&gt;<o:p></o:p></p>

<p class=Cprg>&lt;asp:BoundColumn HeaderText=&quot;address&quot;
SortExpression=&quot;address&quot; DataField=&quot;address&quot;/&gt;<o:p></o:p></p>

<p class=Cprg>&lt;asp:BoundColumn HeaderText=&quot;city&quot;
SortExpression=&quot;city&quot; DataField=&quot;city&quot;/&gt;<o:p></o:p></p>

<p class=Cprg>&lt;asp:BoundColumn HeaderText=&quot;state&quot;
SortExpression=&quot;state&quot; DataField=&quot;state&quot;/&gt;<o:p></o:p></p>

<p class=Cprg>&lt;asp:BoundColumn HeaderText=&quot;zip&quot;
SortExpression=&quot;zip&quot; DataField=&quot;zip&quot;/&gt;<o:p></o:p></p>

<p class=Cprg>&lt;asp:BoundColumn HeaderText=&quot;contract&quot;
SortExpression=&quot;contract&quot; DataField=&quot;contract&quot;/&gt;<o:p></o:p></p>

<p class=Cprg>&lt;/columns&gt;<o:p></o:p></p>

<p class=Cprg>&lt;/ASP:DataGrid&gt;<o:p></o:p></p>

<p class=Cprg>&lt;/form&gt;<o:p></o:p></p>

<p class=Cprg>&lt;/body&gt;<o:p></o:p></p>

<p class=Cprg>&lt;/html&gt;<o:p></o:p></p>

<p class=Cbase><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=Cbase>The program remains the same up to the closing tag script. We
have repeated the program once again, since we wanted to provide you with
running programs and not just code fragments. <o:p></o:p></p>

<p class=Cbase><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=Cbase>The problem with the earlier Edit program was that we could
easily change the Author id field, but this change never got reflected in our
database. In the above program, we use BoundColumns to introduce our own
fields. Thus, all the fields are editable, except the au_id field, since the
ReadOnly attribute for this property is set to True. Further, the
AutoGenerateColumns attribute for the DataGridControl is set to False,
resulting in a display of only one set of columns, instead of two. The use of
BoundColumns thus, renders us with a lot more flexibility.<o:p></o:p></p>

<p class=Cbase><span style="mso-spacerun: yes"> </span><o:p></o:p></p>

<p class=Cbase>We have elucidated a similar example, earlier in the text.<o:p></o:p></p>

<p class=Cbase><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=Cprg><u>a.aspx</u><o:p></o:p></p>

<p class=Cprg>&lt;%@ Import Namespace=&quot;System.Data&quot; %&gt;<o:p></o:p></p>

<p class=Cprg>&lt;%@ Import Namespace=&quot;System.Data.SqlClient&quot; %&gt;<o:p></o:p></p>

<p class=Cprg>&lt;html&gt;<o:p></o:p></p>

<p class=Cprg>&lt;script language=&quot;C#&quot; runat=&quot;server&quot;&gt;<o:p></o:p></p>

<p class=Cprg>SqlConnection c;<o:p></o:p></p>

<p class=Cprg>void Page_Load(Object Src, EventArgs E) <o:p></o:p></p>

<p class=Cprg>{<o:p></o:p></p>

<p class=Cprg>c = new
SqlConnection(&quot;server=localhost;uid=sa;pwd=;database=pubs&quot;);<o:p></o:p></p>

<p class=Cprg>if (!IsPostBack)<o:p></o:p></p>

<p class=Cprg>bbb();<o:p></o:p></p>

<p class=Cprg>}<o:p></o:p></p>

<p class=Cprg>public void Delete(Object sender, DataGridCommandEventArgs E)<o:p></o:p></p>

<p class=Cprg>{<o:p></o:p></p>

<p class=Cprg>String d = &quot;DELETE from Authors where au_id = @Id&quot;;<o:p></o:p></p>

<p class=Cprg>SqlCommand co= new SqlCommand(d, c);<o:p></o:p></p>

<p class=Cprg>co.Parameters.Add(new SqlParameter(&quot;@Id&quot;,
SqlDbType.VarChar, 11));<o:p></o:p></p>

<p class=Cprg>co.Parameters[&quot;@Id&quot;].Value =
l.DataKeys[(int)E.Item.ItemIndex];<o:p></o:p></p>

<p class=Cprg>c.Open();<o:p></o:p></p>

<p class=Cprg>try <o:p></o:p></p>

<p class=Cprg>{<o:p></o:p></p>

<p class=Cprg>co.ExecuteNonQuery();<o:p></o:p></p>

<p class=Cprg>m.InnerHtml = &quot;&lt;b&gt;Record
Deleted&lt;/b&gt;&lt;br&gt;&quot; + d;<o:p></o:p></p>

<p class=Cprg>}<o:p></o:p></p>

<p class=Cprg>catch (SqlException) <o:p></o:p></p>

<p class=Cprg>{<o:p></o:p></p>

<p class=Cprg>m.InnerHtml = &quot;ERROR: Could not delete record&quot;;<o:p></o:p></p>

<p class=Cprg>m.Style[&quot;color&quot;] = &quot;red&quot;;<o:p></o:p></p>

<p class=Cprg>}<o:p></o:p></p>

<p class=Cprg>c.Close();<o:p></o:p></p>

<p class=Cprg>bbb();<o:p></o:p></p>

<p class=Cprg>}<o:p></o:p></p>

<p class=Cprg>public void bbb() <o:p></o:p></p>

<p class=Cprg>{<o:p></o:p></p>

<p class=Cprg>SqlDataAdapter co = new SqlDataAdapter(&quot;select * from
Authors&quot;, c);<o:p></o:p></p>

<p class=Cprg>DataSet ds = new DataSet();<o:p></o:p></p>

<p class=Cprg>co.Fill(ds, &quot;Authors&quot;);<o:p></o:p></p>

<p class=Cprg>l.DataSource=ds.Tables[&quot;Authors&quot;].DefaultView;<o:p></o:p></p>

<p class=Cprg>l.DataBind();<o:p></o:p></p>

<p class=Cprg>}<o:p></o:p></p>

<p class=Cprg>&lt;/script&gt;<o:p></o:p></p>

<p class=Cprg>&lt;body &gt;<o:p></o:p></p>

<p class=Cprg>&lt;form runat=&quot;server&quot;&gt;<o:p></o:p></p>

<p class=Cprg>&lt;span id=&quot;m&quot; runat=&quot;server&quot;/&gt;&lt;p&gt;<o:p></o:p></p>

<p class=Cprg>&lt;ASP:DataGrid id=&quot;l&quot; runat=&quot;server&quot;
DataKeyField=&quot;au_id&quot; OnDeleteCommand=&quot;Delete&quot;&gt;<o:p></o:p></p>

<p class=Cprg>&lt;columns&gt;<o:p></o:p></p>

<p class=Cprg>&lt;asp:ButtonColumn Text=&quot;Delete Author1&quot;
CommandName=&quot;Delete&quot;/&gt;<o:p></o:p></p>

<p class=Cprg>&lt;/columns&gt;<o:p></o:p></p>

<p class=Cprg>&lt;/ASP:DataGrid&gt;<o:p></o:p></p>

<p class=Cprg>&lt;/form&gt;<o:p></o:p></p>

<p class=Cprg>&lt;/body&gt;<o:p></o:p></p>

<p class=Cprg>&lt;/html&gt;<o:p></o:p></p>

<p class=Cbase><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=Coutput><u>Output</u><o:p></o:p></p>

<p class=Coutput><img width=426 height=61 id="_x0000_i1051"
src="chap5img/img23.bmp"><o:p></o:p></p>

<p class=Cbase><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=Cbase>This program simply deletes a record. Delete is the simplest of
all the SQL commands. We simply add one more column or Button to the DataGrid,
and when we click on it, the delete function gets called. <o:p></o:p></p>

<p class=Cbase><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=Cbase>In the SQL statement, we simply replace Update with the word
Delete alongwith the placeholder containing the primary key. No other code is
modified.<o:p></o:p></p>

<p class=Cbase><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=Cbase><b><span style='font-size:14.0pt;font-family:"Times New Roman"'>Sorting<o:p></o:p></span></b></p>

<p class=Cbase><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=Cprg><u>a.aspx</u><o:p></o:p></p>

<p class=Cprg>&lt;%@ Import Namespace=&quot;System.Data&quot; %&gt;<o:p></o:p></p>

<p class=Cprg>&lt;%@ Import Namespace=&quot;System.Data.SqlClient&quot; %&gt;<o:p></o:p></p>

<p class=Cprg>&lt;html&gt;<o:p></o:p></p>

<p class=Cprg>&lt;script language=&quot;C#&quot; runat=&quot;server&quot;&gt;<o:p></o:p></p>

<p class=Cprg>SqlConnection c;<o:p></o:p></p>

<p class=Cprg>void Page_Load(Object Src, EventArgs E) <o:p></o:p></p>

<p class=Cprg>{<o:p></o:p></p>

<p class=Cprg>c = new
SqlConnection(&quot;server=localhost;uid=sa;pwd=;database=pubs&quot;);<o:p></o:p></p>

<p class=Cprg>if (!IsPostBack)<o:p></o:p></p>

<p class=Cprg>bbb(&quot;au_id&quot;);<o:p></o:p></p>

<p class=Cprg>}<o:p></o:p></p>

<p class=Cprg>void abc(Object Src, DataGridSortCommandEventArgs E) <o:p></o:p></p>

<p class=Cprg>{<o:p></o:p></p>

<p class=Cprg>bbb(E.SortExpression);<o:p></o:p></p>

<p class=Cprg>}<o:p></o:p></p>

<p class=Cprg>public void bbb(String s) <o:p></o:p></p>

<p class=Cprg>{<o:p></o:p></p>

<p class=Cprg>SqlDataAdapter co = new SqlDataAdapter(&quot;select * from
Authors&quot;, c);<o:p></o:p></p>

<p class=Cprg>DataSet ds = new DataSet();<o:p></o:p></p>

<p class=Cprg>co.Fill(ds, &quot;Authors&quot;);<o:p></o:p></p>

<p class=Cprg>DataView Source = ds.Tables[&quot;Authors&quot;].DefaultView;<o:p></o:p></p>

<p class=Cprg>Source.Sort = s;<o:p></o:p></p>

<p class=Cprg>l.DataSource=Source;<o:p></o:p></p>

<p class=Cprg>l.DataBind();<o:p></o:p></p>

<p class=Cprg>}<o:p></o:p></p>

<p class=Cprg>&lt;/script&gt;<o:p></o:p></p>

<p class=Cprg>&lt;body&gt;<o:p></o:p></p>

<p class=Cprg>&lt;form runat=&quot;server&quot;&gt;<o:p></o:p></p>

<p class=Cprg>&lt;ASP:DataGrid id=&quot;l&quot; runat=&quot;server&quot;
OnSortCommand=&quot;abc&quot; AllowSorting=&quot;true&quot; /&gt;<o:p></o:p></p>

<p class=Cprg>&lt;/form&gt;<o:p></o:p></p>

<p class=Cprg>&lt;/body&gt;<o:p></o:p></p>

<p class=Cprg>&lt;/html&gt;<o:p></o:p></p>

<p class=Cbase><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=Cbase>As we have enabled sorting in the DataGrid, we see a hyperlink
for all the column headers. If we click on any of the columns, the function abc
gets called. This function uses E.SortExpression, which holds details of the
column that we click on, and thereafter, it calls bbb with the Sort field as a
parameter. The member Sort is initialized to this new field, and thereafter,
the DataGrid sorts the records automatically. If we try to understand the same
concept of Sorting with a Database, it unshields this power of a DataGrid
Control. <o:p></o:p></p>

<p class=Cbase><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=Cprg><u>a.aspx</u><o:p></o:p></p>

<p class=Cprg>&lt;%@ Import Namespace=&quot;System.Data&quot; %&gt;<o:p></o:p></p>

<p class=Cprg>&lt;%@ Import Namespace=&quot;System.Data.SqlClient&quot; %&gt;<o:p></o:p></p>

<p class=Cprg>&lt;html&gt;<o:p></o:p></p>

<p class=Cprg>&lt;script language=&quot;C#&quot; runat=&quot;server&quot;&gt;<o:p></o:p></p>

<p class=Cprg>SqlConnection c;<o:p></o:p></p>

<p class=Cprg>void Page_Load(Object Src, EventArgs E) <o:p></o:p></p>

<p class=Cprg>{<o:p></o:p></p>

<p class=Cprg>c = new
SqlConnection(&quot;server=localhost;uid=sa;pwd=;database=pubs&quot;);<o:p></o:p></p>

<p class=Cprg>if (!IsPostBack)<o:p></o:p></p>

<p class=Cprg>bbb(&quot;au_id&quot;);<o:p></o:p></p>

<p class=Cprg>}<o:p></o:p></p>

<p class=Cprg>void abc(Object Src, DataGridSortCommandEventArgs E) <o:p></o:p></p>

<p class=Cprg>{<o:p></o:p></p>

<p class=Cprg>bbb(E.SortExpression);<o:p></o:p></p>

<p class=Cprg>}<o:p></o:p></p>

<p class=Cprg>public void bbb(String s) <o:p></o:p></p>

<p class=Cprg>{<o:p></o:p></p>

<p class=Cprg>SqlDataAdapter co = new SqlDataAdapter(&quot;select * from
Authors&quot;, c);<o:p></o:p></p>

<p class=Cprg>DataSet ds = new DataSet();<o:p></o:p></p>

<p class=Cprg>co.Fill(ds, &quot;Authors&quot;);<o:p></o:p></p>

<p class=Cprg>DataView Source = ds.Tables[&quot;Authors&quot;].DefaultView;<o:p></o:p></p>

<p class=Cprg>Source.Sort = s;<o:p></o:p></p>

<p class=Cprg>l.DataSource=Source;<o:p></o:p></p>

<p class=Cprg>l.DataBind();<o:p></o:p></p>

<p class=Cprg>}<o:p></o:p></p>

<p class=Cprg>&lt;/script&gt;<o:p></o:p></p>

<p class=Cprg>&lt;body&gt;<o:p></o:p></p>

<p class=Cprg>&lt;form runat=&quot;server&quot;&gt;<o:p></o:p></p>

<p class=Cprg>&lt;ASP:DataGrid id=&quot;l&quot; runat=&quot;server&quot;
OnSortCommand=&quot;abc&quot; AllowSorting=&quot;true&quot;
AutoGenerateColumns=&quot;false&quot;&gt;<o:p></o:p></p>

<p class=Cprg>&lt;columns&gt;<o:p></o:p></p>

<p class=Cprg><span style="mso-spacerun: yes">       
</span>&lt;asp:BoundColumn HeaderText=&quot;au_id&quot;
SortExpression=&quot;au_id&quot; DataField=&quot;au_id&quot;
ItemStyle-Wrap=&quot;false&quot;/&gt;<o:p></o:p></p>

<p class=Cprg><span style="mso-spacerun: yes">       
</span>&lt;asp:BoundColumn HeaderText=&quot;au_lname&quot;
SortExpression=&quot;au_lname&quot; DataField=&quot;au_lname&quot;/&gt;<o:p></o:p></p>

<p class=Cprg><span style="mso-spacerun: yes">       
</span>&lt;asp:BoundColumn HeaderText=&quot;au_fname&quot;
SortExpression=&quot;au_fname&quot; DataField=&quot;au_fname&quot;/&gt;<o:p></o:p></p>

<p class=Cprg><span style="mso-spacerun: yes">        </span>&lt;asp:BoundColumn
HeaderText=&quot;phone&quot; SortExpression=&quot;phone&quot;
DataField=&quot;phone&quot;/&gt;<o:p></o:p></p>

<p class=Cprg><span style="mso-spacerun: yes">       
</span>&lt;asp:BoundColumn HeaderText=&quot;address&quot;
SortExpression=&quot;address&quot; DataField=&quot;address&quot;/&gt;<o:p></o:p></p>

<p class=Cprg><span style="mso-spacerun: yes">       
</span>&lt;asp:BoundColumn HeaderText=&quot;city&quot;
SortExpression=&quot;city&quot; DataField=&quot;city&quot;/&gt;<o:p></o:p></p>

<p class=Cprg><span style="mso-spacerun: yes">        </span>&lt;asp:BoundColumn
HeaderText=&quot;state&quot; SortExpression=&quot;state&quot;
DataField=&quot;state&quot;/&gt;<o:p></o:p></p>

<p class=Cprg><span style="mso-spacerun: yes">       
</span>&lt;asp:BoundColumn HeaderText=&quot;zip&quot;
SortExpression=&quot;zip&quot; DataField=&quot;zip&quot;/&gt;<o:p></o:p></p>

<p class=Cprg><span style="mso-spacerun: yes">       
</span>&lt;asp:BoundColumn HeaderText=&quot;contract&quot;
SortExpression=&quot;contract&quot; DataField=&quot;contract&quot;/&gt;<o:p></o:p></p>

<p class=Cprg><span style="mso-spacerun: yes">   </span><span
style="mso-spacerun: yes">   </span>&lt;/columns&gt;<o:p></o:p></p>

<p class=Cprg>&lt;/ASP:DataGrid&gt;<o:p></o:p></p>

<p class=Cprg>&lt;/form&gt;<o:p></o:p></p>

<p class=Cprg>&lt;/body&gt;<o:p></o:p></p>

<p class=Cprg>&lt;/html&gt;<o:p></o:p></p>

<p class=Cbase><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=Cbase>We have introduced a slight modification to the earlier program.
Since we are using BoundColumn, our own fields can now be sorted. <o:p></o:p></p>

<p class=Cbase><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=Cbase>We can thus decide on the number of columns that the user can
sort on. We can also avoid displaying the entire database and restrict the
display of all the columns.<o:p></o:p></p>

<p class=Cbase><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=Cbase><b><span style='font-size:14.0pt;font-family:"Times New Roman"'>Stored
Procedures<o:p></o:p></span></b></p>

<p class=Cbase><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=Cprg><u>a.aspx</u><o:p></o:p></p>

<p class=Cprg>&lt;%@ Import Namespace=&quot;System.Data&quot; %&gt;<o:p></o:p></p>

<p class=Cprg>&lt;%@ Import Namespace=&quot;System.Data.SqlClient&quot; %&gt;<o:p></o:p></p>

<p class=Cprg>&lt;html&gt;<o:p></o:p></p>

<p class=Cprg>&lt;script language=&quot;C#&quot; runat=&quot;server&quot;&gt;<o:p></o:p></p>

<p class=Cprg>void Page_Load(Object Src, EventArgs E) <o:p></o:p></p>

<p class=Cprg>{<o:p></o:p></p>

<p class=Cprg>SqlConnection c = new
SqlConnection(&quot;server=localhost;uid=sa;pwd=;database=Northwind&quot;);<o:p></o:p></p>

<p class=Cprg>SqlDataAdapter co = new SqlDataAdapter(&quot;Ten Most Expensive
Products &quot;, c);<o:p></o:p></p>

<p class=Cprg>co.SelectCommand.CommandType = CommandType.StoredProcedure;<o:p></o:p></p>

<p class=Cprg>DataSet ds = new DataSet();<o:p></o:p></p>

<p class=Cprg>co.Fill(ds, &quot;Products&quot;);<o:p></o:p></p>

<p class=Cprg>l.DataSource=ds.Tables[&quot;Products&quot;].DefaultView;<o:p></o:p></p>

<p class=Cprg>l.DataBind();<o:p></o:p></p>

<p class=Cprg>}<o:p></o:p></p>

<p class=Cprg>&lt;/script&gt;<o:p></o:p></p>

<p class=Cprg>&lt;body&gt;<o:p></o:p></p>

<p class=Cprg>&lt;ASP:DataGrid id=&quot;l&quot; runat=&quot;server&quot;/&gt;<o:p></o:p></p>

<p class=Cprg>&lt;/body&gt;<o:p></o:p></p>

<p class=Cprg>&lt;/html&gt;<o:p></o:p></p>

<p class=Cbase><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=Coutput><u>Output</u><o:p></o:p></p>

<p class=Coutput><img width=186 height=173 id="_x0000_i1052"
src="chap5img/img25.bmp"><o:p></o:p></p>

<p class=Cbase><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=Cbase>The above program executes a stored procedure on the database
server. <o:p></o:p></p>

<p class=Cbase><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=Cbase>A stored procedure is code that is to be executed on the server,
in one single stroke. Ad hoc queries, like the ones we have been writing so
far, are performance expensive. Using stored procedures, introduces speed and
momentum to our programs. Within a stored procedure, we can write any SQL
statement. We also have the power of a programming language at our disposal.
Today, all known databases support the concept of a stored procedure, which was
not the case a few years ago.<span style="mso-spacerun: yes">  </span><o:p></o:p></p>

<p class=Cbase>A connection is made to the NorthWind database, instead of pubs.
This database contains a stored procedure called 'Ten Most Expensive Products'.
Instead of supplying an SQL statement to the SqlDataAdapter constructor, we now
supply the name of the stored procedure. <o:p></o:p></p>

<p class=Cbase><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=Cbase>Thereafter, ASP+ is to be informed that the string provided is a
stored procedure and not an SQL command. To do so, we use the member
CommandType and initialize it to a number signifying a stored procedure. By
default, the CommandType has a number pertaining to an SQL statement. <o:p></o:p></p>

<p class=Cbase><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=Cbase>Other than these modifications, the code remains the same. Given
below is the code contained in the stored procedure. At this point in time, it
consists of a simple select statement, but it can easily accommodate a large
amount of code.<o:p></o:p></p>

<p class=Cbase><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=Coutput><u>Ten Most Expensive Products</u><o:p></o:p></p>

<p class=Cbase><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=Cprg>SET QUOTED_IDENTIFIER ON <o:p></o:p></p>

<p class=Cprg>GO<o:p></o:p></p>

<p class=Cprg>SET ANSI_NULLS ON <o:p></o:p></p>

<p class=Cprg>GO<o:p></o:p></p>

<p class=Cprg><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=Cprg>ALTER<span style="mso-spacerun: yes">  </span>procedure &quot;Ten
Most Expensive Products&quot; AS<o:p></o:p></p>

<p class=Cprg>SET ROWCOUNT 10<o:p></o:p></p>

<p class=Cprg>SELECT Products.ProductName AS TenMostExpensiveProducts,
Products.UnitPrice<o:p></o:p></p>

<p class=Cprg>FROM Products<o:p></o:p></p>

<p class=Cprg>ORDER BY Products.UnitPrice DESC<o:p></o:p></p>

<p class=Cprg><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=Cprg>GO<o:p></o:p></p>

<p class=Cprg>SET QUOTED_IDENTIFIER OFF <o:p></o:p></p>

<p class=Cprg>GO<o:p></o:p></p>

<p class=Cprg>SET ANSI_NULLS ON <o:p></o:p></p>

<p class=Cprg>GO<o:p></o:p></p>

<p class=Cbase><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=Cprg><u>a.aspx</u><o:p></o:p></p>

<p class=Cprg>&lt;%@ Import Namespace=&quot;System.Data&quot; %&gt;<o:p></o:p></p>

<p class=Cprg>&lt;%@ Import Namespace=&quot;System.Data.SqlClient&quot; %&gt;<o:p></o:p></p>

<p class=Cprg>&lt;html&gt;<o:p></o:p></p>

<p class=Cprg>&lt;script language=&quot;C#&quot; runat=&quot;server&quot;&gt;<o:p></o:p></p>

<p class=Cprg>public void abc(Object sender, EventArgs E) <o:p></o:p></p>

<p class=Cprg>{<o:p></o:p></p>

<p class=Cprg>SqlConnection c = new
SqlConnection(&quot;server=localhost;uid=sa;pwd=;database=Northwind&quot;);<o:p></o:p></p>

<p class=Cprg>SqlDataAdapter co = new
SqlDataAdapter(&quot;SalesByCategory&quot;, c);<o:p></o:p></p>

<p class=Cprg>co.SelectCommand.CommandType = CommandType.StoredProcedure;<o:p></o:p></p>

<p class=Cprg>co.SelectCommand.Parameters.Add(new
SqlParameter(&quot;@CategoryName&quot;, SqlDbType.NVarChar, 15));<o:p></o:p></p>

<p class=Cprg>co.SelectCommand.Parameters[&quot;@CategoryName&quot;].Value =
sc.Value;<o:p></o:p></p>

<p class=Cprg>co.SelectCommand.Parameters.Add(new
SqlParameter(&quot;@OrdYear&quot;, SqlDbType.NVarChar, 4));<o:p></o:p></p>

<p class=Cprg>co.SelectCommand.Parameters[&quot;@OrdYear&quot;].Value =
yr.Value;<o:p></o:p></p>

<p class=Cprg>DataSet ds = new DataSet();<o:p></o:p></p>

<p class=Cprg>co.Fill(ds, &quot;Sales&quot;);<o:p></o:p></p>

<p class=Cprg>l.DataSource=ds.Tables[&quot;Sales&quot;].DefaultView;<o:p></o:p></p>

<p class=Cprg>l.DataBind();<o:p></o:p></p>

<p class=Cprg>}<o:p></o:p></p>

<p class=Cprg>&lt;/script&gt;<o:p></o:p></p>

<p class=Cprg>&lt;body &gt;<o:p></o:p></p>

<p class=Cprg>&lt;form runat=&quot;server&quot;&gt;<o:p></o:p></p>

<p class=Cprg>&lt;select id=&quot;sc&quot; runat=&quot;server&quot;&gt;<o:p></o:p></p>

<p class=Cprg>&lt;option&gt;Beverages&lt;/option&gt;<o:p></o:p></p>

<p class=Cprg>&lt;option&gt;Condiments&lt;/option&gt;<o:p></o:p></p>

<p class=Cprg>&lt;option&gt;Confections&lt;/option&gt;<o:p></o:p></p>

<p class=Cprg>&lt;option&gt;Dairy Products&lt;/option&gt;<o:p></o:p></p>

<p class=Cprg>&lt;option&gt;Grains/Cereals&lt;/option&gt;<o:p></o:p></p>

<p class=Cprg>&lt;option&gt;Meat/Poultry&lt;/option&gt;<o:p></o:p></p>

<p class=Cprg>&lt;option&gt;Produce&lt;/option&gt;<o:p></o:p></p>

<p class=Cprg>&lt;option&gt;Seafood&lt;/option&gt;<o:p></o:p></p>

<p class=Cprg>&lt;/select&gt;<o:p></o:p></p>

<p class=Cprg>&lt;select id=&quot;yr&quot; runat=&quot;server&quot;&gt;<o:p></o:p></p>

<p class=Cprg>&lt;option&gt;1996&lt;/option&gt;<o:p></o:p></p>

<p class=Cprg>&lt;option&gt;1997&lt;/option&gt;<span style="mso-spacerun:
yes">  </span><o:p></o:p></p>

<p class=Cprg>&lt;option&gt;1998&lt;/option&gt;<span style="mso-spacerun:
yes">  </span><o:p></o:p></p>

<p class=Cprg>&lt;/select&gt;<o:p></o:p></p>

<p class=Cprg>&lt;input type=&quot;submit&quot; OnServerClick=&quot;abc&quot;
Value=&quot;Get Sales&quot; runat=&quot;server&quot;/&gt;&lt;p&gt;<o:p></o:p></p>

<p class=Cprg>&lt;ASP:DataGrid id=&quot;l&quot; runat=&quot;server&quot; /&gt;<o:p></o:p></p>

<p class=Cprg>&lt;/form&gt;<o:p></o:p></p>

<p class=Cprg>&lt;/body&gt;<o:p></o:p></p>

<p class=Cprg>&lt;/html&gt;<o:p></o:p></p>

<p class=Cbase><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=Coutput><u>Output</u><o:p></o:p></p>

<p class=Coutput><img width=261 height=234 id="_x0000_i1053"
src="chap5img/img26.bmp"><o:p></o:p></p>

<p class=Cbase><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=Cbase>We can pass as many parameters as we like, to a stored
procedure. Along with a button labeled 'Get Sales' to retrieve data, we display
two listboxes. The first one facilitates choosing of a category, while the
second one facilitates selection of the year for the sales data. <o:p></o:p></p>

<p class=Cbase><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=Cbase>To pass parameters to the stored procedure, we create a
placeholder, as explained before. The names given to the parameters, namely,
CategoryName and OrdYear, should match the names in the stored procedure.
Thereafter, the placeholders are initialized to the items selected in the
listbox.<o:p></o:p></p>

<p class=Cbase><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=Cbase>The source code of the stored procedure reads as follows:<o:p></o:p></p>

<p class=Cbase><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=Cprg><u>SalesByCategory<o:p></o:p></u></p>

<p class=Cprg><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=Coutput>ALTER<span style="mso-spacerun: yes">  </span>PROCEDURE
SalesByCategory<o:p></o:p></p>

<p class=Coutput><span style="mso-spacerun: yes">    </span>@CategoryName
nvarchar(15), @OrdYear nvarchar(4) = '1998'<o:p></o:p></p>

<p class=Coutput>AS<o:p></o:p></p>

<p class=Coutput>IF @OrdYear != '1996' AND @OrdYear != '1997' AND @OrdYear !=
'1998' <o:p></o:p></p>

<p class=Coutput>BEGIN<o:p></o:p></p>

<p class=Coutput><span style='mso-tab-count:1'>            </span>SELECT
@OrdYear = '1998'<o:p></o:p></p>

<p class=Coutput>END<o:p></o:p></p>

<p class=Coutput><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=Coutput>SELECT ProductName,<o:p></o:p></p>

<p class=Coutput><span style='mso-tab-count:1'>            </span>TotalPurchase=ROUND(SUM(CONVERT(decimal(14,2),
OD.Quantity * (1-OD.Discount) * OD.UnitPrice)), 0)<o:p></o:p></p>

<p class=Coutput>FROM [Order Details] OD, Orders O, Products P, Categories C<o:p></o:p></p>

<p class=Coutput>WHERE OD.OrderID = O.OrderID <o:p></o:p></p>

<p class=Coutput><span style='mso-tab-count:1'>            </span>AND
OD.ProductID = P.ProductID <o:p></o:p></p>

<p class=Coutput><span style='mso-tab-count:1'>            </span>AND
P.CategoryID = C.CategoryID<o:p></o:p></p>

<p class=Coutput><span style='mso-tab-count:1'>            </span>AND
C.CategoryName = @CategoryName<o:p></o:p></p>

<p class=Coutput><span style='mso-tab-count:1'>            </span>AND
SUBSTRING(CONVERT(nvarchar(22), O.OrderDate, 111), 1, 4) = @OrdYear<o:p></o:p></p>

<p class=Coutput>GROUP BY ProductName<o:p></o:p></p>

<p class=Coutput>ORDER BY ProductName<o:p></o:p></p>

<p class=Coutput><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=Coutput>GO<o:p></o:p></p>

<p class=Coutput>SET QUOTED_IDENTIFIER OFF <o:p></o:p></p>

<p class=Coutput>GO<o:p></o:p></p>

<p class=Coutput>SET ANSI_NULLS ON <o:p></o:p></p>

<p class=Coutput>GO<o:p></o:p></p>

<p class=Cbase><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=Cbase>We supply the procedure with two parameters and store them in
two variables, beginning with the @ sign. All this is part of the SQLServer
syntax for stored procedures. Then, using an 'if' statement, we check whether
the year is some predefined value or not. If it is, we give it a default value
of 1998. <o:p></o:p></p>

<p class=Cbase><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=Cbase>In case the OrdYear parameter is sent across, the default value
that it assumes, is 1998. Then, we use a 'join' to merge the three tables. The
'Group by' clause gives a summary, and the 'sum function' adds the parameters
that have been supplied. We shall not go on exploring more details of SQL any
further. <o:p></o:p></p>

<p class=Cbase><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=Cbase>Thus, we can see that the stored procedure is a programming
language that has been merged with SQL. <o:p></o:p></p>

<p class=Cbase><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=Cprg><u>a.aspx</u><o:p></o:p></p>

<p class=Cprg>&lt;%@ Import Namespace=&quot;System.Data&quot; %&gt;<o:p></o:p></p>

<p class=Cprg>&lt;%@ Import Namespace=&quot;System.Data.SqlClient&quot; %&gt;<o:p></o:p></p>

<p class=Cprg>&lt;html&gt;<o:p></o:p></p>

<p class=Cprg>&lt;script language=&quot;C#&quot; runat=&quot;server&quot;&gt;<o:p></o:p></p>

<p class=Cprg>public void abc(Object sender, EventArgs E) <o:p></o:p></p>

<p class=Cprg>{<o:p></o:p></p>

<p class=Cprg>SqlConnection c = new
SqlConnection(&quot;server=localhost;uid=sa;pwd=;database=Northwind&quot;);<o:p></o:p></p>

<p class=Cprg>SqlDataAdapter co = new SqlDataAdapter(&quot;Employee Sales By
Country &quot;, c);<o:p></o:p></p>

<p class=Cprg>co.SelectCommand.CommandType = CommandType.StoredProcedure;<o:p></o:p></p>

<p class=Cprg>co.SelectCommand.Parameters.Add(new
SqlParameter(&quot;@Beginning_Date&quot;, SqlDbType.DateTime));<o:p></o:p></p>

<p class=Cprg>co.SelectCommand.Parameters[&quot;@Beginning_Date&quot;].Value =
BD.SelectedDate;<o:p></o:p></p>

<p class=Cprg>co.SelectCommand.Parameters.Add(new
SqlParameter(&quot;@Ending_Date&quot;, SqlDbType.DateTime));<o:p></o:p></p>

<p class=Cprg>co.SelectCommand.Parameters[&quot;@Ending_Date&quot;].Value =
ED.SelectedDate;<o:p></o:p></p>

<p class=Cprg>DataSet ds = new DataSet();<o:p></o:p></p>

<p class=Cprg>co.Fill(ds, &quot;Sales&quot;);<o:p></o:p></p>

<p class=Cprg>l.DataSource=ds.Tables[&quot;Sales&quot;].DefaultView;<o:p></o:p></p>

<p class=Cprg>l.DataBind();<o:p></o:p></p>

<p class=Cprg>}<o:p></o:p></p>

<p class=Cprg>&lt;/script&gt;<o:p></o:p></p>

<p class=Cprg>&lt;body&gt;<o:p></o:p></p>

<p class=Cprg>&lt;form runat=&quot;server&quot;&gt;<o:p></o:p></p>

<p class=Cprg>&lt;ASP:Calendar id=&quot;BD&quot; BorderWidth=&quot;2&quot;
BorderColor=&quot;lightblue&quot; Font-Size=&quot;8pt&quot;<span
style="mso-spacerun: yes">  </span>TitleStyle-Font-Size=&quot;8pt&quot;
TitleStyle-BackColor=&quot;#cceecc&quot;
DayHeaderStyle-BackColor=&quot;#ddffdd&quot;
DayHeaderStyle-Font-Size=&quot;10pt&quot;<span style="mso-spacerun: yes"> 
</span>WeekendDayStyle-BackColor=&quot;#ffffcc&quot;
SelectedDate=&quot;7/1/1996&quot; VisibleDate=&quot;7/1/1996&quot; SelectedDayStyle-BackColor=&quot;lightblue&quot;
runat=&quot;server&quot;/&gt;<o:p></o:p></p>

<p class=Cprg>&lt;p&gt;<o:p></o:p></p>

<p class=Cprg>&lt;ASP:Calendar id=&quot;ED&quot; runat=&quot;server&quot;/&gt;<o:p></o:p></p>

<p class=Cprg>&lt;input type=&quot;submit&quot; OnServerClick=&quot;abc&quot;
Value=&quot;Get Employee Sales&quot;
runat=&quot;server&quot;/&gt;&lt;p&gt;<span style="mso-spacerun: yes">         
</span><o:p></o:p></p>

<p class=Cprg>&lt;p&gt;<o:p></o:p></p>

<p class=Cprg>&lt;ASP:DataGrid id=&quot;l&quot; runat=&quot;server&quot;/&gt;<o:p></o:p></p>

<p class=Cprg>&lt;/form&gt;<o:p></o:p></p>

<p class=Cprg>&lt;/body&gt;<o:p></o:p></p>

<p class=Cprg>&lt;/html&gt;<o:p></o:p></p>

<p class=Cbase><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=Cbase><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=Coutput><u>Output</u><o:p></o:p></p>

<p class=Coutput><img width=250 height=371 id="_x0000_i1054"
src="chap5img/img27.bmp"><o:p></o:p></p>

<p class=Coutput><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=Cbase>This example is short, sweet and pretty. Here, we are creating a
calendar by using the tag Calendar. We have two calendar controls, having the
ids of BD and ED. The first one has a large number of options, whereas, the
second has none. This is just to demonstrate the fact that a large number of
options can be set in the calendar tag. <o:p></o:p></p>

<p class=Cbase><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=Cbase>We chose the start date in the first calendar and the end date
in the second calendar. Then we clicked on the button labeled 'Get Employee
Sales'. The function abc is associated with this button. This function has a
stored procedure called 'Employee Sales by Country'. We provide the
SqlParameters named Beginning_Date and Ending_Date, to this stored procedure.
The Calendar control stores the selected dates in one of its member called
SelectedDate. Hence, the Parameters are initialized to these dates. <o:p></o:p></p>

<p class=Cbase>A point to be noted here is that, a date from the previous
century has to be provided, or else an exception will be thrown. The code of
the stored procedure named Employee Sales By Country, is as follows:<o:p></o:p></p>

<p class=Cbase><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=Coutput><u>Employee Sales by Country</u><o:p></o:p></p>

<p class=Cbase><span style="mso-spacerun: yes"> </span><o:p></o:p></p>

<p class=Cprg>SET QUOTED_IDENTIFIER ON <o:p></o:p></p>

<p class=Cprg>GO<o:p></o:p></p>

<p class=Cprg>SET ANSI_NULLS ON <o:p></o:p></p>

<p class=Cprg>GO<o:p></o:p></p>

<p class=Cprg><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=Cprg>ALTER<span style="mso-spacerun: yes">  </span>procedure
&quot;Employee Sales by Country&quot; <o:p></o:p></p>

<p class=Cprg>@Beginning_Date DateTime, @Ending_Date DateTime AS<o:p></o:p></p>

<p class=Cprg>SELECT Employees.Country, Employees.LastName,
Employees.FirstName, Orders.ShippedDate, Orders.OrderID, &quot;Order
Subtotals&quot;.Subtotal AS SaleAmount<o:p></o:p></p>

<p class=Cprg>FROM Employees INNER JOIN <o:p></o:p></p>

<p class=Cprg><span style='mso-tab-count:1'>            </span>(Orders INNER
JOIN &quot;Order Subtotals&quot; ON Orders.OrderID = &quot;Order
Subtotals&quot;.OrderID) <o:p></o:p></p>

<p class=Cprg><span style='mso-tab-count:1'>            </span>ON
Employees.EmployeeID = Orders.EmployeeID<o:p></o:p></p>

<p class=Cprg>WHERE Orders.ShippedDate Between @Beginning_Date And @Ending_Date<o:p></o:p></p>

<p class=Cprg><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=Cprg>GO<o:p></o:p></p>

<p class=Cprg>SET QUOTED_IDENTIFIER OFF <o:p></o:p></p>

<p class=Cprg>GO<o:p></o:p></p>

<p class=Cprg>SET ANSI_NULLS ON <o:p></o:p></p>

<p class=Cprg>GO<o:p></o:p></p>

<p class=Cbase><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=Cbase><b><span style='font-size:14.0pt;font-family:"Times New Roman"'>Master-Detail
relationship<o:p></o:p></span></b></p>

<p class=Cbase><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=Cbase>Generally, data is not stored in one single table. It is spread
over many tables. The data model used currently cannot represent relationships
in a single grid.<o:p></o:p></p>

<p class=Cbase><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=Cbase>We would also like our display to follow the same principle
i.e., it should display the master column as a hyperlink, and when we click on
the link, the details represented by the master be displayed below.<o:p></o:p></p>

<p class=Cprg><u><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></u></p>

<p class=Cprg><u>a.aspx</u><o:p></o:p></p>

<p class=Cprg>&lt;%@ Import Namespace=&quot;System.Data&quot; %&gt;<o:p></o:p></p>

<p class=Cprg>&lt;%@ Import Namespace=&quot;System.Data.SqlClient&quot; %&gt;<o:p></o:p></p>

<p class=Cprg>&lt;html&gt;<o:p></o:p></p>

<p class=Cprg>&lt;script language=&quot;C#&quot; runat=&quot;server&quot;&gt;<o:p></o:p></p>

<p class=Cprg>void Page_Load(Object Src, EventArgs E ) <o:p></o:p></p>

<p class=Cprg>{<o:p></o:p></p>

<p class=Cprg>SqlConnection c = new
SqlConnection(&quot;server=localhost;uid=sa;pwd=;database=pubs&quot;);<o:p></o:p></p>

<p class=Cprg>SqlDataAdapter co = new SqlDataAdapter(&quot;select * from
Authors&quot;, c);<o:p></o:p></p>

<p class=Cprg>DataSet ds = new DataSet();<o:p></o:p></p>

<p class=Cprg>co.Fill(ds, &quot;Authors&quot;);<o:p></o:p></p>

<p class=Cprg>l.DataSource=ds.Tables[&quot;Authors&quot;].DefaultView;<o:p></o:p></p>

<p class=Cprg>l.DataBind();<o:p></o:p></p>

<p class=Cprg>}<o:p></o:p></p>

<p class=Cprg>&lt;/script&gt;<o:p></o:p></p>

<p class=Cprg>&lt;body &gt;<o:p></o:p></p>

<p class=Cprg>&lt;form runat=&quot;server&quot;&gt;<o:p></o:p></p>

<p class=Cprg>&lt;ASP:DataGrid id=&quot;l&quot; runat=&quot;server&quot;
DataKeyField=&quot;au_id&quot;&gt;<o:p></o:p></p>

<p class=Cprg>&lt;columns&gt;<o:p></o:p></p>

<p class=Cprg>&lt;asp:HyperLinkColumn<span style="mso-spacerun: yes"> 
</span>DataNavigateUrlField=&quot;au_id&quot;
DataNavigateUrlFormatString=&quot;a1.aspx?id={0}&quot; Text=&quot;Get
Details1&quot;/&gt;<o:p></o:p></p>

<p class=Cprg>&lt;/columns&gt;<o:p></o:p></p>

<p class=Cprg>&lt;/ASP:DataGrid&gt;<o:p></o:p></p>

<p class=Cprg>&lt;/form&gt;<o:p></o:p></p>

<p class=Cprg>&lt;/body&gt;<o:p></o:p></p>

<p class=Cprg>&lt;/html&gt;<o:p></o:p></p>

<p class=Cbase><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=Cbase>This program simply displays all the fields of all the records
from the authors table. To this, we simply add a column containing the text
‘Get Details1’, using HyperLinkColumn. Whenever the user clicks on this link of
a specific record, a new URL is created with a1.aspx, followed by id= and {0}.
The {0} gets replaced with the value contained in the <span style='font-family:
"Trebuchet MS"'>authors </span>id for that record. <o:p></o:p></p>

<p class=Cbase><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=Cbase>Let us go over to a1.aspx to understand the nitty gritties.<o:p></o:p></p>

<p class=Cbase><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=Cprg><u>a1.aspx</u><o:p></o:p></p>

<p class=Cprg>&lt;%@ Import Namespace=&quot;System.Data&quot; %&gt;<o:p></o:p></p>

<p class=Cprg>&lt;%@ Import Namespace=&quot;System.Data.SqlClient&quot; %&gt;<o:p></o:p></p>

<p class=Cprg>&lt;html&gt;<o:p></o:p></p>

<p class=Cprg>&lt;script language=&quot;C#&quot; runat=&quot;server&quot;&gt;<o:p></o:p></p>

<p class=Cprg>SqlConnection c;<o:p></o:p></p>

<p class=Cprg>void Page_Load(Object Src, EventArgs E ) <o:p></o:p></p>

<p class=Cprg>{<o:p></o:p></p>

<p class=Cprg>c = new
SqlConnection(&quot;server=localhost;uid=sa;pwd=;database=pubs&quot;);<o:p></o:p></p>

<p class=Cprg>String s = &quot;select t.title_id, t.type, t.pub_id, t.price
from titles t, titleauthor ta, authors a where<span style="mso-spacerun: yes"> 
</span>ta.au_id=@Id AND ta.title_id=t.title_id AND ta.au_id = a.au_id&quot;;<o:p></o:p></p>

<p class=Cprg>SqlDataAdapter co = new SqlDataAdapter(s, c);<o:p></o:p></p>

<p class=Cprg>co.SelectCommand.Parameters.Add(new SqlParameter(&quot;@Id&quot;,
SqlDbType.VarChar, 11));<o:p></o:p></p>

<p class=Cprg>co.SelectCommand.Parameters[&quot;@Id&quot;].Value =
Request.QueryString[&quot;id&quot;];<o:p></o:p></p>

<p class=Cprg>DataSet ds = new DataSet();<o:p></o:p></p>

<p class=Cprg>co.Fill(ds, &quot;Titles&quot;);<o:p></o:p></p>

<p class=Cprg>l.DataSource=ds.Tables[&quot;Titles&quot;].DefaultView;<o:p></o:p></p>

<p class=Cprg>l.DataBind();<o:p></o:p></p>

<p class=Cprg>}<o:p></o:p></p>

<p class=Cprg>&lt;/script&gt;<o:p></o:p></p>

<p class=Cprg>&lt;body &gt;<o:p></o:p></p>

<p class=Cprg>&lt;form runat=&quot;server&quot;&gt;<o:p></o:p></p>

<p class=Cprg>Details for Author &lt;%=Request.QueryString[&quot;id&quot;]%&gt;<o:p></o:p></p>

<p class=Cprg>&lt;ASP:DataGrid id=&quot;l&quot; runat=&quot;server&quot;/&gt;<o:p></o:p></p>

<p class=Cprg>&lt;/form&gt;<o:p></o:p></p>

<p class=Cprg>&lt;/body&gt;<o:p></o:p></p>

<p class=Cprg>&lt;/html&gt;<o:p></o:p></p>

<p class=Cbase><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=Cbase>In the file a1.aspx, the select statement looks up three tables.
The placeholder @Id gives us the author id. This parameter ld is initialized to
the value returned by QueryString[&quot;id&quot;]. As we have learnt earlier,
QueryString returns the value contained in the name-value pair in the URL. So,
QueryString[&quot;id&quot;]<span style="mso-spacerun: yes">  </span>will return
the<span style="mso-spacerun: yes">  </span>author id of the record that we
have clicked on. <o:p></o:p></p>

<p class=Cbase><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=Coutput><u>Output</u><o:p></o:p></p>

<p class=Coutput><img width=426 height=61 id="_x0000_i1055"
src="chap5img/img28.bmp"><o:p></o:p></p>

<p class=Coutput><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=Coutput><u>http://127.0.0.1/a1.aspx?id=238-95-7766</u><o:p></o:p></p>

<p class=Coutput><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=Coutput>Details for Author 238-95-7766 <o:p></o:p></p>

<p class=Coutput><img width=164 height=40 id="_x0000_i1056"
src="chap5img/img29.bmp"><o:p></o:p></p>

<p class=Coutput><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=Cbase>The new window displays a data grid that contains all the books
that this particular author has written. This is how a master-detail
relationship can be established..<o:p></o:p></p>

<p class=Cbase><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=Cbase><b><span style='font-size:14.0pt;font-family:"Times New Roman"'>XML<o:p></o:p></span></b></p>

<p class=Cbase><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=Cbase>XML is an abbreviation for the eXtensible Markup Language. There
are many proponents of this language who will try to convince you that XML is a
very powerful language that can even eradicate poverty from this world. That
may be a bit too far-fetched, but we cannot stop people from propagating the
benefits of XML and how it can make the world a better place to live in. <o:p></o:p></p>

<p class=Cbase><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=Cbase>The DataSet concept invented by Microsoft, delinked the data
from its source. So, while implementing DataSet, it does not make any
difference whether the data is in a SQL Server database or in XML. Thus, the
concept of a DataSet is independent of the actual data source. <o:p></o:p></p>

<p class=Cbase><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=Cbase>Let us actually read some data in XML.<o:p></o:p></p>

<p class=Cbase><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=Cprg><u>a.aspx</u><o:p></o:p></p>

<p class=Cprg>&lt;%@ Import Namespace=&quot;System.IO&quot; %&gt;<o:p></o:p></p>

<p class=Cprg>&lt;%@ Import Namespace=&quot;System.Data&quot; %&gt;<o:p></o:p></p>

<p class=Cprg>&lt;html&gt;<o:p></o:p></p>

<p class=Cprg>&lt;script language=&quot;C#&quot; runat=&quot;server&quot;&gt;<o:p></o:p></p>

<p class=Cprg>void Page_Load(Object Src, EventArgs E) {<o:p></o:p></p>

<p class=Cprg>DataSet ds = new DataSet();<o:p></o:p></p>

<p class=Cprg>FileStream fs = new
FileStream(Server.MapPath(&quot;a1.xml&quot;),FileMode.Open,FileAccess.Read);<o:p></o:p></p>

<p class=Cprg>StreamReader r = new StreamReader(fs);<o:p></o:p></p>

<p class=Cprg>ds.ReadXml(r);<o:p></o:p></p>

<p class=Cprg>fs.Close();<o:p></o:p></p>

<p class=Cprg>DataView Sv = new DataView(ds.Tables[0]);<o:p></o:p></p>

<p class=Cprg>s.InnerHtml = Sv.Table.TableName;<o:p></o:p></p>

<p class=Cprg>l.DataSource = Sv;<o:p></o:p></p>

<p class=Cprg>l.DataBind(); <o:p></o:p></p>

<p class=Cprg>}<o:p></o:p></p>

<p class=Cprg>&lt;/script&gt;<o:p></o:p></p>

<p class=Cprg>&lt;body&gt;<o:p></o:p></p>

<p class=Cprg>&lt;span runat=&quot;server&quot; id=&quot;s&quot;/&gt;<o:p></o:p></p>

<p class=Cprg>&lt;p&gt;<o:p></o:p></p>

<p class=Cprg>&lt;ASP:DataGrid id=&quot;l&quot; runat=&quot;server&quot;/&gt;<o:p></o:p></p>

<p class=Cprg>&lt;/body&gt;<o:p></o:p></p>

<p class=Cprg>&lt;/html&gt;<o:p></o:p></p>

<p class=Cbase><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=Cbase>We have a simple DataGrid <span style='font-family:"Trebuchet MS"'>l</span>
with no attributes defined. In this control, the data obtained from the XML
file is to be displayed. In the Page_Load function, a new DataSet object is
created. This is followed by a FileStream object called 'fs'. <o:p></o:p></p>

<p class=Cbase><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=Cbase>To create an object of type FileStream, the constructor is
passed three parameters:<o:p></o:p></p>

<p class=Cbase><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=Cbullets><span style='mso-bidi-font-size:12.0pt;font-family:"Times New Roman"'>•<span
style='mso-tab-count:1'>     </span></span>the name of the XML file.<o:p></o:p></p>

<p class=Cbullets><span style='mso-bidi-font-size:12.0pt;font-family:"Times New Roman"'>•<span
style='mso-tab-count:1'>     </span></span>a number denoting file open.<o:p></o:p></p>

<p class=Cbullets><span style='mso-bidi-font-size:12.0pt;font-family:"Times New Roman"'>•<span
style='mso-tab-count:1'>     </span></span>a number denoting file read. <o:p></o:p></p>

<p class=Cbase><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=Cbase>The MapPath function gives the file an absolute path name. In
our case, as we have installed IIS on C:\, the first parameter eventually reads
as c:\inetpub\wwwroot\a1.xml. <o:p></o:p></p>

<p class=Cbase><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=Cbase>After FileStream, we create a StreamReader object called 'r'.
This is accomplished by passing the newly created FileStream object 'fs' as a
parameter to the constructor.<o:p></o:p></p>

<p class=Cbase><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=Cbase>Finally, the function ReadXml is called off the DataSet and
passed the parameter 'r', thus indirectly providing the XML filename. Once the
records are read, the file is closed.<o:p></o:p></p>

<p class=Cbase><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=Cbase>We then create a DataView object called 'Sv' and we pass a
DataTable object to the constructor. The span object 's' is filled up with the
name of the table stored in Sv.Table.TableName. It is obvious that the name is
acquired from a1.xml. Finally, we bind 'Sv', a DataView object to the DataGrid.
<o:p></o:p></p>

<p class=Cbase>Thus, the final execution is almost identical to what was done
using SQL, thereby, making it difficult for us to decipher the source of the
data. <o:p></o:p></p>

<p class=Cbase><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=Cprg><u>a1.xml</u><o:p></o:p></p>

<p class=Cprg>&lt;root&gt;<o:p></o:p></p>

<p class=Cprg>&lt;schema id=&quot;DocumentElement&quot;
targetNamespace=&quot;&quot; xmlns=&quot;http://www.w3.org/2001/XMLSchema&quot;
<o:p></o:p></p>

<p class=Cprg>xmlns:xdo=&quot;urn:schemas-microsoft-com:xml-xdo&quot;
xdo:DataSetName=&quot;DocumentElement&quot;&gt;<o:p></o:p></p>

<p class=Cprg>&lt;element name=&quot;Products&quot;&gt;<o:p></o:p></p>

<p class=Cprg>&lt;complexType&gt;<o:p></o:p></p>

<p class=Cprg>&lt;all&gt;<o:p></o:p></p>

<p class=Cprg>&lt;element name=&quot;ProductID&quot;
type=&quot;int&quot;&gt;&lt;/element&gt;<o:p></o:p></p>

<p class=Cprg>&lt;element name=&quot;CategoryID&quot; minOccurs=&quot;0&quot;
type=&quot;int&quot;&gt;&lt;/element&gt;<o:p></o:p></p>

<p class=Cprg>&lt;element name=&quot;ProductName&quot;
type=&quot;string&quot;&gt;&lt;/element&gt;<o:p></o:p></p>

<p class=Cprg>&lt;/all&gt;<o:p></o:p></p>

<p class=Cprg>&lt;/complexType&gt;<o:p></o:p></p>

<p class=Cprg>&lt;/element&gt;<o:p></o:p></p>

<p class=Cprg>&lt;/schema&gt;<o:p></o:p></p>

<p class=Cprg>&lt;DocumentElement&gt;<o:p></o:p></p>

<p class=Cprg>&lt;Products&gt;<o:p></o:p></p>

<p class=Cprg>&lt;ProductID&gt;1001&lt;/ProductID&gt;<o:p></o:p></p>

<p class=Cprg>&lt;CategoryID&gt;1&lt;/CategoryID&gt;<o:p></o:p></p>

<p class=Cprg>&lt;ProductName&gt;Chocolate City Milk&lt;/ProductName&gt;<o:p></o:p></p>

<p class=Cprg>&lt;/Products&gt;<o:p></o:p></p>

<p class=Cprg>&lt;Products&gt;<o:p></o:p></p>

<p class=Cprg>&lt;ProductID&gt;3004&lt;/ProductID&gt;<o:p></o:p></p>

<p class=Cprg>&lt;CategoryID&gt;3&lt;/CategoryID&gt;<o:p></o:p></p>

<p class=Cprg>&lt;ProductName&gt;Fizzy Fizzing Drink&lt;/ProductName&gt;<o:p></o:p></p>

<p class=Cprg>&lt;/Products&gt;<o:p></o:p></p>

<p class=Cprg>&lt;/DocumentElement&gt;<o:p></o:p></p>

<p class=Cprg>&lt;/root&gt;<o:p></o:p></p>

<p class=Cbase><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=Coutput><u>Output</u><o:p></o:p></p>

<p class=Coutput>Products <o:p></o:p></p>

<p class=Coutput><img width=194 height=51 id="_x0000_i1057"
src="chap5img/img30.bmp"><o:p></o:p></p>

<p class=Cbase><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=Cbase>An XML file contains only tags. We start with a tag called
'root' and end with the tag called '/root'. XML is very stringent about rules
governing tags. Thus, we have to follow certain basic rules when we use these
tags. The tag &lt;element&gt; has an attribute called 'name', which is
initialized to a table name. In our case, this name is Products. <o:p></o:p></p>

<p class=Cbase><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=Cbase>Within the tags &lt;all&gt; and &lt;/all&gt;, we use the element
tag again, but this time, it is used with the names of the fields and their
data types. These two values are supplied to the name and type attributes in
element. All this data describes the schema, and hence, we enclose this data in
a tag called schema.<o:p></o:p></p>

<p class=Cbase><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=Cbase>The tag schema has an attribute called DataSetName, that
specifies a tag called DocumentElement, within which all the data is placed.
The individual records are placed within the Products tags and the individual
values for the fields are enclosed within tags representing the field names.
Thus, it is possible to display data from an XML file in the DataGrid Control,
assuming that it originated from a database.<o:p></o:p></p>

<p class=Cbase><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=Cprg><u>a.aspx</u><o:p></o:p></p>

<p class=Cprg>&lt;%@ Import Namespace=&quot;System.IO&quot; %&gt;<o:p></o:p></p>

<p class=Cprg>&lt;%@ Import Namespace=&quot;System.Data&quot; %&gt;<o:p></o:p></p>

<p class=Cprg>&lt;html&gt;<o:p></o:p></p>

<p class=Cprg>&lt;script language=&quot;C#&quot; runat=&quot;server&quot;&gt;<o:p></o:p></p>

<p class=Cprg>void Page_Load(Object Src, EventArgs E) <o:p></o:p></p>

<p class=Cprg>{<o:p></o:p></p>

<p class=Cprg>DataSet ds = new DataSet();<o:p></o:p></p>

<p class=Cprg>FileStream fs = new
FileStream(Server.MapPath(&quot;s.xml&quot;),FileMode.Open,FileAccess.Read);<o:p></o:p></p>

<p class=Cprg>StreamReader sc = new StreamReader(fs);<o:p></o:p></p>

<p class=Cprg>ds.ReadXmlSchema (sc);<o:p></o:p></p>

<p class=Cprg>fs.Close();<o:p></o:p></p>

<p class=Cprg>fs = new
FileStream(Server.MapPath(&quot;d.xml&quot;),FileMode.Open,FileAccess.Read);<o:p></o:p></p>

<p class=Cprg>StreamReader r = new StreamReader(fs);<o:p></o:p></p>

<p class=Cprg>ds.ReadXml(r);<o:p></o:p></p>

<p class=Cprg>fs.Close();<o:p></o:p></p>

<p class=Cprg>DataView Sv = new DataView(ds.Tables[0]);<o:p></o:p></p>

<p class=Cprg>s.InnerHtml = Sv.Table.TableName;<o:p></o:p></p>

<p class=Cprg>l.DataSource = Sv;<o:p></o:p></p>

<p class=Cprg>l.DataBind(); <o:p></o:p></p>

<p class=Cprg>}<o:p></o:p></p>

<p class=Cprg>&lt;/script&gt;<o:p></o:p></p>

<p class=Cprg>&lt;body&gt;<o:p></o:p></p>

<p class=Cprg>&lt;span runat=&quot;server&quot; id=&quot;s&quot;/&gt;<o:p></o:p></p>

<p class=Cprg>&lt;p&gt;<o:p></o:p></p>

<p class=Cprg>&lt;ASP:DataGrid id=&quot;l&quot; runat=&quot;server&quot;/&gt;<o:p></o:p></p>

<p class=Cprg>&lt;/body&gt;<o:p></o:p></p>

<p class=Cprg>&lt;/html&gt;<o:p></o:p></p>

<p class=Cprg><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=Cprg><u>s.xml</u><o:p></o:p></p>

<p class=Cprg>&lt;schema id=&quot;DocumentElement&quot;
targetNamespace=&quot;&quot; xmlns=&quot;http://www.w3.org/2001/XMLSchema&quot;
xmlns:xdo=&quot;urn:schemas-microsoft-com:xml-xdo&quot;
xdo:DataSetName=&quot;DocumentElement&quot;&gt;<o:p></o:p></p>

<p class=Cprg>&lt;element name=&quot;Products&quot;&gt;<o:p></o:p></p>

<p class=Cprg>&lt;complexType&gt;<o:p></o:p></p>

<p class=Cprg>&lt;all&gt;<o:p></o:p></p>

<p class=Cprg>&lt;element name=&quot;ProductID&quot; type=&quot;int&quot;&gt;&lt;/element&gt;<o:p></o:p></p>

<p class=Cprg>&lt;element name=&quot;CategoryID&quot; minOccurs=&quot;0&quot;
type=&quot;int&quot;&gt;&lt;/element&gt;<o:p></o:p></p>

<p class=Cprg>&lt;element name=&quot;ProductName&quot;
type=&quot;string&quot;&gt;&lt;/element&gt;<o:p></o:p></p>

<p class=Cprg>&lt;/all&gt;<o:p></o:p></p>

<p class=Cprg>&lt;/complexType&gt;<o:p></o:p></p>

<p class=Cprg>&lt;/element&gt;<o:p></o:p></p>

<p class=Cprg>&lt;/schema&gt;<o:p></o:p></p>

<p class=Cprg><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=Cprg><u>d.xml</u><o:p></o:p></p>

<p class=Cprg>&lt;DocumentElement&gt;<o:p></o:p></p>

<p class=Cprg>&lt;Products&gt;<o:p></o:p></p>

<p class=Cprg>&lt;ProductID&gt;3003&lt;/ProductID&gt;<o:p></o:p></p>

<p class=Cprg>&lt;CategoryID&gt;3&lt;/CategoryID&gt;<o:p></o:p></p>

<p class=Cprg>&lt;ProductName&gt;Kona Diet Cola&lt;/ProductName&gt;<o:p></o:p></p>

<p class=Cprg>&lt;/Products&gt;<o:p></o:p></p>

<p class=Cprg>&lt;Products&gt;<o:p></o:p></p>

<p class=Cprg>&lt;ProductID&gt;3004&lt;/ProductID&gt;<o:p></o:p></p>

<p class=Cprg>&lt;CategoryID&gt;3&lt;/CategoryID&gt;<o:p></o:p></p>

<p class=Cprg>&lt;ProductName&gt;Fizzy Fizzing Drink&lt;/ProductName&gt;<o:p></o:p></p>

<p class=Cprg>&lt;/Products&gt;<o:p></o:p></p>

<p class=Cprg>&lt;/DocumentElement&gt;<o:p></o:p></p>

<p class=Cbase><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=Coutput><u>Output</u><o:p></o:p></p>

<p class=Coutput>Products <o:p></o:p></p>

<p class=Coutput><img width=192 height=52 id="_x0000_i1058"
src="chap5img/img31.bmp"><o:p></o:p></p>

<p class=Cbase><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=Cbase>The output is the same as shown with the earlier program. The
only change is that, we have separated the schema and the data into separate
XML files named s.xml and d.xml, respectively. As the schema is placed in a
file s.xml, in ASP+, the ReadXmlSchema function is utilized to read the schema.
Thereafter, the entire process is repeated again to read the XML data, using a
different function named ReadXml. <o:p></o:p></p>

<p class=Cbase><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=Cbase>You are at liberty to decide whether you want the schema and
data to reside in a single file or you want to place the the schema (or data
definition) and the data in separate files. ASP+ can handle both the situations
with equal aplomb.<o:p></o:p></p>

<p class=Cbase><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=Cprg><u>a.aspx</u><o:p></o:p></p>

<p class=Cprg>&lt;%@ Import Namespace=&quot;System.Data&quot; %&gt;<o:p></o:p></p>

<p class=Cprg>&lt;%@ Import Namespace=&quot;System.Data.SqlClient&quot; %&gt;<o:p></o:p></p>

<p class=Cprg>&lt;html&gt;<o:p></o:p></p>

<p class=Cprg>&lt;head&gt;<o:p></o:p></p>

<p class=Cprg>&lt;script language=&quot;C#&quot; runat=&quot;server&quot;&gt;<o:p></o:p></p>

<p class=Cprg>public DataView dv;<o:p></o:p></p>

<p class=Cprg>public DataSet ds;<o:p></o:p></p>

<p class=Cprg>public void abc(Object sender, EventArgs evt)<o:p></o:p></p>

<p class=Cprg>{<o:p></o:p></p>

<p class=Cprg>if (IsPostBack)<o:p></o:p></p>

<p class=Cprg>{<o:p></o:p></p>

<p class=Cprg>SqlConnection c = new
SqlConnection(&quot;server=localhost;uid=sa;pwd=;database=pubs&quot;);<o:p></o:p></p>

<p class=Cprg>SqlDataAdapter co = new SqlDataAdapter(&quot;select * from
Authors&quot;, c);<o:p></o:p></p>

<p class=Cprg>ds = new DataSet();<o:p></o:p></p>

<p class=Cprg>co.Fill(ds, &quot;Table&quot;);<o:p></o:p></p>

<p class=Cprg>dv = new DataView(ds.Tables[0]);<o:p></o:p></p>

<p class=Cprg>l.DataSource=dv;<o:p></o:p></p>

<p class=Cprg>l.DataBind();<o:p></o:p></p>

<p class=Cprg>}<o:p></o:p></p>

<p class=Cprg>}<o:p></o:p></p>

<p class=Cprg>&lt;/script&gt;<o:p></o:p></p>

<p class=Cprg>&lt;/head&gt;<o:p></o:p></p>

<p class=Cprg>&lt;body bgcolor=&quot;ffffcc&quot;&gt;<o:p></o:p></p>

<p class=Cprg>&lt;form runat=&quot;server&quot;&gt;<o:p></o:p></p>

<p class=Cprg>&lt;input type=&quot;submit&quot; runat=&quot;server&quot;
OnServerClick=&quot;abc&quot;&gt;<o:p></o:p></p>

<p class=Cprg>&lt;%<span style="mso-spacerun: yes">  </span>if
(Page.IsPostBack) {<span style="mso-spacerun: yes">  </span>%&gt;<o:p></o:p></p>

<p class=Cprg>&lt;textarea cols=80 rows=25&gt;<o:p></o:p></p>

<p class=Cprg>&lt;%<o:p></o:p></p>

<p class=Cprg>ds.WriteXml(Response.Output);<span style="mso-spacerun: yes">  
</span><o:p></o:p></p>

<p class=Cprg>%&gt;<o:p></o:p></p>

<p class=Cprg>&lt;/textarea&gt;<o:p></o:p></p>

<p class=Cprg>&lt;%<span style="mso-spacerun: yes">  </span>}<span
style="mso-spacerun: yes">  </span>%&gt;<o:p></o:p></p>

<p class=Cprg>&lt;ASP:DataGrid id=&quot;l&quot; runat=&quot;server&quot;/&gt;<o:p></o:p></p>

<p class=Cprg>&lt;/form&gt;<o:p></o:p></p>

<p class=Cprg>&lt;/body&gt;<o:p></o:p></p>

<p class=Cprg>&lt;/html&gt;<o:p></o:p></p>

<p class=Cbase><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=Cbase>This program achieves the reverse of the earlier program in the
sense it creates an XML file from the data retrieved from the database. <o:p></o:p></p>

<p class=Cbase><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=Cbase>We first associate our data grid with all the records of the
authors table. We then come to the textarea html tag, which can display a large
amount of data. Next, we use a function called WriteXml from the dataset object
'ds' that fills up the text area with the records present in the database in an
XML equivalent form. <o:p></o:p></p>

<p class=Cbase><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=Cbase>The text area displays the actual records within tags. Thus, we
can take SQL data and write out an XML file, or read an XML file into a
DataGrid.<o:p></o:p></p>

<p class=Cbase><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=Cbase><b><span style='font-size:14.0pt;font-family:"Times New Roman"'>Data
Binding and DataLists<o:p></o:p></span></b></p>

<p class=Cbase><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=Cprg><u>a.aspx</u><o:p></o:p></p>

<p class=Cprg>&lt;html&gt;<o:p></o:p></p>

<p class=Cprg>&lt;head&gt;<o:p></o:p></p>

<p class=Cprg>&lt;script language=&quot;C#&quot; runat=&quot;server&quot;&gt;<o:p></o:p></p>

<p class=Cprg>void Page_Load(Object s, EventArgs e) <o:p></o:p></p>

<p class=Cprg>{<o:p></o:p></p>

<p class=Cprg>DataBind();<o:p></o:p></p>

<p class=Cprg>}<o:p></o:p></p>

<p class=Cprg>string yyy<o:p></o:p></p>

<p class=Cprg>{<o:p></o:p></p>

<p class=Cprg>get <o:p></o:p></p>

<p class=Cprg>{<o:p></o:p></p>

<p class=Cprg>return &quot;Vijay&quot;;<o:p></o:p></p>

<p class=Cprg>}<o:p></o:p></p>

<p class=Cprg>}<o:p></o:p></p>

<p class=Cprg>&lt;/script&gt;<o:p></o:p></p>

<p class=Cprg>&lt;/head&gt;<o:p></o:p></p>

<p class=Cprg>&lt;body&gt;<o:p></o:p></p>

<p class=Cprg>&lt;form runat=server&gt;<o:p></o:p></p>

<p class=Cprg>Name: &lt;b&gt;&lt;%# yyy %&gt;&lt;/b&gt;<o:p></o:p></p>

<p class=Cprg>&lt;/form&gt;<o:p></o:p></p>

<p class=Cprg>&lt;/body&gt;<o:p></o:p></p>

<p class=Cprg>&lt;/html&gt;<o:p></o:p></p>

<p class=Cbase><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=Coutput><u>Output</u><o:p></o:p></p>

<p class=Coutput>Name: <b>Vijay</b><o:p></o:p></p>

<p class=Cbase><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=Cbase>Before we get back to reading data from a table, let us delve
upon another aspect of working with databases, namely, the Data Binding Server
controls. <o:p></o:p></p>

<p class=Cbase><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=Cbase>We have created a property called yyy with a 'get' only. Thus,
we cannot modify it, since it has a 'read only' property. The text returned
here is &quot;Vijay&quot;. On loading the ASP+ program, we see &quot;Name:
Vijay&quot; displayed in the browser window. <o:p></o:p></p>

<p class=Cbase><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=Cbase>This is because, in the function Page_Load, we are simply
calling the familiar function called DataBind. This function looks at tags
beginning with the symbol &lt;%#. It is aware that the word yyy following this
symbol, is a property. Therefore, it calls the get accessor within it. That is
why the value &quot;Vijay&quot; is displayed. Without the DataBind function, a
blank value for yyy would have been displayed. <o:p></o:p></p>

<p class=Cbase><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=Cbase>In functionality, it is similar to using an 'equal to' sign.
Then, why is it called 'binding a property'?<o:p></o:p></p>

<p class=Cbase><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=Cbase>To obtain the answer, you have to continue reading on.<o:p></o:p></p>

<p class=Cprg><u>a.aspx</u><o:p></o:p></p>

<p class=Cprg>&lt;html&gt;<o:p></o:p></p>

<p class=Cprg>&lt;head&gt;<o:p></o:p></p>

<p class=Cprg>&lt;script language=&quot;C#&quot; runat=&quot;server&quot;&gt;<o:p></o:p></p>

<p class=Cprg>void abc(Object s, EventArgs e) <o:p></o:p></p>

<p class=Cprg>{<o:p></o:p></p>

<p class=Cprg>DataBind();<o:p></o:p></p>

<p class=Cprg>}<o:p></o:p></p>

<p class=Cprg>&lt;/script&gt;<o:p></o:p></p>

<p class=Cprg>&lt;/head&gt;<o:p></o:p></p>

<p class=Cprg>&lt;body&gt;<o:p></o:p></p>

<p class=Cprg>&lt;form runat=server&gt;<o:p></o:p></p>

<p class=Cprg>&lt;asp:TextBox id=&quot;aa&quot; runat=&quot;server&quot; /&gt;<o:p></o:p></p>

<p class=Cprg>&lt;asp:button Text=&quot;Submit&quot; OnClick=&quot;abc&quot;
runat=server/&gt;<o:p></o:p></p>

<p class=Cprg>&lt;p&gt;<o:p></o:p></p>

<p class=Cprg>TextBox: <o:p></o:p></p>

<p class=Cprg>&lt;asp:label text='&lt;%# aa.Text %&gt;' runat=server/&gt;<o:p></o:p></p>

<p class=Cprg>&lt;/form&gt;<o:p></o:p></p>

<p class=Cprg>&lt;/body&gt;<o:p></o:p></p>

<p class=Cprg>&lt;/html&gt;<o:p></o:p></p>

<p class=Cbase><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=Coutput><u>Output</u><o:p></o:p></p>

<p class=Coutput><img width=134 height=51 id="_x0000_i1059"
src="chap5img/img32.bmp"><o:p></o:p></p>

<p class=Cbase><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=Cbase>In this example, we have a textbox named 'aa' and a button. When
the button is clicked, it calls the function abc. The text within the label is
the value returned by a &lt;%#. We replace yyy with aa.Text. <o:p></o:p></p>

<p class=Cbase><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=Cbase>The function abc contains the DataBind function which is called
when we click on the button. As before, the tags &lt;%# are searched and
evaluated. If we enter some text in the textbox and click on the button, the
label will reflect the contents of the textbox.<o:p></o:p></p>

<p class=Cbase><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=Cprg><u>a.aspx</u><o:p></o:p></p>

<p class=Cprg>&lt;html&gt;<o:p></o:p></p>

<p class=Cprg>&lt;head&gt;<o:p></o:p></p>

<p class=Cprg>&lt;script language=&quot;C#&quot; runat=&quot;server&quot;&gt;<o:p></o:p></p>

<p class=Cprg>void Page_Load(Object Sender, EventArgs E) <o:p></o:p></p>

<p class=Cprg>{<o:p></o:p></p>

<p class=Cprg>ArrayList v = new ArrayList();<o:p></o:p></p>

<p class=Cprg>v.Add (12);<o:p></o:p></p>

<p class=Cprg>v.Add (113);<o:p></o:p></p>

<p class=Cprg>v.Add (23);<o:p></o:p></p>

<p class=Cprg>l.DataSource = v;<o:p></o:p></p>

<p class=Cprg>l.DataBind();<o:p></o:p></p>

<p class=Cprg>}<o:p></o:p></p>

<p class=Cprg>&lt;/script&gt;<o:p></o:p></p>

<p class=Cprg>&lt;/head&gt;<o:p></o:p></p>

<p class=Cprg>&lt;body&gt;<o:p></o:p></p>

<p class=Cprg>&lt;form runat=server&gt;<o:p></o:p></p>

<p class=Cprg>&lt;asp:DataGrid id=&quot;l&quot; runat=&quot;server&quot; /&gt;<o:p></o:p></p>

<p class=Cprg>&lt;/form&gt;<o:p></o:p></p>

<p class=Cprg>&lt;/body&gt;<o:p></o:p></p>

<p class=Cprg>&lt;/html&gt;<o:p></o:p></p>

<p class=Cbase><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=Coutput><u>Output</u><o:p></o:p></p>

<p class=Coutput><img width=29 height=66 id="_x0000_i1060"
src="chap5img/img33.bmp"><o:p></o:p></p>

<p class=Coutput><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=Cbase>We have learnt how to populate a DataGrid with data from a
database and also from a DataTable. In this program we use an ArrayList class
to fill up the control. <o:p></o:p></p>

<p class=Cbase><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=Cbase>An ArrayList object 'v' is created and then, using the Add
function, this ArrayList object is filled up with data. Next, the DataSource
member of the DataGrid is initialized to 'v'. Thus, we see the three values
added to our ArrayList object in the DataGrid control.<o:p></o:p></p>

<p class=Cbase><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=Cbase>An ArrayList object simply stores a series of values. It can
store an infinite number of values. <o:p></o:p></p>

<p class=Cbase><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=Cprg><u>a.aspx</u><o:p></o:p></p>

<p class=Cprg>&lt;html&gt;<o:p></o:p></p>

<p class=Cprg>&lt;head&gt;<o:p></o:p></p>

<p class=Cprg>&lt;script language=&quot;C#&quot; runat=&quot;server&quot;&gt;<o:p></o:p></p>

<p class=Cprg>void Page_Load(Object Src, EventArgs E) <o:p></o:p></p>

<p class=Cprg>{<o:p></o:p></p>

<p class=Cprg>ArrayList v = new ArrayList();<o:p></o:p></p>

<p class=Cprg>v.Add (10);<o:p></o:p></p>

<p class=Cprg>v.Add (20);<o:p></o:p></p>

<p class=Cprg>v.Add (30);<o:p></o:p></p>

<p class=Cprg>l.DataSource = v;<o:p></o:p></p>

<p class=Cprg>l.DataBind();<o:p></o:p></p>

<p class=Cprg>}<o:p></o:p></p>

<p class=Cprg>String abc(int n) <o:p></o:p></p>

<p class=Cprg>{<o:p></o:p></p>

<p class=Cprg>if ( n &gt;= 15)<o:p></o:p></p>

<p class=Cprg>return &quot;hi&quot;;<o:p></o:p></p>

<p class=Cprg>else<o:p></o:p></p>

<p class=Cprg>return &quot;bye&quot;;<o:p></o:p></p>

<p class=Cprg>}<o:p></o:p></p>

<p class=Cprg>&lt;/script&gt;<o:p></o:p></p>

<p class=Cprg>&lt;/head&gt;<o:p></o:p></p>

<p class=Cprg>&lt;body&gt;<o:p></o:p></p>

<p class=Cprg>&lt;form runat=server&gt;<o:p></o:p></p>

<p class=Cprg>&lt;asp:DataList id=&quot;l&quot; runat=&quot;server&quot;&gt;<o:p></o:p></p>

<p class=Cprg>&lt;ItemTemplate&gt;<o:p></o:p></p>

<p class=Cprg>Vijay: &lt;%# Container.DataItem %&gt; <o:p></o:p></p>

<p class=Cprg>Mukhi: &lt;%# abc((int) Container.DataItem) %&gt;<span
style="mso-spacerun: yes">  </span><o:p></o:p></p>

<p class=Cprg>&lt;/Itemtemplate&gt;<o:p></o:p></p>

<p class=Cprg>&lt;/asp:datalist&gt;<o:p></o:p></p>

<p class=Cprg>&lt;/form&gt;<o:p></o:p></p>

<p class=Cprg>&lt;/body&gt;<o:p></o:p></p>

<p class=Cprg>&lt;/html&gt;<o:p></o:p></p>

<p class=Cbase><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=Coutput><u>Output </u><o:p></o:p></p>

<p class=Coutput>Vijay: 10 Mukhi: bye<span style="mso-spacerun: yes">  </span><o:p></o:p></p>

<p class=Coutput>Vijay: 20 Mukhi: hi<span style="mso-spacerun: yes">  </span><o:p></o:p></p>

<p class=Coutput>Vijay: 30 Mukhi: hi<span style="mso-spacerun: yes">  </span><o:p></o:p></p>

<p class=Cbase><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=Cbase>Data Binding is an extremely powerful concept, since it enables
us to bind anything that we wish to bind. <o:p></o:p></p>

<p class=Cbase><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=Cbase>We have an ArrayList 'v' that has three values of 10, 20 and 30.
A template is created that displays Vijay: and Mukhi :. The rest of the output
is dynamic. <o:p></o:p></p>

<p class=Cbase><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=Cbase>We have a member called Container in a template, that uses the
property DataItem to retrieve the values in the list. With Mukhi:, we go a step
ahead and call the function abc, giving it the values of the ArrayList. <o:p></o:p></p>

<p class=Cbase>If the value contained in 'n' is larger than 15, 'hi' is
returned, otherwise 'bye' is returned. Thus, the output of a function can also
be bound. <o:p></o:p></p>

<p class=Cbase><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=Cbase>The next program uses the DataList control, which is similar to
a DataGrid.<o:p></o:p></p>

<p class=Cbase><span style="mso-spacerun: yes"> </span><o:p></o:p></p>

<p class=Cprg><u>a.aspx</u><o:p></o:p></p>

<p class=Cprg>&lt;%@ Import namespace=&quot;System.Data&quot; %&gt;<o:p></o:p></p>

<p class=Cprg>&lt;html&gt;<o:p></o:p></p>

<p class=Cprg>&lt;head&gt;<o:p></o:p></p>

<p class=Cprg>&lt;script language=&quot;C#&quot; runat=&quot;server&quot;&gt;<o:p></o:p></p>

<p class=Cprg>void Page_Load(Object sender, EventArgs e) <o:p></o:p></p>

<p class=Cprg>{<o:p></o:p></p>

<p class=Cprg>DataTable d = new DataTable();<o:p></o:p></p>

<p class=Cprg>d.Columns.Add(new DataColumn(&quot;c1&quot;,
typeof(Int32)));<span style="mso-spacerun: yes">            </span><o:p></o:p></p>

<p class=Cprg>d.Columns.Add(new DataColumn(&quot;c2&quot;, typeof(bool)));<o:p></o:p></p>

<p class=Cprg>DataRow dr;<o:p></o:p></p>

<p class=Cprg>dr = d.NewRow();<o:p></o:p></p>

<p class=Cprg>dr[0] = 11;<o:p></o:p></p>

<p class=Cprg>dr[1] = true;<o:p></o:p></p>

<p class=Cprg>d.Rows.Add(dr);<o:p></o:p></p>

<p class=Cprg>dr = d.NewRow();<o:p></o:p></p>

<p class=Cprg>dr[0] = 2;<o:p></o:p></p>

<p class=Cprg>dr[1] = false;<o:p></o:p></p>

<p class=Cprg>d.Rows.Add(dr);<o:p></o:p></p>

<p class=Cprg>DataView dv = new DataView(d);<o:p></o:p></p>

<p class=Cprg>l.DataSource = dv;<o:p></o:p></p>

<p class=Cprg>l.DataBind();<o:p></o:p></p>

<p class=Cprg>}<o:p></o:p></p>

<p class=Cprg>&lt;/script&gt;<o:p></o:p></p>

<p class=Cprg>&lt;/head&gt;<o:p></o:p></p>

<p class=Cprg>&lt;body&gt;<o:p></o:p></p>

<p class=Cprg>&lt;form runat=server&gt;<o:p></o:p></p>

<p class=Cprg>&lt;asp:DataList id=&quot;l&quot; runat=&quot;server&quot;&gt;<o:p></o:p></p>

<p class=Cprg>&lt;ItemTemplate&gt;<o:p></o:p></p>

<p class=Cprg>Num: &lt;%# DataBinder.Eval(Container.DataItem, &quot;c1&quot;,
&quot;{0:N2}&quot;) %&gt;<o:p></o:p></p>

<p class=Cprg>Check: &lt;asp:CheckBox id=chk1 Checked='&lt;%#
(bool)DataBinder.Eval(Container.DataItem, &quot;c2&quot;) %&gt;'
runat=server/&gt;<o:p></o:p></p>

<p class=Cprg>&lt;/Itemtemplate&gt;<o:p></o:p></p>

<p class=Cprg>&lt;/asp:Datalist&gt;<o:p></o:p></p>

<p class=Cprg>&lt;/form&gt;<o:p></o:p></p>

<p class=Cprg>&lt;/body&gt;<o:p></o:p></p>

<p class=Cprg>&lt;/html&gt;<o:p></o:p></p>

<p class=Cbase><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=Coutput><u>Output</u><o:p></o:p></p>

<p class=Coutput><img width=149 height=56 id="_x0000_i1061"
src="chap5img/img34.bmp"><o:p></o:p></p>

<p class=Coutput><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=Cbase>This is another program that amply substantiates the importance
of data binding. Here, we have added a new function called DataBinder.Eval,
which accepts three parameters: <o:p></o:p></p>

<p class=Cbase><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=Cbullets><span style='mso-bidi-font-size:12.0pt;font-family:"Times New Roman"'>•<span
style='mso-tab-count:1'>     </span></span>The Container containing the
DataItem.<o:p></o:p></p>

<p class=Cbullets><span style='mso-bidi-font-size:12.0pt;font-family:"Times New Roman"'>•<span
style='mso-tab-count:1'>     </span></span>The column name.<o:p></o:p></p>

<p class=Cbullets><span style='mso-bidi-font-size:12.0pt;font-family:"Times New Roman"'>•<span
style='mso-tab-count:1'>     </span></span>The format.<o:p></o:p></p>

<p class=Cbase><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=Cbase>Num, the first numeric field is displayed with two decimal
places and Check:, the second field accepts a logical value, as the Checked
attribute of the checkbox can be either marked or unmarked. <o:p></o:p></p>

<p class=Cbase><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=Cbase>Note that the second call to the DataBinder.Eval function has
only two parameters instead of three, as no formatting is required here.<o:p></o:p></p>

<p class=Cbase><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=Cprg><u>a.aspx</u><o:p></o:p></p>

<p class=Cprg>&lt;%@ Import Namespace=&quot;System.Data&quot; %&gt;<o:p></o:p></p>

<p class=Cprg>&lt;%@ Import Namespace=&quot;System.Data.SqlClient&quot; %&gt;<o:p></o:p></p>

<p class=Cprg>&lt;html&gt;<o:p></o:p></p>

<p class=Cprg>&lt;script language=&quot;C#&quot; runat=server&gt;<o:p></o:p></p>

<p class=Cprg>void abc(Object sender, EventArgs e) <o:p></o:p></p>

<p class=Cprg>{<o:p></o:p></p>

<p class=Cprg>SqlConnection c = new
SqlConnection(&quot;server=localhost;uid=sa;pwd=;database=pubs&quot;);<o:p></o:p></p>

<p class=Cprg>SqlDataAdapter co = new SqlDataAdapter(&quot;select * from Titles
where type='&quot; + ca.SelectedItem.Value + &quot;'&quot;, c);<o:p></o:p></p>

<p class=Cprg>DataSet ds = new DataSet();<o:p></o:p></p>

<p class=Cprg>co.Fill(ds, &quot;Titles&quot;);<o:p></o:p></p>

<p class=Cprg>l.DataSource = ds.Tables[&quot;Titles&quot;].DefaultView;<o:p></o:p></p>

<p class=Cprg>l.DataBind();<o:p></o:p></p>

<p class=Cprg>}<o:p></o:p></p>

<p class=Cprg>&lt;/script&gt;<o:p></o:p></p>

<p class=Cprg>&lt;body&gt;<o:p></o:p></p>

<p class=Cprg>&lt;form action=&quot;a.aspx&quot; method=&quot;post&quot;
runat=&quot;server&quot;&gt;<o:p></o:p></p>

<p class=Cprg>&lt;asp:dropdownlist id=&quot;ca&quot; runat=server&gt;<o:p></o:p></p>

<p class=Cprg>&lt;asp:listitem &gt;psychology&lt;/asp:listitem&gt;<o:p></o:p></p>

<p class=Cprg>&lt;asp:listitem &gt;business&lt;/asp:listitem&gt;<o:p></o:p></p>

<p class=Cprg>&lt;asp:listitem &gt;popular_comp&lt;/asp:listitem&gt;<o:p></o:p></p>

<p class=Cprg>&lt;/asp:dropdownlist&gt;<o:p></o:p></p>

<p class=Cprg>&lt;asp:button type=submit text=&quot;Lookup&quot;
OnClick=&quot;abc&quot; runat=&quot;server&quot;/&gt;<o:p></o:p></p>

<p class=Cprg>&lt;asp:datalist id=&quot;l&quot; repeatcolumns=&quot;2&quot;
runat=&quot;server&quot;&gt;<o:p></o:p></p>

<p class=Cprg>&lt;Itemtemplate&gt;<o:p></o:p></p>

<p class=Cprg>&lt;img src='&lt;%# DataBinder.Eval(Container.DataItem,
&quot;title_id&quot;, &quot;/quickstart/aspplus/images/title-{0}.gif&quot;)
%&gt;'&gt; &lt;br&gt;<o:p></o:p></p>

<p class=Cprg>&lt;%# DataBinder.Eval(Container.DataItem, &quot;title_id&quot;,
&quot;/quickstart/aspplus/images/title-{0}.gif&quot;) %&gt;'&gt; &lt;br&gt;<o:p></o:p></p>

<p class=Cprg>&lt;%# DataBinder.Eval(Container.DataItem, &quot;title&quot;)
%&gt;&lt;br&gt;<o:p></o:p></p>

<p class=Cprg>Price: &lt;%# DataBinder.Eval(Container.DataItem,
&quot;price&quot;, &quot;${0}&quot;) %&gt; &lt;br&gt;<o:p></o:p></p>

<p class=Cprg>&lt;/Itemtemplate&gt;<o:p></o:p></p>

<p class=Cprg>&lt;/asp:datalist&gt;<o:p></o:p></p>

<p class=Cprg>&lt;/form&gt;<o:p></o:p></p>

<p class=Cprg>&lt;/center&gt;<o:p></o:p></p>

<p class=Cprg>&lt;/body&gt;<o:p></o:p></p>

<p class=Cprg>&lt;/html&gt;<o:p></o:p></p>

<p class=Cbase><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=Cbase>A dropdown listbox with an id of 'ca', displays the names of the
categories. When we click on the button 'LookUp', the function abc gets called.
The code remains almost the same as before, with the exception that '<span
style='font-family:"Trebuchet MS"'>l'</span> now refers to a DataList and not a
DataGrid. The select statement obtains its value from the listbox. <o:p></o:p></p>

<p class=Cbase><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=Cbase>In the form, the DataList has an attribute called repeatcolumns,
which is set to 2. We have initialized it to 2 because we want two books to be
placed side by side. The template property then allows us to decide on the
columns that we want. The first column is an &lt;img&gt; tag. To fill up the
'src' attribute for the image tag, we use DataBinder.Eval for the title_id
field with Container.DataItem as the first parameter. This will display the
picture. The next line will display the address of the file and finally the
third line will display the title.<o:p></o:p></p>

<p class=Cbase><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=Cbase>As the value contained in the title field is PS1372, first the
image /quickstart/aspplus/images/title-PS1372.gif' will be displayed, followed
by the URL which gives the address of the file, and finally, the title of the
book. An image must be present in the subdirectory for it to be displayed.<o:p></o:p></p>

<p class=Cbase><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=Cbase>The price is formatted with a dollar sign.<o:p></o:p></p>

<p class=Cbase><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=Cprg><u>a.aspx</u><o:p></o:p></p>

<p class=Cprg>&lt;%@ Import Namespace=&quot;System.Data&quot; %&gt;<o:p></o:p></p>

<p class=Cprg>&lt;%@ Import Namespace=&quot;System.Data.SqlClient&quot; %&gt;<o:p></o:p></p>

<p class=Cprg>&lt;html&gt;<o:p></o:p></p>

<p class=Cprg>&lt;script language=&quot;C#&quot; runat=server&gt;<o:p></o:p></p>

<p class=Cprg>void abc(Object sender, EventArgs e) <o:p></o:p></p>

<p class=Cprg>{<o:p></o:p></p>

<p class=Cprg>SqlConnection c = new
SqlConnection(&quot;server=localhost;uid=sa;pwd=;database=pubs&quot;);<o:p></o:p></p>

<p class=Cprg>SqlDataAdapter co = new SqlDataAdapter(&quot;select * from
Titles&quot;, c);<o:p></o:p></p>

<p class=Cprg>DataSet ds = new DataSet();<o:p></o:p></p>

<p class=Cprg>co.Fill(ds, &quot;Titles&quot;);<o:p></o:p></p>

<p class=Cprg>l.DataSource = ds.Tables[&quot;Titles&quot;].DefaultView;<o:p></o:p></p>

<p class=Cprg>l.DataBind();<o:p></o:p></p>

<p class=Cprg>}<o:p></o:p></p>

<p class=Cprg>&lt;/script&gt;<o:p></o:p></p>

<p class=Cprg>&lt;body&gt;<o:p></o:p></p>

<p class=Cprg>&lt;form action=&quot;a.aspx&quot; method=&quot;post&quot;
runat=&quot;server&quot;&gt;<o:p></o:p></p>

<p class=Cprg>&lt;asp:button type=submit text=&quot;Lookup&quot;
OnClick=&quot;abc&quot; runat=&quot;server&quot;/&gt;<o:p></o:p></p>

<p class=Cprg>&lt;p&gt;<o:p></o:p></p>

<p class=Cprg>&lt;asp:datalist id=&quot;l&quot; layout=&quot;flow&quot;
showfooter=true borderwidth=0 runat=server&gt;<o:p></o:p></p>

<p class=Cprg>&lt;headertemplate&gt;<o:p></o:p></p>

<p class=Cprg>Header: Product Listing &lt;p&gt;<o:p></o:p></p>

<p class=Cprg>&lt;/headertemplate&gt;<o:p></o:p></p>

<p class=Cprg>&lt;Itemtemplate&gt;<span style="mso-spacerun:
yes">                  </span><o:p></o:p></p>

<p class=Cprg>Item:<o:p></o:p></p>

<p class=Cprg>&lt;%# DataBinder.Eval(Container.DataItem, &quot;title_id&quot;)
%&gt;<o:p></o:p></p>

<p class=Cprg>&lt;%# DataBinder.Eval(Container.DataItem, &quot;title&quot;)
%&gt;<o:p></o:p></p>

<p class=Cprg>&lt;%# DataBinder.Eval(Container.DataItem, &quot;price&quot;,
&quot;${0}&quot;) %&gt; &lt;br&gt;<o:p></o:p></p>

<p class=Cprg>&lt;/Itemtemplate&gt;<o:p></o:p></p>

<p class=Cprg>&lt;separatortemplate&gt;<span style="mso-spacerun:
yes">                  </span><o:p></o:p></p>

<p class=Cprg>Separator: vijay mukhi &lt;p&gt;<o:p></o:p></p>

<p class=Cprg>&lt;/separatortemplate&gt;<o:p></o:p></p>

<p class=Cprg>&lt;footertemplate&gt;<span style="mso-spacerun:
yes">                  </span><o:p></o:p></p>

<p class=Cprg>footer: End &lt;p&gt;<o:p></o:p></p>

<p class=Cprg>&lt;/footertemplate&gt;<o:p></o:p></p>

<p class=Cprg>&lt;/asp:datalist&gt;<o:p></o:p></p>

<p class=Cprg>&lt;/form&gt;<o:p></o:p></p>

<p class=Cprg>&lt;/body&gt;<o:p></o:p></p>

<p class=Cprg>&lt;/html&gt;<o:p></o:p></p>

<p class=Cbase><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=Coutput><u>Output </u><o:p></o:p></p>

<p class=Coutput>Header: Product Listing <o:p></o:p></p>

<p class=Coutput>Item: BU1032But is It User Friendly?$19.99 <o:p></o:p></p>

<p class=Coutput>Separator: vijay mukhi <o:p></o:p></p>

<p class=Coutput>Item: BU1111Cooking with Computers: Surreptitious Balance
Sheets$11.95<span style="mso-spacerun: yes">  </span><o:p></o:p></p>

<p class=Coutput>footer: End<o:p></o:p></p>

<p class=Cbase><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=Cbase>The advantage of using a template is that we have complete flexibility
in deciding the format for displaying the data. The fact that it may be a
DataGrid or a DataList, is of no consequence at all. <o:p></o:p></p>

<p class=Cbase><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=Cbase>Here, we start with a headertemplate that gets displayed only
once in the beginning. Hence, we see Header: Product Listing at the very
beginning. The footertemplate gets displayed only once, but at the end.
Therefore, Footer: End is displayed at the end of the page.<o:p></o:p></p>

<p class=Cbase><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=Cbase>Thereafter, the item template gets displayed once for every
record and the separator template gets displayed between records.<o:p></o:p></p>

<p class=Cbase><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=Cbase><b><span style='font-size:14.0pt;font-family:"Times New Roman"'>Business
Objects<o:p></o:p></span></b></p>

<p class=Cbase><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=Cprg><u>a.aspx</u><o:p></o:p></p>

<p class=Cprg>&lt;html&gt;<o:p></o:p></p>

<p class=Cprg>&lt;script language=&quot;C#&quot; runat=&quot;server&quot;&gt;<o:p></o:p></p>

<p class=Cprg>public void Page_Load(Object sender, EventArgs E)<o:p></o:p></p>

<p class=Cprg>{<o:p></o:p></p>

<p class=Cprg>zzz c = new zzz();<o:p></o:p></p>

<p class=Cprg>string s = c.abc() ;<o:p></o:p></p>

<p class=Cprg>Response.Write(s);<o:p></o:p></p>

<p class=Cprg>}<o:p></o:p></p>

<p class=Cprg>&lt;/script&gt;<o:p></o:p></p>

<p class=Cprg>&lt;/html&gt;<o:p></o:p></p>

<p class=Cbase><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=Coutput>c:\inetpub\wwwroot&gt; md bin<o:p></o:p></p>

<p class=Coutput>c:\inetpub\wwwroot&gt; cd bin<o:p></o:p></p>

<p class=Coutput>c:\inetpub\wwwroot\bin&gt; edit b.cs<o:p></o:p></p>

<p class=Cbase><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=Cprg><u>b.cs</u><o:p></o:p></p>

<p class=Cprg>public class zzz<o:p></o:p></p>

<p class=Cprg>{<o:p></o:p></p>

<p class=Cprg>public System.String abc() <o:p></o:p></p>

<p class=Cprg>{<o:p></o:p></p>

<p class=Cprg>return &quot;hell1&quot;;<o:p></o:p></p>

<p class=Cprg>}<o:p></o:p></p>

<p class=Cprg>}<o:p></o:p></p>

<p class=Cbase><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=Cbase>We run the C# compiler using the following command:<o:p></o:p></p>

<p class=Cbase><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=Coutput>c:\inetpub\wwwroot\bin&gt;csc /target:library b.cs<o:p></o:p></p>

<p class=Cbase><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=Cbase>On loading the aspx program, the framework realizes that it
cannot find a class called zzz. But, before it generates an error, it peeps
into the 'bin' subdirectory of the current directory. Since we have run a.aspx
from wwwroot, it checks for a 'bin' subdirectory that has to lie underneath the
wwwroot directory. Here, it looks into each and every dll for the class zzz. On
locating the specific dll, it executes the function abc from it. <o:p></o:p></p>

<p class=Cbase><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=Cbase>It is important to clarify the fact that this class could have
been written in COBOL for all that we care, but it does not make any difference
here. The class zzz is termed as a business object and it can contain any valid
C# code. <o:p></o:p></p>

<p class=Cbase><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=Cbase>In Page_Load, we are creating a new instance of class zzz and
storing it in the object 'c'. 's' holds the return value of the function abc.
Using the Write function, we display the value of 's'. Thus, the word 'hell' is
displayed because the function abc returns just this string.<o:p></o:p></p>

<p class=Cbase><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=Cbase>While writing code, it is preferable to separate the business
logic from the presentation logic. Thus, in the above case, we have created two
files:<o:p></o:p></p>

<p class=Cbase><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=Cbullets><span style='mso-bidi-font-size:12.0pt;font-family:"Times New Roman"'>•<span
style='mso-tab-count:1'>     </span></span>a.aspx,<span style="mso-spacerun:
yes">  </span>that contains code to display a user interface to the user.<o:p></o:p></p>

<p class=Cbullets><span style='mso-bidi-font-size:12.0pt;font-family:"Times New Roman"'>•<span
style='mso-tab-count:1'>     </span></span>b.cs, that holds code which
understands business logic or business rules. <o:p></o:p></p>

<p class=Cbase><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=Cbase>Thus, whenever a change is required, it is incorporated in the
relevant file, without modifying the other. This is also characterized as
'encapsulating logic in business components'. Thus, we can incorporate multiple
layers in the software world. <o:p></o:p></p>

<p class=Cbase><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=Cbase>ASP+ looks for our business objects in a well-known
sub-directory called 'bin'. Hence, the executables are placed in the 'bin'
subdirectory. Thus, they do not have to be registered at all. The bin<span
style="mso-spacerun: yes">                </span>sub-directory is checked every
time, and when any change is made to the code, it can be recompiled for future
use. Thus, a new copy is automatically used, without restarting the server. <o:p></o:p></p>

<p class=Cbase><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=Cbase>The other advantage of a pre-decided sub-directory is that it
can be assigned 'ftp rights', and the user can then comfortably locate his
files from anywhere in the world.<o:p></o:p></p>

<p class=Cbase><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=Cbase>Under normal circumstances, while you are running an exe
program, you issue a command to delete it, but it will not get deleted since
the file gets locked on the disk. However, such is not the case here. Whenever
a business object is loaded into memory, it does not get locked on the disk. A
shadow copy is loaded in memory, thereby facilitating multiple versions to run
concurrently. Thus, at the very basic or core level, a business component is
nothing but a class.<o:p></o:p></p>

<p class=Cbase><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=Cprg><u>a.aspx</u><o:p></o:p></p>

<p class=Cprg>&lt;%@ Import Namespace=&quot;ddd&quot; %&gt;<o:p></o:p></p>

<p class=Cprg>&lt;html&gt;<o:p></o:p></p>

<p class=Cprg>&lt;script language=&quot;C#&quot; runat=&quot;server&quot;&gt;<o:p></o:p></p>

<p class=Cprg>public void Page_Load(Object sender, EventArgs E)<o:p></o:p></p>

<p class=Cprg>{<o:p></o:p></p>

<p class=Cprg>if (!IsPostBack)<o:p></o:p></p>

<p class=Cprg>{<o:p></o:p></p>

<p class=Cprg>zzz d = new
zzz(&quot;server=(local)\\NetSDK;uid=sa;pwd=;database=grocertogo&quot;);<o:p></o:p></p>

<p class=Cprg>c.DataSource = d.abc();<o:p></o:p></p>

<p class=Cprg>c.DataBind();<o:p></o:p></p>

<p class=Cprg>}<o:p></o:p></p>

<p class=Cprg>}<o:p></o:p></p>

<p class=Cprg>public void abc(Object sender, EventArgs E)<o:p></o:p></p>

<p class=Cprg>{<o:p></o:p></p>

<p class=Cprg>zzz d = new
zzz(&quot;server=(local)\\NetSDK;uid=sa;pwd=;database=grocertogo&quot;);<o:p></o:p></p>

<p class=Cprg>l.DataSource = d.pqr(c.SelectedItem.Value);<o:p></o:p></p>

<p class=Cprg>l.DataBind();<o:p></o:p></p>

<p class=Cprg>}<o:p></o:p></p>

<p class=Cprg>&lt;/script&gt;<o:p></o:p></p>

<p class=Cprg>&lt;body&gt;<o:p></o:p></p>

<p class=Cprg>&lt;form runat=&quot;server&quot;&gt;<o:p></o:p></p>

<p class=Cprg>&lt;ASP:DropDownList id=&quot;c&quot;
DataValueField=&quot;CategoryName&quot; runat=&quot;server&quot;/&gt;<o:p></o:p></p>

<p class=Cprg>&lt;input type=&quot;Submit&quot; OnServerClick=&quot;abc&quot;
Value=&quot;Show&quot; runat=&quot;server&quot;/&gt;&lt;p&gt;<o:p></o:p></p>

<p class=Cprg>&lt;ASP:DataList id=&quot;l&quot; RepeatColumns=&quot;2&quot;
runat=&quot;server&quot;&gt;<o:p></o:p></p>

<p class=Cprg>&lt;Itemtemplate&gt;<o:p></o:p></p>

<p class=Cprg>&lt;ASP:ImageButton command=&quot;Select&quot; ImageUrl='&lt;%#
DataBinder.Eval(Container.DataItem, &quot;ImagePath&quot;) %&gt;'
runat=&quot;server&quot;/&gt;<o:p></o:p></p>

<p class=Cprg>&lt;/Itemtemplate&gt;<o:p></o:p></p>

<p class=Cprg>&lt;/ASP:DataList&gt;<o:p></o:p></p>

<p class=Cprg>&lt;/form&gt; <o:p></o:p></p>

<p class=Cprg>&lt;/body&gt;<o:p></o:p></p>

<p class=Cprg>&lt;/html&gt;<o:p></o:p></p>

<p class=Cprg><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=Cprg><u>b.cs</u><o:p></o:p></p>

<p class=Cprg>namespace ddd<o:p></o:p></p>

<p class=Cprg>{<o:p></o:p></p>

<p class=Cprg>using System;<o:p></o:p></p>

<p class=Cprg>using System.Data;<o:p></o:p></p>

<p class=Cprg>using System.Data.SqlClient;<o:p></o:p></p>

<p class=Cprg><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=Cprg>public class zzz<o:p></o:p></p>

<p class=Cprg>{<o:p></o:p></p>

<p class=Cprg>String s;<o:p></o:p></p>

<p class=Cprg>public zzz(String s1) <o:p></o:p></p>

<p class=Cprg>{<o:p></o:p></p>

<p class=Cprg>s = s1;<o:p></o:p></p>

<p class=Cprg>}<o:p></o:p></p>

<p class=Cprg><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=Cprg>public DataView abc() <o:p></o:p></p>

<p class=Cprg>{<o:p></o:p></p>

<p class=Cprg>SqlConnection c = new SqlConnection(s);<o:p></o:p></p>

<p class=Cprg>SqlDataAdapter co = new SqlDataAdapter(&quot;select distinct
CategoryName from Categories&quot;, c);<o:p></o:p></p>

<p class=Cprg>DataSet ds = new DataSet();<o:p></o:p></p>

<p class=Cprg>co.Fill(ds, &quot;yyy&quot;);<o:p></o:p></p>

<p class=Cprg>return ds.Tables[&quot;yyy&quot;].DefaultView;<o:p></o:p></p>

<p class=Cprg>}<o:p></o:p></p>

<p class=Cprg><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=Cprg>public DataView pqr(String ca) <o:p></o:p></p>

<p class=Cprg>{<o:p></o:p></p>

<p class=Cprg>SqlConnection c = new SqlConnection(s);<o:p></o:p></p>

<p class=Cprg>SqlDataAdapter co = new SqlDataAdapter(&quot;select ImagePath
from Products p,Categories c where c.CategoryName='&quot; + ca + &quot;' and
p.CategoryId = c.CategoryId&quot;, c);<o:p></o:p></p>

<p class=Cprg>DataSet ds = new DataSet();<o:p></o:p></p>

<p class=Cprg>co.Fill(ds, &quot;xxx&quot;);<o:p></o:p></p>

<p class=Cprg>return ds.Tables[&quot;xxx&quot;].DefaultView;<o:p></o:p></p>

<p class=Cprg>}<o:p></o:p></p>

<p class=Cprg>}<o:p></o:p></p>

<p class=Cprg>}<o:p></o:p></p>

<p class=Cbase><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=Coutput>&gt; csc /target:library b.cs <o:p></o:p></p>

<p class=Coutput><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=Cbase>This is a two-tier application. In the file a.aspx, we import
the namespace ddd, since all our business objects are placed in this namespace.
Since it is optional, it may or may not be incorporated. When Page_Load is
called, since IsPostBack is false, we create a business object called zzz,
which resides in b.cs. <o:p></o:p></p>

<p class=Cbase><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=Cbase>This file is placed in the c:\inetpub\wwwroot\bin sub-directory
and has been compiled to create a dll.<span style="mso-spacerun: yes"> 
</span>We will explain the signifance of the bin directory in the next chapter.<o:p></o:p></p>

<p class=Cbase><span style='color:red'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=Cbase><span style='color:black'>The constructor of the zzz class saves
the string parameter containing the connection string, in an instance variable
called 's'. There is a drop down listbox having an id 'c', that displays the
list of categories whose products we would like to see. We initialize the
DataSource member of the listbox from our business object zzz to the value
returned by the function abc. </span><o:p></o:p></p>

<p class=Cbase><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=Cbase>The function abc in b.cs creates a new SqlConnection using the
string passed in the constructor, which is now available in the instance
variable 's'. We then select only one field named, CategoryName from the
Categories table, and prefix it with the word 'distinct'. As we had mentioned
earlier, in SQL Language, the word 'distinct' represents unique records. <o:p></o:p></p>

<p class=Cbase><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=Cbase>As you may have observed in this entire chapter, we have created
a DataSet and returned a DataView object of yyy. This represents three records
in our case, namely, 'Cereals', 'Milk' and 'Soda'.<o:p></o:p></p>

<p class=Cbase><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=Cbase>When the function abc finishes execution in the aspx file, the
data is bound to the control. Since we have chosen the property DataValueField
in control 'c' to be CategoryName, only the values in the CategoryName are
displayed in the listbox. It is essential for us to populate the listbox from
the database. We have made a specific mention of it here, incase you have
overlooked this fact. We can choose any category and then click on the button
labeled 'Show'.<o:p></o:p></p>

<p class=Cbase><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=Cbase>In the function abc located in the aspx file, we have created a
new instance of type zzz and passed it the same parameters as that of the
constructor. The DataSource object of the DataList<span style='font-family:
"Trebuchet MS"'> l,</span> is initialized by the function pqr in the class zzz.
This function is assigned one parameter which is the item or the category
selected from the drop down listbox. <o:p></o:p></p>

<p class=Cbase><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=Cbase>The functionality of the function pqr is the same as that of the
function abc, except for the SQL Select statement. The select statement that is
a link of two tables, i.e. Products and Categories, is given one field called
ImagePath, and the filter is set to the category that is selected from the
listbox. Thus, the DataView that is returned, contains only those products that
fall in the selected category.<o:p></o:p></p>

<p class=Cbase><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=Cbase>If you click on the button, you will see images on your screen.
This is because we have customized the template for the DataList object. A tag
called ImageButton, with the property ImageUrl containing the name of a picture
file, is placed in the template. This path name is taken from the ImagePath
field, using the Eval function. <o:p></o:p></p>

<p class=Cbase><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=Cbase>Thus, we have bifurcated our code into two: <o:p></o:p></p>

<p class=Cbase><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=Cbullets><span style='mso-bidi-font-size:12.0pt;font-family:"Times New Roman"'>•<span
style='mso-tab-count:1'>     </span></span>The database handling issues are in
a business object within the file b.cs<o:p></o:p></p>

<p class=Cbullets><span style='mso-bidi-font-size:12.0pt;font-family:"Times New Roman"'>•<span
style='mso-tab-count:1'>     </span></span>The presentation issues in the file
a.aspx.<o:p></o:p></p>

<p class=Cbase><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=Cbase>We normally use business objects to perform data access.
However, when this code is placed in an external component or object, it
becomes easier for others to understand our code. Thus, it separates the User
Interface issues from the Backend.<o:p></o:p></p>

<p class=Cbase><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=Cbase>We would like to list out the two reasons for working on the
samples provided by Microsoft:<o:p></o:p></p>

<p class=Cbase><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=Cbullets><span style='mso-bidi-font-size:12.0pt;font-family:"Times New Roman"'>•<span
style='mso-tab-count:1'>     </span></span>We are working with a beta copy. So,
when we are experimenting with code, we cannot be sure whether it is a mistake
on our part, or a bug in the beta copy.<o:p></o:p></p>

<p class=Cbullets><span style='mso-bidi-font-size:12.0pt;font-family:"Times New Roman"'>•<span
style='mso-tab-count:1'>     </span></span>Various tables and pictures are
readily available to us.<o:p></o:p></p>

<p class=Cbase><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=Cbase><b><span style='font-size:14.0pt;font-family:"Times New Roman"'>Three
Tier applications<o:p></o:p></span></b></p>

<p class=Cbase><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=Cprg><u>a.aspx</u><o:p></o:p></p>

<p class=Cprg>&lt;%@ Import Namespace=&quot;n1&quot; %&gt;<o:p></o:p></p>

<p class=Cprg>&lt;html&gt;<o:p></o:p></p>

<p class=Cprg>&lt;script language=&quot;C#&quot; runat=&quot;server&quot;&gt;<o:p></o:p></p>

<p class=Cprg>public void Page_Load(Object sender, EventArgs E)<o:p></o:p></p>

<p class=Cprg>{<o:p></o:p></p>

<p class=Cprg>if (!IsPostBack)<o:p></o:p></p>

<p class=Cprg>{<o:p></o:p></p>

<p class=Cprg>bbb b = new bbb();<o:p></o:p></p>

<p class=Cprg>c.DataSource = b.abc();<o:p></o:p></p>

<p class=Cprg>c.DataBind();<o:p></o:p></p>

<p class=Cprg>}<o:p></o:p></p>

<p class=Cprg>}<o:p></o:p></p>

<p class=Cprg>public void abc(Object sender, EventArgs E)<o:p></o:p></p>

<p class=Cprg>{<o:p></o:p></p>

<p class=Cprg>int id = 0;<o:p></o:p></p>

<p class=Cprg>if (cid.Text != &quot;&quot;)<o:p></o:p></p>

<p class=Cprg>id = Int32.Parse(cid.Text);<o:p></o:p></p>

<p class=Cprg>bbb b = new bbb();<o:p></o:p></p>

<p class=Cprg>l.DataSource = b.pqr(c.SelectedItem.Value,id);<o:p></o:p></p>

<p class=Cprg>l.DataBind();<o:p></o:p></p>

<p class=Cprg>}<o:p></o:p></p>

<p class=Cprg>&lt;/script&gt;<o:p></o:p></p>

<p class=Cprg>&lt;body &gt;<o:p></o:p></p>

<p class=Cprg>&lt;form runat=&quot;server&quot;&gt;<o:p></o:p></p>

<p class=Cprg>&lt;ASP:DropDownList id=&quot;c&quot;
DataValueField=&quot;CategoryName&quot; runat=&quot;server&quot;/&gt;<o:p></o:p></p>

<p class=Cprg>&lt;ASP:TextBox id=&quot;cid&quot; Width=&quot;35&quot; runat=&quot;server&quot;/&gt;
<o:p></o:p></p>

<p class=Cprg>&lt;input type=&quot;Submit&quot; OnServerClick=&quot;abc&quot;
Value=&quot;fetch&quot; runat=&quot;server&quot;/&gt;<o:p></o:p></p>

<p class=Cprg>&lt;ASP:DataList id=&quot;l&quot; RepeatColumns=&quot;2&quot;
runat=&quot;server&quot;&gt;<o:p></o:p></p>

<p class=Cprg>&lt;Itemtemplate&gt;<o:p></o:p></p>

<p class=Cprg>&lt;ASP:ImageButton command=&quot;Select&quot; ImageUrl='&lt;%#
DataBinder.Eval(Container.DataItem, &quot;ImagePath&quot;) %&gt;'
runat=&quot;server&quot;/&gt;<o:p></o:p></p>

<p class=Cprg>&lt;%# DataBinder.Eval(Container.DataItem,
&quot;ProductName&quot;) %&gt; <o:p></o:p></p>

<p class=Cprg>&lt;br&gt;<o:p></o:p></p>

<p class=Cprg>&lt;%# DataBinder.Eval(Container.DataItem, &quot;UnitPrice&quot;,
&quot;{0:C}&quot;).ToString() %&gt;<o:p></o:p></p>

<p class=Cprg>&lt;br&gt;<o:p></o:p></p>

<p class=Cprg>&lt;/Itemtemplate&gt;<o:p></o:p></p>

<p class=Cprg>&lt;/ASP:DataList&gt;<o:p></o:p></p>

<p class=Cprg>&lt;/form&gt; <o:p></o:p></p>

<p class=Cprg>&lt;/body&gt;<o:p></o:p></p>

<p class=Cprg>&lt;/html&gt;<o:p></o:p></p>

<p class=Cprg><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=Cprg><u>b.cs</u><o:p></o:p></p>

<p class=Cprg>namespace n1<o:p></o:p></p>

<p class=Cprg>{<o:p></o:p></p>

<p class=Cprg>using System;<o:p></o:p></p>

<p class=Cprg>using System.Data;<o:p></o:p></p>

<p class=Cprg>using System.Data.SqlClient;<o:p></o:p></p>

<p class=Cprg>using n2;<o:p></o:p></p>

<p class=Cprg>public class bbb<o:p></o:p></p>

<p class=Cprg>{<o:p></o:p></p>

<p class=Cprg>ccc da;<o:p></o:p></p>

<p class=Cprg>public bbb() <o:p></o:p></p>

<p class=Cprg>{<o:p></o:p></p>

<p class=Cprg>da = new
ccc(&quot;server=(local)\\NetSDK;uid=sa;pwd=;database=grocertogo&quot;);<o:p></o:p></p>

<p class=Cprg>}<o:p></o:p></p>

<p class=Cprg>public DataView abc() <o:p></o:p></p>

<p class=Cprg>{<o:p></o:p></p>

<p class=Cprg>return da.abc1();<o:p></o:p></p>

<p class=Cprg>}<o:p></o:p></p>

<p class=Cprg>public DataView pqr(String c, int id) <o:p></o:p></p>

<p class=Cprg>{<o:p></o:p></p>

<p class=Cprg>DataView v = da.pqr1(c);<o:p></o:p></p>

<p class=Cprg>double d = 0;<o:p></o:p></p>

<p class=Cprg>if (id<span style="mso-spacerun: yes">  </span>&lt;= 25 )<o:p></o:p></p>

<p class=Cprg>d = .50; <o:p></o:p></p>

<p class=Cprg>else<o:p></o:p></p>

<p class=Cprg>d = 1.50; <o:p></o:p></p>

<p class=Cprg>for (int i=0; i&lt;v.Count; i++)<o:p></o:p></p>

<p class=Cprg>{<o:p></o:p></p>

<p class=Cprg>v[i][&quot;UnitPrice&quot;] =
Double.Parse(v[i][&quot;UnitPrice&quot;].ToString()) - d;<o:p></o:p></p>

<p class=Cprg>}<o:p></o:p></p>

<p class=Cprg>return v;<o:p></o:p></p>

<p class=Cprg>}<o:p></o:p></p>

<p class=Cprg>}<o:p></o:p></p>

<p class=Cprg>}<o:p></o:p></p>

<p class=Cprg><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=Cprg><u>c.cs</u><o:p></o:p></p>

<p class=Cprg>namespace n2<o:p></o:p></p>

<p class=Cprg>{<o:p></o:p></p>

<p class=Cprg>using System;<o:p></o:p></p>

<p class=Cprg>using System.Data;<o:p></o:p></p>

<p class=Cprg>using System.Data.SqlClient;<o:p></o:p></p>

<p class=Cprg>public class ccc<o:p></o:p></p>

<p class=Cprg>{<o:p></o:p></p>

<p class=Cprg>String s;<o:p></o:p></p>

<p class=Cprg>public ccc(String s1) <o:p></o:p></p>

<p class=Cprg>{<o:p></o:p></p>

<p class=Cprg>s = s1;<o:p></o:p></p>

<p class=Cprg>}<o:p></o:p></p>

<p class=Cprg>public String ConnectionString <o:p></o:p></p>

<p class=Cprg>{<o:p></o:p></p>

<p class=Cprg>get <o:p></o:p></p>

<p class=Cprg>{<o:p></o:p></p>

<p class=Cprg>return s;<o:p></o:p></p>

<p class=Cprg>}<o:p></o:p></p>

<p class=Cprg>set <o:p></o:p></p>

<p class=Cprg>{<o:p></o:p></p>

<p class=Cprg>s = value;<o:p></o:p></p>

<p class=Cprg>}<o:p></o:p></p>

<p class=Cprg>}<o:p></o:p></p>

<p class=Cprg>public DataView abc1() <o:p></o:p></p>

<p class=Cprg>{<o:p></o:p></p>

<p class=Cprg>SqlConnection c = new SqlConnection(s);<o:p></o:p></p>

<p class=Cprg>SqlDataAdapter co = new SqlDataAdapter(&quot;select distinct
CategoryName from Categories&quot;,c);<o:p></o:p></p>

<p class=Cprg>DataSet ds = new DataSet();<o:p></o:p></p>

<p class=Cprg>co.Fill(ds, &quot;uuu&quot;);<o:p></o:p></p>

<p class=Cprg>return ds.Tables[&quot;uuu&quot;].DefaultView;<o:p></o:p></p>

<p class=Cprg>}<o:p></o:p></p>

<p class=Cprg>public DataView pqr1(String ca) <o:p></o:p></p>

<p class=Cprg>{<o:p></o:p></p>

<p class=Cprg>SqlConnection c = new SqlConnection(s);<o:p></o:p></p>

<p class=Cprg>SqlDataAdapter co = new SqlDataAdapter(&quot;select ProductName,
ImagePath, UnitPrice, c.CategoryId<span style="mso-spacerun: yes">  </span>from
Products p, Categories c where c.CategoryName='&quot; + ca + &quot;' and
p.CategoryId = c.CategoryId&quot;,c);<o:p></o:p></p>

<p class=Cprg>DataSet ds = new DataSet();<o:p></o:p></p>

<p class=Cprg>co.Fill(ds, &quot;yyy&quot;);<o:p></o:p></p>

<p class=Cprg>return ds.Tables[&quot;yyy&quot;].DefaultView;<o:p></o:p></p>

<p class=Cprg>}<o:p></o:p></p>

<p class=Cprg>}<o:p></o:p></p>

<p class=Cprg>}<o:p></o:p></p>

<p class=Cbase><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=Cbase>This example is large in size and is spread over three files. It
introduces a few more concepts. We first compile c.cs as follows:<o:p></o:p></p>

<p class=Cbase><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=Coutput>&gt;csc /target:library c.cs /R:system.data.dll /R:system.dll<o:p></o:p></p>

<p class=Cbase><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=Cbase>And then, we compile b.cs as follows:<o:p></o:p></p>

<p class=Cbase><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=Coutput>&gt;csc /target:library b.cs /R:system.data.dll /R:system.dll
/R:c.dll<o:p></o:p></p>

<p class=Coutput><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=Cbase>The file b.cs refers to the code present in the file c.cs.
Hence, c.dll is incorporated while creating the file b.dll. We do not observe
any major difference in the output from the earlier programs. <o:p></o:p></p>

<p class=Cbase><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=Cbase>Let us now understand how it works.<o:p></o:p></p>

<p class=Cbase>'bbb b = new bbb()' will take us to the file b.cs because, the
class bbb dwells in it. Within the constructor, we are simply creating a new
object named ccc and giving it the connection string. <o:p></o:p></p>

<p class=Cbase><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=Cbase>The object ccc is located in c.cs. The constructor of this class
simply initializes the instance variable 's' to the data supplied to it in the
form of parameters. The database handling tasks are performed in ccc. <o:p></o:p></p>

<p class=Cbase><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=Cbase>The DataSource for the DropDownList 'c' is initialized by
calling the function abc from the object 'b'. The object abc in the class bbb
in turn, calls the function abc1 from the class ccc. This function then fetches
unique categories from the Categories Table and returns the DefaultView of the
DataSet. Earlier, this code was in the class bbb. <o:p></o:p></p>

<p class=Cbase><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=Cbase>The statement<span style='font-family:"Trebuchet MS"'> l.</span>DataSource
= b.pqr(c.SelectedItem.Value,id) in the function abc, will call the function
pqr in the file b.cs with two parameters,<span style="mso-spacerun: yes"> 
</span>viz. the string 'c' that contains the category, and the customer id,
which is contained in an int variable called 'id'. <o:p></o:p></p>

<p class=Cbase><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=Cbase>In this function, the DataView object 'v' is initialized to the
output of pqr1 from ccc. This function takes one parameter, viz. the category.
In the file c.cs, the function pqr fills data into the DataView, after fetching
it from the two tables named Products and Category. These values are obtained
only from three fields.<o:p></o:p></p>

<p class=Cbase><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=Cbase>Once the Data is ready, the customer number received in id is
then verified to check whether it is less than or equal to 25. Accordingly, the
double variable 'd', that stands for the discount, is assigned a value of .5 or
1.5.<o:p></o:p></p>

<p class=Cbase><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=Cbase>The DataView object 'v' has a member called Count, which gives a
count of the records present in the object. Using the array notation v[i], we
refer to the individual records and then give the
indexer[&quot;UnitPrice&quot;] to access the field. Our intention is to reduce
the price or UnitPrice by the amount of discount offered to the customers. So,
we retrieve the value in the UnitPrice field and convert it into a string.
Thereafter, we Parse it and finally subtract the discount from it. <o:p></o:p></p>

<p class=Cbase><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=Cbase>Thus, in the above program, the class bbb contains the business
logic for calculating the discount, while the class ccc contains the data
handling routines. Such type of applications are called Three Tier
Applications. The second layer or the middle layer is also called middleware.
Thus, software written for the business world comprises of database retrieval,
as well as, business logic. <o:p></o:p></p>

<p class=Cbase><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=Cbase>Before we end this chapter, one more program that displays the
data contained in the ArrayLists. <o:p></o:p></p>

<p class=Cprg><span style='font-size:10.0pt;font-family:"Bookman Old Style"'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=Cprg><u>a.aspx</u><o:p></o:p></p>

<p class=Cprg>&lt;html&gt;<o:p></o:p></p>

<p class=Cprg>&lt;head&gt;<o:p></o:p></p>

<p class=Cprg>&lt;script language=&quot;C#&quot; runat=&quot;server&quot;&gt;<o:p></o:p></p>

<p class=Cprg>void Page_Load(Object Sender, EventArgs e) <o:p></o:p></p>

<p class=Cprg>{<o:p></o:p></p>

<p class=Cprg>if (!Page.IsPostBack) <o:p></o:p></p>

<p class=Cprg>{<o:p></o:p></p>

<p class=Cprg>ArrayList v = new ArrayList();<o:p></o:p></p>

<p class=Cprg>v.Add(new ppp(&quot;Vijay&quot;, &quot;Mukhi&quot;, &quot;150
Rs&quot;));<o:p></o:p></p>

<p class=Cprg>v.Add(new ppp(&quot;Sonal&quot;, &quot;VMCI&quot;, &quot;25
Dollars&quot;));<o:p></o:p></p>

<p class=Cprg>r.DataSource = v;<o:p></o:p></p>

<p class=Cprg>r.DataBind();<o:p></o:p></p>

<p class=Cprg>}<o:p></o:p></p>

<p class=Cprg>}<o:p></o:p></p>

<p class=Cprg>void abc(object sender, RepeaterCommandEventArgs e) <o:p></o:p></p>

<p class=Cprg>{<o:p></o:p></p>

<p class=Cprg>l.Text = e.CommandName + &quot; &quot; + e.CommandArgument;<o:p></o:p></p>

<p class=Cprg>}<o:p></o:p></p>

<p class=Cprg>public class ppp<o:p></o:p></p>

<p class=Cprg>{<o:p></o:p></p>

<p class=Cprg>string n;<o:p></o:p></p>

<p class=Cprg>string t;<o:p></o:p></p>

<p class=Cprg>string s;<o:p></o:p></p>

<p class=Cprg>public ppp(string n1, string t1, string s1) <o:p></o:p></p>

<p class=Cprg>{<o:p></o:p></p>

<p class=Cprg>n = n1;<o:p></o:p></p>

<p class=Cprg>t = t1;<o:p></o:p></p>

<p class=Cprg>s = s1;<o:p></o:p></p>

<p class=Cprg>}<o:p></o:p></p>

<p class=Cprg>public string name <o:p></o:p></p>

<p class=Cprg>{<o:p></o:p></p>

<p class=Cprg>get <o:p></o:p></p>

<p class=Cprg>{<o:p></o:p></p>

<p class=Cprg>return n;<o:p></o:p></p>

<p class=Cprg>}<o:p></o:p></p>

<p class=Cprg>}<o:p></o:p></p>

<p class=Cprg>public string tick <o:p></o:p></p>

<p class=Cprg>{<o:p></o:p></p>

<p class=Cprg>get <o:p></o:p></p>

<p class=Cprg>{<o:p></o:p></p>

<p class=Cprg>return t;<o:p></o:p></p>

<p class=Cprg>}<o:p></o:p></p>

<p class=Cprg>}<o:p></o:p></p>

<p class=Cprg>public string share<o:p></o:p></p>

<p class=Cprg>{<o:p></o:p></p>

<p class=Cprg>get <o:p></o:p></p>

<p class=Cprg>{<o:p></o:p></p>

<p class=Cprg>return s;<o:p></o:p></p>

<p class=Cprg>}<o:p></o:p></p>

<p class=Cprg>}<o:p></o:p></p>

<p class=Cprg>}<o:p></o:p></p>

<p class=Cprg>&lt;/script&gt;<o:p></o:p></p>

<p class=Cprg>&lt;/head&gt;<o:p></o:p></p>

<p class=Cprg>&lt;body&gt;<o:p></o:p></p>

<p class=Cprg>&lt;form runat=server&gt;<o:p></o:p></p>

<p class=Cprg>&lt;asp:Repeater id=r onitemcommand=&quot;abc&quot;
runat=&quot;server&quot;&gt;<o:p></o:p></p>

<p class=Cprg>&lt;ItemTemplate&gt;<o:p></o:p></p>

<p class=Cprg>&lt;asp:Button Text=&quot;Buy&quot; CommandName=&quot;buy&quot;
CommandArgument='&lt;%# DataBinder.Eval(Container.DataItem, &quot;tick&quot;)
%&gt;' runat=&quot;server&quot; /&gt;<o:p></o:p></p>

<p class=Cprg>&lt;asp:Button Text=&quot;Sell&quot; CommandName=&quot;sell&quot;
CommandArgument='&lt;%# DataBinder.Eval(Container.DataItem, &quot;share&quot;)
%&gt;' runat=&quot;server&quot; /&gt;<o:p></o:p></p>

<p class=Cprg>&lt;asp:Label Text='&lt;%# DataBinder.Eval(Container.DataItem,
&quot;name&quot;) %&gt;' runat=server /&gt;<o:p></o:p></p>

<p class=Cprg>&lt;p&gt;<o:p></o:p></p>

<p class=Cprg>&lt;/Itemtemplate&gt;<o:p></o:p></p>

<p class=Cprg>&lt;/asp:Repeater&gt;<o:p></o:p></p>

<p class=Cprg>&lt;asp:Label id=l runat=&quot;server&quot; /&gt;<o:p></o:p></p>

<p class=Cprg>&lt;/form&gt;<o:p></o:p></p>

<p class=Cprg>&lt;/body&gt;<o:p></o:p></p>

<p class=Cprg>&lt;/html&gt;<o:p></o:p></p>

<p class=Cbase><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=Coutput><u>Output<o:p></o:p></u></p>

<p class=Coutput><img width=115 height=72 id="_x0000_i1062"
src="chap5img/img35.bmp"></p>

<p class=Cbase><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=Cbase>A new aspx control, by the name of Repeater, has been introduced
here. It has an id of 'r' and it calls the function abc whenever it is clicked.
A Repeater Control functions like a 'for' statement or a loop. <o:p></o:p></p>

<p class=Cbase><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=Cbase>The controls specified within the template are repeated for each
item in the DataSource property of the repeater. To prove this, in the
Page_Load function, we create an array that has three items of type ppp. This
class has three properties, i.e. name, tick and share. In the constructor, the
instance variables are initialized to the constructor parameters and then
returned in the properties. Also, the DataSource property of Repeater is
initialized to the ArrayList obejct. Thus, the repeater control will repeat the
template tag twice for these two values of Vijay and Sonal.<o:p></o:p></p>

<p class=Cbase><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=Cbase>On loading the above file, we see two buttons having the labels
of Buy and Sell. These are the values assigned to the Text attribute. The label
calls the Eval function with the DataItem as the first parameter, and the name
of a property as the second parameter. Thus, the value returned by the property
name will be displayed on the screen. <o:p></o:p></p>

<p class=Cbase><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=Cbase>The function abc is called when we click on the button. The
second parameter 'e' to the function abc, is an instance of
RepeaterCommandEventArgs. It has two useful members. One of them is
CommandName, which returns the value of a property called CommandName in the
button, i.e. Buy or Sell. The second member is CommandArgument, that contains
either the property value tick or share, depending upon the button that we
click on. The values in these two members are finally displayed in the label. <o:p></o:p></p>

<p class=Cbase><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=Cbase>Thus, the buttons can be associated with some value from a
database and we can bubble up these values to identify the button that has been
clicked on.</p>

<p class=MsoNormal><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=MsoNormal><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=MsoNormal><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=MsoNormal><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=MsoNormal><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=MsoNormal><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=MsoNormal><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=MsoNormal><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

</div>

</body>


<!-- Mirrored from www.vijaymukhi.com/documents/books/aspnet1/chap5.htm by HTTrack Website Copier/3.x [XR&CO'2014], Fri, 11 Oct 2024 13:44:33 GMT -->
</html>
