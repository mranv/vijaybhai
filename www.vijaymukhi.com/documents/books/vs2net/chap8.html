<html xmlns:v="urn:schemas-microsoft-com:vml"
xmlns:o="urn:schemas-microsoft-com:office:office"
xmlns:w="urn:schemas-microsoft-com:office:word"
xmlns="http://www.w3.org/TR/REC-html40">


<!-- Mirrored from www.vijaymukhi.com/documents/books/vs2net/chap8.htm by HTTrack Website Copier/3.x [XR&CO'2014], Fri, 11 Oct 2024 14:12:49 GMT -->
<head>
<meta http-equiv=Content-Type content="text/html; charset=windows-1252">
<meta name=ProgId content=Word.Document>
<meta name=Generator content="Microsoft Word 9">
<meta name=Originator content="Microsoft Word 9">
<link rel=File-List href="chap8_files/filelist.html">
<link rel=Edit-Time-Data href="chap8_files/editdata.html">
<!--[if !mso]>
<style>
v\:* {behavior:url(#default#VML);}
o\:* {behavior:url(#default#VML);}
w\:* {behavior:url(#default#VML);}
.shape {behavior:url(#default#VML);}
</style>
<![endif]-->
<title>Visual Studio.Net - Controls and Add-ins</title>
<!--[if gte mso 9]><xml>
 <o:DocumentProperties>
  <o:Author>vmukhi</o:Author>
  <o:LastAuthor>vmukhi</o:LastAuthor>
  <o:Revision>39</o:Revision>
  <o:TotalTime>44</o:TotalTime>
  <o:Created>2002-01-21T06:12:00Z</o:Created>
  <o:LastSaved>2002-02-05T08:23:00Z</o:LastSaved>
  <o:Pages>26</o:Pages>
  <o:Words>8902</o:Words>
  <o:Characters>50742</o:Characters>
  <o:Company>V.M.C.I.</o:Company>
  <o:Lines>422</o:Lines>
  <o:Paragraphs>101</o:Paragraphs>
  <o:CharactersWithSpaces>62314</o:CharactersWithSpaces>
  <o:Version>9.2720</o:Version>
 </o:DocumentProperties>
</xml><![endif]-->
<style>
<!--
 /* Font Definitions */
@font-face
	{font-family:Tahoma;
	panose-1:2 11 6 4 3 5 4 4 2 4;
	mso-font-charset:0;
	mso-generic-font-family:swiss;
	mso-font-pitch:variable;
	mso-font-signature:553679495 -2147483648 8 0 66047 0;}
@font-face
	{font-family:"Bookman Old Style";
	panose-1:2 5 6 4 5 5 5 2 2 4;
	mso-font-charset:0;
	mso-generic-font-family:roman;
	mso-font-pitch:variable;
	mso-font-signature:647 0 0 0 159 0;}
@font-face
	{font-family:"Trebuchet MS";
	panose-1:2 11 6 3 2 2 2 2 2 4;
	mso-font-charset:0;
	mso-generic-font-family:swiss;
	mso-font-pitch:variable;
	mso-font-signature:7 0 0 0 19 0;}
@font-face
	{font-family:"Monotype Corsiva";
	panose-1:3 1 1 1 1 2 1 1 1 1;
	mso-font-charset:0;
	mso-generic-font-family:script;
	mso-font-pitch:variable;
	mso-font-signature:647 0 0 0 159 0;}
 /* Style Definitions */
p.MsoNormal, li.MsoNormal, div.MsoNormal
	{mso-style-parent:"";
	margin:0in;
	margin-bottom:.0001pt;
	mso-pagination:widow-orphan;
	font-size:12.0pt;
	font-family:"Times New Roman";
	mso-fareast-font-family:"Times New Roman";}
p.ILbase, li.ILbase, div.ILbase
	{mso-style-name:ILbase;
	mso-style-parent:"";
	margin:0in;
	margin-bottom:.0001pt;
	text-align:justify;
	mso-pagination:widow-orphan;
	mso-layout-grid-align:none;
	text-autospace:none;
	font-size:10.0pt;
	font-family:"Bookman Old Style";
	mso-fareast-font-family:"Times New Roman";
	mso-bidi-font-family:"Times New Roman";
	color:black;}
p.VSBASE, li.VSBASE, div.VSBASE
	{mso-style-name:"VS BASE";
	mso-style-parent:"";
	margin:0in;
	margin-bottom:.0001pt;
	text-align:justify;
	mso-pagination:widow-orphan;
	mso-layout-grid-align:none;
	text-autospace:none;
	font-size:10.0pt;
	font-family:"Bookman Old Style";
	mso-fareast-font-family:"Times New Roman";
	mso-bidi-font-family:"Times New Roman";
	color:black;}
p.ILprg, li.ILprg, div.ILprg
	{mso-style-name:ILprg;
	mso-style-parent:ILbase;
	mso-style-next:ILbase;
	margin-top:0in;
	margin-right:0in;
	margin-bottom:0in;
	margin-left:.5in;
	margin-bottom:.0001pt;
	mso-pagination:widow-orphan;
	mso-layout-grid-align:none;
	text-autospace:none;
	font-size:9.5pt;
	font-family:"Trebuchet MS";
	mso-fareast-font-family:"Times New Roman";
	mso-bidi-font-family:"Times New Roman";}
p.ILoutput, li.ILoutput, div.ILoutput
	{mso-style-name:ILoutput;
	mso-style-parent:ILbase;
	mso-style-next:ILbase;
	margin-top:0in;
	margin-right:0in;
	margin-bottom:0in;
	margin-left:.5in;
	margin-bottom:.0001pt;
	mso-pagination:widow-orphan;
	mso-layout-grid-align:none;
	text-autospace:none;
	font-size:9.5pt;
	font-family:Tahoma;
	mso-fareast-font-family:"Times New Roman";}
p.ILbullets, li.ILbullets, div.ILbullets
	{mso-style-name:ILbullets;
	mso-style-parent:ILbase;
	margin-top:0in;
	margin-right:0in;
	margin-bottom:0in;
	margin-left:.3in;
	margin-bottom:.0001pt;
	text-align:justify;
	mso-pagination:widow-orphan;
	mso-layout-grid-align:none;
	text-autospace:none;
	font-size:10.0pt;
	font-family:"Bookman Old Style";
	mso-fareast-font-family:"Times New Roman";
	mso-bidi-font-family:"Times New Roman";}
@page Section1
	{size:8.5in 11.0in;
	margin:1.0in 1.25in 1.0in 1.25in;
	mso-header-margin:.5in;
	mso-footer-margin:.5in;
	mso-paper-source:0;}
div.Section1
	{page:Section1;}
-->
</style>
</head>

<body lang=EN-US style='tab-interval:.5in'>

<div class=Section1>

<p class=MsoNormal><img width=103 height=77 id="_x0000_i1025"
src="../img/bpb.html"></p>

<p class=MsoNormal style='mso-layout-grid-align:none;text-autospace:none'><span
style='font-size:24.0pt;font-family:"Monotype Corsiva"'>8.<o:p></o:p></span></p>

<p class=MsoNormal><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=MsoNormal style='mso-layout-grid-align:none;text-autospace:none'><span
style='font-size:24.0pt;font-family:"Monotype Corsiva"'>Capturing Events </span><span
style='font-size:20.0pt;font-family:"Monotype Corsiva"'><o:p></o:p></span></p>

<p class=ILbase><span style='color:windowtext'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=ILbase><span style='color:windowtext'>Before we proceed with the
explanation of the above program, we call upon you to copy the following code. <o:p></o:p></span></p>

<p class=ILbase><span style='color:windowtext'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=ILprg>namespace vij25</p>

<p class=ILprg>{</p>

<p class=ILprg>using System;</p>

<p class=ILprg>using Microsoft.Office.Core;</p>

<p class=ILprg>using Extensibility;</p>

<p class=ILprg>using System.Runtime.InteropServices;</p>

<p class=ILprg>using EnvDTE;</p>

<p class=ILprg>using System.Windows.Forms;</p>

<p class=ILprg>[GuidAttribute(&quot;00271586-C6A9-44EF-A342-2E63FFD4D384&quot;),
ProgId(&quot;vij25.Connect&quot;)]</p>

<p class=ILprg>public class Connect : Object, Extensibility.IDTExtensibility2</p>

<p class=ILprg>{</p>

<p class=ILprg>public Connect() </p>

<p class=ILprg>{</p>

<p class=ILprg>MessageBox.Show(&quot;Connect&quot;);</p>

<p class=ILprg>}</p>

<p class=ILprg>public void OnConnection(object application, ext_ConnectMode c,
object addInInst, ref System.Array custom)</p>

<p class=ILprg>{</p>

<p class=ILprg>DTE applicationObject = (DTE)application;</p>

<p class=ILprg>Windows w = applicationObject.Windows;</p>

<p class=ILprg>Window ww = w.Item(Constants.vsWindowKindOutput);</p>

<p class=ILprg>OutputWindow o = (OutputWindow)ww.Object;</p>

<p class=ILprg>OutputWindowPanes oo =<span style="mso-spacerun: yes"> 
</span>o.OutputWindowPanes;</p>

<p class=ILprg>OutputWindowPane op;<span style='mso-tab-count:1'>  </span></p>

<p class=ILprg>op = oo.Add(&quot;Vijay Mukhi&quot;);</p>

<p class=ILprg>op.OutputString(&quot;Sonal is my wife&quot;);</p>

<p class=ILprg>}</p>

<p class=ILprg>public void OnDisconnection(Extensibility.ext_DisconnectMode
disconnectMode, ref System.Array custom)</p>

<p class=ILprg>{</p>

<p class=ILprg>}</p>

<p class=ILprg>public void OnAddInsUpdate(ref System.Array custom) </p>

<p class=ILprg>{ </p>

<p class=ILprg>}</p>

<p class=ILprg>public void OnStartupComplete(ref System.Array custom)</p>

<p class=ILprg>{</p>

<p class=ILprg>}</p>

<p class=ILprg>public void OnBeginShutdown(ref System.Array custom)</p>

<p class=ILprg>{</p>

<p class=ILprg>}</p>

<p class=ILprg>}</p>

<p class=ILprg>}</p>

<p class=ILbase><span style='color:windowtext'>The last four functions of the
interface would remain empty more often than not. Nonetheless, their presence
in the code is imperative, since they belong to the interface. <o:p></o:p></span></p>

<p class=ILbase><span style='color:windowtext'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=ILbase><span style='color:windowtext'>Build the solution. You must
ensure that the Output window is projected on the screen. If it is not complied
with, then click on the View menu, followed by the Other Windows menu option,
and select Output Window, as demonstrated in screen 8.1.<o:p></o:p></span></p>

<p class=ILbase><span style='color:windowtext'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<table border=0 cellspacing=0 cellpadding=0 style='border-collapse:collapse;
 mso-padding-alt:0in 5.4pt 0in 5.4pt'>
 <tr>
  <td valign=top style='padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal><img width=400 height=300 id="_x0000_i1026"
  src="chap8/1.html"></p>
  </td>
  <td valign=top style='padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal><img width=400 height=300 id="_x0000_i1027"
  src="chap8/2.html"></p>
  </td>
 </tr>
 <tr>
  <td valign=top style='padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal>Screen 8.1</p>
  </td>
  <td valign=top style='padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal>Screen 8.2</p>
  </td>
 </tr>
</table>

<p class=ILbase><span style='color:windowtext'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=ILbase><span style='color:windowtext'>Thereafter, activate the Add-in.
The Output Window would display a screen, as is evident in screen 8.2. Vijay
Mukhi is sighted as the sub-title of the Output Window, which also contains
some text in it. Thus, we have devised an Add-in that writes to the Output
window, provided that the Output window is visible. <o:p></o:p></span></p>

<p class=ILbase><span style='color:windowtext'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=ILbase><span style='color:windowtext'>This Add-in does not activate
the Output window, but it writes to this window. The View menu can be exploited
to activate it at any point of time. As always, the real action lies in the
OnConnection function. Firstly, a handle to the DTE object is acquired, and
then, the windows present in the Visual Studio.Net are accessed. <o:p></o:p></span></p>

<p class=ILbase><span style='color:windowtext'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=ILbase><span style='color:windowtext'>The Windows class is a
compendium of the numerous windows that inhabit the Visual Studio. It is an
interface that is derived from IDispatch. Since it is not the entire collection
of windows but a single window that has caught our fancy, the indexer stands
out as the most favorable option. However, in this situation, the powers to be
insist on the usage of a method called Item to access a single window. The
parameter to this function is of type object, consequently any data type may be
availed. <o:p></o:p></span></p>

<p class=ILbase><span style='color:windowtext'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=ILbase><span style='color:windowtext'>The Item function is then
assigned an enum named Constants from the EnvDTE namespace, and also a value
vsWindowKindOutput, which solicits a handle to the Output Window type. The
return value is stored in an object ww of type Window. <o:p></o:p></span></p>

<p class=ILbase><span style='color:windowtext'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=ILbase><span style='color:windowtext'>This Window object ww contains a
property object, which returns a window. It is this particular window that can be
accessed and used at run time. This signifies the fact that the Window object
is incapable of being used directly. It can only be reached indirectly using
the Object property. <o:p></o:p></span></p>

<p class=ILbase><span style='color:windowtext'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=ILbase><span style='color:windowtext'>The Output window has an
interface OutputWindow, which is also derived from IDispatch. The task of the
Output window is to display the text output of the various tools, such as the
C# compiler. Since a sizeable number of tools exist, the Output window is
divided into panes, which can be selected from a drop-down listbox. Each tool
is competent enough to create its own pane and write into it. <o:p></o:p></span></p>

<p class=ILbase><span style='color:windowtext'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=ILbase><span style='color:windowtext'>Tools that are written in the
appropriate manner should only write into their own panes. Thus, there is a
need to create a pane first. Towards this end, the property OutputWindowPanes
is employed. It returns an OutputWindowPanes object, which represents a
collection of panes in the Output window. <o:p></o:p></span></p>

<p class=ILbase><span style='color:windowtext'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=ILbase><span style='color:windowtext'>Using the Add function, an
additional pane named Vijay Mukhi is added to the Output window. Concurrently,
the newly created OutputWindowPane object is stored in the variable op. Then,
the OutputString function is called to write the desired text in the window.
Thus, the text can be written into any window in Visual Studio.Net with
effortless ease. <o:p></o:p></span></p>

<p class=ILbase><span style='color:windowtext'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=ILprg>namespace vij25</p>

<p class=ILprg>{</p>

<p class=ILprg>using System;</p>

<p class=ILprg>using Microsoft.Office.Core;</p>

<p class=ILprg>using Extensibility;</p>

<p class=ILprg>using System.Runtime.InteropServices;</p>

<p class=ILprg>using EnvDTE;</p>

<p class=ILprg>using System.Windows.Forms;</p>

<p class=ILprg>[GuidAttribute(&quot;00271586-C6A9-44EF-A342-2E63FFD4D384&quot;),
ProgId(&quot;vij25.Connect&quot;)]</p>

<p class=ILprg>public class Connect : Object, Extensibility.IDTExtensibility2</p>

<p class=ILprg>{</p>

<p class=ILprg>public Connect()</p>

<p class=ILprg>{</p>

<p class=ILprg>MessageBox.Show(&quot;Connect&quot;);</p>

<p class=ILprg>}</p>

<p class=ILprg>OutputWindowPane op;<span style='mso-tab-count:1'>  </span></p>

<p class=ILprg>WindowEvents we;</p>

<p class=ILprg>public void OnConnection(object application, ext_ConnectMode c,
object addInInst, ref System.Array custom)</p>

<p class=ILprg>{</p>

<p class=ILprg>DTE applicationObject = (DTE)application;</p>

<p class=ILprg>Windows w = applicationObject.Windows;</p>

<p class=ILprg>Events e = applicationObject.Events;</p>

<p class=ILprg>we = e.get_WindowEvents(null);</p>

<p class=ILprg>we.WindowClosing += new
_dispWindowEvents_WindowClosingEventHandler(wClosing);</p>

<p class=ILprg>we.WindowActivated += new
_dispWindowEvents_WindowActivatedEventHandler(wActivated);</p>

<p class=ILprg>we.WindowCreated += new
_dispWindowEvents_WindowCreatedEventHandler(wCreated);</p>

<p class=ILprg>we.WindowMoved += new
_dispWindowEvents_WindowMovedEventHandler(wMoved);</p>

<p class=ILprg>Window ww = w.Item(Constants.vsWindowKindOutput);</p>

<p class=ILprg>OutputWindow o = (OutputWindow)ww.Object;</p>

<p class=ILprg>OutputWindowPanes oo =<span style="mso-spacerun: yes"> 
</span>o.OutputWindowPanes;</p>

<p class=ILprg>op = oo.Add(&quot;Vijay Mukhi&quot;);</p>

<p class=ILprg>op.OutputString(&quot;In Connection\n&quot;);</p>

<p class=ILprg>}</p>

<p class=ILprg>public void OnDisconnection(Extensibility.ext_DisconnectMode
disconnectMode, ref System.Array custom)</p>

<p class=ILprg>{</p>

<p class=ILprg>we.WindowClosing -= new _dispWindowEvents_WindowClosingEventHandler(wClosing);</p>

<p class=ILprg>we.WindowActivated -= new
_dispWindowEvents_WindowActivatedEventHandler(wActivated);</p>

<p class=ILprg>we.WindowCreated -= new
_dispWindowEvents_WindowCreatedEventHandler(wCreated);</p>

<p class=ILprg>we.WindowMoved -= new
_dispWindowEvents_WindowMovedEventHandler(wMoved);</p>

<p class=ILprg>}</p>

<p class=ILprg>public void OnAddInsUpdate(ref System.Array custom)</p>

<p class=ILprg>{</p>

<p class=ILprg>}</p>

<p class=ILprg>public void OnStartupComplete(ref System.Array custom)</p>

<p class=ILprg>{</p>

<p class=ILprg>}</p>

<p class=ILprg>public void OnBeginShutdown(ref System.Array custom)</p>

<p class=ILprg>{</p>

<p class=ILprg>}</p>

<p class=ILprg>public void wClosing(EnvDTE.Window a)</p>

<p class=ILprg>{</p>

<p class=ILprg>op.OutputString(&quot;Window Closing Name: &quot; + a.Caption +
&quot;\n&quot;);</p>

<p class=ILprg>}</p>

<p class=ILprg>public void wActivated(EnvDTE.Window a, EnvDTE.Window b)</p>

<p class=ILprg>{</p>

<p class=ILprg>op.OutputString(&quot;Window Activated Name &quot; + a.Caption +
&quot; Deactivated &quot; + b.Caption + &quot;\n&quot;);</p>

<p class=ILprg>}</p>

<p class=ILprg>public void wCreated(EnvDTE.Window a)</p>

<p class=ILprg>{</p>

<p class=ILprg>op.OutputString(&quot;Window Created &quot; + a.Caption +
&quot;\n&quot;);</p>

<p class=ILprg>}</p>

<p class=ILprg>public void wMoved(Window a, int top, int left, int width, int
height)</p>

<p class=ILprg>{</p>

<p class=ILprg>op.OutputString(&quot;Window Moved &quot; + a.Caption + &quot;
&quot; + top.ToString() + &quot; &quot; + left.ToString() + &quot;\n&quot;);</p>

<p class=ILprg>}</p>

<p class=ILprg>}</p>

<p class=ILprg>}</p>

<p class=ILbase><span style='color:windowtext'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=ILbase><span style='color:windowtext'>The aforementioned instance
captures Windows events as and when they occur, and then, it displays them in
the Output window. The previous example had brought out the technique of
writing text in a window. Hence, we have refrained from laying too much
emphasis on this aspect here. <o:p></o:p></span></p>

<p class=ILbase><span style='color:windowtext'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=ILbase><span style='color:windowtext'>The Events property returns an
Events collection, which is a cluster of all events that could ever crop up.
Since our prime concern is only the Windows events, the property WindowEvents
is taken cognizance of. It takes a parameter whose value is null at this instance.
This can be a Window object if the events to a single window are to be taken
into consideration. Thus, this parameter acts as a filter, where the value of
null is specified at the time when all the events have to be captured. <o:p></o:p></span></p>

<p class=ILbase><span style='color:windowtext'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=ILbase><span style='color:windowtext'>The class WindowsEvents has four
events, and each of them is associated with a function through a delegate.
Thus, whenever an event is triggered, the automation model calls the relevant
function. The programmer enjoys the license to enter the code in these
functions. <o:p></o:p></span></p>

<p class=ILbase><span style='color:windowtext'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=ILbase><span style='color:windowtext'>We shall now shed sufficient
light upon each and every event, and shall also elucidate the parameters with
which the functions get called. <o:p></o:p></span></p>

<p class=ILbase><span style='color:windowtext'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=ILbase><span style='color:windowtext'>The first event is
WindowClosing, which calls the function wClosing each time a window is closed.
To activate this event, simply close a window. On doing so, the function
wClosing gets called. This function is furnished with a Window object of the
window that is being closed. The crux of the matter is that this function gets
called before the window actually closes. <o:p></o:p></span></p>

<p class=ILbase><span style='color:windowtext'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=ILbase><span style='color:windowtext'>In all the Window events, only
the Caption of the window is displayed. However, you are at liberty to display
all the properties, if you so desire. <o:p></o:p></span></p>

<p class=ILbase><span style='color:windowtext'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=ILbase><span style='color:windowtext'>The screen 8.3 exhibits the
additional line in the Output window. The event of WindowActivated occurs whenever
a window obtains focus or gets activated. <o:p></o:p></span></p>

<p class=ILbase><span style='color:windowtext'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<table border=0 cellspacing=0 cellpadding=0 style='border-collapse:collapse;
 mso-padding-alt:0in 5.4pt 0in 5.4pt'>
 <tr>
  <td valign=top style='padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal><img width=400 height=300 id="_x0000_i1028"
  src="chap8/3.html"></p>
  </td>
 </tr>
 <tr>
  <td valign=top style='padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal>Screen 8.3</p>
  </td>
 </tr>
</table>

<p class=ILbase><span style='color:windowtext'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=ILbase><span style='color:windowtext'>This event occurs only after the
environment is absolutely ready or initialized. Moreover, the first window that
receives focus does not trigger this event. <o:p></o:p></span></p>

<p class=ILbase><span style='color:windowtext'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=ILbase><span style='color:windowtext'>The rationale behind it is that
the event calls a function with two parameters. The first parameter is a Window
object that receives focus. The second parameter is the Window object that has
just lost focus. Thus, to activate this event, click on any window and observe
the Output Window. <o:p></o:p></span></p>

<p class=ILbase><span style='color:windowtext'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=ILbase><span style='color:windowtext'>The third event is
WindowCreated, which occurs whenever a window is created. A window can be
created by merely opting for the menu option Window, followed by the option New
Window. The function that is called, is passed the handle of the newly created
window. <o:p></o:p></span></p>

<p class=ILbase><span style='color:windowtext'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=ILbase><span style='color:windowtext'>Finally, the last event of
WindowMoved occurs whenever a window is moved. To move a window, click on the
title bar of the window, and without releasing the mouse, drag the window
around. <o:p></o:p></span></p>

<p class=ILbase><span style='color:windowtext'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=ILbase><span style='color:windowtext'>The first parameter is the
Window object being moved and the next four parameters indicate the new
location of the window. The four points refer to the top and left position,
along with the width and the height. The program displays the top and left
parameters. You may also display the others if you so desire. <o:p></o:p></span></p>

<p class=ILbase><span style='color:windowtext'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=ILbase><span style='color:windowtext'>Thus, whenever any program or a
user activates either of the four abovementioned events, the functions that are
associated with the events, are called to first identify the affected window. <o:p></o:p></span></p>

<p class=ILbase><span style='color:windowtext'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=ILbase><span style='color:windowtext'>This is all there is to the
automation world. Believe us, there is no information kept under wraps!
Therefore, it becomes a simple task to activate a user-defined code whenever a
Windows event occurs. <o:p></o:p></span></p>

<p class=ILbase><span style='color:windowtext'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=ILbase><span style='color:windowtext'>The function OnDisconnection
gets executed whenever the Add-in is downloaded. So, basic courtesy demands
that you clean up your act before marching forward. If this is not done, then
no code would be available to handle the events. The -= syntax is used to
displace the function from the event. <o:p></o:p></span></p>

<p class=ILbase><span style='color:windowtext'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=ILbase><span style='color:windowtext'>We wish to enlighten those of
you who are still uninitiated, that functions can be added using the +=
syntax.<span style="mso-spacerun: yes">  </span><o:p></o:p></span></p>

<p class=ILbase><span style='color:windowtext'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=ILprg>public void wMoved(Window a, int top, int left, int width, int
height)</p>

<p class=ILprg>{</p>

<p class=ILprg>op.OutputString(&quot;Window Moved &quot; + a.Caption + &quot;
&quot; + top.ToString() + &quot; &quot; + left.ToString() + &quot;\n&quot;);</p>

<p class=ILprg>a.Caption = &quot;Sonal Mukhi&quot;;</p>

<p class=ILprg>}</p>

<p class=ILbase><span style='color:windowtext'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=ILbase><span style='color:windowtext'>A minor modification has been
introduced in the above program, whereby a single line of code has been added
to the wMoved function. <o:p></o:p></span></p>

<p class=ILbase><span style='color:windowtext'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=ILbase><span style='color:windowtext'>The caption of the window can be
accessed using the Caption property, which is a read-write property. Here, it
is changed to 'Sonal Mukhi'. Thus, each time the window is moved, the caption
of the window changes to 'Sonal Mukhi'. Screen 8.4 flaunts the Output Window
with its new caption. <o:p></o:p></span></p>

<p class=ILbase><span style='color:windowtext'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<table border=0 cellspacing=0 cellpadding=0 style='border-collapse:collapse;
 mso-padding-alt:0in 5.4pt 0in 5.4pt'>
 <tr>
  <td valign=top style='padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal><img width=400 height=300 id="_x0000_i1029"
  src="chap8/4.html"></p>
  </td>
 </tr>
 <tr>
  <td valign=top style='padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal>Screen 8.4</p>
  </td>
 </tr>
</table>

<p class=ILbase><span style='color:windowtext'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=ILbase><span style='color:windowtext'>Thus, the properties of the window
can now be changed effortlessly, whenever a specific Window event occurs.<o:p></o:p></span></p>

<p class=ILbase><span style='color:windowtext'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=ILbase><span style='color:windowtext'>The ensuing example tackles the
events present in the Events collection. The basic structure of the program
remains unaltered. There are a large number of events to trap. So, without
further ado, we launch into writing separate programs for each of the events.<o:p></o:p></span></p>

<p class=ILbase><span style='color:windowtext'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=ILprg>namespace vij25<span style="mso-spacerun: yes">  </span>{</p>

<p class=ILprg>using System;</p>

<p class=ILprg>using Microsoft.Office.Core;</p>

<p class=ILprg>using Extensibility;</p>

<p class=ILprg>using System.Runtime.InteropServices;</p>

<p class=ILprg>using EnvDTE;</p>

<p class=ILprg>using System.Windows.Forms;</p>

<p class=ILprg>[GuidAttribute(&quot;00271586-C6A9-44EF-A342-2E63FFD4D384&quot;),
ProgId(&quot;vij25.Connect&quot;)]</p>

<p class=ILprg>public class Connect : Object, Extensibility.IDTExtensibility2</p>

<p class=ILprg>{</p>

<p class=ILprg>public Connect()</p>

<p class=ILprg>{</p>

<p class=ILprg>MessageBox.Show(&quot;Connect&quot;);</p>

<p class=ILprg>}</p>

<p class=ILprg>OutputWindowPane op;<span style='mso-tab-count:1'>  </span></p>

<p class=ILprg>TextEditorEvents texte;</p>

<p class=ILprg>public void OnConnection(object application, ext_ConnectMode c,
object addInInst, ref System.Array custom)</p>

<p class=ILprg>{</p>

<p class=ILprg>DTE applicationObject = (DTE)application;</p>

<p class=ILprg>Windows w = applicationObject.Windows;</p>

<p class=ILprg>Events e = applicationObject.Events;</p>

<p class=ILprg>texte = e.get_TextEditorEvents(null);</p>

<p class=ILprg>texte.LineChanged += new
_dispTextEditorEvents_LineChangedEventHandler(tLineChanged);</p>

<p class=ILprg>Window ww = w.Item(Constants.vsWindowKindOutput);</p>

<p class=ILprg>OutputWindow o = (OutputWindow)ww.Object;</p>

<p class=ILprg>OutputWindowPanes oo =<span style="mso-spacerun: yes"> 
</span>o.OutputWindowPanes;</p>

<p class=ILprg>op = oo.Add(&quot;Vijay Mukhi&quot;);</p>

<p class=ILprg>}</p>

<p class=ILprg>public void OnDisconnection(Extensibility.ext_DisconnectMode
disconnectMode, ref System.Array custom)</p>

<p class=ILprg>{</p>

<p class=ILprg>texte.LineChanged -= new
_dispTextEditorEvents_LineChangedEventHandler(tLineChanged);</p>

<p class=ILprg>}</p>

<p class=ILprg>public void OnAddInsUpdate(ref System.Array custom) { }</p>

<p class=ILprg>public void OnStartupComplete(ref System.Array custom) { }</p>

<p class=ILprg>public void OnBeginShutdown(ref System.Array custom) { }</p>

<p class=ILprg>public void tLineChanged(TextPoint s, TextPoint e, int h)</p>

<p class=ILprg>{</p>

<p class=ILprg>vsTextChanged t = (vsTextChanged)h;</p>

<p class=ILprg>op.OutputString(&quot;TextEditor &quot; + s.DisplayColumn.ToString()
+ &quot; &quot; + e.DisplayColumn.ToString() + &quot; &quot; +
e.Line.ToString());</p>

<p class=ILprg>op.OutputString(&quot; Name: &quot; + s.Parent.Parent.Name);</p>

<p class=ILprg>op.OutputString(&quot; hint: &quot; + t.ToString() +
&quot;\n&quot;);</p>

<p class=ILprg>}</p>

<p class=ILprg>}</p>

<p class=ILprg>}</p>

<p class=ILbase><span style='color:windowtext'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=ILbase><span style='color:windowtext'>The next event to be captured is
the TextEditorEvents. This is achieved by using the property TextEditorEvents
and assigning it a TextDocument object type, which currently holds a value of
null. The events are to be monitored for the parameter, which is the
TextDocument object. Fortunately, the TextEditorEvents contains only a solitary
event called LineChanged. <o:p></o:p></span></p>

<p class=ILbase><span style='color:windowtext'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=ILbase><span style='color:windowtext'>This event gets fired whenever
any changes are incorporated in a line in the Code Editor, and the insertion
point is moved. The texte variable of type TextEditorEvents is used to
initialize the LineChanged event, thus resulting in a call to the coupled
function tLineChanged. <o:p></o:p></span></p>

<p class=ILbase><span style='color:windowtext'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=ILbase><span style='color:windowtext'>Then, the above function is
eliminated from the OnDisconnection function. The function tLineChanged gets
called with three parameters. The first two are TextPoint objects, which
represent the start and end points of the line that is being modified.
Basically, a TextPoint object represents a location in the Code Editor. Thus,
this object can be used to determine any location or point in the text
document. <o:p></o:p></span></p>

<p class=ILbase><span style='color:windowtext'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=ILbase><span style='color:windowtext'>To understand the exact course
of things around here, move to any line in the Code Editor and press the Enter
key. The first TextPoint object 's' indicates the start column number, as seen
in screen 8.5. The property DisplayColumn displays this value. <o:p></o:p></span></p>

<p class=ILbase><span style='color:windowtext'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<table border=0 cellspacing=0 cellpadding=0 style='border-collapse:collapse;
 mso-padding-alt:0in 5.4pt 0in 5.4pt'>
 <tr>
  <td valign=top style='padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal><img width=400 height=300 id="_x0000_i1030"
  src="chap8/5.html"></p>
  </td>
 </tr>
 <tr>
  <td valign=top style='padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal>Screen 8.5</p>
  </td>
 </tr>
</table>

<p class=ILbase><span style='color:windowtext'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=ILbase><span style='color:windowtext'>The end TextPoint parameter
evidently prints a value of 1, since the Enter key moves the cursor to the
beginning of a new line. The Line property denotes the line number where the
cursor is currently blinking, while the Parent property provides the name of
the file. The last parameter is not an int, but an enum or a constant named
vsChanged. <o:p></o:p></span></p>

<p class=ILbase><span style='color:windowtext'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=ILbase><span style='color:windowtext'>This constant can assume one of
the following values in order to communicate the change that has occurred in
the text document:-<o:p></o:p></span></p>

<p class=ILbullets><span style='mso-bidi-font-size:12.0pt;font-family:"Times New Roman"'>•<span
style='mso-tab-count:1'>     </span></span>A value of 1 signifies that multiple
lines have been affected, which happens when a great deal of text is inserted.</p>

<p class=ILbullets><span style='mso-bidi-font-size:12.0pt;font-family:"Times New Roman"'>•<span
style='mso-tab-count:1'>     </span></span>A value of 2 implies that a line was
committed to disk by saving the file. </p>

<p class=ILbullets><span style='mso-bidi-font-size:12.0pt;font-family:"Times New Roman"'>•<span
style='mso-tab-count:1'>     </span></span>A value of 4 signifies that the
insertion point has been moved.</p>

<p class=ILbullets><span style='mso-bidi-font-size:12.0pt;font-family:"Times New Roman"'>•<span
style='mso-tab-count:1'>     </span></span>A value of 8 represents the 'replace
all' operation. </p>

<p class=ILbullets><span style='mso-bidi-font-size:12.0pt;font-family:"Times New Roman"'>•<span
style='mso-tab-count:1'>     </span></span>A value of 16 indicates that a new
line was created.</p>

<p class=ILbullets><span style='mso-bidi-font-size:12.0pt;font-family:"Times New Roman"'>•<span
style='mso-tab-count:1'>     </span></span>A value of 20 means that the Enter key
was pressed, since it denotes that the cursor or insertion point was moved and
a new line was created. </p>

<p class=ILbullets><span style='mso-bidi-font-size:12.0pt;font-family:"Times New Roman"'>•<span
style='mso-tab-count:1'>     </span></span>A value of 32 symbolizes the 'find
all' operation.</p>

<p class=ILbase><span style='color:windowtext'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=ILbase><span style='color:windowtext'>This is how the changes that
have transpired in the Text Editor, can be identified.<o:p></o:p></span></p>

<p class=ILbase><span style='color:windowtext'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=ILprg>public void tLineChanged(TextPoint s, TextPoint e, int h)</p>

<p class=ILprg>{</p>

<p class=ILprg>vsTextChanged t = (vsTextChanged)h;</p>

<p class=ILprg>op.OutputString(&quot;TextEditor &quot; +
s.DisplayColumn.ToString() + &quot; &quot; + e.DisplayColumn.ToString() +
&quot; &quot; + e.Line.ToString());</p>

<p class=ILprg>op.OutputString(&quot; Name: &quot; + s.Parent.Parent.Name);</p>

<p class=ILprg>op.OutputString(&quot; hint: &quot; + t.ToString() +
&quot;\n&quot;);</p>

<p class=ILprg>EditPoint ee = s.CreateEditPoint();</p>

<p class=ILprg>ee.Insert(&quot;Sonal Mukhi&quot;);</p>

<p class=ILprg>ee.ChangeCase(20,vsCaseOptions.vsCaseOptionsUppercase);</p>

<p class=ILprg>}</p>

<p class=ILbase><span style='color:windowtext'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=ILbase><span style='color:windowtext'>Now, add three lines to the
function tLineChanged. An EndPoint class allows text to be manipulated either
in the Code Editor or in the text document. An EndPoint is created by employing
the end TextPoint object e and the function CreateEndPoint. <o:p></o:p></span></p>

<p class=ILbase><span style='color:windowtext'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=ILbase><span style='color:windowtext'>After introducing the above
Add-in, move the cursor to the comma that is located after the first parameter
on the line containing the tLineChanged function. Press the Enter key at this
position. The changes that occur in the editor are reflected in screen 8.6.<o:p></o:p></span></p>

<p class=ILbase><span style='color:windowtext'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<table border=0 cellspacing=0 cellpadding=0 style='border-collapse:collapse;
 mso-padding-alt:0in 5.4pt 0in 5.4pt'>
 <tr>
  <td valign=top style='padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal><img width=400 height=300 id="_x0000_i1031"
  src="chap8/6.html"></p>
  </td>
 </tr>
 <tr>
  <td valign=top style='padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal>Screen 8.6</p>
  </td>
 </tr>
</table>

<p class=ILbase><span style='color:windowtext'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=ILbase><span style='color:windowtext'>Sonal Mukhi gets inserted at
that position. This is a fallout of the Insert function. Thereafter, the
remaining characters are converted to upper case by the ChangeCase function.
The ChangeCase function takes the remaining 20 characters as the first
parameter value, and converts them to the case specified in the second
parameter. <o:p></o:p></span></p>

<p class=ILbase><span style='color:windowtext'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=ILbase><span style='color:windowtext'>The second parameter is an enum
that can assume any one of three different values. <o:p></o:p></span></p>

<p class=ILbullets><span style='mso-bidi-font-size:12.0pt;font-family:"Times New Roman"'>•<span
style='mso-tab-count:1'>     </span></span>The value of vsCaseOptionsUppercase
converts all the characters to capitals.</p>

<p class=ILbullets><span style='mso-bidi-font-size:12.0pt;font-family:"Times New Roman"'>•<span
style='mso-tab-count:1'>     </span></span>The second option converts all the
characters to lower case.</p>

<p class=ILbullets><span style='mso-bidi-font-size:12.0pt;font-family:"Times New Roman"'>•<span
style='mso-tab-count:1'>     </span></span>The third option capitalizes only
the first character of every word.</p>

<p class=ILbase><span style='color:windowtext'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=ILbase><span style='color:windowtext'>The keystone here is that each
and every character can be manipulated within the Code Editor. <o:p></o:p></span></p>

<p class=ILbase><span style='color:windowtext'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=ILprg>namespace vij25 {</p>

<p class=ILprg>using System;</p>

<p class=ILprg>using Microsoft.Office.Core;</p>

<p class=ILprg>using Extensibility;</p>

<p class=ILprg>using System.Runtime.InteropServices;</p>

<p class=ILprg>using EnvDTE;</p>

<p class=ILprg>using System.Windows.Forms;</p>

<p class=ILprg>[GuidAttribute(&quot;00271586-C6A9-44EF-A342-2E63FFD4D384&quot;),
ProgId(&quot;vij25.Connect&quot;)]</p>

<p class=ILprg>public class Connect : Object, Extensibility.IDTExtensibility2</p>

<p class=ILprg>{</p>

<p class=ILprg>public Connect() {</p>

<p class=ILprg>MessageBox.Show(&quot;Connect&quot;);</p>

<p class=ILprg>}</p>

<p class=ILprg>OutputWindowPane op;</p>

<p class=ILprg>TaskListEvents taske;</p>

<p class=ILprg>public void OnConnection(object application, ext_ConnectMode c,
object addInInst, ref System.Array custom)</p>

<p class=ILprg>{</p>

<p class=ILprg>DTE applicationObject = (DTE)application;</p>

<p class=ILprg>Windows w = applicationObject.Windows;</p>

<p class=ILprg>Events e = applicationObject.Events;</p>

<p class=ILprg>Window ww = w.Item(Constants.vsWindowKindOutput);</p>

<p class=ILprg>OutputWindow o = (OutputWindow)ww.Object;</p>

<p class=ILprg>OutputWindowPanes oo =<span style="mso-spacerun: yes"> 
</span>o.OutputWindowPanes;</p>

<p class=ILprg>op = oo.Add(&quot;Vijay Mukhi&quot;);</p>

<p class=ILprg>taske = e.get_TaskListEvents(&quot;&quot;);</p>

<p class=ILprg>taske.TaskAdded += new
_dispTaskListEvents_TaskAddedEventHandler(tAdded);</p>

<p class=ILprg>taske.TaskModified += new _dispTaskListEvents_TaskModifiedEventHandler(tModified);</p>

<p class=ILprg>taske.TaskNavigated += new
_dispTaskListEvents_TaskNavigatedEventHandler(tNavigated);</p>

<p class=ILprg>taske.TaskRemoved += new
_dispTaskListEvents_TaskRemovedEventHandler(tRemoved);</p>

<p class=ILprg>}</p>

<p class=ILprg>public void OnDisconnection(Extensibility.ext_DisconnectMode
disconnectMode, ref System.Array custom)</p>

<p class=ILprg>{</p>

<p class=ILprg>taske.TaskAdded -= new
_dispTaskListEvents_TaskAddedEventHandler(tAdded);</p>

<p class=ILprg>taske.TaskModified -= new
_dispTaskListEvents_TaskModifiedEventHandler(tModified);</p>

<p class=ILprg>taske.TaskNavigated -= new
_dispTaskListEvents_TaskNavigatedEventHandler(tNavigated);</p>

<p class=ILprg>taske.TaskRemoved -= new
_dispTaskListEvents_TaskRemovedEventHandler(tRemoved);</p>

<p class=ILprg>}</p>

<p class=ILprg>public void tAdded(TaskItem t)</p>

<p class=ILprg>{</p>

<p class=ILprg>op.OutputString(&quot;Added &quot; + t.Description +
&quot;\n&quot;);</p>

<p class=ILprg>}</p>

<p class=ILprg>public void tModified(TaskItem t, vsTaskListColumn c)</p>

<p class=ILprg>{</p>

<p class=ILprg>op.OutputString(&quot;Modified<span style="mso-spacerun: yes"> 
</span>&quot; + t.Description + &quot;\n&quot;);</p>

<p class=ILprg>}</p>

<p class=ILprg>public void tNavigated(TaskItem t, ref bool h)</p>

<p class=ILprg>{</p>

<p class=ILprg>op.OutputString(&quot;Navigated &quot; + t.Description +
&quot;\n&quot;);</p>

<p class=ILprg>}</p>

<p class=ILprg>public void tRemoved(TaskItem t)</p>

<p class=ILprg>{</p>

<p class=ILprg>op.OutputString(&quot;Removed<span style="mso-spacerun: yes"> 
</span>&quot; + t.Description + &quot;\n&quot;);</p>

<p class=ILprg>}</p>

<p class=ILprg>public void OnAddInsUpdate(ref System.Array custom) { }</p>

<p class=ILprg>public void OnStartupComplete(ref System.Array custom) { }</p>

<p class=ILprg>public void OnBeginShutdown(ref System.Array custom) { }</p>

<p class=ILprg>}</p>

<p class=ILprg>}</p>

<p class=ILbase><span style='color:windowtext'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=ILbase><span style='color:windowtext'>The above Add-in examines the events
that deal with Tasks. So, an instance variable named taske of type
TaskListEvents is created. Then, it is initialized using the property
TaskListEvents from the Events table. This property takes a string parameter,
which is the name of the category whose tasks need to be filtered. <o:p></o:p></span></p>

<p class=ILbase><span style='color:windowtext'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=ILbase><span style='color:windowtext'>The TaskListEvents class has
only four events that get triggered. Likewise, four functions are associated
with these events, as was illustrated earlier. Then, at disconnection time,
they are eliminated. Now, it is left for you to decipher the code that
reiterates itself. <o:p></o:p></span></p>

<p class=ILbase><span style='color:windowtext'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=ILbase><span style='color:windowtext'>After the above Add-in has been
built and activated, the Task Window has to be activated in order to view the
output. This is achieved by clicking on the menu View, followed by the option
Other Windows, and then, by selecting the Task List, as is evident in screen
8.7.<o:p></o:p></span></p>

<p class=ILbase><span style='color:windowtext'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<table border=0 cellspacing=0 cellpadding=0 style='border-collapse:collapse;
 mso-padding-alt:0in 5.4pt 0in 5.4pt'>
 <tr>
  <td valign=top style='padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal><img width=400 height=300 id="_x0000_i1032"
  src="chap8/7.html"></p>
  </td>
 </tr>
 <tr>
  <td valign=top style='padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal>Screen 8.7</p>
  </td>
 </tr>
</table>

<p class=ILbase><span style='color:windowtext'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=ILbase><span style='color:windowtext'>The Task Window displays the line
'Click here to add a new task'. When the Task Window is clicked on, a new line
gets added in the Task Window, where the text vijay is entered and the Enter
key is pressed, (Screen 8.8).<o:p></o:p></span></p>

<p class=ILbase><span style='color:windowtext'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<table border=0 cellspacing=0 cellpadding=0 style='border-collapse:collapse;
 mso-padding-alt:0in 5.4pt 0in 5.4pt'>
 <tr>
  <td valign=top style='padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal><img width=400 height=300 id="_x0000_i1033"
  src="chap8/8.html"></p>
  </td>
 </tr>
 <tr>
  <td valign=top style='padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal>Screen 8.8</p>
  </td>
 </tr>
</table>

<p class=ILbase><span style='color:windowtext'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=ILbase><span style='color:windowtext'>On pressing the Enter key, the
function tAdded gets called. This phenomenon is an outcome of the event named
TaskAdded. The function is passed a parameter of type TaskItem object. The Description
property is then displayed, which exposes the text vijay. <o:p></o:p></span></p>

<p class=ILbase><span style='color:windowtext'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=ILbase><span style='color:windowtext'>Double clicking on the task
vijay now activates the event TaskNavigated. The first parameter is the
navigated task, while the second parameter is a bool value. The second
parameter is passed by ref. <o:p></o:p></span></p>

<p class=ILbase><span style='color:windowtext'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=ILbase><span style='color:windowtext'>Thus, in the eventuality of it
being changed, these modifications get reflected in the main code. Now, click
on the checkbox in front of Vijay. The screen 8.9 amply substantiates the fact
that the task item was being modified, which triggered off the event
TaskModified. <o:p></o:p></span></p>

<p class=ILbase><span style='color:windowtext'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<table border=0 cellspacing=0 cellpadding=0 style='border-collapse:collapse;
 mso-padding-alt:0in 5.4pt 0in 5.4pt'>
 <tr>
  <td valign=top style='padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal><img width=400 height=300 id="_x0000_i1036"
  src="chap8/9.html"></p>
  </td>
  <td valign=top style='padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal><img width=400 height=300 id="_x0000_i1037"
  src="chap8/10.html"></p>
  </td>
 </tr>
 <tr>
  <td valign=top style='padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal>Screen 8.9</p>
  </td>
  <td valign=top style='padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal>Screen 8.10</p>
  </td>
 </tr>
</table>

<p class=ILbase><span style='color:windowtext'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=ILbase><span style='color:windowtext'>The Delete key on the keyboard
is used to delete the task Vijay. This action triggers off the event
TaskRemoved. The Output Window pane Vijay Mukhi displays the events being
called and the functions being executed.<o:p></o:p></span></p>

<p class=ILbase><span style='color:windowtext'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=ILprg>namespace vij25</p>

<p class=ILprg>{</p>

<p class=ILprg>using System;</p>

<p class=ILprg>using Microsoft.Office.Core;</p>

<p class=ILprg>using Extensibility;</p>

<p class=ILprg>using System.Runtime.InteropServices;</p>

<p class=ILprg>using EnvDTE;</p>

<p class=ILprg>using System.Windows.Forms;</p>

<p class=ILprg>[GuidAttribute(&quot;00271586-C6A9-44EF-A342-2E63FFD4D384&quot;),
ProgId(&quot;vij25.Connect&quot;)]</p>

<p class=ILprg>public class Connect : Object, Extensibility.IDTExtensibility2</p>

<p class=ILprg>{</p>

<p class=ILprg>public Connect()</p>

<p class=ILprg>{</p>

<p class=ILprg>MessageBox.Show(&quot;Connect&quot;);</p>

<p class=ILprg>}</p>

<p class=ILprg>OutputWindowPane op;</p>

<p class=ILprg>SolutionEvents se;</p>

<p class=ILprg>public void OnConnection(object application, ext_ConnectMode c,
object addInInst, ref System.Array custom)</p>

<p class=ILprg>{</p>

<p class=ILprg>DTE applicationObject = (DTE)application;</p>

<p class=ILprg>Windows w = applicationObject.Windows;</p>

<p class=ILprg>Events e = applicationObject.Events;</p>

<p class=ILprg>Window ww = w.Item(Constants.vsWindowKindOutput);</p>

<p class=ILprg>OutputWindow o = (OutputWindow)ww.Object;</p>

<p class=ILprg>OutputWindowPanes oo =<span style="mso-spacerun: yes"> 
</span>o.OutputWindowPanes;</p>

<p class=ILprg>op = oo.Add(&quot;Vijay Mukhi&quot;);</p>

<p class=ILprg>se = e.SolutionEvents;</p>

<p class=ILprg>se.AfterClosing += new
_dispSolutionEvents_AfterClosingEventHandler(sAfterClosing);</p>

<p class=ILprg>se.BeforeClosing += new
_dispSolutionEvents_BeforeClosingEventHandler(sBeforeClosing);</p>

<p class=ILprg>se.Opened += new _dispSolutionEvents_OpenedEventHandler(sOpened);</p>

<p class=ILprg>se.ProjectAdded += new
_dispSolutionEvents_ProjectAddedEventHandler(sProjectAdded);</p>

<p class=ILprg>se.ProjectRemoved += new
_dispSolutionEvents_ProjectRemovedEventHandler(sProjectRemoved);</p>

<p class=ILprg>se.ProjectRenamed += new _dispSolutionEvents_ProjectRenamedEventHandler(sProjectRenamed);</p>

<p class=ILprg>se.QueryCloseSolution += new
_dispSolutionEvents_QueryCloseSolutionEventHandler(sQueryCloseSolution);</p>

<p class=ILprg>se.Renamed += new
_dispSolutionEvents_RenamedEventHandler(sRenamed);</p>

<p class=ILprg>}</p>

<p class=ILprg><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=ILprg>public void OnDisconnection(Extensibility.ext_DisconnectMode
disconnectMode, ref System.Array custom)</p>

<p class=ILprg>{</p>

<p class=ILprg>se.AfterClosing -= new
_dispSolutionEvents_AfterClosingEventHandler(sAfterClosing);</p>

<p class=ILprg>se.BeforeClosing -= new
_dispSolutionEvents_BeforeClosingEventHandler(sBeforeClosing);</p>

<p class=ILprg>se.Opened -= new _dispSolutionEvents_OpenedEventHandler(sOpened);</p>

<p class=ILprg>se.ProjectAdded -= new
_dispSolutionEvents_ProjectAddedEventHandler(sProjectAdded);</p>

<p class=ILprg>se.ProjectRemoved -= new
_dispSolutionEvents_ProjectRemovedEventHandler(sProjectRemoved);</p>

<p class=ILprg>se.ProjectRenamed -= new _dispSolutionEvents_ProjectRenamedEventHandler(sProjectRenamed);</p>

<p class=ILprg>se.QueryCloseSolution -= new
_dispSolutionEvents_QueryCloseSolutionEventHandler(sQueryCloseSolution);</p>

<p class=ILprg>se.Renamed -= new
_dispSolutionEvents_RenamedEventHandler(sRenamed);</p>

<p class=ILprg>}</p>

<p class=ILprg>public void sAfterClosing()</p>

<p class=ILprg>{</p>

<p class=ILprg>op.OutputString(&quot;AfterClosing\n&quot;);</p>

<p class=ILprg>}</p>

<p class=ILprg>public void sBeforeClosing()</p>

<p class=ILprg>{</p>

<p class=ILprg>op.OutputString(&quot;BeforeClosing\n&quot;);</p>

<p class=ILprg>}</p>

<p class=ILprg>public void sOpened()</p>

<p class=ILprg>{</p>

<p class=ILprg>op.OutputString(&quot;Opened\n&quot;);</p>

<p class=ILprg>}</p>

<p class=ILprg>public void sProjectAdded(Project p)</p>

<p class=ILprg>{</p>

<p class=ILprg>op.OutputString(&quot;ProjectAdded &quot; + p.FullName +
&quot;\n&quot;);</p>

<p class=ILprg>}</p>

<p class=ILprg>public void sProjectRemoved(Project p)</p>

<p class=ILprg>{</p>

<p class=ILprg>op.OutputString(&quot;ProjectRemoved &quot; + p.FullName +
&quot;\n&quot;);</p>

<p class=ILprg>}</p>

<p class=ILprg>public void sProjectRenamed(Project p, string o)</p>

<p class=ILprg>{</p>

<p class=ILprg>op.OutputString(&quot;ProjectRenamed &quot; + p.FullName +
&quot; &quot; + o + &quot;\n&quot;);</p>

<p class=ILprg>}</p>

<p class=ILprg>public void sQueryCloseSolution(ref bool c)</p>

<p class=ILprg>{</p>

<p class=ILprg>op.OutputString(&quot;QueryCloseSolution &quot; + c +
&quot;\n&quot;);</p>

<p class=ILprg>}</p>

<p class=ILprg>public void sRenamed(string o)</p>

<p class=ILprg>{</p>

<p class=ILprg>op.OutputString(&quot;Renamed &quot; + o + &quot;\n&quot;);</p>

<p class=ILprg>}</p>

<p class=ILprg>public void OnAddInsUpdate(ref System.Array custom)</p>

<p class=ILprg>{</p>

<p class=ILprg>}</p>

<p class=ILprg>public void OnStartupComplete(ref System.Array custom)</p>

<p class=ILprg>{</p>

<p class=ILprg>}</p>

<p class=ILprg>public void OnBeginShutdown(ref System.Array custom) { }</p>

<p class=ILprg>}</p>

<p class=ILprg>}</p>

<p class=ILbase><span style='color:windowtext'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=ILbase><span style='color:windowtext'>This Add-in handles events
associated with the Solution Explorer. An object se of type SolutionEvents is
created and initialized, using the SolutionEvents property from the Events
class. This class houses a total of eight events, which are skimmed over one at
a time. <o:p></o:p></span></p>

<p class=ILbase><span style='color:windowtext'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=ILbase><span style='color:windowtext'>At first, the Solution Events
created an Add-in project. The wizard creates two projects in a single
solution. <o:p></o:p></span></p>

<p class=ILbase><span style='color:windowtext'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=ILbase><span style='color:windowtext'>The project attends to the task
of saving the details of the projects, while the solution merely stores the
projects that it encompasses. The details are stored in ASCII files. A solution
uses an sln extension, while a project utilizes a csproj extension. These
configuration files are pure XML files. <o:p></o:p></span></p>

<p class=ILbase><span style='color:windowtext'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=ILbase><span style='color:windowtext'>When the project name is right
clicked on, a menu unfolds itself. The selection of the menu option of Remove
triggers off the event ProjectRemoved. The function associated with this event
is called with a single parameter, which is the project earmarked for
elimination. The code in this function merely displays the full path of the
project.<span style="mso-spacerun: yes">  </span><o:p></o:p></span></p>

<p class=ILbase><span style='color:windowtext'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=ILbase><span style='color:windowtext'>In case the Rename option had
been selected in lieu of the Remove option, the event ProjectRenamed would have
been<span style="mso-spacerun: yes">  </span>triggered off. The function
accepts two parameters, viz. a handle to the project that is currently selected
and a string that contains the old name. The Output Window projects both, the
new as well as the old name.<o:p></o:p></span></p>

<p class=ILbase><span style='color:windowtext'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=ILbase><span style='color:windowtext'>One of the menu options that
presents itself on right clicking the Project is Add, which leads to the menu
option New Project. A click on this option brings forth the familiar Project
dialog box, from where a Project template type can be selected. This activates
the event ProjectAdded, and also displays the full name of the new project that
has been added. <o:p></o:p></span></p>

<p class=ILbase><span style='color:windowtext'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=ILbase><span style='color:windowtext'>This thrashes out the issue of
events that handle Projects in a solution. Now, let us converge our attention
onto the Solution Events. <o:p></o:p></span></p>

<p class=ILbase><span style='color:windowtext'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=ILbase><span style='color:windowtext'>When the solution name is
clicked on with the right-mouse button and the Rename option is selected, the Renamed
event gets fired. The event gets triggered only when a new word is specified,
followed by the Enter key. The function is supplied with a string containing
the old name. <o:p></o:p></span></p>

<p class=ILbase><span style='color:windowtext'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=ILbase><span style='color:windowtext'>Open a solution that had been
stored earlier, while the existing one is still open. On doing so, the
QueryCloseSolution event gets triggered, with a boolean value of false. This
event is followed by the BeforeClosing event, which in turn is followed by the
AfterClosing event, since the solution gets closed. Then, the Opened event of
the project that is being opened, gets triggered off. This explicates all the
five solution events that get executed. There is a minor aspect that still
needs to be expounded. <o:p></o:p></span></p>

<p class=ILbase><span style='color:windowtext'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=ILprg>public void sQueryCloseSolution (ref bool c)</p>

<p class=ILprg>{</p>

<p class=ILprg>op.OutputString(&quot;QueryCloseSolution &quot; + c +
&quot;\n&quot;);</p>

<p class=ILprg>c = true;</p>

<p class=ILprg>}</p>

<p class=ILbase><span style='color:windowtext'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=ILbase><span style='color:windowtext'>The event QueryCloseSolution
gets called just prior to the closing of a solution. A ref parameter is passed,
which has a default value of false. Set it to true, and then, build the
solution. Activate the Add-in. Once this has been accomplished, attempt at
opening any new solution. Amazingly, no solution opens up. <o:p></o:p></span></p>

<p class=ILbase><span style='color:windowtext'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=ILbase><span style='color:windowtext'>This stems from the fact that
the Event Manager checks the value of the bool parameter. If any of the
functions sets its value to true, then the earlier solution does not close at
all. It is for this reason that the event begins with the word Query. The
Add-ins are asked whether they want the existing solution to be closed or not.<o:p></o:p></span></p>

<p class=ILbase><span style='color:windowtext'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=ILprg>namespace vij25</p>

<p class=ILprg>{</p>

<p class=ILprg>using System;</p>

<p class=ILprg>using Microsoft.Office.Core;</p>

<p class=ILprg>using Extensibility;</p>

<p class=ILprg>using System.Runtime.InteropServices;</p>

<p class=ILprg>using EnvDTE;</p>

<p class=ILprg>using System.Windows.Forms;</p>

<p class=ILprg>[GuidAttribute(&quot;00271586-C6A9-44EF-A342-2E63FFD4D384&quot;),
ProgId(&quot;vij25.Connect&quot;)]</p>

<p class=ILprg>public class Connect : Object, Extensibility.IDTExtensibility2</p>

<p class=ILprg>{</p>

<p class=ILprg>public Connect()</p>

<p class=ILprg>{</p>

<p class=ILprg>MessageBox.Show(&quot;Connect&quot;);</p>

<p class=ILprg>}</p>

<p class=ILprg>OutputWindowPane op;</p>

<p class=ILprg>SelectionEvents se;</p>

<p class=ILprg>DTE applicationObject;</p>

<p class=ILprg>public void OnConnection(object application, ext_ConnectMode c,
object addInInst, ref System.Array custom)</p>

<p class=ILprg>{</p>

<p class=ILprg>applicationObject = (DTE)application;</p>

<p class=ILprg>Windows w = applicationObject.Windows;</p>

<p class=ILprg>Events e = applicationObject.Events;</p>

<p class=ILprg>Window ww = w.Item(Constants.vsWindowKindOutput);</p>

<p class=ILprg>OutputWindow o = (OutputWindow)ww.Object;</p>

<p class=ILprg>OutputWindowPanes oo =<span style="mso-spacerun: yes"> 
</span>o.OutputWindowPanes;</p>

<p class=ILprg>op = oo.Add(&quot;Vijay Mukhi&quot;);</p>

<p class=ILprg>se = e.SelectionEvents;</p>

<p class=ILprg>se.OnChange += new
_dispSelectionEvents_OnChangeEventHandler(sOnChange);</p>

<p class=ILprg>}</p>

<p class=ILprg>public void OnDisconnection(Extensibility.ext_DisconnectMode
disconnectMode, ref System.Array custom)</p>

<p class=ILprg>{</p>

<p class=ILprg>se.OnChange -= new
_dispSelectionEvents_OnChangeEventHandler(sOnChange);</p>

<p class=ILprg>}</p>

<p class=ILprg>public void sOnChange()</p>

<p class=ILprg>{</p>

<p class=ILprg>SelectedItems s = applicationObject.SelectedItems;</p>

<p class=ILprg>int c = s.Count;</p>

<p class=ILprg>op.OutputString(&quot;Selection Number &quot; + c.ToString() +
&quot;\n&quot;);</p>

<p class=ILprg>for (int i = 1 ; i &lt;= c ; i++)</p>

<p class=ILprg>{</p>

<p class=ILprg>SelectedItem ss = s.Item(i);</p>

<p class=ILprg>op.OutputString(&quot;Name &quot; + ss.Name + &quot;\n&quot;);</p>

<p class=ILprg>}</p>

<p class=ILprg>}</p>

<p class=ILprg>public void OnAddInsUpdate(ref System.Array custom) { }</p>

<p class=ILprg>public void OnStartupComplete(ref System.Array custom) { }</p>

<p class=ILprg>public void OnBeginShutdown(ref System.Array custom) { }</p>

<p class=ILprg>}</p>

<p class=ILprg>}</p>

<p class=ILprg><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=ILbase><span style='color:windowtext'>The events property returns a SelectionEvents
object when the property SelectionEvents is pressed into action. Fortunately,
there is a solitary event called OnChange, which is linked with the function
sOnChange that accepts no parameters. <o:p></o:p></span></p>

<p class=ILbase><span style='color:windowtext'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=ILbase><span style='color:windowtext'>In case it has slipped your
attention, the applicationObject or DTE object has been made an instance
variable. The event OnChange gets fired whenever the user makes some selection,
or when the selection model changes. <o:p></o:p></span></p>

<p class=ILbase><span style='color:windowtext'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=ILbase><span style='color:windowtext'>The DTE object has a property
called SelectedItems that returns a SelectedItems object. This object collects
all the changes. All collection objects have a property called Count, which
gives the total count on the items that are present.<o:p></o:p></span></p>

<p class=ILbase><span style='color:windowtext'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=ILbase><span style='color:windowtext'>In the above code, the Count
property is displayed in function sOnChange, and all the items in the
collection are examined using a 'for' loop. The Item function is like an
indexer, which facilitates the retrieval of each and every item that is
present. For the Item function, the count starts from 1, whereas the indexer
for the Item function begins its count with the value of 0. Then, the name of
the selection is displayed in the Output window. <o:p></o:p></span></p>

<p class=ILbase><span style='color:windowtext'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=ILbase><span style='color:windowtext'>Build and activate the Add-in,
and then, keep selecting varied items in the project. The OnChange event gets
triggered, thus displaying the names of the individual project files that are
clicked on. <o:p></o:p></span></p>

<p class=ILbase><span style='color:windowtext'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=ILbase><span style='color:windowtext'>Next, click on the solution
vij25 on the Start page. This will beget a change in the selection model. This
triggers off the event OnChange multiple times, and prompts the display of a
list of files that constitute the solution. <o:p></o:p></span></p>

<p class=ILbase><span style='color:windowtext'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=ILprg>namespace vij25</p>

<p class=ILprg>{</p>

<p class=ILprg>using System;</p>

<p class=ILprg>using Microsoft.Office.Core;</p>

<p class=ILprg>using Extensibility;</p>

<p class=ILprg>using System.Runtime.InteropServices;</p>

<p class=ILprg>using EnvDTE;</p>

<p class=ILprg>using System.Windows.Forms;</p>

<p class=ILprg>[GuidAttribute(&quot;00271586-C6A9-44EF-A342-2E63FFD4D384&quot;),
ProgId(&quot;vij25.Connect&quot;)]</p>

<p class=ILprg>public class Connect : Object, Extensibility.IDTExtensibility2</p>

<p class=ILprg>{</p>

<p class=ILprg>public Connect()</p>

<p class=ILprg>{</p>

<p class=ILprg>MessageBox.Show(&quot;Connect&quot;);</p>

<p class=ILprg>}</p>

<p class=ILprg>OutputWindowPane op;</p>

<p class=ILprg>OutputWindowEvents oe;</p>

<p class=ILprg>DTE applicationObject;</p>

<p class=ILprg>public void OnConnection(object application, ext_ConnectMode c, object
addInInst, ref System.Array custom)</p>

<p class=ILprg>{</p>

<p class=ILprg>applicationObject = (DTE)application;</p>

<p class=ILprg>Windows w = applicationObject.Windows;</p>

<p class=ILprg>Events e = applicationObject.Events;</p>

<p class=ILprg>Window ww = w.Item(Constants.vsWindowKindOutput);</p>

<p class=ILprg>oe = e.get_OutputWindowEvents (&quot;&quot;);</p>

<p class=ILprg>oe.PaneAdded += new
_dispOutputWindowEvents_PaneAddedEventHandler(sPaneAdded);</p>

<p class=ILprg>oe.PaneClearing += new
_dispOutputWindowEvents_PaneClearingEventHandler(sPaneClearing);</p>

<p class=ILprg>oe.PaneUpdated += new
_dispOutputWindowEvents_PaneUpdatedEventHandler(sPaneUpdated);</p>

<p class=ILprg>OutputWindow o = (OutputWindow)ww.Object;</p>

<p class=ILprg>OutputWindowPanes oo =<span style="mso-spacerun: yes"> 
</span>o.OutputWindowPanes;</p>

<p class=ILprg>op = oo.Add(&quot;Vijay Mukhi&quot;);</p>

<p class=ILprg>op.OutputString(&quot;Started\n&quot;);</p>

<p class=ILprg>}</p>

<p class=ILprg>public void OnDisconnection(Extensibility.ext_DisconnectMode
disconnectMode, ref System.Array custom)</p>

<p class=ILprg>{</p>

<p class=ILprg>oe.PaneAdded -= new _dispOutputWindowEvents_PaneAddedEventHandler(sPaneAdded);</p>

<p class=ILprg>oe.PaneClearing -= new
_dispOutputWindowEvents_PaneClearingEventHandler(sPaneClearing);</p>

<p class=ILprg>oe.PaneUpdated -= new
_dispOutputWindowEvents_PaneUpdatedEventHandler(sPaneUpdated);</p>

<p class=ILprg>}</p>

<p class=ILprg>public void sPaneAdded(OutputWindowPane p)</p>

<p class=ILprg>{</p>

<p class=ILprg>op.OutputString(&quot;PaneAdded &quot; + p.Name +
&quot;\n&quot;);</p>

<p class=ILprg>}</p>

<p class=ILprg>public void sPaneClearing(OutputWindowPane p)</p>

<p class=ILprg>{</p>

<p class=ILprg>op.OutputString(&quot;PaneClearing &quot; + p.Name +
&quot;\n&quot;);</p>

<p class=ILprg>}</p>

<p class=ILprg>public void sPaneUpdated(OutputWindowPane p)</p>

<p class=ILprg>{</p>

<p class=ILprg>System.Windows.Forms.MessageBox.Show(&quot;PaneUpdated&quot;);</p>

<p class=ILprg>}</p>

<p class=ILprg>public void OnAddInsUpdate(ref System.Array custom) { }</p>

<p class=ILprg>public void OnStartupComplete(ref System.Array custom) { }</p>

<p class=ILprg>public void OnBeginShutdown(ref System.Array custom) { }</p>

<p class=ILprg>}</p>

<p class=ILprg>}</p>

<p class=ILbase><span style='color:windowtext'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=ILbase><span style='color:windowtext'>The above Add-in deals with
events related to the Output window. Here, we need to proceed cautiously, since
the program also writes to the Output window. The property OutputWindowEvents
gives an OutputWindowEvents object; and as usual, the parameter that is passed
is the name of the pane in a string form. A value of null traps all the events
for all the Output Window panes. There are three events in this section. <o:p></o:p></span></p>

<p class=ILbase><span style='color:windowtext'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=ILbase><span style='color:windowtext'>At first, the activated Add-in
displays the text ‘Srarted’<span style="mso-spacerun: yes">  </span>in the
Output Window.<o:p></o:p></span></p>

<p class=ILbase><span style='color:windowtext'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=ILbase><span style='color:windowtext'>The message box that emerges,
signifies that an event PaneUpdated has been fired. The function OutputString
has not been used in the function sPaneUpdated, since it would result in an
indefinite recursion. It is because the event gets triggered whenever something
is written in the pane. The screen 8.11 displays the relevant message box. <o:p></o:p></span></p>

<p class=ILbase><span style='color:windowtext'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<table border=0 cellspacing=0 cellpadding=0 style='border-collapse:collapse;
 mso-padding-alt:0in 5.4pt 0in 5.4pt'>
 <tr>
  <td valign=top style='padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal><img width=400 height=300 id="_x0000_i1038"
  src="chap8/11.html"></p>
  </td>
  <td valign=top style='padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal><img width=400 height=300 id="_x0000_i1039"
  src="chap8/12.html"></p>
  </td>
 </tr>
 <tr>
  <td valign=top style='padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal>Screen 8.11</p>
  </td>
  <td valign=top style='padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal>Screen 8.12</p>
  </td>
 </tr>
</table>

<p class=ILbase><span style='color:windowtext'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=ILbase><span style='color:windowtext'>Rebuild the solution. The screen
8.12 appears because the PaneClearing event gets called. This occurs because
Visual Studio.Net actually builds the pane before writing into it. In the above
events, it is merely the name of the pane that is displayed.<o:p></o:p></span></p>

<p class=ILbase><span style='color:windowtext'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=ILprg>namespace vij25</p>

<p class=ILprg>{</p>

<p class=ILprg>using System;</p>

<p class=ILprg>using Microsoft.Office.Core;</p>

<p class=ILprg>using Extensibility;</p>

<p class=ILprg>using System.Runtime.InteropServices;</p>

<p class=ILprg>using EnvDTE;</p>

<p class=ILprg>using System.Windows.Forms;</p>

<p class=ILprg>[GuidAttribute(&quot;00271586-C6A9-44EF-A342-2E63FFD4D384&quot;),
ProgId(&quot;vij25.Connect&quot;)]</p>

<p class=ILprg>public class Connect : Object, Extensibility.IDTExtensibility2</p>

<p class=ILprg>{</p>

<p class=ILprg>public Connect() {</p>

<p class=ILprg>MessageBox.Show(&quot;Connect&quot;);</p>

<p class=ILprg>}</p>

<p class=ILprg>OutputWindowPane op;</p>

<p class=ILprg>FindEvents fe;</p>

<p class=ILprg>DTE applicationObject;</p>

<p class=ILprg>public void OnConnection(object application, ext_ConnectMode c,
object addInInst, ref System.Array custom) {</p>

<p class=ILprg>applicationObject = (DTE)application;</p>

<p class=ILprg>Windows w = applicationObject.Windows;</p>

<p class=ILprg>EnvDTE.Events e = applicationObject.Events;</p>

<p class=ILprg>Window ww = w.Item(Constants.vsWindowKindOutput);</p>

<p class=ILprg>OutputWindow o = (OutputWindow)ww.Object;</p>

<p class=ILprg>OutputWindowPanes oo =<span style="mso-spacerun: yes"> 
</span>o.OutputWindowPanes;</p>

<p class=ILprg>op = oo.Add(&quot;Vijay Mukhi&quot;);</p>

<p class=ILprg>fe = e.FindEvents;</p>

<p class=ILprg>fe.FindDone += new
_dispFindEvents_FindDoneEventHandler(fFindDone);</p>

<p class=ILprg>}</p>

<p class=ILprg>public void OnDisconnection(Extensibility.ext_DisconnectMode
disconnectMode, ref System.Array custom)</p>

<p class=ILprg>{</p>

<p class=ILprg>fe.FindDone -= new
_dispFindEvents_FindDoneEventHandler(fFindDone);</p>

<p class=ILprg>}</p>

<p class=ILprg>public void fFindDone(vsFindResult r, bool c)</p>

<p class=ILprg>{</p>

<p class=ILprg>op.OutputString(&quot; &quot; + r.ToString() + &quot; &quot; +
c.ToString() + &quot;\n&quot;);</p>

<p class=ILprg>}</p>

<p class=ILprg>public void OnAddInsUpdate(ref System.Array custom) { }</p>

<p class=ILprg>public void OnStartupComplete(ref System.Array custom) { }</p>

<p class=ILprg>public void OnBeginShutdown(ref System.Array custom) { }</p>

<p class=ILprg>}</p>

<p class=ILprg>}</p>

<p class=ILbase><span style='color:windowtext'>The above Add-in traps the
events that get generated when the Find in Files option is used. This option is
in the Edit menu, located after the menu options of Find and Replace. Enter a
search word and click on Find. The Find Results 1 window shows-up the results
of the Find in Files operation, but the the FindDone event does not get called.
This can be verified in the output window.<o:p></o:p></span></p>

<p class=ILbase><span style='color:windowtext'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=ILbase><span style='color:windowtext'>Now for the option “Look
in”<span style="mso-spacerun: yes">  </span>in the Find in Files Dialog Box
change the value “Current Document” to a Specific file name
“C:\v2\vij25\Connect.cs” as in screen 8.13.<o:p></o:p></span></p>

<p class=ILbase><span style='color:windowtext'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<table border=0 cellspacing=0 cellpadding=0 style='border-collapse:collapse;
 mso-padding-alt:0in 5.4pt 0in 5.4pt'>
 <tr>
  <td valign=top style='padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal><img width=400 height=300 id="_x0000_i1040"
  src="chap8/13.html"></p>
  </td>
  <td valign=top style='padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal><img width=400 height=300 id="_x0000_i1041"
  src="chap8/14.html"></p>
  </td>
 </tr>
 <tr>
  <td valign=top style='padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal>Screen 8.13</p>
  </td>
  <td valign=top style='padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal>Screen 8.14</p>
  </td>
 </tr>
</table>

<p class=ILbase><span style='color:windowtext'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=ILbase><span style='color:windowtext'>The Add-in obtains access to the
FindEvents object in the Events class by using the FindEvents property. The
function fFindDone gets called whenever the Find in Files operation completes
with a specified file name, as depicted in screen 8.14.<o:p></o:p></span></p>

<p class=ILbase><span style='color:windowtext'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=ILbase><span style='color:windowtext'>Here, the function fFindDone
gets called, together with the Find Results Output window containing the
results of the Find in Files operation. The fFindDone function gets called with
two parameters; one is an enum named vsFindResult, while the other is a bool
having the result value of false.<o:p></o:p></span></p>

<p class=ILbase><span style='color:windowtext'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=ILbase><span style='color:windowtext'>The enum vsFindResult can assume
any one of seven possible values, conferring the outcome of the search. They
are sequentially numbered from 0 to 6. <o:p></o:p></span></p>

<p class=ILbullets><span style='mso-bidi-font-size:12.0pt;font-family:"Times New Roman"'>•<span
style='mso-tab-count:1'>     </span></span>The first enum value is
vsFindResultNotFound or 0, which indicates that the search item has not been
found. </p>

<p class=ILbullets><span style='mso-bidi-font-size:12.0pt;font-family:"Times New Roman"'>•<span
style='mso-tab-count:1'>     </span></span>In our case, the enum value is
vsFindResultFound or 1, since the key word has been located in the file. </p>

<p class=ILbullets><span style='mso-bidi-font-size:12.0pt;font-family:"Times New Roman"'>•<span
style='mso-tab-count:1'>     </span></span>The third enum value is
vsFindResultReplaceAndNotFound or 2, which indicates that the search word for
the replace operation was not found. </p>

<p class=ILbullets><span style='mso-bidi-font-size:12.0pt;font-family:"Times New Roman"'>•<span
style='mso-tab-count:1'>     </span></span>The fourth enum value is
vsFindResultReplaceAndFound or 3. It informs us that the Replace word that was
being sought, has been found.</p>

<p class=ILbullets><span style='mso-bidi-font-size:12.0pt;font-family:"Times New Roman"'>•<span
style='mso-tab-count:1'>     </span></span>The fifth enum value is
vsFindResultReplaced or 4, which indicates that the search item was successfully
replaced. </p>

<p class=ILbullets><span style='mso-bidi-font-size:12.0pt;font-family:"Times New Roman"'>•<span
style='mso-tab-count:1'>     </span></span>The sixth enum value is
vsFindResultPending or 5, which signifies that the search is still pending.</p>

<p class=ILbullets><span style='mso-bidi-font-size:12.0pt;font-family:"Times New Roman"'>•<span
style='mso-tab-count:1'>     </span></span>The seventh enum value and the final
enum value is vsFindResultError or 6, which indicates that the search has
resulted in some error. </p>

<p class=ILbase><span style='color:windowtext'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=ILbase><span style='color:windowtext'>It is a great experience working
with Add-ins that have only one event.<o:p></o:p></span></p>

<p class=ILbase><span style='color:windowtext'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=ILprg>namespace vij25</p>

<p class=ILprg>{</p>

<p class=ILprg>using System;</p>

<p class=ILprg>using Microsoft.Office.Core;</p>

<p class=ILprg>using Extensibility;</p>

<p class=ILprg>using System.Runtime.InteropServices;</p>

<p class=ILprg>using EnvDTE;</p>

<p class=ILprg>using System.Windows.Forms;</p>

<p class=ILprg>[GuidAttribute(&quot;00271586-C6A9-44EF-A342-2E63FFD4D384&quot;),
ProgId(&quot;vij25.Connect&quot;)]</p>

<p class=ILprg>public class Connect : Object, Extensibility.IDTExtensibility2</p>

<p class=ILprg>{</p>

<p class=ILprg>public Connect() </p>

<p class=ILprg>{</p>

<p class=ILprg>MessageBox.Show(&quot;Connect&quot;);</p>

<p class=ILprg>}</p>

<p class=ILprg>OutputWindowPane op;</p>

<p class=ILprg>DTE applicationObject;</p>

<p class=ILprg>DTEEvents de;</p>

<p class=ILprg>public void OnConnection(object application, ext_ConnectMode c,
object addInInst, ref System.Array custom)</p>

<p class=ILprg>{</p>

<p class=ILprg>applicationObject = (DTE)application;</p>

<p class=ILprg>Windows w = applicationObject.Windows;</p>

<p class=ILprg>Events e = applicationObject.Events;</p>

<p class=ILprg>Window ww = w.Item(Constants.vsWindowKindOutput);</p>

<p class=ILprg>OutputWindow o = (OutputWindow)ww.Object;</p>

<p class=ILprg>OutputWindowPanes oo =<span style="mso-spacerun: yes"> 
</span>o.OutputWindowPanes;</p>

<p class=ILprg>op = oo.Add(&quot;Vijay Mukhi&quot;);</p>

<p class=ILprg>de = e.DTEEvents;</p>

<p class=ILprg>de.ModeChanged += new
_dispDTEEvents_ModeChangedEventHandler(dModeChanged);</p>

<p class=ILprg>de.OnBeginShutdown += new _dispDTEEvents_OnBeginShutdownEventHandler(dOnBeginShutdown);</p>

<p class=ILprg>de.OnMacrosRuntimeReset += new <span style='font-size:9.0pt'>_dispDTEEvents_OnMacrosRuntimeResetEventHandler(dOnMacrosRuntimeReset);</span></p>

<p class=ILprg>de.OnStartupComplete += new
_dispDTEEvents_OnStartupCompleteEventHandler(dOnStartupComplete);</p>

<p class=ILprg>}</p>

<p class=ILprg>public void OnDisconnection(Extensibility.ext_DisconnectMode
disconnectMode, ref System.Array custom)</p>

<p class=ILprg>{</p>

<p class=ILprg>de.ModeChanged -= new
_dispDTEEvents_ModeChangedEventHandler(dModeChanged);</p>

<p class=ILprg>de.OnBeginShutdown -= new
_dispDTEEvents_OnBeginShutdownEventHandler(dOnBeginShutdown);</p>

<p class=ILprg>de.OnMacrosRuntimeReset -= new
_dispDTEEvents_OnMacrosRuntimeResetEventHandler(dOnMacrosRuntimeReset);</p>

<p class=ILprg>de.OnStartupComplete -= new
_dispDTEEvents_OnStartupCompleteEventHandler(dOnStartupComplete);</p>

<p class=ILprg>}</p>

<p class=ILprg>public void dModeChanged(vsIDEMode l)</p>

<p class=ILprg>{</p>

<p class=ILprg>op.OutputString(&quot;ModeChanged &quot; + l.ToString() +
&quot;\n&quot;);</p>

<p class=ILprg>}</p>

<p class=ILprg>public void dOnBeginShutdown()</p>

<p class=ILprg>{</p>

<p class=ILprg>MessageBox.Show(&quot;OnBeginShutdown\n&quot;);</p>

<p class=ILprg>}</p>

<p class=ILprg>public void dOnMacrosRuntimeReset() {</p>

<p class=ILprg>MessageBox.Show(&quot;OnMacrosRuntimeReset\n&quot;);</p>

<p class=ILprg>}</p>

<p class=ILprg>public void dOnStartupComplete() {</p>

<p class=ILprg>MessageBox.Show(&quot;OnStartupComplete\n&quot;);</p>

<p class=ILprg>}</p>

<p class=ILprg>public void OnAddInsUpdate(ref System.Array custom) { }</p>

<p class=ILprg>public void OnStartupComplete(ref System.Array custom) { }</p>

<p class=ILprg>public void OnBeginShutdown(ref System.Array custom) { }</p>

<p class=ILprg>}</p>

<p class=ILprg>}</p>

<p class=ILbase><span style='color:windowtext'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=ILbase><span style='color:windowtext'>The DTE events relate to the
state that the environment is in. Therefore, the DTEEvents property from the
events object is used to attain a new DTEEvents object. <o:p></o:p></span></p>

<p class=ILbase><span style='color:windowtext'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=ILbase><span style='color:windowtext'>This class has four events. The
first one is the ModeChanged event. This event gets fired whenever the mode of the
environment endures a change. For instance, this occurs when the Windows
Application project is opened by clicking on the menu option of Debug - Start.
Although it projects an empty window, it also simultaneously triggers off the
event ModeChanged. <o:p></o:p></span></p>

<p class=ILbase><span style='color:windowtext'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=ILbase><span style='color:windowtext'>The event is passed one
parameter, which is an enum of type vsIDEMode that takes only two values. The
value of vsIDEModeDesign indicates that the environment is in Design Mode. On
closing the form, the event gets called again. However, this time, the parameter
has a value of vsIDEModeDebug. This suggests that the environment is in Debug
Mode. <o:p></o:p></span></p>

<p class=ILbase><span style='color:windowtext'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=ILbase><span style='color:windowtext'>On closing Visual Studio.Net,
the event OnBeginShutDown gets called while Visual Studio.Net is in the process
of shutting down or quitting out. After Visual Studio.Net starts up and has
been completely launched, then and only then, the OnStartupComplete event gets
called. All the User Interface features and the resources provided by Visual
Studio.Net, can be put to use from this stage onwards.<o:p></o:p></span></p>

<p class=ILbase><span style='color:windowtext'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=ILbase><span style='color:windowtext'>Now, click on the menu option
Tools, and then on Macros. Thereafter, select New Macro Project. The dialog box
that comes in sight, is shown in screen 8.15.<o:p></o:p></span></p>

<p class=ILbase><span style='color:windowtext'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<table border=0 cellspacing=0 cellpadding=0 style='border-collapse:collapse;
 mso-padding-alt:0in 5.4pt 0in 5.4pt'>
 <tr>
  <td valign=top style='padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal><img width=400 height=300 id="_x0000_i1042"
  src="chap8/15.html"></p>
  </td>
  <td valign=top style='padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal><img width=400 height=300 id="_x0000_i1043"
  src="chap8/16.html"></p>
  </td>
  <td valign=top style='padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal><img width=400 height=300 id="_x0000_i1044"
  src="chap8/17.html"></p>
  </td>
 </tr>
 <tr>
  <td valign=top style='padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal>Screen 8.15</p>
  </td>
  <td valign=top style='padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal>Screen 8.16</p>
  </td>
  <td valign=top style='padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal>Screen 8.17</p>
  </td>
 </tr>
</table>

<p class=ILbase><span style='color:windowtext'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=ILbase><span style='color:windowtext'>Select the existing option, and
then, click on the OK button. Screen 8.17 exhibits a MessageBox, thus
suggesting that the OnMacrosRuntimeReset event has been called. This event gets
called when the macro runtime execution engine resets itself, which occurs
during the creation of a new Macro project. This act clears up all global
variable data and eliminates all the event connections.<o:p></o:p></span></p>

<p class=ILbase><span style='color:windowtext'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=ILprg>namespace vij25</p>

<p class=ILprg>{</p>

<p class=ILprg>using System;</p>

<p class=ILprg>using Microsoft.Office.Core;</p>

<p class=ILprg>using Extensibility;</p>

<p class=ILprg>using System.Runtime.InteropServices;</p>

<p class=ILprg>using EnvDTE;</p>

<p class=ILprg>using System.Windows.Forms;</p>

<p class=ILprg>[GuidAttribute(&quot;00271586-C6A9-44EF-A342-2E63FFD4D384&quot;),
ProgId(&quot;vij25.Connect&quot;)]</p>

<p class=ILprg>public class Connect : Object, Extensibility.IDTExtensibility2</p>

<p class=ILprg>{</p>

<p class=ILprg>public Connect()</p>

<p class=ILprg>{</p>

<p class=ILprg>MessageBox.Show(&quot;Connect&quot;);</p>

<p class=ILprg>}</p>

<p class=ILprg>OutputWindowPane op;</p>

<p class=ILprg>DTE applicationObject;</p>

<p class=ILprg>DocumentEvents de;</p>

<p class=ILprg>public void OnConnection(object application, ext_ConnectMode c,
object addInInst, ref System.Array custom)</p>

<p class=ILprg>{</p>

<p class=ILprg>applicationObject = (DTE)application;</p>

<p class=ILprg>Windows w = applicationObject.Windows;</p>

<p class=ILprg>Events e = applicationObject.Events;</p>

<p class=ILprg>Window ww = w.Item(Constants.vsWindowKindOutput);</p>

<p class=ILprg>OutputWindow o = (OutputWindow)ww.Object;</p>

<p class=ILprg>OutputWindowPanes oo =<span style="mso-spacerun: yes"> 
</span>o.OutputWindowPanes;</p>

<p class=ILprg>op = oo.Add(&quot;Vijay Mukhi&quot;);</p>

<p class=ILprg>de = e.get_DocumentEvents(null);</p>

<p class=ILprg>de.DocumentClosing += new _dispDocumentEvents_DocumentClosingEventHandler(dDocumentClosing);</p>

<p class=ILprg>de.DocumentOpened += new
_dispDocumentEvents_DocumentOpenedEventHandler(dDocumentOpened);</p>

<p class=ILprg>de.DocumentOpening += new
_dispDocumentEvents_DocumentOpeningEventHandler(dDocumentOpening);</p>

<p class=ILprg>de.DocumentSaved += new _dispDocumentEvents_DocumentSavedEventHandler(dDocumentSaved);</p>

<p class=ILprg>}</p>

<p class=ILprg>public void OnDisconnection(Extensibility.ext_DisconnectMode
disconnectMode, ref System.Array custom)</p>

<p class=ILprg>{</p>

<p class=ILprg>de.DocumentClosing -= new
_dispDocumentEvents_DocumentClosingEventHandler(dDocumentClosing);</p>

<p class=ILprg>de.DocumentOpened -= new
_dispDocumentEvents_DocumentOpenedEventHandler(dDocumentOpened);</p>

<p class=ILprg>de.DocumentOpening -= new
_dispDocumentEvents_DocumentOpeningEventHandler(dDocumentOpening);</p>

<p class=ILprg>de.DocumentSaved -= new
_dispDocumentEvents_DocumentSavedEventHandler(dDocumentSaved);</p>

<p class=ILprg>}</p>

<p class=ILprg>public void dDocumentClosing(Document d)</p>

<p class=ILprg>{</p>

<p class=ILprg>op.OutputString(&quot;DocumentClosing &quot; + d.Name +
&quot;\n&quot;);</p>

<p class=ILprg>}</p>

<p class=ILprg>public void dDocumentOpened(Document d)</p>

<p class=ILprg>{</p>

<p class=ILprg>op.OutputString(&quot;DocumentOpened: &quot; + d.Name +
&quot;\n&quot;);</p>

<p class=ILprg>}</p>

<p class=ILprg>public void dDocumentOpening(string d, bool t)</p>

<p class=ILprg>{</p>

<p class=ILprg>op.OutputString(&quot;DocumentOpening<span style="mso-spacerun:
yes">  </span>&quot; + d + &quot; &quot; + t.ToString() + &quot;\n&quot;);</p>

<p class=ILprg>}</p>

<p class=ILprg>public void dDocumentSaved(Document d)</p>

<p class=ILprg>{</p>

<p class=ILprg>op.OutputString(&quot;DocumentSaved &quot; + d.Name + &quot;\n&quot;);</p>

<p class=ILprg>}</p>

<p class=ILprg>public void OnAddInsUpdate(ref System.Array custom) { </p>

<p class=ILprg>}</p>

<p class=ILprg>public void OnStartupComplete(ref System.Array custom) {<span
style="mso-spacerun: yes">  </span>}</p>

<p class=ILprg>public void OnBeginShutdown(ref System.Array custom) { }</p>

<p class=ILprg>}</p>

<p class=ILprg>}</p>

<p class=ILbase><span style='color:windowtext'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=ILbase><span style='color:windowtext'>The above Add-in deals with Document
events. The property DocumentEvents provides a Document object. The parameter
supplied is a null value, by reason of which, the<span style="mso-spacerun:
yes">  </span>DocumentEvents object gets triggered for all documents. There are
four events that get triggered. <o:p></o:p></span></p>

<p class=ILbase><span style='color:windowtext'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=ILbase><span style='color:windowtext'>Firstly, ensure that the
solution vij30 is active. Then, activate the Add-in and select the project
vij20 from the start page (Help - Show Startpage). <o:p></o:p></span></p>

<p class=ILbase><span style='color:windowtext'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<table border=0 cellspacing=0 cellpadding=0 style='border-collapse:collapse;
 mso-padding-alt:0in 5.4pt 0in 5.4pt'>
 <tr>
  <td valign=top style='padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal><img width=400 height=300 id="_x0000_i1045"
  src="chap8/18.html"></p>
  </td>
 </tr>
 <tr>
  <td valign=top style='padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal>Screen 8.18</p>
  </td>
 </tr>
</table>

<p class=ILbase><span style='color:windowtext'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=ILbase><span style='color:windowtext'>The following output is visible
in the Output window:-<o:p></o:p></span></p>

<p class=ILbase><span style='color:windowtext'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=ILoutput>DocumentClosing Form1.cs</p>

<p class=ILoutput>DocumentClosing Form1.resx</p>

<p class=ILoutput>DocumentOpening<span style="mso-spacerun: yes"> 
</span>c:\v1\vij20\Class1.cs False</p>

<p class=ILoutput>DocumentOpened: Class1.cs</p>

<p class=ILoutput>DocumentSaved Class1.cs</p>

<p class=ILbase><span style='color:windowtext'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=ILbase><span style='color:windowtext'>The activation of a new project is
preceded by the closing of all open documents. Thus, the framework closes the
two documents that comprise the vij30 project, viz. Form1.cs and Form1.resx.
This triggers off the event DocumentClosing twice. This event is passed a
Document object. The Name property is printed out. <o:p></o:p></span></p>

<p class=ILbase><span style='color:windowtext'>Then, as a new solution is being
opened, and since the solution is made up of a single file named Class1.cs, the
event DocumentOpening is triggered off, and it is assigned two parameters. The
first one is the Document object whose Name property is displayed, and the
second is a bool that conveys whether the document is being opened in read-only
mode or not. <o:p></o:p></span></p>

<p class=ILbase><span style='color:windowtext'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=ILbase><span style='color:windowtext'>Since the document Class1.cs
permits changes, the bool variable holds a value of false. This event is
immediately followed by the event DocumentOpened with a similar document
parameter. The document is saved after integrating a few changes to the file
Class1.cs, using the menu option File - Save Class1.cs. Thereafter, the event
DocumentSaved gets triggered off. <o:p></o:p></span></p>

<p class=ILbase><span style='color:windowtext'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=ILprg>namespace vij25</p>

<p class=ILprg>{</p>

<p class=ILprg>using System;</p>

<p class=ILprg>using Microsoft.Office.Core;</p>

<p class=ILprg>using Extensibility;</p>

<p class=ILprg>using System.Runtime.InteropServices;</p>

<p class=ILprg>using EnvDTE;</p>

<p class=ILprg>using System.Windows.Forms;</p>

<p class=ILprg>[GuidAttribute(&quot;00271586-C6A9-44EF-A342-2E63FFD4D384&quot;),
ProgId(&quot;vij25.Connect&quot;)]</p>

<p class=ILprg>public class Connect : Object, Extensibility.IDTExtensibility2</p>

<p class=ILprg>{</p>

<p class=ILprg>OutputWindowPane op;</p>

<p class=ILprg>DTE applicationObject;</p>

<p class=ILprg>CommandEvents ce;</p>

<p class=ILprg>public void OnConnection(object application, ext_ConnectMode c,
object addInInst, ref System.Array custom)</p>

<p class=ILprg>{</p>

<p class=ILprg>applicationObject = (DTE)application;</p>

<p class=ILprg>Windows w = applicationObject.Windows;</p>

<p class=ILprg>Events e = applicationObject.Events;</p>

<p class=ILprg>Window ww = w.Item(Constants.vsWindowKindOutput);</p>

<p class=ILprg>OutputWindow o = (OutputWindow)ww.Object;</p>

<p class=ILprg>OutputWindowPanes oo =<span style="mso-spacerun: yes"> 
</span>o.OutputWindowPanes;</p>

<p class=ILprg>op = oo.Add(&quot;Vijay Mukhi&quot;);</p>

<p class=ILprg>ce =
e.get_CommandEvents(&quot;{00000000-0000-0000-0000-000000000000}&quot;, 0);</p>

<p class=ILprg>ce.AfterExecute += new
_dispCommandEvents_AfterExecuteEventHandler(cAfterExecute);</p>

<p class=ILprg>ce.BeforeExecute += new
_dispCommandEvents_BeforeExecuteEventHandler(cBeforeExecute);</p>

<p class=ILprg>}</p>

<p class=ILprg>public void OnDisconnection(Extensibility.ext_DisconnectMode
disconnectMode, ref System.Array custom)</p>

<p class=ILprg>{</p>

<p class=ILprg>ce.AfterExecute -= new
_dispCommandEvents_AfterExecuteEventHandler(cAfterExecute);</p>

<p class=ILprg>ce.BeforeExecute -= new
_dispCommandEvents_BeforeExecuteEventHandler(cBeforeExecute);</p>

<p class=ILprg>}</p>

<p class=ILprg>public void cAfterExecute(string g, int i, object c, object c1)</p>

<p class=ILprg>{</p>

<p class=ILprg>string s= &quot;&quot;;</p>

<p class=ILprg>s = applicationObject.Commands.Item(g,i).Name;</p>

<p class=ILprg>op.OutputString(&quot;AfterExecute &quot; + s + &quot; &quot; +
g + &quot; &quot; + i.ToString() + &quot;\n&quot;);</p>

<p class=ILprg>}</p>

<p class=ILprg>public void cBeforeExecute(string g, int i, object c, object c1,
ref bool d)</p>

<p class=ILprg>{</p>

<p class=ILprg>string s= &quot;&quot;;</p>

<p class=ILprg>s = applicationObject.Commands.Item(g,i).Name;</p>

<p class=ILprg>op.OutputString(&quot;BeforeExecute &quot; + s + &quot; &quot; +
g + &quot; &quot; + i.ToString() + &quot; &quot; + d.ToString() +
&quot;\n&quot;);</p>

<p class=ILprg>}</p>

<p class=ILprg>public void OnAddInsUpdate(ref System.Array custom) </p>

<p class=ILprg>{ </p>

<p class=ILprg>}</p>

<p class=ILprg>public void OnStartupComplete(ref System.Array custom) </p>

<p class=ILprg>{ </p>

<p class=ILprg>}</p>

<p class=ILprg>public void OnBeginShutdown(ref System.Array custom) </p>

<p class=ILprg>{ </p>

<p class=ILprg>}</p>

<p class=ILprg>}</p>

<p class=ILprg>}</p>

<p class=ILbase><span style='color:windowtext'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=ILbase><span style='color:windowtext'>The Add-in furnished above,
examines the CommandEvents. Yet again, the CommandEvents object is retrieved
from the Events object by resorting to the property CommandEvents. This
property necessitates two parameters.<o:p></o:p></span></p>

<p class=ILbase><span style='color:windowtext'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=ILbase><span style='color:windowtext'>The first parameter is a string
that represents a GUID. This string is in the form of 8 digits, followed by
three sets of four digits, and ends with 12 digits to form a 16 byte number.
The GUID for the command group can be supplied. A value of null signifies that
all the command groups are included.<o:p></o:p></span></p>

<p class=ILbase><span style='color:windowtext'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=ILbase><span style='color:windowtext'>The second parameter is an int
or an ID, which serves as an index into the command in the command group. Each
command has an index and a GUID. <o:p></o:p></span></p>

<p class=ILbase><span style='color:windowtext'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<table border=0 cellspacing=0 cellpadding=0 style='border-collapse:collapse;
 mso-padding-alt:0in 5.4pt 0in 5.4pt'>
 <tr>
  <td valign=top style='padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal><img width=400 height=300 id="_x0000_i1046"
  src="chap8/19.html"></p>
  </td>
 </tr>
 <tr>
  <td valign=top style='padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal>Screen 8.19</p>
  </td>
 </tr>
</table>

<p class=ILbase><span style='color:windowtext'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=ILbase><span style='color:windowtext'>This CommandEvents object has
only two events, viz. BeforeExecute and AfterExecute. When the Add-in is
activated by clicking on the OK button, the event AfterExecute gets called, as
illustrated below.<o:p></o:p></span></p>

<p class=ILbase><span style='color:windowtext'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=ILoutput>AfterExecute Tools.AddinManager
{5EFC7975-14BC-11CF-9B2B-00AA00573819} 297</p>

<p class=ILbase><span style='color:windowtext'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=ILbase><span style='color:windowtext'>This event takes four
parameters. The first parameter is the GUID of the command, which consists of
the textual name of the command, plus a GUID. The second parameter with a value
of 297, is the ID of the command. The last two parameters are custom arguments,
which are passed to the command and to the next event handler. <o:p></o:p></span></p>

<p class=ILbase><span style='color:windowtext'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=ILbase><span style='color:windowtext'>Now, select the menu option
View, Solution Explorer. This adds the following lines in the Output window:-<o:p></o:p></span></p>

<p class=ILoutput><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=ILoutput>BeforeExecute View.SolutionExplorer
{5EFC7975-14BC-11CF-9B2B-00AA00573819} 234 False</p>

<p class=ILoutput>AfterExecute View.SolutionExplorer
{5EFC7975-14BC-11CF-9B2B-00AA00573819} 234</p>

<p class=ILbase><span style='color:windowtext'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=ILbase><span style='color:windowtext'>The BeforeExecute event gets
called prior to the execution of the command. The text output clearly
postulates that the menu option of Solution Explorer had been selected. <o:p></o:p></span></p>

<p class=ILbase><span style='color:windowtext'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=ILbase><span style='color:windowtext'>Copy the above text from the
Output window. On pressing Ctrl-C, the following lines get displayed:-<o:p></o:p></span></p>

<p class=ILoutput><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=ILoutput>BeforeExecute Edit.Copy
{5EFC7975-14BC-11CF-9B2B-00AA00573819} 15 False</p>

<p class=ILoutput>AfterExecute Edit.Copy {5EFC7975-14BC-11CF-9B2B-00AA00573819}
15</p>

<p class=ILbase><span style='color:windowtext'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<table border=0 cellspacing=0 cellpadding=0 style='border-collapse:collapse;
 mso-padding-alt:0in 5.4pt 0in 5.4pt'>
 <tr>
  <td valign=top style='padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal><img width=400 height=300 id="_x0000_i1047"
  src="chap8/20.html"></p>
  </td>
 </tr>
 <tr>
  <td valign=top style='padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal>Screen 8.20</p>
  </td>
 </tr>
</table>

<p class=ILbase><span style='color:windowtext'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=ILbase><span style='color:windowtext'>This sample elucidates the fact
that although the Solution Explorer and Copy may inhabit different menus, they
share the same command group. The ID is used to differentiate between the distinct
commands within a command group.<o:p></o:p></span></p>

<p class=ILbase><span style='color:windowtext'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=ILprg>public void cBeforeExecute(string g, int i, object c, object c1,
ref bool d)</p>

<p class=ILprg>{</p>

<p class=ILprg>string s= &quot;&quot;;</p>

<p class=ILprg>s = applicationObject.Commands.Item(g,i).Name;</p>

<p class=ILprg>op.OutputString(&quot;BeforeExecute &quot; + s + &quot; &quot; +
g + &quot; &quot; + i.ToString() + &quot; &quot; + d.ToString() +
&quot;\n&quot;);</p>

<p class=ILprg>d = true;</p>

<p class=ILprg>}</p>

<p class=ILbase><span style='color:windowtext'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=ILbase><span style='color:windowtext'>Effect a minor alteration in the
cBeforeExecute function, by setting the last ref bool parameter that is passed
a value of true. By default, this variable has a value of false. Now, build the
Add-in. As before, the AfterExecute event gets called. Also, selecting any menu
option or shortcut henceforth, would prove to be futile, since none of them
would work. Try to activate any menu option or button from the toolbox,
including shortcuts such as Ctrl-Shift-B. Take our word, nothing will work! <o:p></o:p></span></p>

<p class=ILbase><span style='color:windowtext'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=ILbase><span style='color:windowtext'>The Output window lucidly
illustrates the fact that although the BeforeExecute and AfterExecute events
get triggered, code in the Visual Studio framework does not get called. The
Visual Studio.Net product has been built by employing the same code that we
have implemented here.<o:p></o:p></span></p>

<p class=ILbase><span style='color:windowtext'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=ILbase><span style='color:windowtext'>When we click on the menu option
View, Solution Explorer, either some code gets executed, or a listener gets
called. There can be innumerable such listeners registered for each command.
Every listener gets called in turn. If any listener changes the value of the
last ref parameter to true, as has been done by us, no other listener is
expected to execute code for that command, since some routing is handling the
events. This effectively disables all the code in Visual Studio.Net. Therefore,
returning a value of true apprises the framework of the fact that the program
would handle the request, and hence, it would not be delegated. <o:p></o:p></span></p>

<p class=ILbase><span style='color:windowtext'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=ILbase><span style='color:windowtext'>The last Add-in in this chapter
deals with the set of debugging events.<o:p></o:p></span></p>

<p class=ILbase><span style='color:windowtext'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=ILprg>namespace vij25</p>

<p class=ILprg>{</p>

<p class=ILprg>using System;</p>

<p class=ILprg>using Microsoft.Office.Core;</p>

<p class=ILprg>using Extensibility;</p>

<p class=ILprg>using System.Runtime.InteropServices;</p>

<p class=ILprg>using EnvDTE;</p>

<p class=ILprg>using System.Windows.Forms;</p>

<p class=ILprg>[GuidAttribute(&quot;81BA7553-4DE7-4A73-A0CD-48F644052262&quot;),
ProgId(&quot;vij25.Connect&quot;)]</p>

<p class=ILprg>public class Connect : Object, Extensibility.IDTExtensibility2</p>

<p class=ILprg>{</p>

<p class=ILprg>OutputWindowPane op;</p>

<p class=ILprg>DTE applicationObject;</p>

<p class=ILprg>DebuggerEvents de;</p>

<p class=ILprg>public Connect() </p>

<p class=ILprg>{ </p>

<p class=ILprg>MessageBox.Show(&quot;Connect&quot;); </p>

<p class=ILprg>}</p>

<p class=ILprg>public void OnConnection(object application,
Extensibility.ext_ConnectMode connectMode, object addInInst, ref System.Array
custom)</p>

<p class=ILprg>{</p>

<p class=ILprg>applicationObject = (DTE)application;</p>

<p class=ILprg>Windows w = applicationObject.Windows;</p>

<p class=ILprg>Events e = applicationObject.Events;</p>

<p class=ILprg>Window ww = w.Item(Constants.vsWindowKindOutput);</p>

<p class=ILprg>OutputWindow o = (OutputWindow)ww.Object;</p>

<p class=ILprg>OutputWindowPanes oo =<span style="mso-spacerun: yes"> 
</span>o.OutputWindowPanes;</p>

<p class=ILprg>op = oo.Add(&quot;Vijay Mukhi&quot;);</p>

<p class=ILprg>de = e.DebuggerEvents;</p>

<p class=ILprg style='margin-left:.3in'><span style='font-size:8.0pt'>de.OnContextChanged
+= new </span><span style='font-size:8.5pt'>_dispDebuggerEvents_OnContextChangedEventHandler(dOnContextChanged);<o:p></o:p></span></p>

<p class=ILprg style='margin-left:.3in'><span style='font-size:8.5pt'>de.OnEnterBreakMode
+= new _dispDebuggerEvents_OnEnterBreakModeEventHandler(dOnEnterBreakMode);<o:p></o:p></span></p>

<p class=ILprg style='margin-left:.3in'><span style='font-size:8.5pt'>de.OnEnterDesignMode
+= new _dispDebuggerEvents_OnEnterDesignModeEventHandler(dOnEnterDesignMode);<o:p></o:p></span></p>

<p class=ILprg style='margin-left:.3in'><span style='font-size:8.5pt'>de.OnEnterRunMode
+= new _dispDebuggerEvents_OnEnterRunModeEventHandler(dOnEnterRunMode);<o:p></o:p></span></p>

<p class=ILprg style='margin-left:.3in'><span style='font-size:8.5pt'>de.OnExceptionNotHandled
+= new
_dispDebuggerEvents_OnExceptionNotHandledEventHandler(dOnExceptionNotHandled);<o:p></o:p></span></p>

<p class=ILprg style='margin-left:.3in'><span style='font-size:8.5pt'>de.OnExceptionThrown
+= new _dispDebuggerEvents_OnExceptionThrownEventHandler(dOnExceptionThrown);<o:p></o:p></span></p>

<p class=ILprg>}</p>

<p class=ILprg>public void dOnContextChanged(Process p, Program pr, Thread t,
StackFrame f)</p>

<p class=ILprg>{</p>

<p class=ILprg>op.OutputString(&quot;OnContextChanged\n&quot;);</p>

<p class=ILprg>}</p>

<p class=ILprg>public void dOnEnterBreakMode(dbgEventReason r, ref
dbgExecutionAction a)</p>

<p class=ILprg>{</p>

<p class=ILprg>op.OutputString(&quot;OnEnterBreakMode &quot; + r.ToString() +
&quot; &quot; + a.ToString() + &quot;\n&quot;);</p>

<p class=ILprg>}</p>

<p class=ILprg>public void dOnEnterDesignMode(dbgEventReason r)</p>

<p class=ILprg>{</p>

<p class=ILprg>op.OutputString(&quot;OnEnterDesignMode &quot; + r.ToString() +
&quot;\n&quot;);</p>

<p class=ILprg>}</p>

<p class=ILprg>public void dOnEnterRunMode(dbgEventReason r)</p>

<p class=ILprg>{</p>

<p class=ILprg>op.OutputString(&quot;OnEnterRunMode &quot; + r.ToString() +
&quot;\n&quot;);</p>

<p class=ILprg>}</p>

<p class=ILprg>public void dOnExceptionNotHandled(string e, string n, int c,
string d, ref dbgExceptionAction a)</p>

<p class=ILprg>{</p>

<p class=ILprg>op.OutputString(&quot;OnExceptionNotHandled-&quot; + e +
&quot;-&quot; + n + &quot;-&quot; + c.ToString() + &quot;-&quot; + d +
&quot;-&quot; + a.ToString() + &quot;-\n&quot;);</p>

<p class=ILprg>}</p>

<p class=ILprg>public void dOnExceptionThrown(string e, string n, int c, string
d, ref dbgExceptionAction a)</p>

<p class=ILprg>{</p>

<p class=ILprg>op.OutputString(&quot;OnExceptionThrown\n&quot;);</p>

<p class=ILprg>}</p>

<p class=ILprg>public void OnDisconnection(Extensibility.ext_DisconnectMode
disconnectMode, ref System.Array custom) { }</p>

<p class=ILprg>public void OnAddInsUpdate(ref System.Array custom) { }</p>

<p class=ILprg>public void OnStartupComplete(ref System.Array custom) { }</p>

<p class=ILprg>public void OnBeginShutdown(ref System.Array custom) { }</p>

<p class=ILprg>}</p>

<p class=ILprg>}</p>

<p class=ILbase><span style='color:windowtext'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=ILbase><span style='color:windowtext'>We access the DebuggerEvents
using the property DebuggerEvents. This class has six debugger events in total.
In the Windows Application, first activate the Add-in and then select the
Windows project.<o:p></o:p></span></p>

<p class=ILbase><span style='color:windowtext'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=ILbase><span style='color:windowtext'>Thereafter click on menu Debug
followed by the menu item Start. This act triggers off an event OnEnterRunMode
as the debugger has now entered run mode.<span style="mso-spacerun: yes"> 
</span>This event is used to update the user interface. It is passed one
parameter that is an enum dbgEventReason that can take as many as 13 different
values, and thus giving a reason as to why the event got called. <o:p></o:p></span></p>

<p class=ILbase><span style='color:windowtext'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=ILbase><span style='color:windowtext'>The value seen is
dbgEventReasonGo because the Start option is clicked on. Also, when the form is
closed, another event called OnEnterDesignMode gets fired. This happens since
the mode is changed from the run or debug mode to design mode. The reason enum
clearly indicates that there is no reason for the event being fired as the user
closed the form, to switch to the Design mode. <o:p></o:p></span></p>

<p class=ILbase><span style='color:windowtext'>Next click on the Debug option
and then the menu option Step Into, that allows single stepping the program.
This activates the event OnEnterBreakMode with a reason
dbgExecutionActionDefault as it is the default way of entering the break mode.<o:p></o:p></span></p>

<p class=ILbase><span style='color:windowtext'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<table border=0 cellspacing=0 cellpadding=0 style='border-collapse:collapse;
 mso-padding-alt:0in 5.4pt 0in 5.4pt'>
 <tr>
  <td valign=top style='padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal><img width=400 height=300 id="_x0000_i1048"
  src="chap8/21.html"></p>
  </td>
 </tr>
 <tr>
  <td valign=top style='padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal>Screen 8.21</p>
  </td>
 </tr>
</table>

<p class=ILbase><span style='color:windowtext'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=ILbase><span style='color:windowtext'>Now add some code to the simple
windows application. The Main function has a newly inserted line which is as
follows.<o:p></o:p></span></p>

<p class=ILbase><span style='color:windowtext'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=ILprg>static void Main()<span style="mso-spacerun: yes">  </span>{</p>

<p class=ILprg>throw new System.Exception(&quot;hi&quot;);</p>

<p class=ILprg>Application.Run(new Form1());</p>

<p class=ILprg>}</p>

<p class=ILbase><span style='color:windowtext'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=ILbase><span style='color:windowtext'>Thereafter click on the menu
option Debug and then on Start. This leads to screen 8.22 where the first
function to be called is Main. <o:p></o:p></span></p>

<p class=ILbase><span style='color:windowtext'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<table border=0 cellspacing=0 cellpadding=0 style='border-collapse:collapse;
 mso-padding-alt:0in 5.4pt 0in 5.4pt'>
 <tr>
  <td valign=top style='padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal><img width=400 height=300 id="_x0000_i1049"
  src="chap8/22.html"></p>
  </td>
 </tr>
 <tr>
  <td valign=top style='padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal>Screen 8.22</p>
  </td>
 </tr>
</table>

<p class=ILbase><span style='color:windowtext'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=ILbase><span style='color:windowtext'>The first line of code in Main
throws an exception. At this juncture, click on break and then on menu Debug,
Continue. The following lines are seen added to the Output window.<o:p></o:p></span></p>

<p class=ILbase><span style='color:windowtext'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=ILoutput>OnEnterRunMode dbgEventReasonGo</p>

<p class=ILoutput>OnExceptionNotHandled-Common Language Runtime
Exceptions-System.Exception-0-An unhandled exception of type 'System.Exception'
occurred in vij30.exe</p>

<p class=ILoutput>Additional information: hi</p>

<p class=ILoutput>-dbgExceptionActionDefault-</p>

<p class=ILoutput>OnEnterBreakMode dbgEventReasonExceptionNotHandled
dbgExecutionActionDefault</p>

<p class=ILoutput>OnEnterRunMode dbgEventReasonGo</p>

<p class=ILoutput>OnEnterDesignMode dbgEventReasonNone</p>

<p class=ILbase><span style='color:windowtext'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=ILbase><span style='color:windowtext'>The first event is obvious and
has been seen before. Then the debugger encounters a throw statement. It
displays a dialog box with the options of Break or Continue. This also
signifies that the exception was not handled, thus triggering the event
OnExceptionNotHandled . <o:p></o:p></span></p>

<p class=ILbase><span style='color:windowtext'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=ILbase><span style='color:windowtext'>The first parameter is the name
of the exception i.e. Common Language Runtime Exceptions. The other three
possible values are<span style="mso-spacerun: yes">   </span>C++, a native
runtime check or a Win32 exception. The next parameter is the name of the
exception System.Exception that is thrown. <o:p></o:p></span></p>

<p class=ILbase><span style='color:windowtext'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<table border=0 cellspacing=0 cellpadding=0 style='border-collapse:collapse;
 mso-padding-alt:0in 5.4pt 0in 5.4pt'>
 <tr>
  <td valign=top style='padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal><img width=400 height=300 id="_x0000_i1050"
  src="chap8/23.html"></p>
  </td>
 </tr>
 <tr>
  <td valign=top style='padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal>Screen 8.23</p>
  </td>
 </tr>
</table>

<p class=ILbase><span style='color:windowtext'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=ILbase><span style='color:windowtext'>The line of code where the
exception occurs is at int 0.<span style="mso-spacerun: yes">  </span>This is
followed by a really large description of the exception including the string
passed to the exception. <o:p></o:p></span></p>

<p class=ILbase><span style='color:windowtext'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=ILbase><span style='color:windowtext'>The last parameter is an enum
dbgExceptionAction that notifies the system how the exception should be
handled. It takes one of the four values. The value passed asks for the default
action dbgExceptionActionDefault to be carried. The others are
dbgExceptionActionIgnore, dbgExceptionActionBreak and dbgExceptionActionContinue.
<o:p></o:p></span></p>

<p class=ILbase><span style='color:windowtext'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=ILbase><span style='color:windowtext'>The event OnExceptionThrown does
not get called ever even when the throw clause is placed in the try and catch
statements.<o:p></o:p></span></p>

<p class=ILbase><span style='color:windowtext'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=ILbase><span style='color:windowtext'>Now introduce one small addition
to the function dOnExceptionNotHandled. <o:p></o:p></span></p>

<p class=ILbase><span style='color:windowtext'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=ILprg>public void dOnExceptionNotHandled(string e, string n, int c,
string d, ref dbgExceptionAction a) </p>

<p class=ILprg>{</p>

<p class=ILprg>op.OutputString(&quot;OnExceptionNotHandled-&quot; + e +
&quot;-&quot; + n + &quot;-&quot; + c.ToString() + &quot;-&quot; + d +
&quot;-&quot; + a.ToString() + &quot;-\n&quot;);</p>

<p class=ILprg>a = dbgExceptionAction.dbgExceptionActionBreak;</p>

<p class=ILprg>}</p>

<p class=ILbase><span style='color:windowtext'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=ILbase><span style='color:windowtext'>The dialog box is not displayed
as the last ref parameter a of type dbgExceptionAction is set to a value
dbgExceptionActionBreak. The default value is dbgExceptionActionDefault which
displays the dialog box.<span style="mso-spacerun: yes">  </span>The value of
dbgExceptionActionBreak sets the option to Break, thus avoiding any clicks
required on the button Break in the Dialog box. Thus, the entire workings of
Visual Studio.Net can be predecided and programmed.<o:p></o:p></span></p>

<p class=ILbase><span style='color:windowtext'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=ILbase><span style='color:windowtext'>Add-ins can possess extender
properties, whereby properties could be added to the solution and to the other
windows. However, to facilitate this, the registry needs to be modified, and
certain keys containing specific data and values need to be inserted. <o:p></o:p></span></p>

<p class=ILbase><span style='color:windowtext'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=ILbase><span style='color:windowtext'>We have decided to wrap up this
book at this juncture. Thereby, we have effectively postponed the explanation
of this imperative task to our forthcoming book. We have been compelled to do
so, because only by providing a comprehensive explanation, would we be able to
do full justice to this topic.<o:p></o:p></span></p>

<p class=ILbase><span style='color:windowtext'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=VSBASE><span style='color:windowtext'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

</div>

</body>


<!-- Mirrored from www.vijaymukhi.com/documents/books/vs2net/chap8.htm by HTTrack Website Copier/3.x [XR&CO'2014], Fri, 11 Oct 2024 14:13:16 GMT -->
</html>
