<html xmlns:v="urn:schemas-microsoft-com:vml"
xmlns:o="urn:schemas-microsoft-com:office:office"
xmlns:w="urn:schemas-microsoft-com:office:word"
xmlns="http://www.w3.org/TR/REC-html40">


<!-- Mirrored from www.vijaymukhi.com/documents/books/vs2net/chap3.htm by HTTrack Website Copier/3.x [XR&CO'2014], Fri, 11 Oct 2024 14:08:35 GMT -->
<head>
<meta http-equiv=Content-Type content="text/html; charset=windows-1252">
<meta name=ProgId content=Word.Document>
<meta name=Generator content="Microsoft Word 9">
<meta name=Originator content="Microsoft Word 9">
<link rel=File-List href="chap3_files/filelist.html">
<link rel=Edit-Time-Data href="chap3_files/editdata.html">
<!--[if !mso]>
<style>
v\:* {behavior:url(#default#VML);}
o\:* {behavior:url(#default#VML);}
w\:* {behavior:url(#default#VML);}
.shape {behavior:url(#default#VML);}
</style>
<![endif]-->
<title>Visual Studio.Net - Controls and Add-ins</title>
<!--[if gte mso 9]><xml>
 <o:DocumentProperties>
  <o:Author>vmukhi</o:Author>
  <o:LastAuthor>vmukhi</o:LastAuthor>
  <o:Revision>22</o:Revision>
  <o:TotalTime>27</o:TotalTime>
  <o:Created>2002-01-21T06:04:00Z</o:Created>
  <o:LastSaved>2002-01-22T07:25:00Z</o:LastSaved>
  <o:Pages>16</o:Pages>
  <o:Words>3910</o:Words>
  <o:Characters>22290</o:Characters>
  <o:Company>V.M.C.I.</o:Company>
  <o:Lines>185</o:Lines>
  <o:Paragraphs>44</o:Paragraphs>
  <o:CharactersWithSpaces>27373</o:CharactersWithSpaces>
  <o:Version>9.2720</o:Version>
 </o:DocumentProperties>
</xml><![endif]-->
<style>
<!--
 /* Font Definitions */
@font-face
	{font-family:Tahoma;
	panose-1:2 11 6 4 3 5 4 4 2 4;
	mso-font-charset:0;
	mso-generic-font-family:swiss;
	mso-font-pitch:variable;
	mso-font-signature:553679495 -2147483648 8 0 66047 0;}
@font-face
	{font-family:"Bookman Old Style";
	panose-1:2 5 6 4 5 5 5 2 2 4;
	mso-font-charset:0;
	mso-generic-font-family:roman;
	mso-font-pitch:variable;
	mso-font-signature:647 0 0 0 159 0;}
@font-face
	{font-family:"Trebuchet MS";
	panose-1:2 11 6 3 2 2 2 2 2 4;
	mso-font-charset:0;
	mso-generic-font-family:swiss;
	mso-font-pitch:variable;
	mso-font-signature:7 0 0 0 19 0;}
@font-face
	{font-family:"Monotype Corsiva";
	panose-1:3 1 1 1 1 2 1 1 1 1;
	mso-font-charset:0;
	mso-generic-font-family:script;
	mso-font-pitch:variable;
	mso-font-signature:647 0 0 0 159 0;}
 /* Style Definitions */
p.MsoNormal, li.MsoNormal, div.MsoNormal
	{mso-style-parent:"";
	margin:0in;
	margin-bottom:.0001pt;
	mso-pagination:widow-orphan;
	font-size:12.0pt;
	font-family:"Times New Roman";
	mso-fareast-font-family:"Times New Roman";}
p.ILbase, li.ILbase, div.ILbase
	{mso-style-name:ILbase;
	mso-style-parent:"";
	margin:0in;
	margin-bottom:.0001pt;
	text-align:justify;
	mso-pagination:widow-orphan;
	mso-layout-grid-align:none;
	text-autospace:none;
	font-size:10.0pt;
	font-family:"Bookman Old Style";
	mso-fareast-font-family:"Times New Roman";
	mso-bidi-font-family:"Times New Roman";
	color:black;}
p.ILprg, li.ILprg, div.ILprg
	{mso-style-name:ILprg;
	mso-style-parent:ILbase;
	mso-style-next:ILbase;
	margin-top:0in;
	margin-right:0in;
	margin-bottom:0in;
	margin-left:.5in;
	margin-bottom:.0001pt;
	mso-pagination:widow-orphan;
	mso-layout-grid-align:none;
	text-autospace:none;
	font-size:9.5pt;
	font-family:"Trebuchet MS";
	mso-fareast-font-family:"Times New Roman";
	mso-bidi-font-family:"Times New Roman";}
p.ILoutput, li.ILoutput, div.ILoutput
	{mso-style-name:ILoutput;
	mso-style-parent:ILbase;
	mso-style-next:ILbase;
	margin-top:0in;
	margin-right:0in;
	margin-bottom:0in;
	margin-left:.5in;
	margin-bottom:.0001pt;
	mso-pagination:widow-orphan;
	mso-layout-grid-align:none;
	text-autospace:none;
	font-size:9.5pt;
	font-family:Tahoma;
	mso-fareast-font-family:"Times New Roman";}
p.ILbullets, li.ILbullets, div.ILbullets
	{mso-style-name:ILbullets;
	mso-style-parent:ILbase;
	margin-top:0in;
	margin-right:0in;
	margin-bottom:0in;
	margin-left:.3in;
	margin-bottom:.0001pt;
	text-align:justify;
	mso-pagination:widow-orphan;
	mso-layout-grid-align:none;
	text-autospace:none;
	font-size:10.0pt;
	font-family:"Bookman Old Style";
	mso-fareast-font-family:"Times New Roman";
	mso-bidi-font-family:"Times New Roman";}
@page Section1
	{size:8.5in 11.0in;
	margin:1.0in 1.25in 1.0in 1.25in;
	mso-header-margin:.5in;
	mso-footer-margin:.5in;
	mso-paper-source:0;}
div.Section1
	{page:Section1;}
-->
</style>
</head>

<body lang=EN-US style='tab-interval:.5in'>

<div class=Section1>

<p class=MsoNormal><img width=103 height=77 id="_x0000_i1025"
src="bpb.gif"></p>

<p class=MsoNormal style='mso-layout-grid-align:none;text-autospace:none'><span
style='font-size:24.0pt;font-family:"Monotype Corsiva";color:black'>3.</span></p>

<p class=MsoNormal><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=MsoNormal style='mso-layout-grid-align:none;text-autospace:none'><span
style='font-size:24.0pt;font-family:"Monotype Corsiva";color:black'>Type
Conversion</span><span style='font-size:20.0pt;font-family:"Monotype Corsiva"'><o:p></o:p></span></p>

<p class=ILbase><span style='color:windowtext'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=ILbase><span style='color:windowtext'>The preceding chapter was
riveted around the creation of a User Interface Type Editor. However, in this chapter,
we shall explore how to convert one type into another. <o:p></o:p></span></p>

<p class=ILbase><span style='color:windowtext'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=ILprg><u>a.cs</u></p>

<p class=ILprg>using System;</p>

<p class=ILprg>using System.IO;</p>

<p class=ILprg>using System.ComponentModel;</p>

<p class=ILprg>using System.Globalization;</p>

<p class=ILprg>using System.Drawing;</p>

<p class=ILprg>using System.Windows.Forms;</p>

<p class=ILprg>public class aaa : UserControl<span style="mso-spacerun: yes"> 
</span></p>

<p class=ILprg>{</p>

<p class=ILprg>Point b1;</p>

<p class=ILprg>public Point a1</p>

<p class=ILprg>{</p>

<p class=ILprg>get {</p>

<p class=ILprg>return b1;</p>

<p class=ILprg>}</p>

<p class=ILprg>set {</p>

<p class=ILprg>b1 = value;</p>

<p class=ILprg>}</p>

<p class=ILprg>}</p>

<p class=ILprg>}</p>

<p class=ILbase><span style='color:windowtext'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=ILbase><span style='color:windowtext'>The control used in the previous
chapter has been reemployed here. This control has a property a1 of type Point.
On initiating this control into the form, the Properties window metamorphoses
(as witnessed in screen 3.1), to incorporate the properties associated with the
control. The property a1 displays a plus sign, which signifies that some
properties exist within this control. <o:p></o:p></span></p>

<p class=ILbase><span style='color:windowtext'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<table border=0 cellspacing=0 cellpadding=0 style='border-collapse:collapse;
 mso-padding-alt:0in 5.4pt 0in 5.4pt'>
 <tr>
  <td valign=top style='padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal><img width=400 height=300 id="_x0000_i1026"
  src="chap3/1.jpg"><o:p></o:p></p>
  </td>
 </tr>
 <tr>
  <td valign=top style='padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal>Screen 3.1<o:p></o:p></p>
  </td>
 </tr>
</table>

<p class=ILbase><span style='color:windowtext'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=ILbase><span style='color:windowtext'>The values displayed are the
string representation of the values of the individual properties. <o:p></o:p></span></p>

<p class=ILbase><span style='color:windowtext'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=ILbase><span style='color:windowtext'>A Point object actually consists
of two properties X and Y. Thus, the values observed are the current values of
the properties X and Y, separated by a comma. Clicking on the plus sign, brings
forth the individual values of the two properties X and Y, as seen in screen
3.2. In this case, both of these share a value of 0. <o:p></o:p></span></p>

<p class=ILbase><span style='color:windowtext'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<table border=0 cellspacing=0 cellpadding=0 style='border-collapse:collapse;
 mso-padding-alt:0in 5.4pt 0in 5.4pt'>
 <tr>
  <td valign=top style='padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal><img width=400 height=300 id="_x0000_i1027"
  src="chap3/2.jpg"><o:p></o:p></p>
  </td>
 </tr>
 <tr>
  <td valign=top style='padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal>Screen 3.2<o:p></o:p></p>
  </td>
 </tr>
</table>

<p class=ILbase><span style='color:windowtext'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=ILprg><u>a.cs</u></p>

<p class=ILprg>using System;</p>

<p class=ILprg>using System.IO;</p>

<p class=ILprg>using System.ComponentModel;</p>

<p class=ILprg>using System.Globalization;</p>

<p class=ILprg>using System.Drawing;</p>

<p class=ILprg>using System.Windows.Forms;</p>

<p class=ILprg>public class aaa : UserControl</p>

<p class=ILprg>{</p>

<p class=ILprg>[TypeConverter(typeof(StringConverter))]</p>

<p class=ILprg>public Point a1</p>

<p class=ILprg>{</p>

<p class=ILprg>get</p>

<p class=ILprg>{</p>

<p class=ILprg>return new Point(10,20);</p>

<p class=ILprg>}</p>

<p class=ILprg>set</p>

<p class=ILprg>{</p>

<p class=ILprg>}</p>

<p class=ILprg>}</p>

<p class=ILprg>}</p>

<p class=ILbase><span style='color:windowtext'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=ILbase><span style='color:windowtext'>A few amendments have been made
to the earlier control. The attribute called TypeConverter has been added,
thereby specifying a type to the constructor. This type is the class
StringConverter. Resultantly, the plus sign gets displaced from the property a1
and merely a string representation of the object is visible, as is evident in
screen 3.3. <o:p></o:p></span></p>

<p class=ILbase><span style='color:windowtext'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<table border=0 cellspacing=0 cellpadding=0 style='border-collapse:collapse;
 mso-padding-alt:0in 5.4pt 0in 5.4pt'>
 <tr>
  <td valign=top style='padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal><img width=400 height=300 id="_x0000_i1028"
  src="chap3/3.jpg"><o:p></o:p></p>
  </td>
 </tr>
 <tr>
  <td valign=top style='padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal>Screen 3.3<o:p></o:p></p>
  </td>
 </tr>
</table>

<p class=ILbase><span style='color:windowtext'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=ILbase><span style='color:windowtext'>The property now returns a Point
object, which is displayed as a string. It is as an outcome of the
TypeConverter employing the StringConverter class to display the type as a
string and not as a Point. <o:p></o:p></span></p>

<p class=ILbase><span style='color:windowtext'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=ILprg><u>a.cs</u></p>

<p class=ILprg>using System;</p>

<p class=ILprg>using System.IO;</p>

<p class=ILprg>using System.ComponentModel;</p>

<p class=ILprg>using System.Globalization;</p>

<p class=ILprg>using System.Drawing;</p>

<p class=ILprg>using System.Windows.Forms;</p>

<p class=ILprg>public class aaa : UserControl</p>

<p class=ILprg>{</p>

<p class=ILprg>[TypeConverter(typeof(bbb))]</p>

<p class=ILprg>Point b1 = new Point(10,20);</p>

<p class=ILprg>public Point a1</p>

<p class=ILprg>{</p>

<p class=ILprg>get</p>

<p class=ILprg>{</p>

<p class=ILprg>return b1;</p>

<p class=ILprg>}</p>

<p class=ILprg>set</p>

<p class=ILprg>{</p>

<p class=ILprg>b1 = value;</p>

<p class=ILprg>}</p>

<p class=ILprg>}</p>

<p class=ILprg>}</p>

<p class=ILprg>public class bbb : PointConverter</p>

<p class=ILprg>{</p>

<p class=ILprg>}</p>

<p class=ILbase><span style='color:windowtext'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=ILbase><span style='color:windowtext'>Now, the parameter changes to
type bbb and is assigned to the TypeConverter attribute. This class bbb is
derived from PointConverter. However, screen 3.4 does not display anything new.
Everything remains in its pristine state. The Point property a1 displays its
wares just as a point representation is expected to. <o:p></o:p></span></p>

<p class=ILbase><span style='color:windowtext'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<table border=0 cellspacing=0 cellpadding=0 style='border-collapse:collapse;
 mso-padding-alt:0in 5.4pt 0in 5.4pt'>
 <tr>
  <td valign=top style='padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal><img width=400 height=300 id="_x0000_i1029"
  src="chap3/4.jpg"><o:p></o:p></p>
  </td>
 </tr>
 <tr>
  <td valign=top style='padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal>Screen 3.4<o:p></o:p></p>
  </td>
 </tr>
</table>

<p class=ILbase><span style='color:windowtext'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=ILbase><span style='color:windowtext'>Thus, it is safe to assume that
the Point class has an attribute TypeConverter, and a PointConverter is passed as
a parameter to it. Subsequent to this, we shall unfold the process of tracking
down all the attributes that a class is filled by.<o:p></o:p></span></p>

<p class=ILbase><span style='color:windowtext'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=ILprg><u>a.cs</u></p>

<p class=ILprg>using System;</p>

<p class=ILprg>using System.IO;</p>

<p class=ILprg>using System.ComponentModel;</p>

<p class=ILprg>using System.Globalization;</p>

<p class=ILprg>using System.Drawing;</p>

<p class=ILprg>using System.Windows.Forms;</p>

<p class=ILprg>public class aaa : UserControl</p>

<p class=ILprg>{</p>

<p class=ILprg>yyy b1 = new yyy(1,2);</p>

<p class=ILprg>[TypeConverter(typeof(bbb))]</p>

<p class=ILprg>public yyy a1</p>

<p class=ILprg>{</p>

<p class=ILprg>get</p>

<p class=ILprg>{</p>

<p class=ILprg>sss.abc(&quot;aaa get &quot;);</p>

<p class=ILprg>return b1;</p>

<p class=ILprg>}</p>

<p class=ILprg>set</p>

<p class=ILprg>{</p>

<p class=ILprg>sss.abc(&quot;aaa set &quot;);</p>

<p class=ILprg>b1 = value;</p>

<p class=ILprg>}</p>

<p class=ILprg>}</p>

<p class=ILprg>}</p>

<p class=ILprg>public class yyy</p>

<p class=ILprg>{</p>

<p class=ILprg>public yyy(int x , int y)</p>

<p class=ILprg>{</p>

<p class=ILprg>sss.abc(&quot;yyy Constructor&quot;);</p>

<p class=ILprg>}</p>

<p class=ILprg>public override string ToString()</p>

<p class=ILprg>{</p>

<p class=ILprg>sss.abc(&quot;yyy ToString&quot;);</p>

<p class=ILprg>return &quot;Vijay&quot;;</p>

<p class=ILprg>}</p>

<p class=ILprg>}</p>

<p class=ILprg>public class sss</p>

<p class=ILprg>{</p>

<p class=ILprg>public static void abc(string s)</p>

<p class=ILprg>{</p>

<p class=ILprg>FileStream fs = new FileStream(&quot;c:\\a1\\a.txt&quot;,
FileMode.Append, FileAccess.Write);</p>

<p class=ILprg>StreamWriter w = new StreamWriter(fs);</p>

<p class=ILprg>w.WriteLine(s);</p>

<p class=ILprg>w.Flush();</p>

<p class=ILprg>w.Close();</p>

<p class=ILprg>}</p>

<p class=ILprg>}</p>

<p class=ILprg>public class bbb : TypeConverter</p>

<p class=ILprg>{</p>

<p class=ILprg>public bbb()</p>

<p class=ILprg>{</p>

<p class=ILprg>sss.abc(&quot;bbb Constructor&quot;);</p>

<p class=ILprg>}</p>

<p class=ILprg>}</p>

<p class=ILbase><span style='color:windowtext'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=ILoutput><u>a.txt</u></p>

<p class=ILoutput>yyy Constructor</p>

<p class=ILoutput>aaa get </p>

<p class=ILoutput>bbb Constructor</p>

<p class=ILoutput>aaa get </p>

<p class=ILoutput>yyy ToString</p>

<p class=ILoutput>aaa get </p>

<p class=ILoutput>yyy ToString</p>

<p class=ILbase><span style='color:windowtext'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=ILbase><span style='color:windowtext'>In the above control, the
property a1 is of type yyy. This class yyy is not derived from any other class.
Hence, it derives from the base class object. It has a constructor with two
parameters, and it overrides the ToString function from the object. This function
is invoked whenever a String representation of the yyy object is required.<o:p></o:p></span></p>

<p class=ILbase><span style='color:windowtext'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=ILbase><span style='color:windowtext'>When the control is ushered into
the form, the Properties window establishes how the yyy object should be
displayed by it. If the TypeConverter attribute is missing, it calls the
ToString function of the class to display the string representation of the
object. <o:p></o:p></span></p>

<p class=ILbase><span style='color:windowtext'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=ILbase><span style='color:windowtext'>All the classes need recourse to
the function abc. Hence, we devised a class sss and installed the function abc
as the static member of this class. This is how it is made accessible to the
other three classes. <o:p></o:p></span></p>

<p class=ILbase><span style='color:windowtext'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=ILbase><span style='color:windowtext'>Being an Instance type, the
variable b1 gets created first. Hence, the yyy constructor is seen as the first
line in our file a.txt.<span style="mso-spacerun: yes">  </span>Then, since the
property a1 is to be displayed, the get accessor of the property is summoned.
For reasons unclear, it gets called a good many times. We presume that this is
so because the property window does not have adequate faith in the get accessor
of the property. This get accessor returns a yyy object. But, prior to displaying
the yyy object, the Properties window shall use the TypeConverter attribute to
determine how a yyy type should be displayed. Since the class bbb exists with
the attribute, it calls the constructor from the class bbb. <o:p></o:p></span></p>

<p class=ILbase><span style='color:windowtext'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=ILbase><span style='color:windowtext'>The class bbb is derived from
the class TypeConverter. In fact, all Converter classes are derived from the
TypeConverter. Therefore, any class specified with the TypeConverter attribute
must necessarily be a class derived from TypeConverter. The PointConverter
class that we had used a short while ago, has also been derived from the class
TypeConverter. <o:p></o:p></span></p>

<p class=ILbase><span style='color:windowtext'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=ILbase><span style='color:windowtext'>The get accessor gets called yet
again. It returns the yyy object, which we shall explore shortly. The ToString
function of the class yyy gets called, and since it returns 'Vijay', we see 'Vijay'
as the value of the property in the Properties window, as displayed in screen
3.5. <o:p></o:p></span></p>

<p class=ILbase><span style='color:windowtext'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<table border=0 cellspacing=0 cellpadding=0 style='border-collapse:collapse;
 mso-padding-alt:0in 5.4pt 0in 5.4pt'>
 <tr>
  <td valign=top style='padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal><img width=400 height=300 id="_x0000_i1030"
  src="chap3/5.jpg"><o:p></o:p></p>
  </td>
 </tr>
 <tr>
  <td valign=top style='padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal>Screen 3.5<o:p></o:p></p>
  </td>
 </tr>
</table>

<p class=ILbase><span style='color:windowtext'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=ILbase><span style='color:windowtext'>Since the property a1 of type
yyy is a read only property, we are prohibited from making any changes to it. <o:p></o:p></span></p>

<p class=ILbase><span style='color:windowtext'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=ILprg><u>a.cs</u></p>

<p class=ILprg>public class bbb : TypeConverter</p>

<p class=ILprg>{</p>

<p class=ILprg>public override bool CanConvertFrom(ITypeDescriptorContext
c,Type t) </p>

<p class=ILprg>{</p>

<p class=ILprg>sss.abc(&quot;CanConvertFrom &quot; + t.ToString());</p>

<p class=ILprg>return true;</p>

<p class=ILprg>}</p>

<p class=ILprg>public override bool CanConvertTo(ITypeDescriptorContext c,Type
t) </p>

<p class=ILprg>{</p>

<p class=ILprg>sss.abc(&quot;CanConvertTo &quot; + t.ToString());</p>

<p class=ILprg>return true;</p>

<p class=ILprg>}</p>

<p class=ILprg>}</p>

<p class=ILbase><span style='color:windowtext'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=ILbase><span style='color:windowtext'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=ILoutput><u>a.txt</u></p>

<p class=ILoutput>yyy Constructor</p>

<p class=ILoutput>aaa get </p>

<p class=ILoutput>CanConvertFrom System.String</p>

<p class=ILoutput>aaa get </p>

<p class=ILoutput>yyy ToString</p>

<p class=ILbase><span style='color:windowtext'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=ILbase><span style='color:windowtext'>In this program, the classes
aaa, sss and yyy remain unaltered. The changes effected in the class bbb are
reflected above. Two functions named CanConvertFrom and CanConvertTo, which
reside in the class TypeConverter, are added to this class. <o:p></o:p></span></p>

<p class=ILbase><span style='color:windowtext'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=ILbase><span style='color:windowtext'>After the 'get' accessor returns
the yyy object, Visual Studio.Net calls the CanConvertFrom function to convert
the yyy type into a string. This is precisely why the Type parameter t is of type
String. Moreover, the Properties window displays everything as a string. The
return value of True confirms the conversion from a yyy type to a string type. <o:p></o:p></span></p>

<p class=ILbase><span style='color:windowtext'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=ILbase><span style='color:windowtext'>The Properties window feels
elated on encountering a value of True. However, when we change the value of
the string displayed and press enter, an error window is hurled at us, as seen
in screen 3.6.<o:p></o:p></span></p>

<p class=ILbase><span style='color:windowtext'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<table border=0 cellspacing=0 cellpadding=0 style='border-collapse:collapse;
 mso-padding-alt:0in 5.4pt 0in 5.4pt'>
 <tr>
  <td valign=top style='padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal><img width=300 height=300 id="_x0000_i1031"
  src="chap3/6.jpg"><o:p></o:p></p>
  </td>
 </tr>
 <tr>
  <td valign=top style='padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal>Screen 3.6<o:p></o:p></p>
  </td>
 </tr>
</table>

<p class=ILbase><span style='color:windowtext'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=ILprg><u>a.cs</u></p>

<p class=ILprg>public class yyy</p>

<p class=ILprg>{</p>

<p class=ILprg>public int a,b;</p>

<p class=ILprg>public yyy(int x , int y)</p>

<p class=ILprg>{</p>

<p class=ILprg>sss.abc(&quot;yyy Constructor&quot;);</p>

<p class=ILprg>a = x;</p>

<p class=ILprg>b = y;</p>

<p class=ILprg>}</p>

<p class=ILprg>public override string ToString()</p>

<p class=ILprg>{</p>

<p class=ILprg>sss.abc(&quot;yyy ToString&quot;);</p>

<p class=ILprg>return a + &quot;,&quot; + b;</p>

<p class=ILprg>}</p>

<p class=ILprg>}</p>

<p class=ILprg><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=ILprg>public class bbb : TypeConverter</p>

<p class=ILprg>{</p>

<p class=ILprg>public override bool CanConvertFrom(ITypeDescriptorContext
c,Type t) </p>

<p class=ILprg>{</p>

<p class=ILprg>sss.abc(&quot;CanConvertFrom &quot; + t.ToString());</p>

<p class=ILprg>return true;</p>

<p class=ILprg>}</p>

<p class=ILprg>public override bool CanConvertTo(ITypeDescriptorContext c,Type
t) </p>

<p class=ILprg>{</p>

<p class=ILprg>sss.abc(&quot;CanConvertTo &quot; + t.ToString());</p>

<p class=ILprg>return true;</p>

<p class=ILprg>}</p>

<p class=ILprg>public override object ConvertTo(ITypeDescriptorContext
c,CultureInfo cu, object v, Type t) </p>

<p class=ILprg>{<span style="mso-spacerun: yes">  </span></p>

<p class=ILprg>sss.abc(&quot;ConvertTo &quot; + t.ToString() + &quot; &quot; +
v.ToString());</p>

<p class=ILprg>yyy a1 = (yyy)v;</p>

<p class=ILprg>string s1 = a1.a + &quot;-&quot; + a1.b;</p>

<p class=ILprg>return s1;</p>

<p class=ILprg>}</p>

<p class=ILprg>}</p>

<p class=ILbase><span style='color:windowtext'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=ILbase><span style='color:windowtext'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=ILoutput><u>a.txt</u></p>

<p class=ILoutput>yyy Constructor</p>

<p class=ILoutput>aaa get </p>

<p class=ILoutput>CanConvertFrom System.String</p>

<p class=ILoutput>aaa get </p>

<p class=ILoutput>yyy ToString</p>

<p class=ILoutput>ConvertTo System.String 1,2</p>

<p class=ILbase><span style='color:windowtext'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=ILbase><span style='color:windowtext'>In a bid to ensure that we are able
to view some values in our property window, we now add an adequate amount of
code to our control. <o:p></o:p></span></p>

<p class=ILbase><span style='color:windowtext'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=ILbase><span style='color:windowtext'>The class yyy has two public
instance variables a and b, which are meant to hold the values of the
parameters passed to the constructor. <o:p></o:p></span></p>

<p class=ILbase><span style='color:windowtext'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=ILbase><span style='color:windowtext'>A Size object is known by the
Width and Height properties; a Point object is known by the X and Y properties;
and the class yyy is best recognized by the properties a and b. The ToString
function returns the values of the instance variables a and b after placing a comma
between them. <o:p></o:p></span></p>

<p class=ILbase><span style='color:windowtext'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=ILbase><span style='color:windowtext'>The ConvertTo function gets
called since the CanConvertFrom function returns a value of true. In this
function, the Type object is of string type, while the second last parameter is
the yyy object. This function is called in order that the yyy object may be
converted into a string and then returned back. This string that is returned
would eventually be displayed in the Properties window. <o:p></o:p></span></p>

<p class=ILbase><span style='color:windowtext'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=ILbase><span style='color:windowtext'>Because we are calling the
ToString function of the yyy object v in the function abc, we see the ToString
function being called first in the a.txt file. This also corroborates the fact
that the ToString function returns the values of the variables a and b,
separated by a space. <o:p></o:p></span></p>

<p class=ILbase><span style='color:windowtext'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=ILbase><span style='color:windowtext'>Thus, to recapitulate, the
CanConvertFrom function consents to convert a yyy object returned from the
'get' accessor into a string, with a return value of true. Therefore, the
ConvertTo function gets called. The actual yyy object passed to this function
is stored in a yyy object a1. A string is returned, which contains a minus sign
between the values a and b, which we presume is for good luck. <o:p></o:p></span></p>

<p class=ILbase><span style='color:windowtext'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<table border=0 cellspacing=0 cellpadding=0 style='border-collapse:collapse;
 mso-padding-alt:0in 5.4pt 0in 5.4pt'>
 <tr>
  <td valign=top style='padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal><img width=400 height=300 id="_x0000_i1032"
  src="chap3/7.jpg"><o:p></o:p></p>
  </td>
 </tr>
 <tr>
  <td valign=top style='padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal>Screen 3.7<o:p></o:p></p>
  </td>
 </tr>
</table>

<p class=ILbase><span style='color:windowtext'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=ILbase><span style='color:windowtext'>The screen 3.7 exhibits the
value of the property as 1-2. If the ToString function of the yyy object is
eliminated, the yyy object returned by the get accessor simply remains
unchanged and does not get converted. The get and set accessors are completely
oblivious to our actions. Hence, they will only deal with a yyy object, thus
calling upon the program to implement code for converting the object to a
string, and vice-versa.<o:p></o:p></span></p>

<p class=ILbase><span style='color:windowtext'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=ILprg><u>a.cs</u></p>

<p class=ILprg>public override bool CanConvertFrom(ITypeDescriptorContext
c,Type t) </p>

<p class=ILprg>{</p>

<p class=ILprg>sss.abc(&quot;CanConvertFrom &quot; + t.ToString());</p>

<p class=ILprg>return false;</p>

<p class=ILprg>}</p>

<p class=ILbase><span style='color:windowtext'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=ILbase><span style='color:windowtext'>Changing the return value from
true to false in the CanConvertFrom function simply notifies the Properties window
about the fact that the string cannot be converted into a yyy object. Hence,
the property value shall be displayed as 1-2, but it would be read-only.<o:p></o:p></span></p>

<p class=ILbase><span style='color:windowtext'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=ILprg><u>a.cs</u></p>

<p class=ILprg>public class bbb : TypeConverter</p>

<p class=ILprg>{</p>

<p class=ILprg>public override bool CanConvertFrom(ITypeDescriptorContext
c,Type t) </p>

<p class=ILprg>{</p>

<p class=ILprg>sss.abc(&quot;CanConvertFrom &quot; + t.ToString());</p>

<p class=ILprg>return true;</p>

<p class=ILprg>}</p>

<p class=ILprg>public override bool CanConvertTo(ITypeDescriptorContext c,Type
t) </p>

<p class=ILprg>{</p>

<p class=ILprg>sss.abc(&quot;CanConvertTo &quot; + t.ToString());</p>

<p class=ILprg>return true;</p>

<p class=ILprg>}</p>

<p class=ILprg>public override object ConvertTo(ITypeDescriptorContext c,CultureInfo
cu, object v, Type t) </p>

<p class=ILprg>{<span style="mso-spacerun: yes">  </span></p>

<p class=ILprg>sss.abc(&quot;ConvertTo &quot; + t.ToString() + &quot; &quot; +
v.ToString());</p>

<p class=ILprg>yyy a1 = (yyy)v;</p>

<p class=ILprg>string s1 = a1.a + &quot;-&quot; + a1.b;</p>

<p class=ILprg>return s1;</p>

<p class=ILprg>}</p>

<p class=ILprg>public override object ConvertFrom(ITypeDescriptorContext
c,CultureInfo cu, object o) </p>

<p class=ILprg>{</p>

<p class=ILprg>sss.abc(&quot;ConvertFrom &quot; + o.ToString());</p>

<p class=ILprg>string s1 = (string)o;</p>

<p class=ILprg>char [] c1<span style="mso-spacerun: yes">  </span>= new char[]
{'-'};</p>

<p class=ILprg>string[] v = s1.Split(c1);</p>

<p class=ILprg>sss.abc(&quot;a=&quot; + v[0] + &quot; b= &quot;+ v[1]);</p>

<p class=ILprg>int a1,b1;</p>

<p class=ILprg>a1 = int.Parse(v[0]);</p>

<p class=ILprg>b1 = int.Parse(v[1]);</p>

<p class=ILprg>yyy y1 = new yyy(a1,b1);</p>

<p class=ILprg>sss.abc(&quot;ConvertFrom End&quot;);</p>

<p class=ILprg>return y1;</p>

<p class=ILprg>}</p>

<p class=ILprg>}</p>

<p class=ILprg><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=ILprg>public class aaa : UserControl<span style="mso-spacerun: yes"> 
</span>{</p>

<p class=ILprg>yyy b1 = new yyy(1,2);</p>

<p class=ILprg>[TypeConverter(typeof(bbb))]</p>

<p class=ILprg>public yyy a1</p>

<p class=ILprg>{</p>

<p class=ILprg>get</p>

<p class=ILprg>{</p>

<p class=ILprg>sss.abc(&quot;aaa get &quot; + b1.ToString());</p>

<p class=ILprg>return b1;</p>

<p class=ILprg>}</p>

<p class=ILprg>set</p>

<p class=ILprg>{</p>

<p class=ILprg>sss.abc(&quot;aaa set &quot; + value.ToString());</p>

<p class=ILprg>b1 = value;</p>

<p class=ILprg>}</p>

<p class=ILprg>}</p>

<p class=ILbase><span style='color:windowtext'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=ILoutput><u>a.txt</u></p>

<p class=ILoutput>yyy Constructor</p>

<p class=ILoutput>yyy ToString</p>

<p class=ILoutput>aaa get 1,2</p>

<p class=ILoutput>CanConvertFrom System.String</p>

<p class=ILoutput>yyy ToString</p>

<p class=ILoutput>ConvertTo System.String 1,2</p>

<p class=ILoutput>CanConvertFrom System.String</p>

<p class=ILoutput>ConvertFrom 10-20</p>

<p class=ILoutput>a=10 b= 20</p>

<p class=ILoutput>yyy Constructor</p>

<p class=ILoutput>ConvertFrom End</p>

<p class=ILoutput>yyy ToString</p>

<p class=ILoutput>aaa get 1,2</p>

<p class=ILoutput>yyy ToString</p>

<p class=ILoutput>aaa set 10,20</p>

<p class=ILoutput>yyy ToString</p>

<p class=ILoutput>aaa get 10,20</p>

<p class=ILoutput>yyy ToString</p>

<p class=ILoutput>ConvertTo System.String 10,20</p>

<p class=ILbase><span style='color:windowtext'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<table border=0 cellspacing=0 cellpadding=0 style='border-collapse:collapse;
 mso-padding-alt:0in 5.4pt 0in 5.4pt'>
 <tr>
  <td valign=top style='padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal><img width=400 height=300 id="_x0000_i1033"
  src="chap3/8.jpg"><o:p></o:p></p>
  </td>
 </tr>
 <tr>
  <td valign=top style='padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal>Screen 3.8<o:p></o:p></p>
  </td>
 </tr>
</table>

<p class=ILbase><span style='color:windowtext'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=ILbase><span style='color:windowtext'>The screen 3.8 is ample
testimony of the fact that the control now permits amendments to the value of
the property a1. The values have been changed from 1-2 to 10-20. The new
function to be implemented is ConvertFrom, while the rest of the code remains
the same. This function gets called whenever the Properties window perceives a
change in the property. <o:p></o:p></span></p>

<p class=ILbase><span style='color:windowtext'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=ILbase><span style='color:windowtext'>The last parameter is a string
since the property value is written as a string value of 10-20. This string
value now necessitates conversion into a yyy object through the TypeConverter
class bbb, since it represents a yyy type. <o:p></o:p></span></p>

<p class=ILbase><span style='color:windowtext'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=ILbase><span style='color:windowtext'>In this particular case, a minus
sign has been inserted between the two values in the function ConvertTo. So, the
first task at hand is to banish this minus sign. <o:p></o:p></span></p>

<p class=ILbase><span style='color:windowtext'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=ILbase><span style='color:windowtext'>To work towards this end, the
value in the parameter o that represents the string has been assigned to a
string variable s1. Thereafter, we create an array of chars that holds only one
char, viz. a minus sign. The Split function of the string class splits a string
on the array of chars passed as a parameter. <o:p></o:p></span></p>

<p class=ILbase><span style='color:windowtext'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=ILbase><span style='color:windowtext'>In the case of the existing
minus sign, the Split function shall split the string s1 into two strings.<span
style="mso-spacerun: yes">  </span>Thus, it returns an array of size two, and
the values are stored in the array of strings named v.<span
style="mso-spacerun: yes">  </span>The first member of this array v[0] would
hold the value of the variable a, while the second v[1] would accommodate the
value of variable b. <o:p></o:p></span></p>

<p class=ILbase><span style='color:windowtext'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=ILbase><span style='color:windowtext'>Then, the int class is used to
convert the strings into ints. Thereafter, a yyy object is created with these
ints as parameters, and duly returned. Then, the set accessor gets called with
this yyy object. Also, the yyy object is displayed in the property a1. <o:p></o:p></span></p>

<p class=ILbase><span style='color:windowtext'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=ILbase><span style='color:windowtext'>Thus, the set accessor needs a
yyy object. The ConvertFrom function gets called which returns a yyy object
when it is given a string containing the types. The ConvertTo function gets
called next, as the get accessor returns a yyy object with the values of 10 and
20. This yyy object is then converted into a string to be displayed in the
Properties window.<o:p></o:p></span></p>

<p class=ILbase><span style='color:windowtext'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=ILprg><u>a.cs</u></p>

<p class=ILprg>public override bool
GetStandardValuesSupported(ITypeDescriptorContext c)</p>

<p class=ILprg>{</p>

<p class=ILprg>sss.abc(&quot;GetStandardValuesSupported&quot;);</p>

<p class=ILprg>return true;</p>

<p class=ILprg>}</p>

<p class=ILbase><span style='color:windowtext'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=ILoutput><u>a.txt</u></p>

<p class=ILoutput>GetStandardValuesSupported</p>

<p class=ILoutput>CanConvertFrom System.String</p>

<p class=ILbase><span style='color:windowtext'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=ILbase><span style='color:windowtext'>Yet another function called
GetStandardValuesSupported is added to the class bbb. This function returns a
value of true. On viewing screen 3.9, you would notice that the property a1 now
has a listbox User Interface.<o:p></o:p></span></p>

<p class=ILbase><span style='color:windowtext'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<table border=0 cellspacing=0 cellpadding=0 style='border-collapse:collapse;
 mso-padding-alt:0in 5.4pt 0in 5.4pt'>
 <tr>
  <td valign=top style='padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal><img width=400 height=300 id="_x0000_i1034"
  src="chap3/9.jpg"><o:p></o:p></p>
  </td>
 </tr>
 <tr>
  <td valign=top style='padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal>Screen 3.9<o:p></o:p></p>
  </td>
 </tr>
</table>

<p class=ILbase><span style='color:windowtext'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=ILbase><span style='color:windowtext'>This function gets called pretty
early, even before the CanConvertFrom function gets called. Therefore, a click
on the listbox down arrow does not lead to the display of any data at all. Now,
its time to pack the listbox with some yyy objects.<o:p></o:p></span></p>

<p class=ILbase><span style='color:windowtext'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=ILprg><u>a.cs</u></p>

<p class=ILprg>public override StandardValuesCollection GetStandardValues
(ITypeDescriptorContext c)</p>

<p class=ILprg>{</p>

<p class=ILprg>sss.abc(&quot;GetStandardValues Start&quot;);</p>

<p class=ILprg>yyy [] v = new yyy[2];</p>

<p class=ILprg>v[0] = new yyy(10,20);</p>

<p class=ILprg>v[1] = new yyy(100,200);</p>

<p class=ILprg>TypeConverter.StandardValuesCollection s = new
TypeConverter.StandardValuesCollection(v); </p>

<p class=ILprg>sss.abc(&quot;GetStandardValues End&quot;);</p>

<p class=ILprg>return s;</p>

<p class=ILprg>}</p>

<p class=ILbase><span style='color:windowtext'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=ILoutput><u>a.txt</u></p>

<p class=ILoutput>GetStandardValues Start</p>

<p class=ILoutput>yyy Constructor</p>

<p class=ILoutput>yyy Constructor</p>

<p class=ILoutput>GetStandardValues End</p>

<p class=ILbase><span style='color:windowtext'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=ILbase><span style='color:windowtext'>The newly added function GetStandardValues
returns a StandardValuesCollection object. The constructor of this object
requires an ICollection parameter interface, which is supported by a large
number of data types, including an array. An array of two yyy objects is
created and the individual members named v[0] and v[1] are initialized. This
array is then handed down to the StandardValuesCollection constructor and the
value i.e s, is then returned. <o:p></o:p></span></p>

<p class=ILbase><span style='color:windowtext'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=ILbase><span style='color:windowtext'>On executing the control, when
the drop-down listbox of property a1 is clicked on, two values meet the eye,
separated by a minus sign, as observed in screen 3.10.<o:p></o:p></span></p>

<p class=ILbase><span style='color:windowtext'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<table border=0 cellspacing=0 cellpadding=0 style='border-collapse:collapse;
 mso-padding-alt:0in 5.4pt 0in 5.4pt'>
 <tr>
  <td valign=top style='padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal><img width=400 height=300 id="_x0000_i1035"
  src="chap3/10.jpg"><o:p></o:p></p>
  </td>
  <td valign=top style='padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal><img width=400 height=300 id="_x0000_i1036"
  src="chap3/11.jpg"><o:p></o:p></p>
  </td>
 </tr>
 <tr>
  <td valign=top style='padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal>Screen 3.10<o:p></o:p></p>
  </td>
  <td valign=top style='padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal>Screen 3.11<o:p></o:p></p>
  </td>
 </tr>
</table>

<p class=ILbase><span style='color:windowtext'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=ILbase><span style='color:windowtext'>The ToString function of the yyy
class places a comma between the two instance variable values a and b. On
selecting any of the values in the listbox, the value of the property also
undergoes change, as shown in screen 3.11.<o:p></o:p></span></p>

<p class=ILbase><span style='color:windowtext'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=ILbase><span style='color:windowtext'>Thus, the function ConvertTo has
to be called, which converts the yyy object into a string, thereby displaying
it in the listbox. It is with the help of this approach that our list of yyy
objects can be placed in a drop-down listbox. <o:p></o:p></span></p>

<p class=ILbase><span style='color:windowtext'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=ILbase><span style='color:windowtext'>The only downside of the earlier
method is that we are permitted to amend the values directly if we so desire,
as has been done in screen 3.12.<o:p></o:p></span></p>

<p class=ILbase><span style='color:windowtext'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<table border=0 cellspacing=0 cellpadding=0 style='border-collapse:collapse;
 mso-padding-alt:0in 5.4pt 0in 5.4pt'>
 <tr>
  <td valign=top style='padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal><img width=400 height=300 id="_x0000_i1037"
  src="chap3/12.jpg"><o:p></o:p></p>
  </td>
 </tr>
 <tr>
  <td valign=top style='padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal>Screen 3.12<o:p></o:p></p>
  </td>
 </tr>
</table>

<p class=ILbase><span style='color:windowtext'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=ILprg><u>a.cs</u></p>

<p class=ILprg>public override bool
GetStandardValuesSupported(ITypeDescriptorContext c)</p>

<p class=ILprg>{</p>

<p class=ILprg>sss.abc(&quot;GetStandardValuesSupported&quot;);</p>

<p class=ILprg>return true;</p>

<p class=ILprg>}</p>

<p class=ILprg>public override StandardValuesCollection
GetStandardValues(ITypeDescriptorContext c)</p>

<p class=ILprg>{</p>

<p class=ILprg>sss.abc(&quot;GetStandardValues Start&quot;);</p>

<p class=ILprg>yyy [] v = new yyy[2];</p>

<p class=ILprg>v[0] = new yyy(10,20);</p>

<p class=ILprg>v[1] = new yyy(100,200);</p>

<p class=ILprg>TypeConverter.StandardValuesCollection s = new
TypeConverter.StandardValuesCollection(v); </p>

<p class=ILprg>sss.abc(&quot;GetStandardValues End&quot;);</p>

<p class=ILprg>return s;</p>

<p class=ILprg>}</p>

<p class=ILprg>public override bool
GetStandardValuesExclusive(ITypeDescriptorContext c)</p>

<p class=ILprg>{</p>

<p class=ILprg>sss.abc(&quot;GetStandardValuesExclusive&quot;);</p>

<p class=ILprg>return true;</p>

<p class=ILprg>}</p>

<p class=ILbase><span style='color:windowtext'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=ILoutput><u>a.txt</u></p>

<p class=ILoutput>GetStandardValuesSupported</p>

<p class=ILoutput>CanConvertFrom System.String</p>

<p class=ILoutput>GetStandardValuesExclusive</p>

<p class=ILbase><span style='color:windowtext'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=ILbase><span style='color:windowtext'>We have added one more function
named GetStandardValuesExclusive that returns a value of true, in case the
drop-down listbox happens to be the only avenue for assigning a value to the
property. This function GetStandardValuesExclusive gets called after
GetStandardValuesSupported returns true. <o:p></o:p></span></p>

<p class=ILbase><span style='color:windowtext'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<table border=0 cellspacing=0 cellpadding=0 style='border-collapse:collapse;
 mso-padding-alt:0in 5.4pt 0in 5.4pt'>
 <tr>
  <td valign=top style='padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal><img width=400 height=300 id="_x0000_i1038"
  src="chap3/13.jpg"><o:p></o:p></p>
  </td>
 </tr>
 <tr>
  <td valign=top style='padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal>Screen 3.13<o:p></o:p></p>
  </td>
 </tr>
</table>

<p class=ILbase><span style='color:windowtext'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=ILbase><span style='color:windowtext'>Since a value of true has been
returned, the screen 3.13 makes it sufficiently evident that we cannot change
the value of the property a1 using the keyboard. Instead, we have to resort to
the drop-down listbox. Now, delete the three functions that we have added so
far.<o:p></o:p></span></p>

<p class=ILbase><span style='color:windowtext'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=ILprg><u>a.cs</u></p>

<p class=ILprg>public override bool GetPropertiesSupported
(ITypeDescriptorContext c) {</p>

<p class=ILprg>sss.abc(&quot;GetPropertiesSupported&quot;);</p>

<p class=ILprg>return true;</p>

<p class=ILprg>}</p>

<p class=ILbase><span style='color:windowtext'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=ILoutput><u>a.txt</u></p>

<p class=ILoutput>CanConvertFrom System.String</p>

<p class=ILoutput>GetPropertiesSupported</p>

<p class=ILbase><span style='color:windowtext'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=ILbase><span style='color:windowtext'>The new function
GetPropertiesSupported returns a boolean value of true or false, based on
whether the property supports sub-properties or not. <o:p></o:p></span></p>

<p class=ILbase><span style='color:windowtext'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<table border=0 cellspacing=0 cellpadding=0 style='border-collapse:collapse;
 mso-padding-alt:0in 5.4pt 0in 5.4pt'>
 <tr>
  <td valign=top style='padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal><img width=400 height=300 id="_x0000_i1039"
  src="chap3/14.jpg"><o:p></o:p></p>
  </td>
 </tr>
 <tr>
  <td valign=top style='padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal>Screen 3.14<o:p></o:p></p>
  </td>
 </tr>
</table>

<p class=ILbase><span style='color:windowtext'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=ILbase><span style='color:windowtext'>On returning a value of true, we
see the screen 3.14, where the property a1 has a plus sign preceding it. But,
clicking on the plus sign does not display anything, since the properties have
not been specified yet.<o:p></o:p></span></p>

<p class=ILbase><span style='color:windowtext'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=ILbase><span style='color:windowtext'>This function is summoned
immediately after the CanConvertFrom function.<o:p></o:p></span></p>

<p class=ILbase><span style='color:windowtext'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=ILprg><u>a.cs</u></p>

<p class=ILprg>using System;</p>

<p class=ILprg>using System.IO;</p>

<p class=ILprg>using System.ComponentModel;</p>

<p class=ILprg>using System.Globalization;</p>

<p class=ILprg>using System.Drawing;</p>

<p class=ILprg>using System.Windows.Forms;</p>

<p class=ILprg>using System.Collections;</p>

<p class=ILprg>public class aaa : UserControl</p>

<p class=ILprg>{</p>

<p class=ILprg>yyy b1 = new yyy(1,2);</p>

<p class=ILprg>[TypeConverter(typeof(bbb))]</p>

<p class=ILprg>public yyy a1</p>

<p class=ILprg>{</p>

<p class=ILprg>get</p>

<p class=ILprg>{</p>

<p class=ILprg>return b1;</p>

<p class=ILprg>}</p>

<p class=ILprg>set</p>

<p class=ILprg>{</p>

<p class=ILprg>b1 = value;</p>

<p class=ILprg>}</p>

<p class=ILprg>}</p>

<p class=ILprg>}</p>

<p class=ILprg>public class yyy</p>

<p class=ILprg>{</p>

<p class=ILprg>public int aa,bb;</p>

<p class=ILprg>public int a</p>

<p class=ILprg>{</p>

<p class=ILprg>get</p>

<p class=ILprg>{</p>

<p class=ILprg>return aa;</p>

<p class=ILprg>}</p>

<p class=ILprg>set</p>

<p class=ILprg>{</p>

<p class=ILprg>aa = value;</p>

<p class=ILprg>}</p>

<p class=ILprg>}</p>

<p class=ILprg>public int b</p>

<p class=ILprg>{</p>

<p class=ILprg>get</p>

<p class=ILprg>{</p>

<p class=ILprg>return bb;</p>

<p class=ILprg>}</p>

<p class=ILprg>set</p>

<p class=ILprg>{</p>

<p class=ILprg>bb = value;</p>

<p class=ILprg>}</p>

<p class=ILprg>}</p>

<p class=ILprg>public yyy(int x , int y)</p>

<p class=ILprg>{</p>

<p class=ILprg>sss.abc(&quot;yyy Constructor&quot;);</p>

<p class=ILprg>a = x;</p>

<p class=ILprg>b = y;</p>

<p class=ILprg>}</p>

<p class=ILprg>public override string ToString()</p>

<p class=ILprg>{</p>

<p class=ILprg>sss.abc(&quot;yyy ToString&quot;);</p>

<p class=ILprg>return a + &quot;,&quot; + b;</p>

<p class=ILprg>}</p>

<p class=ILprg>}</p>

<p class=ILprg>public class sss</p>

<p class=ILprg>{</p>

<p class=ILprg>public static void abc(string s)</p>

<p class=ILprg>{</p>

<p class=ILprg>FileStream fs = new FileStream(&quot;c:\\a1\\a.txt&quot;,
FileMode.Append, FileAccess.Write);</p>

<p class=ILprg>StreamWriter w = new StreamWriter(fs);</p>

<p class=ILprg>w.WriteLine(s);</p>

<p class=ILprg>w.Flush();</p>

<p class=ILprg>w.Close();</p>

<p class=ILprg>}</p>

<p class=ILprg>}</p>

<p class=ILprg>public class bbb : TypeConverter</p>

<p class=ILprg>{</p>

<p class=ILprg>public override bool CanConvertFrom(ITypeDescriptorContext
c,Type t) </p>

<p class=ILprg>{</p>

<p class=ILprg>sss.abc(&quot;CanConvertFrom &quot; + t.ToString());</p>

<p class=ILprg>return true;</p>

<p class=ILprg>}</p>

<p class=ILprg>public override bool CanConvertTo(ITypeDescriptorContext c,Type
t) </p>

<p class=ILprg>{</p>

<p class=ILprg>sss.abc(&quot;CanConvertTo... &quot; + t.ToString());</p>

<p class=ILprg>return true;</p>

<p class=ILprg>}</p>

<p class=ILprg>public override object ConvertTo(ITypeDescriptorContext
c,CultureInfo cu, object v, Type t) </p>

<p class=ILprg>{<span style="mso-spacerun: yes">  </span></p>

<p class=ILprg>sss.abc(&quot;ConvertTo &quot; + t.ToString() + &quot; &quot; +
v.ToString());</p>

<p class=ILprg>yyy a1 = (yyy)v;</p>

<p class=ILprg>string s1 = a1.a + &quot;-&quot; + a1.b;</p>

<p class=ILprg>return s1;</p>

<p class=ILprg>}</p>

<p class=ILprg>public override object ConvertFrom(ITypeDescriptorContext
c,CultureInfo cu, object o) </p>

<p class=ILprg>{</p>

<p class=ILprg>sss.abc(&quot;ConvertFrom &quot; + o.ToString());</p>

<p class=ILprg>string s1 = (string)o;</p>

<p class=ILprg>char [] c1<span style="mso-spacerun: yes">  </span>= new char[]
{'-'};</p>

<p class=ILprg>string[] v = s1.Split(c1);</p>

<p class=ILprg>sss.abc(&quot;a=&quot; + v[0] + &quot; b= &quot;+ v[1]);</p>

<p class=ILprg>int a1,b1;</p>

<p class=ILprg>a1 = int.Parse(v[0]);</p>

<p class=ILprg>b1 = int.Parse(v[1]);</p>

<p class=ILprg>yyy y1 = new yyy(a1,b1);</p>

<p class=ILprg>sss.abc(&quot;ConvertFrom End&quot;);</p>

<p class=ILprg>return y1;</p>

<p class=ILprg>}</p>

<p class=ILprg>public override bool GetPropertiesSupported(ITypeDescriptorContext
c)</p>

<p class=ILprg>{</p>

<p class=ILprg>sss.abc(&quot;GetPropertiesSupported&quot;);</p>

<p class=ILprg>return true;</p>

<p class=ILprg>}</p>

<p class=ILprg>public override PropertyDescriptorCollection GetProperties
(ITypeDescriptorContext c, object v ,Attribute[] a)</p>

<p class=ILprg>{</p>

<p class=ILprg>sss.abc(&quot;GetProperties....&quot;);</p>

<p class=ILprg>return null;</p>

<p class=ILprg>}</p>

<p class=ILprg>}</p>

<p class=ILbase><span style='color:windowtext'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=ILoutput><u>a.txt</u></p>

<p class=ILoutput>yyy Constructor</p>

<p class=ILoutput>CanConvertFrom System.String</p>

<p class=ILoutput>GetPropertiesSupported</p>

<p class=ILoutput>yyy ToString</p>

<p class=ILoutput>ConvertTo System.String 1,2</p>

<p class=ILoutput>GetPropertiesSupported</p>

<p class=ILoutput>yyy ToString</p>

<p class=ILoutput>ConvertTo System.String 1,2</p>

<p class=ILoutput>ConvertTo System.String 10,2</p>

<p class=ILoutput>yyy ToString</p>

<p class=ILbase><span style='color:windowtext'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=ILbase><span style='color:windowtext'>In the above program that has been
displayed in its entirety, the function GetPropertiesSupported gets called as
usual. Since the value returned is true, the plus sign is displayed in front of
the property a1. Clicking on the plus sign should expose the list of
properties. However, the function GetProperties is bypassed despite its
presence in the file. This function does not get called to retrieve a list of
properties. <o:p></o:p></span></p>

<p class=ILbase><span style='color:windowtext'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=ILbase><span style='color:windowtext'>Previously, there were two
public variables in the class yyy, which have now been converted into
properties a and b; and the variables aa and bb are used to store their values,
respectively. <o:p></o:p></span></p>

<p class=ILbase><span style='color:windowtext'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=ILbase><span style='color:windowtext'>Now, when the properties are
expanded by clicking on the plus sign, the two properties a and b get
displayed, as seen in screen 3.15. <o:p></o:p></span></p>

<p class=ILbase><span style='color:windowtext'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<table border=0 cellspacing=0 cellpadding=0 style='border-collapse:collapse;
 mso-padding-alt:0in 5.4pt 0in 5.4pt'>
 <tr>
  <td valign=top style='padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal><img width=400 height=300 id="_x0000_i1040"
  src="chap3/15.jpg"><o:p></o:p></p>
  </td>
 </tr>
 <tr>
  <td valign=top style='padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal>Screen 3.15<o:p></o:p></p>
  </td>
 </tr>
</table>

<p class=ILbase><span style='color:windowtext'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=ILbase><span style='color:windowtext'>On amending only one of the properties,
'a' for instance, the change in the value of the property shall become visible,
only when you first click on the minus sign, followed by a click on the plus
sign (as in screen 3.16). In other words, only when it is collapsed and
expanded. Changing the value of the property with the help of the Enter key,
shall be dealt with a little later.<o:p></o:p></span></p>

<p class=ILbase><span style='color:windowtext'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<table border=0 cellspacing=0 cellpadding=0 style='border-collapse:collapse;
 mso-padding-alt:0in 5.4pt 0in 5.4pt'>
 <tr>
  <td valign=top style='padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal><img width=400 height=300 id="_x0000_i1041"
  src="chap3/16.jpg"><o:p></o:p></p>
  </td>
 </tr>
 <tr>
  <td valign=top style='padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal>Screen 3.16<o:p></o:p></p>
  </td>
 </tr>
</table>

<p class=ILbase><span style='color:windowtext'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=ILprg><u>a.cs</u></p>

<p class=ILprg>public class yyy</p>

<p class=ILprg>{</p>

<p class=ILprg>public int aa,bb;</p>

<p class=ILprg>public Size d</p>

<p class=ILprg>{</p>

<p class=ILprg>get</p>

<p class=ILprg>{</p>

<p class=ILprg>return new Size(1000,2000);</p>

<p class=ILprg>}</p>

<p class=ILprg>set</p>

<p class=ILprg>{</p>

<p class=ILprg>}</p>

<p class=ILprg>}</p>

<p class=ILprg>public xxx c</p>

<p class=ILprg>{</p>

<p class=ILprg>get</p>

<p class=ILprg>{</p>

<p class=ILprg>return new xxx();</p>

<p class=ILprg>}</p>

<p class=ILprg>set</p>

<p class=ILprg>{</p>

<p class=ILprg>}</p>

<p class=ILprg>}</p>

<p class=ILprg>public int a</p>

<p class=ILprg>{</p>

<p class=ILprg>get</p>

<p class=ILprg>{</p>

<p class=ILprg>return aa;</p>

<p class=ILprg>}</p>

<p class=ILprg>set</p>

<p class=ILprg>{</p>

<p class=ILprg>aa = value;</p>

<p class=ILprg>}</p>

<p class=ILprg>}</p>

<p class=ILprg>public int b</p>

<p class=ILprg>{</p>

<p class=ILprg>get</p>

<p class=ILprg>{</p>

<p class=ILprg>return bb;</p>

<p class=ILprg>}</p>

<p class=ILprg>set</p>

<p class=ILprg>{</p>

<p class=ILprg>bb = value;</p>

<p class=ILprg>}</p>

<p class=ILprg>}</p>

<p class=ILprg>public yyy(int x , int y)</p>

<p class=ILprg>{</p>

<p class=ILprg>sss.abc(&quot;yyy Constructor&quot;);</p>

<p class=ILprg>a = x;</p>

<p class=ILprg>b = y;</p>

<p class=ILprg>}</p>

<p class=ILprg>public override string ToString()</p>

<p class=ILprg>{</p>

<p class=ILprg>sss.abc(&quot;yyy ToString&quot;);</p>

<p class=ILprg>return a + &quot;,&quot; + b;</p>

<p class=ILprg>}</p>

<p class=ILprg>}</p>

<p class=ILprg><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=ILprg>public class xxx</p>

<p class=ILprg>{</p>

<p class=ILprg>public Point d</p>

<p class=ILprg>{</p>

<p class=ILprg>get</p>

<p class=ILprg>{</p>

<p class=ILprg>return new Point(100,200);</p>

<p class=ILprg>}</p>

<p class=ILprg>set</p>

<p class=ILprg>{</p>

<p class=ILprg>}</p>

<p class=ILprg>}</p>

<p class=ILprg>}</p>

<p class=ILbase><span style='color:windowtext'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=ILbase><span style='color:windowtext'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=ILbase><span style='color:windowtext'>The above control is displayed
in its execution mode in screen 3.17. Clicking on the plus sign of the property
a1 shows four properties, viz. the ints a and b, the property c of type xxx and
the Size property d. <o:p></o:p></span></p>

<p class=ILbase><span style='color:windowtext'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<table border=0 cellspacing=0 cellpadding=0 style='border-collapse:collapse;
 mso-padding-alt:0in 5.4pt 0in 5.4pt'>
 <tr>
  <td valign=top style='padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal><img width=400 height=300 id="_x0000_i1042"
  src="chap3/17.jpg"><o:p></o:p></p>
  </td>
  <td valign=top style='padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal><img width=400 height=300 id="_x0000_i1043"
  src="chap3/18.jpg"><o:p></o:p></p>
  </td>
 </tr>
 <tr>
  <td valign=top style='padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal>Screen 3.17<o:p></o:p></p>
  </td>
  <td valign=top style='padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal>Screen 3.18<o:p></o:p></p>
  </td>
 </tr>
</table>

<p class=ILbase><span style='color:windowtext'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=ILbase><span style='color:windowtext'>Besides, there is a plus sign in
front of the Size property. The instant it is clicked upon, we arrive at the
screen 3.18, where the two properties of Width and Height are visible within
Size. <o:p></o:p></span></p>

<p class=ILbase><span style='color:windowtext'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=ILbase><span style='color:windowtext'>The xxx type property c has a
property d of type Point, but there is no trace of the plus sign in front of
it, since there is no TypeConverter attribute in it. This renders the property
as read-only, and the ToString function from the object merely returns the name
of the class. <o:p></o:p></span></p>

<p class=ILbase><span style='color:windowtext'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=ILbase><span style='color:windowtext'>Thus, there may subsist as many
sub-levels of properties as is desired. The sole caveat is that the classes
must necessarily be tagged with the relevant TypeConverter attribute.<o:p></o:p></span></p>

<p class=ILbase><span style='color:windowtext'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=ILprg><u>a.cs</u></p>

<p class=ILprg>[TypeConverter(typeof(SizeConverter))]</p>

<p class=ILprg>public class xxx</p>

<p class=ILbase><span style='color:windowtext'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=ILbase><span style='color:windowtext'>Now, the TypeConverter attribute
has been added with the class name of SizeConverter. Further, the control has
also been introduced. At this stage, the plus sign can be spotted with the
property a1. <o:p></o:p></span></p>

<p class=ILbase><span style='color:windowtext'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=ILbase><span style='color:windowtext'>This property has a plus sign
placed before the property c. Clicking on this plus sign reveals the screen
3.19, wherein the two properties Width and Height are evident, but with
erroneous values. <o:p></o:p></span></p>

<p class=ILbase><span style='color:windowtext'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<table border=0 cellspacing=0 cellpadding=0 style='border-collapse:collapse;
 mso-padding-alt:0in 5.4pt 0in 5.4pt'>
 <tr>
  <td valign=top style='padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>
  </td>
 </tr>
 <tr>
  <td valign=top style='padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal>Screen 3.19<o:p></o:p></p>
  </td>
 </tr>
</table>

<p class=ILbase><span style='color:windowtext'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=ILbase><span style='color:windowtext'>A salient point to be committed
to memory is that, each time you wish to display the value of a property in the
Properties window, when its type is a class created by you, you must ensure
that the attribute TypeConverter is used. There are over a million such classes
that end with Converter.<o:p></o:p></span></p>

<p class=ILbase><span style='color:windowtext'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=ILprg><u>a.cs</u></p>

<p class=ILprg>using System;</p>

<p class=ILprg>using System.IO;</p>

<p class=ILprg>using System.ComponentModel;</p>

<p class=ILprg>using System.Globalization;</p>

<p class=ILprg>using System.Drawing;</p>

<p class=ILprg>using System.Windows.Forms;</p>

<p class=ILprg>using System.Collections;</p>

<p class=ILprg>public class aaa : UserControl<span style="mso-spacerun: yes"> 
</span>{</p>

<p class=ILprg>yyy b1 = new yyy(1,2);</p>

<p class=ILprg>[TypeConverter(typeof(bbb))]</p>

<p class=ILprg>public yyy a1</p>

<p class=ILprg>{</p>

<p class=ILprg>get</p>

<p class=ILprg>{</p>

<p class=ILprg>return b1;</p>

<p class=ILprg>}</p>

<p class=ILprg>set</p>

<p class=ILprg>{</p>

<p class=ILprg>b1 = value;</p>

<p class=ILprg>}</p>

<p class=ILprg>}</p>

<p class=ILprg>}</p>

<p class=ILprg>public class yyy {</p>

<p class=ILprg>public int a,b;</p>

<p class=ILprg>public yyy(int x , int y)</p>

<p class=ILprg>{</p>

<p class=ILprg>a = x;</p>

<p class=ILprg>b = y;</p>

<p class=ILprg>}</p>

<p class=ILprg>}</p>

<p class=ILprg>public class bbb : TypeConverter</p>

<p class=ILprg>{</p>

<p class=ILprg>public override bool CanConvertFrom(ITypeDescriptorContext
c,Type t) </p>

<p class=ILprg>{</p>

<p class=ILprg>return true;</p>

<p class=ILprg>}</p>

<p class=ILprg>public override object ConvertTo(ITypeDescriptorContext
c,CultureInfo cu, object v, Type t) </p>

<p class=ILprg>{<span style="mso-spacerun: yes">  </span></p>

<p class=ILprg>yyy a1 = (yyy)v;</p>

<p class=ILprg>string s1 = a1.a + &quot;-&quot; + a1.b;</p>

<p class=ILprg>return s1;</p>

<p class=ILprg>}</p>

<p class=ILprg>public override object ConvertFrom(ITypeDescriptorContext
c,CultureInfo cu, object o) </p>

<p class=ILprg>{</p>

<p class=ILprg>string s1 = (string)o;</p>

<p class=ILprg>char [] c1<span style="mso-spacerun: yes">  </span>= new char[]
{'-'};</p>

<p class=ILprg>string[] v = s1.Split(c1);</p>

<p class=ILprg>int a1,b1;</p>

<p class=ILprg>a1 = int.Parse(v[0]);</p>

<p class=ILprg>b1 = int.Parse(v[1]);</p>

<p class=ILprg>if ( b1 &gt;= 10)</p>

<p class=ILprg>{</p>

<p class=ILprg>Exception e = new Exception(&quot;Vijay&quot;);</p>

<p class=ILprg>throw e;</p>

<p class=ILprg>}</p>

<p class=ILprg>yyy y1 = new yyy(a1,b1);</p>

<p class=ILprg>return y1;</p>

<p class=ILprg>}</p>

<p class=ILprg>}</p>

<p class=ILbase><span style='color:windowtext'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=ILbase><span style='color:windowtext'>The concluding example of this chapter
happens to be the smallest working control written with the TypeConverter
attribute. It has been our endeavour to build-in an error check, wherein the
user is not authorised to type in a value larger than 10 for the property b.
Thus, the value of b is verified in the function ConvertFrom. If it is larger
than 10, an Exception object 'e' is created and supplied with a string 'Vijay'.
This Exception is then hurled at us.<o:p></o:p></span></p>

<p class=ILbase><span style='color:windowtext'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=ILbase><span style='color:windowtext'>In the control, if the second
value after the minus sign is changed to a number larger than 10, an exception
gets thrown as shown in screen 3.20. Here, we have changed it to 20, and sure
enough, an exception is tossed at us. The Details button shows the string
'Vijay', which was provided to the constructor. <o:p></o:p></span></p>

<p class=ILbase><span style='color:windowtext'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<table border=0 cellspacing=0 cellpadding=0 style='border-collapse:collapse;
 mso-padding-alt:0in 5.4pt 0in 5.4pt'>
 <tr>
  <td valign=top style='padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal><img width=250 height=150 id="_x0000_i1044"
  src="chap3/20.jpg"><o:p></o:p></p>
  </td>
 </tr>
 <tr>
  <td valign=top style='padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal>Screen 3.20<o:p></o:p></p>
  </td>
 </tr>
</table>

<p class=ILbase><span style='color:windowtext'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=ILbase><span style='color:windowtext'>Normally, some meaningful error
message is offered in place of the string 'Vijay'. Thus, we can exercise total
control over the values that the user is legally permitted to enter.<o:p></o:p></span></p>

<p class=ILbase><span style='color:windowtext'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=ILbase><span style='color:windowtext'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=ILbase><span style='color:windowtext'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

</div>

</body>


<!-- Mirrored from www.vijaymukhi.com/documents/books/vs2net/chap3.htm by HTTrack Website Copier/3.x [XR&CO'2014], Fri, 11 Oct 2024 14:09:19 GMT -->
</html>
