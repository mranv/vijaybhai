<html xmlns:v="urn:schemas-microsoft-com:vml"
xmlns:o="urn:schemas-microsoft-com:office:office"
xmlns:w="urn:schemas-microsoft-com:office:word"
xmlns="http://www.w3.org/TR/REC-html40">


<!-- Mirrored from www.vijaymukhi.com/documents/books/wap/sec2/chap11/chap11.htm by HTTrack Website Copier/3.x [XR&CO'2014], Fri, 11 Oct 2024 14:39:23 GMT -->
<head>
<meta http-equiv=Content-Type content="text/html; charset=windows-1252">
<meta name=ProgId content=Word.Document>
<meta name=Generator content="Microsoft Word 9">
<meta name=Originator content="Microsoft Word 9">
<link rel=File-List href="chap11_files/filelist.html">
<link rel=Edit-Time-Data href="chap11_files/editdata.html">
<!--[if !mso]>
<style>
v\:* {behavior:url(#default#VML);}
o\:* {behavior:url(#default#VML);}
w\:* {behavior:url(#default#VML);}
.shape {behavior:url(#default#VML);}
</style>
<![endif]-->
<title>WML and WMLScript</title>
<!--[if gte mso 9]><xml>
 <o:DocumentProperties>
  <o:Author>Vijay Mukhi</o:Author>
  <o:LastAuthor>Vijay Mukhi</o:LastAuthor>
  <o:Revision>7</o:Revision>
  <o:TotalTime>10</o:TotalTime>
  <o:Created>2001-04-08T12:55:00Z</o:Created>
  <o:LastSaved>2001-04-10T15:31:00Z</o:LastSaved>
  <o:Pages>17</o:Pages>
  <o:Words>4944</o:Words>
  <o:Characters>28182</o:Characters>
  <o:Company>VMCI</o:Company>
  <o:Lines>234</o:Lines>
  <o:Paragraphs>56</o:Paragraphs>
  <o:CharactersWithSpaces>34609</o:CharactersWithSpaces>
  <o:Version>9.2720</o:Version>
 </o:DocumentProperties>
</xml><![endif]-->
<style>
<!--
 /* Font Definitions */
@font-face
	{font-family:Tahoma;
	panose-1:2 11 6 4 3 5 4 4 2 4;
	mso-font-charset:0;
	mso-generic-font-family:swiss;
	mso-font-pitch:variable;
	mso-font-signature:16792199 0 0 0 65791 0;}
@font-face
	{font-family:Impact;
	panose-1:2 11 8 6 3 9 2 5 2 4;
	mso-font-charset:0;
	mso-generic-font-family:swiss;
	mso-font-pitch:variable;
	mso-font-signature:647 0 0 0 159 0;}
 /* Style Definitions */
p.MsoNormal, li.MsoNormal, div.MsoNormal
	{mso-style-parent:"";
	margin:0in;
	margin-bottom:.0001pt;
	mso-pagination:widow-orphan;
	font-size:12.0pt;
	font-family:"Times New Roman";
	mso-fareast-font-family:"Times New Roman";}
h1
	{mso-style-next:Normal;
	margin:0in;
	margin-bottom:.0001pt;
	mso-pagination:widow-orphan;
	page-break-after:avoid;
	mso-outline-level:1;
	font-size:24.0pt;
	mso-bidi-font-size:30.0pt;
	font-family:Impact;
	mso-font-kerning:0pt;}
p.WMLbasetext, li.WMLbasetext, div.WMLbasetext
	{mso-style-name:"WML base text";
	mso-style-parent:"";
	margin:0in;
	margin-bottom:.0001pt;
	text-align:justify;
	mso-pagination:widow-orphan;
	mso-layout-grid-align:none;
	text-autospace:none;
	font-size:11.5pt;
	font-family:"Times New Roman";
	mso-fareast-font-family:"Times New Roman";}
p.programs, li.programs, div.programs
	{mso-style-name:programs;
	mso-style-parent:"WML base text";
	margin-top:0in;
	margin-right:0in;
	margin-bottom:0in;
	margin-left:.5in;
	margin-bottom:.0001pt;
	mso-pagination:widow-orphan;
	mso-layout-grid-align:none;
	text-autospace:none;
	font-size:10.0pt;
	font-family:Tahoma;
	mso-fareast-font-family:"Times New Roman";}
@page Section1
	{size:8.5in 11.0in;
	margin:1.0in 1.25in 1.0in 1.25in;
	mso-header-margin:.5in;
	mso-footer-margin:.5in;
	mso-paper-source:0;}
div.Section1
	{page:Section1;}
-->
</style>
</head>

<body lang=EN-US style='tab-interval:.5in'>

<div class=Section1>

<p class=MsoNormal align=right style='text-align:right'><b><span
style='font-size:10.0pt;mso-bidi-font-size:30.0pt;font-family:Impact'><img
width=64 height=48 id="_x0000_i1025" src="../../bpb.jpg"><o:p></o:p></span></b></p>

<p class=MsoNormal><b><span style='font-size:24.0pt;mso-bidi-font-size:30.0pt;
font-family:Impact'>WAP Track</span></b></p>

<p class=WMLbasetext><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=WMLbasetext>This chapter explains how WML can be integrated with
Server Side scripting languages to build real time WAP Application. </p>

<p class=WMLbasetext><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=WMLbasetext>More important is, and that is what we want to show you,
how you can use a web server, server side scripting language, and a database to
write Wap applications. </p>

<p class=WMLbasetext><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=WMLbasetext><b><span style='font-size:10.0pt;mso-bidi-font-size:12.0pt'>Interaction</span></b></p>

<p class=WMLbasetext>- Conversions - <i>Microbrowser - Gateway -Webserver</i></p>

<p class=WMLbasetext><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=WMLbasetext><b>Software requirements</b></p>

<p class=WMLbasetext><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=WMLbasetext><b>Communication</b></p>

<p class=WMLbasetext>- Nokia to Personal Web Server - <i>Browser to server
request</i></p>

<p class=WMLbasetext>- Server to browser - <i>Imp Headers</i></p>

<p class=WMLbasetext>- Personal Web Server to Nokia - <i>Server to browser
response</i></p>

<p class=WMLbasetext><span style="mso-spacerun: yes"> </span></p>

<p class=WMLbasetext><b>Setting up the Application</b></p>

<p class=WMLbasetext><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=WMLbasetext><b>Programs - Worksheet</b></p>

<p class=WMLbasetext>By now, we hope that you are thorough with WML. If you are
not familiar with ASP, you can<span style="mso-spacerun: yes">  </span>refer to
the ASP tutorial at www.vijaymukhi.com. </p>

<p class=WMLbasetext><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=WMLbasetext><b>Conversions</b> - <i>Microbrowser - Gateway - Webserver</i></p>

<p class=WMLbasetext>The WAP-enabled phones (microbrowser) Communicates a
webserver through a WAP gateway. When a user types in a URL, the request is
send to the WAP gateway using the WAP Protocol, where the gateway creates a
conventional HTTP request for the specified URL and sends it to the web server.
The server returns the WML file along with HTTP headers back to the WAP gateway
and the gateway converts it back to WML bytecodes and sends it to microbrowser.</p>

<p class=WMLbasetext><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=WMLbasetext>That's the only reason we need a gateway, for these
conversions.</p>

<p class=WMLbasetext><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=WMLbasetext><b>Software requirements</b></p>

<p class=WMLbasetext>· Microsoft's Personal Web Server. </p>

<p class=WMLbasetext>· Active Server Pages, which is a scripting Language, used
on this server. </p>

<p class=WMLbasetext>· Microsoft Access, a database, to store user information
for future retrieval </p>

<p class=WMLbasetext>· Nokia WAP Toolkit as microbrowser.</p>

<p class=WMLbasetext><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=WMLbasetext><b>Nokia to Personal Web Server </b>- <i>Browser to Server
Request</i></p>

<p class=WMLbasetext><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=programs>index.wml</p>

<p class=programs>&lt;?xml version=&quot;1.0&quot; ?&gt;</p>

<p class=programs>&lt;!DOCTYPE wml PUBLIC &quot;-//WAPFORUM//DTD WML
1.1//EN&quot; &quot;http://www.wapforum.org/DTD/wml_1.1.xml&quot;&gt;</p>

<p class=programs><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=programs>&lt;wml&gt; </p>

<p class=programs><span style="mso-spacerun: yes"> </span>&lt;head&gt;
&lt;meta<span style="mso-spacerun: yes">  </span>http-equiv=&quot;Cache-Control&quot;
content=&quot;max-age=0&quot;/&gt; &lt;/head&gt;</p>

<p class=programs><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=programs>&lt;card id=&quot;login&quot; title=&quot;Login&quot;
newcontext=&quot;true&quot;&gt; </p>

<p class=programs>&lt;p&gt;</p>

<p class=programs>click on &lt;b&gt;options&lt;/b&gt;&lt;br/&gt;</p>

<p class=programs>and then on &lt;b&gt;select&lt;/b&gt; to call your file.</p>

<p class=programs>&lt;/p&gt;</p>

<p class=programs>&lt;do type='submit' label='first.asp' &gt;</p>

<p class=programs><span style='mso-tab-count:1'>            </span>&lt;go
href='http://127.0.0.1/first.asp' &gt;</p>

<p class=programs><span style='mso-tab-count:1'>            </span>&lt;/go&gt;</p>

<p class=programs><span style='mso-tab-count:1'>            </span>&lt;/do&gt;<span
style='mso-tab-count:1'>   </span></p>

<p class=programs>&lt;/card&gt;</p>

<p class=programs>&lt;/wml&gt;</p>

<p class=WMLbasetext><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=WMLbasetext>Click on compile and then on show. The Microbrowser
(Nokia) displays the file. Click on options, this will take you to Browser
Options. Under Browser options first.asp is highlighted so click on select. You
will get a 404 object not found error, because your server has no file called
first.asp. Let us create this File.</p>

<p class=WMLbasetext><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=WMLbasetext><b>Server to Browser</b> - <i>Imp-Headers</i></p>

<p class=WMLbasetext>Whenever a server sends a page to the browser, it first
has to send headers and then the page.</p>

<p class=WMLbasetext><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=WMLbasetext>Headers are nothing but something=something, lines that
give more information of the following content. So if you are sending an HTML
page over you first have to send a header as text/html.</p>

<p class=WMLbasetext><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=programs>&lt;% Response.ContentType=&quot;text/html&quot;<span
style="mso-spacerun: yes">  </span>%&gt;</p>

<p class=programs>&lt;html&gt;</p>

<p class=programs>&lt;b&gt;hi&lt;/b&gt; </p>

<p class=programs>how are you</p>

<p class=programs>&lt;/html&gt;</p>

<p class=WMLbasetext><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=WMLbasetext>This tells the browser that content following is text/html
and the browser displays it as html. Similarly when the server sends an image
file over it sends the header as</p>

<p class=WMLbasetext><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=programs>&lt;% Response.Content-Type=&quot;gif/img&quot; %&gt;</p>

<p class=WMLbasetext><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=WMLbasetext>So now that we have to send a WML file over to the
microbrowser. We first have to send a header that tells the microbrowser
(Nokia) that the content following is WML. So we set the header as </p>

<p class=WMLbasetext><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=programs>&lt;% Response.ContentType =
&quot;text/vnd.wap.wml&quot;<span style="mso-spacerun: yes">  </span>%&gt; </p>

<p class=programs><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=WMLbasetext>followed by WML content.</p>

<p class=WMLbasetext><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=WMLbasetext><b>Personal Web Server to Nokia</b> - <i>Server to Browser
Response</i></p>

<p class=WMLbasetext><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=programs>first.asp</p>

<p class=programs>&lt;% Response.ContentType =
&quot;text/vnd.wap.wml&quot;<span style="mso-spacerun: yes">  </span>%&gt;</p>

<p class=programs><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=programs>&lt;?xml version=&quot;1.0&quot; ?&gt;</p>

<p class=programs>&lt;!DOCTYPE wml PUBLIC &quot;-//WAPFORUM//DTD WML
1.1//EN&quot; &quot;http://www.wapforum.org/DTD/wml_1.1.xml&quot;&gt;</p>

<p class=programs><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=programs>&lt;wml&gt; </p>

<p class=programs>&lt;head&gt; &lt;meta<span style="mso-spacerun: yes"> 
</span>http-equiv=&quot;Cache-Control&quot; content=&quot;max-age=0&quot;/&gt;
&lt;/head&gt;</p>

<p class=programs><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=programs>&lt;card id=&quot;card1&quot;&gt; </p>

<p class=programs>&lt;p align=&quot;center&quot;&gt;</p>

<p class=programs>&lt;big&gt;&lt;b&gt;WapTrack&lt;/b&gt;&lt;/big&gt;</p>

<p class=programs><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=programs>&lt;small&gt;www.vijaymukhi.com&lt;/small&gt;</p>

<p class=programs>&lt;/p&gt;</p>

<p class=programs>&lt;/card&gt; </p>

<p class=programs><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=programs>&lt;/wml&gt;</p>

<p class=WMLbasetext><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=WMLbasetext>Save this file in your server's root directory and call it
from your browser (Nokia) as before. PWS sends the file over and Nokia displays
it.</p>

<p class=WMLbasetext><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=WMLbasetext><b>Setting up the Application</b></p>

<p class=WMLbasetext>To run this program, you need to make a virtual directory
“wapproject“ in the servers root (e.g. ..\Inetpub\wwwroot\wapproject) </p>

<p class=WMLbasetext><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=WMLbasetext>MS-Access database “user.mdb” to store data related to our
application with one table as “id” containing two fields a) <b>username</b> and
b) <b>password</b> in which the username and password of the user will be
stored. Both the fields should be of type “text” with 50 characters as maximum
size and Enter your name and a desired password as the first record. Now you
are ready to go ahead with the codes to get in action.</p>

<p class=WMLbasetext><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=WMLbasetext><b>Note. All the ASP files and the MDB file should be
stored in the virtual directory “wapproject“.</b></p>

<p class=WMLbasetext><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=WMLbasetext><span style='color:red'>You can download the
wapproject.zip file from www.vijaymukhi.com</span></p>

<p class=WMLbasetext><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=WMLbasetext><b>Programs - Workbook</b></p>

<p class=WMLbasetext>Our example is a very simple one. It lets you keep Track
of your daily schedules.</p>

<p class=WMLbasetext><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=programs><u>index.wml</u></p>

<p class=programs>&lt;?xml version=&quot;1.0&quot; ?&gt;</p>

<p class=programs>&lt;!DOCTYPE wml PUBLIC &quot;-//WAPFORUM//DTD WML
1.1//EN&quot; &quot;http://www.wapforum.org/DTD/wml_1.1.xml&quot;&gt;</p>

<p class=programs>&lt;wml&gt; </p>

<p class=programs>&lt;!-- <b><span style="mso-spacerun:
yes"> </span>Cache-Control header</b> --&gt;</p>

<p class=programs>&lt;head&gt; &lt;meta<span style="mso-spacerun: yes"> 
</span>http-equiv=&quot;Cache-Control&quot; content=&quot;max-age=0&quot;/&gt;
&lt;/head&gt;</p>

<p class=programs><b>&lt;!--<span style="mso-spacerun: yes">  </span>card1
which takes you to ../main.asp after 30 seconds --&gt;</b></p>

<p class=programs>&lt;card id=&quot;card1&quot; newcontext=&quot;true&quot;
ontimer=&quot;http://127.0.0.1/wapproject/main.asp&quot;&gt; </p>

<p class=programs>&lt;timer value=&quot;30&quot;/&gt;</p>

<p class=programs>&lt;p align=&quot;center&quot;&gt;</p>

<p class=programs><b>&lt;!-- Content to be displayed --&gt;</b></p>

<p class=programs>&lt;big&gt;&lt;b&gt;WapTrack&lt;/b&gt;&lt;/big&gt;</p>

<p class=programs>&lt;small&gt; &amp;#xA9;<span style="mso-spacerun: yes"> 
</span>www.waptrack.wml&lt;/small&gt;</p>

<p class=programs>&lt;/p&gt;</p>

<p class=programs>&lt;/card&gt; </p>

<p class=programs>&lt;/wml&gt;</p>

<p class=WMLbasetext><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=WMLbasetext>Index.wml is the first file to come over to the user. It
does nothing much but displays name of the site (Wap Track www.waptrack.wml)
and the ontimer takes you to main.asp after 30 sec.</p>

<p class=WMLbasetext><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=WMLbasetext><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=programs><u>main.asp</u></p>

<p class=programs>&lt;% Response.ContentType =
&quot;text/vnd.wap.wml&quot;<span style="mso-spacerun: yes">  </span>%&gt;</p>

<p class=programs>&lt;?xml version=&quot;1.0&quot; ?&gt;</p>

<p class=programs>&lt;!DOCTYPE wml PUBLIC &quot;-//WAPFORUM//DTD WML
1.1//EN&quot; &quot;http://www.wapforum.org/DTD/wml_1.1.xml&quot;&gt;</p>

<p class=programs><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=programs>&lt;wml&gt; </p>

<p class=programs><b>&lt;!--<span style="mso-spacerun: yes"> 
</span>Cache-Control header --&gt;</b></p>

<p class=programs>&lt;head&gt; &lt;meta<span style="mso-spacerun: yes"> 
</span>http-equiv=&quot;Cache-Control&quot; content=&quot;max-age=0&quot;/&gt;
&lt;/head&gt;</p>

<p class=programs><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=programs><b>&lt;!--<span style="mso-spacerun: yes">  </span>card 1
--&gt;</b></p>

<p class=programs>&lt;card id=&quot;main&quot; newcontext=&quot;true&quot;&gt; </p>

<p class=programs><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=programs><b>&lt;!--<span style="mso-spacerun: yes">  </span>link which
takes you to Card id signup --&gt;</b></p>

<p class=programs>&lt;do type='accept' label='signup'&gt;</p>

<p class=programs>&lt;go href='#signup'/&gt;<span style='mso-tab-count:1'>     </span></p>

<p class=programs>&lt;/do&gt;<span style='mso-tab-count:2'>               </span></p>

<p class=programs><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=programs><b>&lt;!--<span style="mso-spacerun: yes">  </span>link which
takes you to Card id login --&gt;</b></p>

<p class=programs>&lt;do type='accept' label='login'&gt;</p>

<p class=programs>&lt;go href='#login'/&gt;</p>

<p class=programs>&lt;/do&gt;<span style='mso-tab-count:1'>   </span></p>

<p class=programs><span style='mso-tab-count:1'>            </span></p>

<p class=programs><b>&lt;!--<span style="mso-spacerun: yes">  </span>Content to
be displayed --&gt;</b><span style='mso-tab-count:1'>      </span></p>

<p class=programs>&lt;p align=&quot;center&quot;&gt;</p>

<p class=programs>Click on &lt;b&gt;Options&lt;/b&gt; to Login or SignUp</p>

<p class=programs>&lt;/p&gt;</p>

<p class=programs>&lt;/card&gt; </p>

<p class=programs><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=programs><b>&lt;!--<span style="mso-spacerun: yes">  </span>signup
card which accepts the username and password and passes it to<span
style="mso-spacerun: yes">  </span>chksignup.asp --&gt;</b></p>

<p class=programs>&lt;card id=&quot;signup&quot; title=&quot;SignUp&quot;
newcontext=&quot;true&quot;&gt; </p>

<p class=programs><span style='mso-tab-count:1'>            </span></p>

<p class=programs>&lt;p&gt;</p>

<p class=programs><b><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></b></p>

<p class=programs><b>&lt;!--<span style="mso-spacerun: yes">  </span>textfields
where user fills in account details --&gt;</b></p>

<p class=programs>Username&lt;input type=&quot;text&quot;
title=&quot;UserName&quot; name=&quot;user&quot; value=&quot;&quot;
/&gt;&lt;br/&gt;</p>

<p class=programs>Password&lt;input type=&quot;password&quot;
title=&quot;Password&quot; name=&quot;pwd&quot; value=&quot;&quot;
/&gt;&lt;br/&gt;</p>

<p class=programs>&lt;/p&gt; </p>

<p class=programs><b><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></b></p>

<p class=programs><b>&lt;!--<span style="mso-spacerun: yes">  </span>link which
takes you to chksignup.asp where the actual check from database takes place
--&gt;</b></p>

<p class=programs>&lt;do type='accept' label='Submit'&gt;</p>

<p class=programs>&lt;go href='http://127.0.0.1/wapproject/chksignup.asp'
method=&quot;post&quot; &gt;</p>

<p class=programs><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=programs><b>&lt;!--<span style="mso-spacerun: yes">  </span>values
entered by the user are stored in variables and passed on to chksignup.asp
--&gt;</b></p>

<p class=programs>&lt;postfield name=&quot;chkuser&quot;
value=&quot;$(user)&quot; /&gt;<span style='mso-tab-count:1'>     </span></p>

<p class=programs>&lt;postfield name=&quot;chkpwd&quot;
value=&quot;$(pwd)&quot; /&gt;</p>

<p class=programs>&lt;/go&gt;</p>

<p class=programs>&lt;/do&gt;<span style='mso-tab-count:1'>   </span></p>

<p class=programs><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=programs><b>&lt;!--<span style="mso-spacerun: yes">  </span>link that
takes you back to card main if you landed up here by mistake --&gt;</b></p>

<p class=programs>&lt;do type=&quot;accept&quot; label=&quot;Back&quot;&gt;</p>

<p class=programs><span style="mso-spacerun: yes"> </span>&lt;go href =
&quot;#main&quot;/&gt;</p>

<p class=programs>&lt;/do&gt;</p>

<p class=programs>&lt;/card&gt; </p>

<p class=programs><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=programs><span style="mso-spacerun: yes"> </span><b>&lt;!--<span
style="mso-spacerun: yes">  </span>login card which accepts the username and password
and passes it on to chklogin.asp for authentication --&gt;</b></p>

<p class=programs><span style="mso-spacerun: yes"> </span>&lt;card
id=&quot;login&quot; title=&quot;Login&quot; newcontext=&quot;true&quot;&gt; </p>

<p class=programs>&lt;p&gt;</p>

<p class=programs><b><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></b></p>

<p class=programs><b>&lt;!--<span style="mso-spacerun: yes">  </span>textfields
where user fills in account details --&gt;</b></p>

<p class=programs>UserName&lt;input type=&quot;text&quot;
title=&quot;UserName&quot; name=&quot;user&quot; value=&quot;&quot;
/&gt;&lt;br/&gt;</p>

<p class=programs>Password&lt;input type=&quot;password&quot;
title=&quot;Password&quot; name=&quot;pwd&quot; value=&quot;&quot;
/&gt;&lt;br/&gt;</p>

<p class=programs>&lt;/p&gt; </p>

<p class=programs><b><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></b></p>

<p class=programs><b>&lt;!--<span style="mso-spacerun: yes">  </span>link that
takes the username and password details to chklogin.asp --&gt;</b></p>

<p class=programs>&lt;do type='accept' label='Submit'&gt;</p>

<p class=programs>&lt;go href='http://127.0.0.1/wapproject/chklogin.asp'
method=&quot;post&quot; &gt;</p>

<p class=programs>&lt;postfield name=&quot;chkuser&quot;
value=&quot;$(user)&quot; /&gt;<span style='mso-tab-count:1'>     </span></p>

<p class=programs>&lt;postfield name=&quot;chkpwd&quot;
value=&quot;$(pwd)&quot; /&gt;</p>

<p class=programs>&lt;/go&gt;</p>

<p class=programs>&lt;/do&gt;<span style='mso-tab-count:1'>   </span></p>

<p class=programs><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=programs><b>&lt;!--<span style="mso-spacerun: yes">  </span>back to
card main --&gt;</b></p>

<p class=programs>&lt;do type=&quot;accept&quot; label=&quot;Back&quot;&gt;</p>

<p class=programs>&lt;go href = &quot;#main&quot;/&gt;</p>

<p class=programs>&lt;/do&gt;</p>

<p class=programs><span style='mso-tab-count:3'>                                    </span></p>

<p class=programs>&lt;/card&gt; </p>

<p class=programs>&lt;/wml&gt;</p>

<p class=WMLbasetext><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=WMLbasetext>Card main has two link that take you either to signup
card<span style="mso-spacerun: yes">  </span>or login card from where you can
either get into your account by typing your username and password or make a new
account by clicking the signup link.</p>

<p class=WMLbasetext><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=WMLbasetext>Card signup allows the user to select a username and
password and passes the details to chksignup.asp to check the availability of
the username.</p>

<p class=WMLbasetext><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=WMLbasetext>Card Login accepts the username and password and passes it
on to chklogin.asp for authentication of the account.</p>

<p class=WMLbasetext><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=programs><u>chksignup.asp</u></p>

<p class=programs>&lt;% Response.ContentType = &quot;text/vnd.wap.wml&quot;%&gt;
</p>

<p class=programs>&lt;%<span style='mso-tab-count:1'>       </span></p>

<p class=programs><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=programs><b>`defining variables</b></p>

<p class=programs>dim chk,msg</p>

<p class=programs>chk=0</p>

<p class=programs>uid = request(&quot;chkuser&quot;)</p>

<p class=programs>pwd = request(&quot;chkpwd&quot;)</p>

<p class=programs><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=programs><b>`checking whether the variables are empty. If by mistake
the user submits without filling the text boxes</b></p>

<p class=programs>IF uid = &quot;&quot; or pwd = &quot;&quot; THEN</p>

<p class=programs>msg = &quot;Incomplete Data ...Re-enter&quot;</p>

<p class=programs>ELSE</p>

<p class=programs><b><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></b></p>

<p class=programs><b>`if user has entered both the fields then the following
code will check whether the desired username is available or in user by another
user. If available, a new account will be created for the user. </b></p>

<p class=programs><span style='mso-tab-count:1'>            </span></p>

<p class=programs><b>`setting up ODBC connection to our MS Access Database</b></p>

<p class=programs>Set cn = Server.CreateObject(&quot;ADODB.Connection&quot;)</p>

<p class=programs>cn.Open &quot;DRIVER={Microsoft Access Driver
(*.mdb)};DBQ=C:\Inetpub\wwwroot\wapproject\user.mdb&quot;</p>

<p class=programs><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=programs><b>`here we check the availability of the desired username.
The account created is case insensitive.</b></p>

<p class=programs>Set rec = Server.CreateObject(&quot;ADODB.Recordset&quot;)</p>

<p class=programs><span style='mso-tab-count:1'>            </span>strSQL =
&quot;SELECT * FROM id&quot;</p>

<p class=programs><span style='mso-tab-count:1'>            </span>rec.Open
strSQL,cn <span style='mso-tab-count:1'>       </span></p>

<p class=programs><span style='mso-tab-count:1'>            </span>Set
objUsername = rec(&quot;username&quot;)</p>

<p class=programs><span style='mso-tab-count:1'>            </span>Do UNTIL
rec.EOF</p>

<p class=programs><span style='mso-tab-count:1'>            </span>IF
UCASE(uid) = UCASE(objUsername) then </p>

<p class=programs><span style='mso-tab-count:1'>            </span>chk=0</p>

<p class=programs><span style='mso-tab-count:1'>            </span>EXIT DO</p>

<p class=programs><span style='mso-tab-count:1'>            </span>ELSE</p>

<p class=programs><span style='mso-tab-count:1'>            </span>chk=1</p>

<p class=programs><span style='mso-tab-count:1'>            </span>rec.MoveNext</p>

<p class=programs><span style='mso-tab-count:1'>            </span>END IF</p>

<p class=programs><span style='mso-tab-count:1'>            </span>LOOP</p>

<p class=programs><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=programs><b>`the value of the chk variable will be 0 if the username
is currently in use.</b></p>

<p class=programs>IF chk = 0 THEN</p>

<p class=programs>msg=&quot;Username in use &lt;br/&gt; Try Again&quot;</p>

<p class=programs>ELSE</p>

<p class=programs><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=programs><b>` if the value is 1, the following code will insert<span
style="mso-spacerun: yes">  </span>the username and password into the id table of
our database. </b></p>

<p class=programs>strSQL = &quot;INSERT INTO id (username,password) VALUES
('&quot;<span style="mso-spacerun: yes">   </span>&amp; uid &amp;
&quot;','&quot; &amp; pwd &amp; &quot;')&quot;</p>

<p class=programs><span style='mso-tab-count:1'>            </span>cn.Execute(strSQL)</p>

<p class=programs><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=programs><b>`create a new table with the same name as the username to
store the schedule of the user.</b></p>

<p class=programs>strSQL = &quot;CREATE TABLE &quot; &amp; uid &amp;
&quot;(flddate varchar(11),fldtime varchar(8),fldmessage varchar(200))&quot;</p>

<p class=programs>cn.Execute(strSQL)</p>

<p class=programs><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=programs><b>`inserts a dummy record into the newly created table</b></p>

<p class=programs>strSQL = &quot;INSERT INTO &quot; &amp; uid &amp; &quot;
(flddate,fldtime,fldmessage) VALUES ('22/22/2002','&quot; &amp; NOW()
&amp;&quot;','WELCOME TO SHEDULE')&quot;</p>

<p class=programs>cn.Execute(strSQL)</p>

<p class=programs><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=programs><b>`Sets the msg varible if the account is created.</b></p>

<p class=programs>msg=&quot;account created &lt;br/&gt;login to use&quot;</p>

<p class=programs>END IF</p>

<p class=programs>cn.close</p>

<p class=programs>END IF</p>

<p class=programs><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=programs>%&gt;</p>

<p class=programs><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=programs><b>`here, the actual WML code comes into picture. It will
display the result of the above code i.e. whether the account is created or the
username is in use.<o:p></o:p></b></p>

<p class=programs>&lt;?xml version=&quot;1.0&quot; ?&gt;</p>

<p class=programs>&lt;!DOCTYPE wml PUBLIC &quot;-//WAPFORUM//DTD WML
1.1//EN&quot; &quot;http://www.wapforum.org/DTD/wml_1.1.xml&quot;&gt;</p>

<p class=programs>&lt;wml&gt; </p>

<p class=programs><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=programs><b>&lt;!--<span style="mso-spacerun: yes"> 
</span>Cache-Control header --&gt;</b></p>

<p class=programs>&lt;head&gt; &lt;meta<span style="mso-spacerun: yes"> 
</span>http-equiv=&quot;Cache-Control&quot; content=&quot;max-age=0&quot;/&gt;
&lt;/head&gt; </p>

<p class=programs>&lt;card id=&quot;card1&quot;&gt; </p>

<p class=programs><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=programs><b>&lt;!-- a timer of 20 seconds is set after which main.asp
page will be displayed. --&gt;</b></p>

<p class=programs>&lt;onevent type='ontimer'&gt; &lt;go
href='http://127.0.0.1/wapproject/main.asp'/&gt; &lt;/onevent&gt; &lt;timer
value = '20'/&gt;</p>

<p class=programs><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=programs><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=programs>&lt;p&gt;</p>

<p class=programs><b><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></b></p>

<p class=programs><b>&lt;!--<span style="mso-spacerun: yes">  </span>msg will display
the value dynamically<span style="mso-spacerun: yes">  </span>depending upon
the result of the above processed code.<span style="mso-spacerun: yes"> 
</span>--&gt;<o:p></o:p></b></p>

<p class=programs>&lt;%= msg %&gt;</p>

<p class=programs>&lt;/p&gt;</p>

<p class=programs>&lt;/card&gt;</p>

<p class=programs>&lt;/wml&gt; </p>

<p class=WMLbasetext><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=WMLbasetext>The chksignup.asp program actually checks for the
availability of the desired username. First it starts of by checking the
variables, which have been passed on by the signup card of main.asp page. If
they are empty, the variable msg will get the value stating that the user has
not entered the fields properly. </p>

<p class=WMLbasetext><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=WMLbasetext>If both the fields contains a value, the program continues
by connecting to the id table in our database. There it checks whether the
desired username is available or not. if not available, the variable msg gets
the value which states that the username is currently in use. If available, the
further code adds the new username and password to the id table. Then it
creates a new table with the same name as the username where we store the users
schedule and the variable msg gets the value which states that the account has
been successfully created. </p>

<p class=WMLbasetext><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=WMLbasetext>Following the asp code is our wml code, which displays the
msg variable which in turn shows the result to the user. After 20 seconds, the
user is taken back to the main page from where he can either login and start
using his account or try signing up again.</p>

<p class=WMLbasetext><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=programs>chklogin.asp</p>

<p class=programs>&lt;% Response.ContentType = &quot;text/vnd.wap.wml&quot; </p>

<p class=programs><b>`defining variables</b></p>

<p class=programs>dim chk,msg,kkk</p>

<p class=programs>kkk=0</p>

<p class=programs>uid = request(&quot;chkuser&quot;)</p>

<p class=programs>pwd = request(&quot;chkpwd&quot;)</p>

<p class=programs><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=programs><b>`checking whether the variables are empty. If by mistake
the user has clicked without filling the text boxes</b></p>

<p class=programs>IF uid = &quot;&quot; or pwd = &quot;&quot; THEN</p>

<p class=programs>msg = &quot;Incomplete Data ...Re-enter&quot;</p>

<p class=programs>ELSE</p>

<p class=programs><span style='mso-tab-count:1'>            </span></p>

<p class=programs><b>`setting up ODBC connection to our MS Access Database</b></p>

<p class=programs>Set cn = Server.CreateObject(&quot;ADODB.Connection&quot;)</p>

<p class=programs>cn.Open cn.Open &quot;DRIVER={Microsoft Access Driver
(*.mdb)};DBQ=C:\Inetpub\wwwroot\wapproject\user.mdb&quot;</p>

<p class=programs>Set rec = Server.CreateObject(&quot;ADODB.Recordset&quot;)</p>

<p class=programs>strSQL = &quot;SELECT * FROM id&quot;</p>

<p class=programs>rec.Open strSQL,cn <span style='mso-tab-count:1'>       </span></p>

<p class=programs><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=programs><b>`the following code is basically for authentication. This
code will either allow the user to login if the username and password is
correct or send the user back to main.asp to re-login if the data is incorrect.<o:p></o:p></b></p>

<p class=programs>Set objUsername = rec(&quot;username&quot;)</p>

<p class=programs>Set objPassword = rec(&quot;password&quot;)</p>

<p class=programs>Do UNTIL rec.EOF</p>

<p class=programs>IF uid = objUsername then </p>

<p class=programs>IF objPassword = pwd then </p>

<p class=programs><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=programs><b>`sets the msg and kkk veriable if Username and Password
match</b></p>

<p class=programs>msg = &quot;Logging In...&lt;br/&gt;Please Wait &quot;</p>

<p class=programs>kkk=1</p>

<p class=programs>ELSE</p>

<p class=programs><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=programs><b>`sets the msg and kkk variable when the username<span
style="mso-spacerun: yes">  </span>matches, but the password does not match.<o:p></o:p></b></p>

<p class=programs>msg = &quot;Incorrect Password&quot;</p>

<p class=programs>kkk=0</p>

<p class=programs>END IF</p>

<p class=programs><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=programs>chk=0</p>

<p class=programs>EXIT DO</p>

<p class=programs>ELSE</p>

<p class=programs><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=programs><b>`chk is set to 1 if username does not match each time you
pass the loop<o:p></o:p></b></p>

<p class=programs>chk=1</p>

<p class=programs>rec.MoveNext </p>

<p class=programs>END IF</p>

<p class=programs>LOOP</p>

<p class=programs><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=programs><b>`sets the veriables if username does not match</b></p>

<p class=programs>IF chk=1 then</p>

<p class=programs>kkk=0</p>

<p class=programs>msg=&quot;Invalid Username&quot;</p>

<p class=programs>ELSE</p>

<p class=programs><b>`adds the username to the session veriable</b></p>

<p class=programs>Session(&quot;username&quot;)=uid</p>

<p class=programs>END IF</p>

<p class=programs><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=programs>cn.close</p>

<p class=programs>END IF</p>

<p class=programs><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=programs>%&gt;</p>

<p class=programs>&lt;?xml version=&quot;1.0&quot; ?&gt;</p>

<p class=programs>&lt;!DOCTYPE wml PUBLIC &quot;-//WAPFORUM//DTD WML
1.1//EN&quot; &quot;http://www.wapforum.org/DTD/wml_1.1.xml&quot;&gt;</p>

<p class=programs><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=programs>&lt;wml&gt; </p>

<p class=programs><b>&lt;!--<span style="mso-spacerun: yes"> 
</span>Cache-Control header --&gt;</b></p>

<p class=programs>&lt;head&gt; &lt;meta<span style="mso-spacerun: yes"> 
</span>http-equiv=&quot;Cache-Control&quot; content=&quot;max-age=0&quot;/&gt;
&lt;/head&gt; </p>

<p class=programs>&lt;card id=&quot;card1&quot; newcontext=&quot;true&quot;&gt;
</p>

<p class=programs>&lt;% </p>

<p class=programs><b><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></b></p>

<p class=programs><b>&lt;!--<span style="mso-spacerun: yes">  </span>the value
of the variable kkk will be 0 if username password does not match, so the<span
style="mso-spacerun: yes">  </span>user is taken back to the main page to
re-login. --&gt;<o:p></o:p></b></p>

<p class=programs>IF kkk=0 THEN</p>

<p class=programs>Response.write(&quot;&lt;onevent type='ontimer'&gt; &lt;go
href='http://127.0.0.1/wapproject/main.asp'/&gt; &lt;/onevent&gt; &lt;timer
value = '20'/&gt;&quot;)</p>

<p class=programs>END IF</p>

<p class=programs><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=programs>&lt;!--<span style="mso-spacerun: yes">  </span><b>the value
of the variable kkk will be 1 if both, username and password match and the user
is taken to datamain.asp where he can see his schedule.</b> --&gt;</p>

<p class=programs>IF kkk=1 THEN</p>

<p class=programs>Response.write(&quot;&lt;onevent type='ontimer'&gt; &lt;go
href='http://127.0.0.1/wapproject/datamain.asp'/&gt; &lt;/onevent&gt; &lt;timer
value = '20'/&gt;&quot;)</p>

<p class=programs>END IF</p>

<p class=programs>%&gt;</p>

<p class=programs><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=programs>&lt;p&gt;</p>

<p class=programs><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=programs>&lt;%= msg %&gt;</p>

<p class=programs><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=programs>&lt;/p&gt;</p>

<p class=programs>&lt;/card&gt; </p>

<p class=programs><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=programs>&lt;/wml&gt;</p>

<p class=WMLbasetext><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=WMLbasetext>chklogin.asp is basically an authentication page. First it
checks the whether the user has filled in both the fields. If not, the variable
msg gets the value which informs the user that he has not filled in the fields
properly. </p>

<p class=WMLbasetext><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=WMLbasetext><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=WMLbasetext>If both the fields contain value, the code sets up the
ODBC connection to our database. Then it checks the username, which is entered
by the user with each username of the username field of the id table. This
check is done to find out whether an account with the following username has
been already created. If the username does not match with the one entered by
the user, the value of msg states that an account such a username does not
exist, kkk is set to 0 and we jump to the WML part.</p>

<p class=WMLbasetext><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=WMLbasetext>If the username matches, the corresponding password field
value is checked. If the password does not match, the msg variable states that
the password entered by the user is incorrect.<span style="mso-spacerun: yes"> 
</span></p>

<p class=WMLbasetext><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=WMLbasetext>If<span style="mso-spacerun: yes">  </span>both the fields
match with the id table, msg states that logging in is in progress. Also, the
variable kkk is set to 1. we also set the value of the variable kkk to 0</p>

<p class=WMLbasetext><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=WMLbasetext>Now we enter into our WML code. Here, we check the
variable kkk. The value of kkk will be 0 when both, the username and password
are incorrect or when the username is correct but the password is incorrect. In
any case the user is taken back to the main page to re-login. So the user is
redirected back to main.asp. </p>

<p class=WMLbasetext><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=WMLbasetext>The value of kkk will be 1 only when the username and
password has matched with any of the username and<span style="mso-spacerun:
yes">  </span>its corresponding password of the id table. In this case, the
user is redirected to datamain.asp, from where the user can check his
schedules. </p>

<p class=WMLbasetext><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=programs><u>datamain.asp</u></p>

<p class=programs>&lt;% Response.ContentType =
&quot;text/vnd.wap.wml&quot;<span style="mso-spacerun: yes">  </span>%&gt;</p>

<p class=programs>&lt;?xml version=&quot;1.0&quot; ?&gt;</p>

<p class=programs>&lt;!DOCTYPE wml PUBLIC &quot;-//WAPFORUM//DTD WML
1.1//EN&quot; &quot;http://www.wapforum.org/DTD/wml_1.1.xml&quot;&gt;</p>

<p class=programs>&lt;wml&gt; </p>

<p class=programs><b>&lt;!--<span style="mso-spacerun: yes">  </span>Cache-Control
header --&gt;</b></p>

<p class=programs>&lt;head&gt; &lt;meta<span style="mso-spacerun: yes"> 
</span>http-equiv=&quot;Cache-Control&quot; content=&quot;max-age=0&quot;/&gt;
&lt;/head&gt; </p>

<p class=programs><b>`the following card has a set of links which give the user
choice as to how he would like to see his schedule, add a schedule, modify a
schedule, delete a schedule or logout</b></p>

<p class=programs>&lt;card id=&quot;datamain&quot;
newcontext=&quot;true&quot;&gt;</p>

<p class=programs><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=programs><b>&lt;!--<span style="mso-spacerun: yes">  </span>`link
takes the user to dataadd</b> <b><span style="mso-spacerun: yes"> </span>--&gt;</b></p>

<p class=programs>&lt;do type='options' label='Add'&gt;</p>

<p class=programs>&lt;go href='#dataadd'/&gt;</p>

<p class=programs>&lt;/do&gt;<span style='mso-tab-count:1'>   </span></p>

<p class=programs><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=programs><b>&lt;!--<span style="mso-spacerun: yes">  </span>link takes
the user to disptdata.asp --&gt;</b></p>

<p class=programs>&lt;do type='options' label='c Todays Shed'&gt;</p>

<p class=programs>&lt;go href='http://127.0.0.1/wapproject/disptdata.asp'/&gt;<span
style='mso-tab-count:1'>    </span></p>

<p class=programs>&lt;/do&gt;</p>

<p class=programs><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=programs><b>&lt;!--<span style="mso-spacerun: yes">  </span>`link
takes the user to dataviewsingle<span style="mso-spacerun: yes"> 
</span>card--&gt;</b></p>

<p class=programs>&lt;do type='options' label='c 1 Shed'&gt;</p>

<p class=programs>&lt;go href='#dataviewsingle'/&gt;<span style='mso-tab-count:
1'>     </span></p>

<p class=programs>&lt;/do&gt;<span style='mso-tab-count:2'>               </span></p>

<p class=programs><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=programs><b>&lt;!--<span style="mso-spacerun: yes">  </span>`link
takes the user to dataviewday card</b> <b>--&gt; </b></p>

<p class=programs>&lt;do type='options' label='c Days Shed'&gt;</p>

<p class=programs>&lt;go href='#dataviewday'/&gt;<span style='mso-tab-count:
1'>        </span></p>

<p class=programs>&lt;/do&gt;<span style='mso-tab-count:1'>   </span></p>

<p class=programs><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=programs><b>&lt;!--<span style="mso-spacerun: yes">  </span>`link
takes the user to datamodify card --&gt;</b>`</p>

<p class=programs>&lt;do type='options' label='Modify'&gt;</p>

<p class=programs>&lt;go href='#datamodify'/&gt;</p>

<p class=programs>&lt;/do&gt;<span style='mso-tab-count:1'>   </span></p>

<p class=programs><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=programs><b>&lt;!--<span style="mso-spacerun: yes">  </span>`link
takes the user to datadelete--&gt;</b></p>

<p class=programs>&lt;do type='options' label='Delete'&gt;</p>

<p class=programs>&lt;go href='#datadelete'/&gt;</p>

<p class=programs>&lt;/do&gt;<span style='mso-tab-count:1'>   </span></p>

<p class=programs><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=programs><b>&lt;!--<span style="mso-spacerun: yes">  </span>`link
takes the user back to main.asp --&gt;</b></p>

<p class=programs>&lt;do type='options' label='LogOut'&gt;</p>

<p class=programs>&lt;go href='http://127.0.0.1/wapproject/main.asp'/&gt;</p>

<p class=programs>&lt;/do&gt;<span style='mso-tab-count:1'>   </span></p>

<p class=WMLbasetext><b>------------------------------------------------------------------------------------</b></p>

<p class=programs>&lt;p&gt;</p>

<p class=programs><b><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></b></p>

<p class=programs><b>&lt;!--<span style="mso-spacerun: yes">  </span>displays a
wellcome message using the session veriable --&gt;</b></p>

<p class=programs>Hi &lt;%= Session(&quot;username&quot;) %&gt;&lt;br/&gt;</p>

<p class=programs>&lt;small&gt;Welcome to Your Page&lt;/small&gt;&lt;br/&gt;</p>

<p class=programs>Check &lt;b&gt;Options&lt;/b&gt;</p>

<p class=programs>&lt;/p&gt;</p>

<p class=programs>&lt;/card&gt;</p>

<p class=programs><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=programs><b>&lt;!--<span style="mso-spacerun: yes">  </span>card
dataadd passes the values to adddata.asp<span style="mso-spacerun: yes"> 
</span>--&gt;</b></p>

<p class=programs>&lt;card id=&quot;dataadd&quot; title=&quot;Add
Shedule&quot;&gt; </p>

<p class=programs>&lt;onevent type='onenterforward'&gt;</p>

<p class=programs>&lt;refresh&gt;</p>

<p class=programs>&lt;setvar name='submit'
value='http://127.0.0.1/wapproject/adddata.asp'/&gt;</p>

<p class=programs>&lt;/refresh&gt;</p>

<p class=programs>&lt;/onevent&gt;</p>

<p class=programs>&lt;p&gt;</p>

<p class=programs>&lt;small&gt; Date = mm/dd/yy &lt;/small&gt;&lt;br/&gt;</p>

<p class=programs>&lt;small&gt;Time = 24 Hr&lt;/small&gt;&lt;br/&gt;</p>

<p class=programs>Date :&lt;input format=&quot;NN\/NN\/\2\0\0\0&quot;
title=&quot;date&quot; name=&quot;date&quot; value=&quot;&quot;
/&gt;&lt;br/&gt;</p>

<p class=programs>Time :&lt;input format=&quot;NN\:NN&quot;
title=&quot;time&quot; name=&quot;time&quot; value=&quot;&quot;
/&gt;&lt;br/&gt;</p>

<p class=programs>Message :&lt;input title=&quot;message&quot;
name=&quot;message&quot; value=&quot;&quot; /&gt;&lt;br/&gt;</p>

<p class=programs>&lt;/p&gt; </p>

<p class=programs>&lt;do type='accept' label='Submit'&gt;</p>

<p class=programs>&lt;go href='$(submit:unesc)' method=&quot;post&quot; &gt;</p>

<p class=programs>&lt;postfield name=&quot;dt&quot; value=&quot;$(date)&quot;
/&gt;<span style='mso-tab-count:1'> </span></p>

<p class=programs>&lt;postfield name=&quot;ti&quot; value=&quot;$(time)&quot;
/&gt;</p>

<p class=programs>&lt;postfield name=&quot;mg&quot;
value=&quot;$(message)&quot; /&gt;</p>

<p class=programs>&lt;/go&gt;</p>

<p class=programs>&lt;/do&gt;<span style='mso-tab-count:1'>   </span></p>

<p class=programs>&lt;do type=&quot;accept&quot; label=&quot;Back&quot;&gt;</p>

<p class=programs>&lt;go href = &quot;#datamain&quot;/&gt;</p>

<p class=programs>&lt;/do&gt;</p>

<p class=programs><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=programs>&lt;/card&gt; </p>

<p class=programs><b>&lt;!--<span style="mso-spacerun: yes">  </span>card
dataviewsingle passes the values to dispsdata.asp<span style="mso-spacerun:
yes">  </span>--&gt;</b></p>

<p class=programs>&lt;card id=&quot;dataviewsingle&quot; title=&quot;Single
Shedule&quot; newcontext=&quot;true&quot;&gt; </p>

<p class=programs>&lt;p&gt;</p>

<p class=programs>&lt;small&gt;Enter Shedule Date And Time &lt;/small&gt;</p>

<p class=programs>Date :&lt;input format=&quot;NN\/NN\/\2\0\0\0&quot;
title=&quot;date&quot; name=&quot;date&quot; value=&quot;&quot;
/&gt;&lt;br/&gt;</p>

<p class=programs>Time :&lt;input format=&quot;NN\:NN&quot;
title=&quot;time&quot; name=&quot;time&quot; value=&quot;&quot;
/&gt;&lt;br/&gt;</p>

<p class=programs>&lt;/p&gt; </p>

<p class=programs>&lt;do type='accept' label='Submit'&gt;</p>

<p class=programs>&lt;go href='http://127.0.0.1/wapproject/dispsdata.asp'
method=&quot;post&quot; &gt;</p>

<p class=programs>&lt;postfield name=&quot;dt&quot; value=&quot;$(date)&quot;
/&gt;<span style='mso-tab-count:1'> </span></p>

<p class=programs>&lt;postfield name=&quot;ti&quot; value=&quot;$(time)&quot;
/&gt;</p>

<p class=programs>&lt;/go&gt;</p>

<p class=programs>&lt;/do&gt;<span style='mso-tab-count:1'>   </span></p>

<p class=programs>&lt;do type=&quot;accept&quot; label=&quot;Back&quot;&gt;</p>

<p class=programs>&lt;go href = &quot;#datamain&quot;/&gt;</p>

<p class=programs>&lt;/do&gt;</p>

<p class=programs><span style='mso-tab-count:3'>                                    </span></p>

<p class=programs>&lt;/card&gt; </p>

<p class=programs><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=programs><b>&lt;!--<span style="mso-spacerun: yes">  </span>card
dataviewday passes the values to dispddata.asp --&gt;</b></p>

<p class=programs>&lt;card id=&quot;dataviewday&quot; title=&quot;days
shedule&quot; newcontext=&quot;true&quot;&gt; </p>

<p class=programs><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=programs>&lt;p&gt;</p>

<p class=programs>&lt;small&gt;Enter Shedule Date And Time &lt;/small&gt;</p>

<p class=programs>Date :&lt;input format=&quot;NN\/NN\/\2\0\0\0&quot;
title=&quot;date&quot; name=&quot;date&quot; value=&quot;&quot;
/&gt;&lt;br/&gt;</p>

<p class=programs>&lt;/p&gt; </p>

<p class=programs>&lt;do type='accept' label='Submit'&gt;</p>

<p class=programs>&lt;go href='http://127.0.0.1/wapproject/dispddata.asp'
method=&quot;post&quot; &gt;</p>

<p class=programs>&lt;postfield name=&quot;dt&quot; value=&quot;$(date)&quot;
/&gt;<span style='mso-tab-count:1'> </span></p>

<p class=programs>&lt;/go&gt;</p>

<p class=programs>&lt;/do&gt;<span style='mso-tab-count:1'>   </span></p>

<p class=programs>&lt;do type=&quot;accept&quot; label=&quot;Back&quot;&gt;</p>

<p class=programs>&lt;go href = &quot;#datamain&quot;/&gt;</p>

<p class=programs>&lt;/do&gt;</p>

<p class=programs><span style='mso-tab-count:3'>                                    </span></p>

<p class=programs>&lt;/card&gt; </p>

<p class=programs><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=programs><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=programs><b>&lt;!--<span style="mso-spacerun: yes">  </span>card
datamodify passes the values to modidata.asp<span style="mso-spacerun: yes"> 
</span>--&gt;</b></p>

<p class=programs>&lt;card id=&quot;datamodify&quot; title=&quot;Modify
Shedule&quot;&gt; </p>

<p class=programs>&lt;onevent type='onenterforward'&gt;</p>

<p class=programs>&lt;refresh&gt;</p>

<p class=programs>&lt;setvar name='submit' value='http://127.0.0.1/wapproject/modidata.asp'/&gt;</p>

<p class=programs>&lt;/refresh&gt;</p>

<p class=programs>&lt;/onevent&gt;</p>

<p class=programs>&lt;p&gt;</p>

<p class=programs>&lt;small&gt; Date = mm/dd/yy &lt;/small&gt;&lt;br/&gt;</p>

<p class=programs>&lt;small&gt;Time = 24 Hr&lt;/small&gt;&lt;br/&gt;</p>

<p class=programs>Date :&lt;input format=&quot;NN\/NN\/\2\0\0\0&quot;
title=&quot;date&quot; name=&quot;date&quot; value=&quot;&quot;
/&gt;&lt;br/&gt;</p>

<p class=programs>Time :&lt;input format=&quot;NN\:NN&quot;
title=&quot;time&quot; name=&quot;time&quot; value=&quot;&quot;
/&gt;&lt;br/&gt;</p>

<p class=programs>Modi Message :&lt;input title=&quot;message&quot;
name=&quot;message&quot; value=&quot;&quot; /&gt;&lt;br/&gt;</p>

<p class=programs>&lt;/p&gt; </p>

<p class=programs>&lt;do type='accept' label='Submit'&gt;</p>

<p class=programs>&lt;go href='$(submit:unesc)' method=&quot;post&quot; &gt;</p>

<p class=programs><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=programs>&lt;postfield name=&quot;dt&quot; value=&quot;$(date)&quot;
/&gt;<span style='mso-tab-count:1'> </span></p>

<p class=programs>&lt;postfield name=&quot;ti&quot; value=&quot;$(time)&quot;
/&gt;</p>

<p class=programs>&lt;postfield name=&quot;mg&quot;
value=&quot;$(message)&quot; /&gt;</p>

<p class=programs>&lt;/go&gt;</p>

<p class=programs>&lt;/do&gt;<span style='mso-tab-count:1'>   </span></p>

<p class=programs>&lt;do type=&quot;accept&quot; label=&quot;Back&quot;&gt;</p>

<p class=programs>&lt;go href = &quot;#datamain&quot;/&gt;</p>

<p class=programs>&lt;/do&gt;</p>

<p class=programs>&lt;/card&gt; </p>

<p class=programs><b><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></b></p>

<p class=programs><b><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></b></p>

<p class=programs><b><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></b></p>

<p class=programs><b>&lt;!--<span style="mso-spacerun: yes">  </span>card
datadelete passes the values to deletedata.asp<span style="mso-spacerun: yes"> 
</span>--&gt;</b></p>

<p class=programs>&lt;card id=&quot;datadelete&quot; title=&quot;Delete Shedule&quot;
newcontext=&quot;true&quot;&gt; </p>

<p class=programs>&lt;p&gt;</p>

<p class=programs>&lt;small&gt;Enter Delete Date And Time &lt;/small&gt;</p>

<p class=programs>Date :&lt;input format=&quot;NN\/NN\/\2\0\0\0&quot;
title=&quot;date&quot; name=&quot;date&quot; value=&quot;&quot;
/&gt;&lt;br/&gt;</p>

<p class=programs>Time :&lt;input format=&quot;NN\:NN&quot;
title=&quot;time&quot; name=&quot;time&quot; value=&quot;&quot;
/&gt;&lt;br/&gt;</p>

<p class=programs>&lt;/p&gt; </p>

<p class=programs>&lt;do type='accept' label='Submit'&gt;</p>

<p class=programs>&lt;go href='http://127.0.0.1/wapproject/deletedata.asp'
method=&quot;post&quot; &gt;</p>

<p class=programs>&lt;postfield name=&quot;dt&quot; value=&quot;$(date)&quot;
/&gt;<span style='mso-tab-count:1'> </span></p>

<p class=programs>&lt;postfield name=&quot;ti&quot; value=&quot;$(time)&quot;
/&gt;</p>

<p class=programs>&lt;/go&gt;</p>

<p class=programs>&lt;/do&gt;<span style='mso-tab-count:1'>   </span></p>

<p class=programs>&lt;do type=&quot;accept&quot; label=&quot;Back&quot;&gt;</p>

<p class=programs>&lt;go href = &quot;#datamain&quot;/&gt;</p>

<p class=programs>&lt;/do&gt;</p>

<p class=programs><span style='mso-tab-count:3'>                                    </span></p>

<p class=programs>&lt;/card&gt; </p>

<p class=programs>&lt;/wml&gt;</p>

<p class=WMLbasetext><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=WMLbasetext>datamain.asp</p>

<p class=WMLbasetext>once the user logs into his account he comes to the
datamain.asp page from where he can access his schedules. The first card i.e.
the datamain card gives the user a list of options so that he can interact with
his account.</p>

<p class=WMLbasetext><span style='mso-tab-count:1'>            </span>a) add a
schedule, </p>

<p class=WMLbasetext><span style='mso-tab-count:1'>            </span>b) view a
single schedule, </p>

<p class=WMLbasetext><span style='mso-tab-count:1'>            </span>c) view
today’s schedule, </p>

<p class=WMLbasetext><span style='mso-tab-count:1'>            </span>d) modify
a schedule </p>

<p class=WMLbasetext><span style='mso-tab-count:1'>            </span>e) delete
a schedule.<span style="mso-spacerun: yes">  </span></p>

<p class=WMLbasetext><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=WMLbasetext>Lets look at it step by step. </p>

<p class=WMLbasetext>a) the first option is to add a schedule. The user is taken
to the dataadd card where can fill in the date, time and the message for the
schedule. On submit the data is passed to `adddata.asp`.</p>

<p class=WMLbasetext><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=WMLbasetext>b) The second option is to see the current days schedule.
When the users chooses this option, 'disptdata.asp' takes over. </p>

<p class=WMLbasetext><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=WMLbasetext>c) The Third option is to view a single schedule. when the
user chooses this option, he is taken to the dataviewsingle card where he can
fill in the date and time of the schedule that he wants to see. On submit, the
page is redirected to `dispsdata.asp` page along with the information entered
by the user.</p>

<p class=WMLbasetext><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=WMLbasetext>c) The fourth option allows the user to view a particular
days schedule. Selecting this option, the user is taken to the dataviewday card
where he can fill in the date of which he wants to see the schedule. The page
is then redirected to the dispddata.asp page along with the date entered by the
user.</p>

<p class=WMLbasetext><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=WMLbasetext>e) The fifth option allows the user to modify an existing
schedule. The datamodify card, which is the link to this option, contains 3
fields. The user has to fill the date and the time of the schedule to be
modified. And the new message which will replace the old message. Choosing the
submit button will redirect to datamodify.asp allong with the data.</p>

<p class=WMLbasetext><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=WMLbasetext>f) The sixth option is to delete a schedule. The user is
taken to the datadelete card where he can enter the date and time of the
schedule which has to be deleted. On submit the data is passed to
`deletedata.asp`.</p>

<p class=WMLbasetext><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=WMLbasetext>g) The last option allows the user to logout from his
account, which takes him back to the main.asp.</p>

<p class=WMLbasetext><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=WMLbasetext><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=WMLbasetext><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=WMLbasetext><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=programs><u>adddata.asp</u></p>

<p class=programs>&lt;% Response.ContentType = “text/vnd.wap.wml”<span
style="mso-spacerun: yes">  </span></p>

<p class=programs><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=programs>‘defining variables<b><o:p></o:p></b></p>

<p class=programs>dim chkdate,chktime,chkmessage,mm,dd,hr,mi,val,msg</p>

<p class=programs>val = 1</p>

<p class=programs><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=programs>‘Retrieving data from Query String<b><o:p></o:p></b></p>

<p class=programs>chkdate=Request(“dt”)</p>

<p class=programs>chktime=Request(“ti”)</p>

<p class=programs>chkmessage=Request(“mg”)</p>

<p class=programs><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=programs>‘checking whether the variables are empty. If by mistake the
user has clicked without filling the text boxes<b><o:p></o:p></b></p>

<p class=programs>IF chkdate = “” or chktime = “” or chkmessage = “” THEN </p>

<p class=programs>val = 4</p>

<p class=programs>msg = “Data Fields Empty...pls re-enter”</p>

<p class=programs>ELSE</p>

<p class=programs><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=programs><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=programs>mm=mid(chkdate,1,2)</p>

<p class=programs>dd=mid(chkdate,4,2)</p>

<p class=programs>hr=mid(chktime,1,2)</p>

<p class=programs>mi=mid(chktime,4,2)</p>

<p class=programs><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=programs>‘Validates data, variable val is set to 0 for error<b><o:p></o:p></b></p>

<p class=programs>IF mm &lt; 1 or mm &gt; 12 THEN</p>

<p class=programs>val=0</p>

<p class=programs>msg = “Month Is Invalid...Please Re-enter”</p>

<p class=programs>END IF<span style='mso-tab-count:1'>   </span></p>

<p class=programs>IF dd &lt; 1 or dd &gt; 31 THEN</p>

<p class=programs>val=0<span style='mso-tab-count:2'>                </span></p>

<p class=programs>msg = “Date Is Invalid...Please Re-enter”</p>

<p class=programs>END IF<span style='mso-tab-count:1'>   </span></p>

<p class=programs>IF hr &lt; 00 or hr &gt; 23 THEN</p>

<p class=programs>val=0<span style='mso-tab-count:2'>                </span></p>

<p class=programs>msg = “Hour Entered Is Invalid...Please Re-enter”</p>

<p class=programs>END IF<span style='mso-tab-count:1'>   </span></p>

<p class=programs>IF mi &lt; 1 or mi &gt; 59 THEN</p>

<p class=programs>val=0<span style='mso-tab-count:1'>    </span></p>

<p class=programs>msg = “Minute Is Invalid...Please Re-enter”</p>

<p class=programs>END IF<span style='mso-tab-count:2'>               </span></p>

<p class=programs>IF chkmessage = “” THEN</p>

<p class=programs>val=0</p>

<p class=programs>msg = “No Messages Entered...Please Re-enter”</p>

<p class=programs>END IF<span style='mso-tab-count:1'>   </span></p>

<p class=programs><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=programs><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=programs>‘checks weather the schedule is already fixed , variable val
is set to 2 if exist<b><o:p></o:p></b></p>

<p class=programs>IF val = 1 THEN</p>

<p class=programs><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=programs>Set cn = Server.CreateObject(“ADODB.Connection”)</p>

<p class=programs>cn.Open “DRIVER={Microsoft Access Driver (*.mdb)};DBQ=C:\SOFTWARE\wapproject\userid.mdb”</p>

<p class=programs>Set rec = Server.CreateObject(“ADODB.Recordset”)</p>

<p class=programs>strSQL = “SELECT * FROM “ &amp; Session(“username”)</p>

<p class=programs>rec.Open strSQL,cn <span style='mso-tab-count:1'>       </span></p>

<p class=programs>Set objdate = rec(“flddate”)</p>

<p class=programs>Set objtime = rec(“fldtime”)</p>

<p class=programs><span style='mso-tab-count:1'>            </span></p>

<p class=programs>Do UNTIL rec.EOF</p>

<p class=programs>IF chkdate = objdate then </p>

<p class=programs>IF objtime = chktime then </p>

<p class=programs><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=programs>msg = “Schedule Already Fixed For This Time...Re-Enter”</p>

<p class=programs>val=2</p>

<p class=programs>EXIT DO</p>

<p class=programs>END IF</p>

<p class=programs>END IF</p>

<p class=programs>rec.MoveNext</p>

<p class=programs>LOOP</p>

<p class=programs>END IF<span style='mso-tab-count:1'>   </span></p>

<p class=programs><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=programs>‘inserts the new schedule<b><o:p></o:p></b></p>

<p class=programs>IF val = 1 THEN</p>

<p class=programs>strSQL = “INSERT INTO “ &amp; Session(“username”) &amp; “(flddate,fldtime,fldmessage)
VALUES(‘“ &amp; chkdate &amp; “‘,’” &amp; chktime &amp; “‘,’” &amp; chkmessage
&amp; “‘)”</p>

<p class=programs>cn.Execute strSQL</p>

<p class=programs>msg = “Shedule Fixed... Back To Main ... “</p>

<p class=programs>cn.close</p>

<p class=programs>END IF</p>

<p class=programs>END IF</p>

<p class=programs>%&gt;</p>

<p class=programs>&lt;?xml version=”1.0&quot; ?&gt;</p>

<p class=programs>&lt;!DOCTYPE wml PUBLIC “-//WAPFORUM//DTD WML 1.1//EN”
“http://www.wapforum.org/DTD/wml_1.1.xml”&gt;</p>

<p class=programs><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=programs>&lt;wml&gt; </p>

<p class=programs><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=programs>&lt;!—<span style="mso-spacerun: yes">  </span>Cache-Control
header —&gt;</p>

<p class=programs>&lt;head&gt; &lt;meta<span style="mso-spacerun: yes"> 
</span>http-equiv=”Cache-Control” content=”max-age=0&quot;/&gt; &lt;/head&gt;</p>

<p class=programs>&lt;card id=”card1&quot;&gt; </p>

<p class=programs>&lt;% </p>

<p class=programs><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=programs>&lt;!—<span style="mso-spacerun: yes">  </span>ontimer takes
the user back to datamain.asp<span style="mso-spacerun: yes">  </span>—&gt;</p>

<p class=programs>Response.write(“&lt;onevent type=’ontimer’&gt; &lt;go
href=’http://127.0.0.1/wapproject/datamain.asp’/&gt; &lt;/onevent&gt; &lt;timer
value = ‘20’/&gt;”)</p>

<p class=programs>%&gt;</p>

<p class=programs>&lt;p&gt;</p>

<p class=programs><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=programs>&lt;!— displayed the value of the msg veriable —&gt;</p>

<p class=programs>&lt;%=msg %&gt;</p>

<p class=programs><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=programs>&lt;/p&gt;</p>

<p class=programs>&lt;/card&gt;</p>

<p class=programs>&lt;/wml&gt;</p>

<p class=WMLbasetext><b><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></b></p>

<p class=WMLbasetext>adddata.asp</p>

<p class=WMLbasetext>This file is used to add a new schedule. The code begins
by checking the validity of the date as well as time. If the user has made an
error in entering the date or the time of the schedule, an error message is
posted. </p>

<p class=WMLbasetext><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=WMLbasetext>Once the date and time validation is complete, the code
checks as to whether a schedule is already fixed with the same date and time.
If so, an error message is posted to the user. </p>

<p class=WMLbasetext>If no matching schedule found, the code inserts the new
schedule into the users table and posts a message that the schedule has been
added. </p>

<p class=WMLbasetext><b><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></b></p>

<p class=programs>disptdata.asp</p>

<p class=programs>&lt;% Response.ContentType = “text/vnd.wap.wml” </p>

<p class=programs><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=programs>‘Retrieving data from the System</p>

<p class=programs>mm=MONTH(date)</p>

<p class=programs>dd=DAY(date)</p>

<p class=programs>yy=YEAR(date)</p>

<p class=programs><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=programs>‘Formats the date</p>

<p class=programs>IF LEN(mm) = 1 THEN</p>

<p class=programs>mm=”0&quot; &amp; mm</p>

<p class=programs>END IF</p>

<p class=programs><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=programs>IF LEN(dd) = 1 THEN</p>

<p class=programs>dd=”0&quot; &amp; dd</p>

<p class=programs>END IF</p>

<p class=programs><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=programs>IF LEN(yy) = 2 THEN</p>

<p class=programs>yy= “20” &amp; yy</p>

<p class=programs>END IF</p>

<p class=programs><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=programs>tdate = mm &amp; “/” &amp; dd &amp; “/” &amp; yy</p>

<p class=programs><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=programs>‘setting up ODBC connection to our MS Access Database</p>

<p class=programs>Set cn = Server.CreateObject(“ADODB.Connection”)</p>

<p class=programs>cn.Open “DRIVER={Microsoft Access Driver
(*.mdb)};DBQ=C:\Inetpub\wwwroot\wapproject\user.mdb”.</p>

<p class=programs>Set rec = Server.CreateObject(“ADODB.Recordset”)</p>

<p class=programs>strSQL = “SELECT * FROM “ &amp; Session(“username”) &amp; “
ORDER BY fldtime”</p>

<p class=programs>rec.Open strSQL,cn <span style='mso-tab-count:1'>       </span></p>

<p class=programs><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=programs>‘Retrieving data from the Query String</p>

<p class=programs>Set objdate = rec(“flddate”)</p>

<p class=programs>Set objtime = rec(“fldtime”)</p>

<p class=programs>Set objmessage = rec(“fldmessage”)</p>

<p class=programs><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=programs>%&gt;</p>

<p class=programs>&lt;?xml version=”1.0&quot; ?&gt;</p>

<p class=programs>&lt;!DOCTYPE wml PUBLIC “-//WAPFORUM//DTD WML 1.1//EN”
“http://www.wapforum.org/DTD/wml_1.1.xml”&gt;</p>

<p class=programs><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=programs>&lt;wml&gt; </p>

<p class=programs>&lt;head&gt; &lt;meta<span style="mso-spacerun: yes"> 
</span>http-equiv=”Cache-Control” content=”max-age=0&quot;/&gt; &lt;/head&gt; </p>

<p class=programs>&lt;card id=”card1&quot; title=”&lt;%=tdate %&gt;”
newcontext=”true”&gt; </p>

<p class=programs>&lt;do type = “accept” label = “Main Page” &gt;</p>

<p class=programs>&lt;go href = “http://127.0.0.1/wapproject/datamain.asp”/&gt;</p>

<p class=programs>&lt;/do&gt;</p>

<p class=programs>&lt;p&gt;</p>

<p class=programs><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=programs>&lt;%</p>

<p class=programs>‘retrieves data from database an creates a table dynamically </p>

<p class=programs>count=0<span style='mso-tab-count:1'>            </span></p>

<p class=programs>otable = 0</p>

<p class=programs>Do UNTIL rec.EOF</p>

<p class=programs>IF tdate = objdate THEN</p>

<p class=programs>IF otable = 0 THEN</p>

<p class=programs>Response.write(“&lt;table title=’shedule’
columns=’2'&gt;&lt;tr&gt;&lt;td&gt;&lt;small&gt;&lt;b&gt;Time&lt;/b&gt;&lt;/small&gt;&lt;/td&gt;&lt;td&gt;&lt;small&gt;&lt;b&gt;Message&lt;/b&gt;&lt;/small&gt;&lt;/td&gt;&lt;/tr&gt;”)</p>

<p class=programs>otable = 1</p>

<p class=programs>END IF<span style='mso-tab-count:1'>   </span> </p>

<p class=programs>Response.write(“&lt;tr&gt;&lt;td&gt;&lt;small&gt;” &amp;
objtime &amp; “&lt;/small&gt;&lt;/td&gt;&lt;td&gt;&lt;small&gt;” &amp;
objmessage &amp; “&lt;/small&gt;&lt;/td&gt;&lt;/tr&gt;”)</p>

<p class=programs>count=1</p>

<p class=programs>END IF</p>

<p class=programs>rec.MoveNext</p>

<p class=programs>LOOP<span style='mso-tab-count:1'>    </span></p>

<p class=programs>cn.close</p>

<p class=programs>IF otable = 1 THEN</p>

<p class=programs>Response.write(“&lt;/table&gt;”)</p>

<p class=programs>END IF</p>

<p class=programs>IF count=0 THEN</p>

<p class=programs>msg = “There are no Shedules on this date”</p>

<p class=programs>Response.write msg</p>

<p class=programs>END IF</p>

<p class=programs>%&gt;</p>

<p class=programs><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=programs>&lt;/p&gt;</p>

<p class=programs>&lt;/card&gt; </p>

<p class=programs><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=programs>&lt;/wml&gt;</p>

<p class=WMLbasetext><b><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></b></p>

<p class=WMLbasetext>disptdata.asp</p>

<p class=WMLbasetext>This program shows the current days schedule. The user
enters the current date &amp; time of the schedule he wishes to see. The data
is been validated for the errors and then the data is been displayed taken from
the Database after filtering in the Date format.</p>

<p class=MsoNormal><b><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></b></p>

<p class=WMLbasetext><b><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></b></p>

<p class=programs>dispsdata.asp</p>

<p class=programs>&lt;% Response.ContentType = “text/vnd.wap.wml” </p>

<p class=programs><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=programs>‘defining variables</p>

<p class=programs>dim date,time,msg</p>

<p class=programs><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=programs>val=1</p>

<p class=programs><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=programs>‘Retrieving data from Query String</p>

<p class=programs>date = request(“dt”)</p>

<p class=programs>time = request(“ti”)</p>

<p class=programs><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=programs>‘check for empty variables.</p>

<p class=programs>IF date = “” or time = “” THEN </p>

<p class=programs>val=2</p>

<p class=programs>msg = “Field Empty...Re-enter”</p>

<p class=programs>ELSE</p>

<p class=programs><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=programs>‘if variables contain data, search for the schedule
requested.</p>

<p class=programs>Set cn = Server.CreateObject(“ADODB.Connection”)</p>

<p class=programs>cn.Open “DRIVER={Microsoft Access Driver (*.mdb)};DBQ=C:\Inetpub\wwwroot\wapproject\user.mdb”</p>

<p class=programs>Set rec = Server.CreateObject(“ADODB.Recordset”)</p>

<p class=programs>strSQL = “SELECT * FROM “ &amp; Session(“username”) </p>

<p class=programs>rec.Open strSQL,cn <span style='mso-tab-count:1'>       </span></p>

<p class=programs>Set objdate = rec(“flddate”)</p>

<p class=programs>Set objtime = rec(“fldtime”)</p>

<p class=programs>Set objmessage = rec(“fldmessage”)</p>

<p class=programs>Do UNTIL rec.EOF</p>

<p class=programs>IF date = objdate then </p>

<p class=programs>IF objtime = time then </p>

<p class=programs>message = objmessage</p>

<p class=programs>val=1</p>

<p class=programs>msg = date &amp; “<span style="mso-spacerun: yes">  </span>“
&amp; time &amp; “<span style="mso-spacerun: yes">  </span>&lt;br/&gt;” &amp;
message</p>

<p class=programs>EXIT DO</p>

<p class=programs>END IF</p>

<p class=programs>END IF</p>

<p class=programs>val = 0</p>

<p class=programs>msg = “Invalid Data or No Matching Record... retry” </p>

<p class=programs>rec.MoveNext</p>

<p class=programs>LOOP<span style='mso-tab-count:1'>    </span></p>

<p class=programs>cn.close</p>

<p class=programs>END IF</p>

<p class=programs>%&gt;</p>

<p class=programs><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=programs>&lt;?xml version=”1.0&quot; ?&gt;</p>

<p class=programs>&lt;!DOCTYPE wml PUBLIC “-//WAPFORUM//DTD WML 1.1//EN”
“http://www.wapforum.org/DTD/wml_1.1.xml”&gt;</p>

<p class=programs><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=programs>&lt;wml&gt; </p>

<p class=programs>&lt;head&gt; &lt;meta<span style="mso-spacerun: yes"> 
</span>http-equiv=”Cache-Control” content=”max-age=0&quot;/&gt; &lt;/head&gt; </p>

<p class=programs>&lt;card id=”card1&quot; newcontext=”true”&gt; </p>

<p class=programs>&lt;do type = “accept” label = “Main Page” &gt;</p>

<p class=programs>&lt;go href = “http://127.0.0.1/wapproject/datamain.asp”/&gt;</p>

<p class=programs>&lt;/do&gt;</p>

<p class=programs>&lt;p&gt;</p>

<p class=programs><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=programs>&lt;%=msg %&gt;</p>

<p class=programs>&lt;/p&gt;</p>

<p class=programs>&lt;/card&gt; </p>

<p class=programs><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=programs>&lt;/wml&gt;</p>

<p class=WMLbasetext><b><u><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></u></b></p>

<p class=WMLbasetext><b><u><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></u></b></p>

<p class=WMLbasetext>dispsdata.asp</p>

<p class=WMLbasetext>When to user chooses to view a single data, dispsdata.asp
file is been called. Then it check whether the fields are empty or they have
some data in them. If any of the variables are empty, the msg variable is given
a value stating the same and the ASP code does not continue. If the variables
contain data, ODBC connection is set. The users schedule table is open with the
help of the session variable. The validation check is carried on. First the
code tries to match the date and time entered by the user. When the fields
match, the variable val is set to 1 and the msg variable contains that
schedule. if no record is found, val is set to 0 and msg carries an error
message. The WML code displays the msg variable and has a link to the
datamain.asp page.</p>

<p class=WMLbasetext><b><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></b></p>

<p class=programs><u>modidata.asp</u></p>

<p class=programs>&lt;% Response.ContentType = “text/vnd.wap.wml”<span
style="mso-spacerun: yes">  </span></p>

<p class=programs>‘defining variables<b> <o:p></o:p></b></p>

<p class=programs>dim chkdate,chktime,chkmessage,mm,dd,hr,mi,val,msg</p>

<p class=programs>val = 1</p>

<p class=programs>‘Retrieving data from Query String<b><o:p></o:p></b></p>

<p class=programs>chkdate=Request(“dt”)</p>

<p class=programs>chktime=Request(“ti”)</p>

<p class=programs>chkmessage=Request(“mg”)</p>

<p class=programs>IF chkdate = “” or chktime = “” or chkmessage = “” THEN </p>

<p class=programs>val = 4</p>

<p class=programs>msg = “Data Fields Empty...pls re-enter”</p>

<p class=programs>ELSE</p>

<p class=programs><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=programs>‘Database ODBC connection.</p>

<p class=programs>Set cn = Server.CreateObject(“ADODB.Connection”)</p>

<p class=programs><span style='mso-tab-count:1'>            </span>cn.Open
“DRIVER={Microsoft Access Driver
(*.mdb)};DBQ=C:\Inetpub\wwwroot\wapproject\user.mdb”</p>

<p class=programs><span style='mso-tab-count:1'>            </span>Set rec =
Server.CreateObject(“ADODB.Recordset”)</p>

<p class=programs><span style='mso-tab-count:1'>            </span>strSQL =
“SELECT * FROM “ &amp; Session(“username”)</p>

<p class=programs><span style='mso-tab-count:1'>            </span>rec.Open
strSQL,cn <span style='mso-tab-count:1'>       </span></p>

<p class=programs><span style='mso-tab-count:1'>            </span>Set objdate
= rec(“flddate”)</p>

<p class=programs><span style='mso-tab-count:1'>            </span>Set objtime
= rec(“fldtime”)</p>

<p class=programs><span style='mso-tab-count:1'>            </span></p>

<p class=programs><span style='mso-tab-count:1'>            </span>‘Retrieving
data from the database. </p>

<p class=programs>Do UNTIL rec.EOF</p>

<p class=programs><span style='mso-tab-count:2'>                        </span>IF
chkdate = objdate then </p>

<p class=programs><span style='mso-tab-count:3'>                                    </span>IF
objtime = chktime then </p>

<p class=programs><span style='mso-tab-count:4'>                                                </span>val=2</p>

<p class=programs><span style='mso-tab-count:4'>                                                </span>EXIT
DO</p>

<p class=programs><span style='mso-tab-count:3'>                                    </span>END
IF</p>

<p class=programs><span style='mso-tab-count:2'>                        </span>END
IF</p>

<p class=programs><span style='mso-tab-count:2'>                        </span>msg=”INVALID
SHEDULE”</p>

<p class=programs><span style="mso-spacerun: yes"> </span><span
style='mso-tab-count:1'>           </span>rec.MoveNext</p>

<p class=programs><span style='mso-tab-count:1'>            </span>LOOP</p>

<p class=programs>END IF<span style='mso-tab-count:1'>   </span></p>

<p class=programs>IF val = 2 THEN</p>

<p class=programs><span style='mso-tab-count:2'>                        </span>strSQL
= “UPDATE “ &amp; Session(“username”) &amp;<span style="mso-spacerun: yes"> 
</span>“ SET fldmessage = ‘“ &amp; chkmessage &amp; “‘ WHERE flddate = ‘“ &amp;
chkdate &amp; “‘ and fldtime<span style="mso-spacerun: yes">  </span>= ‘“ &amp;
chktime<span style="mso-spacerun: yes">  </span>&amp; “‘“</p>

<p class=programs><span style='mso-tab-count:2'>                        </span>cn.Execute
strSQL</p>

<p class=programs><span style='mso-tab-count:2'>                        </span>msg
= “ Shedule Modified”</p>

<p class=programs><span style='mso-tab-count:2'>                        </span>cn.close</p>

<p class=programs>END IF</p>

<p class=programs><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=programs>%&gt;</p>

<p class=programs>&lt;?xml version=”1.0&quot; ?&gt;</p>

<p class=programs>&lt;!DOCTYPE wml PUBLIC “-//WAPFORUM//DTD WML 1.1//EN”
“http://www.wapforum.org/DTD/wml_1.1.xml”&gt;</p>

<p class=programs><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=programs>&lt;wml&gt; </p>

<p class=programs><span style="mso-spacerun: yes"> </span>&lt;head&gt;
&lt;meta<span style="mso-spacerun: yes">  </span>http-equiv=”Cache-Control”
content=”max-age=0&quot;/&gt; &lt;/head&gt;</p>

<p class=programs>&lt;card id=”card1&quot;&gt; </p>

<p class=programs>&lt;% </p>

<p class=programs><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=programs>Response.write(“&lt;onevent type=’ontimer’&gt; &lt;go
href=’http://127.0.0.1/wapproject/datamain.asp’/&gt; &lt;/onevent&gt; &lt;timer
value = ‘20’/&gt;”)</p>

<p class=programs><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=programs>%&gt;</p>

<p class=programs>&lt;p&gt;</p>

<p class=programs>&lt;%=msg %&gt;</p>

<p class=programs><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=programs>&lt;/p&gt;</p>

<p class=programs>&lt;/card&gt;</p>

<p class=programs>&lt;/wml&gt;</p>

<p class=WMLbasetext><b><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></b></p>

<p class=WMLbasetext><b><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></b></p>

<p class=WMLbasetext>modidata.asp</p>

<p class=WMLbasetext>This file helps is modifying an existing data. The
programs first checks whether the user already has an entry for the schedule he
wants to modify. If his table does not have such an entry, a message is posted
to user. If the record is found, the old message is replaced with the new
message and the user is informed about it.</p>

<p class=WMLbasetext><b><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></b></p>

<p class=programs>deletedata.asp</p>

<p class=programs>&lt;% Response.ContentType = “text/vnd.wap.wml” </p>

<p class=programs>‘defining variables<b> <o:p></o:p></b></p>

<p class=programs>dim chkdate,chktime,chkmessage,mm,dd,hr,mi,val,msg</p>

<p class=programs>val = 1</p>

<p class=programs>‘Retrieving data from Query String<b><o:p></o:p></b></p>

<p class=programs>chkdate=Request(“dt”)</p>

<p class=programs>chktime=Request(“ti”)</p>

<p class=programs><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=programs>IF chkdate = “” or chktime = “” THEN </p>

<p class=programs>val = 4</p>

<p class=programs>msg = “Data Fields Empty...pls re-enter”</p>

<p class=programs>ELSE</p>

<p class=programs><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=programs>‘ Database ODBC connection.</p>

<p class=programs>Set cn = Server.CreateObject(“ADODB.Connection”)</p>

<p class=programs><span style='mso-tab-count:1'>            </span>cn.Open
“DRIVER={Microsoft Access Driver (*.mdb)};DBQ=C:\Inetpub\wwwroot\wapproject\user.mdb”</p>

<p class=programs><span style='mso-tab-count:1'>            </span>Set rec =
Server.CreateObject(“ADODB.Recordset”)</p>

<p class=programs><span style='mso-tab-count:1'>            </span>strSQL =
“SELECT * FROM “ &amp; Session(“username”)</p>

<p class=programs><span style='mso-tab-count:1'>            </span>rec.Open
strSQL,cn <span style='mso-tab-count:1'>       </span></p>

<p class=programs><span style='mso-tab-count:1'>            </span>Set objdate
= rec(“flddate”)</p>

<p class=programs><span style='mso-tab-count:1'>            </span>Set objtime
= rec(“fldtime”)</p>

<p class=programs><span style='mso-tab-count:1'>            </span></p>

<p class=programs><span style='mso-tab-count:1'>            </span>Do UNTIL
rec.EOF</p>

<p class=programs><span style='mso-tab-count:2'>                        </span>IF
chkdate = objdate then </p>

<p class=programs><span style='mso-tab-count:3'>                                    </span>IF
objtime = chktime then </p>

<p class=programs><span style='mso-tab-count:4'>                                                </span>val=2</p>

<p class=programs><span style='mso-tab-count:4'>                                                </span>EXIT
DO</p>

<p class=programs><span style='mso-tab-count:3'>                                    </span>END
IF</p>

<p class=programs><span style='mso-tab-count:2'>                        </span>END
IF</p>

<p class=programs><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=programs>msg=”INVALID SHEDULE”</p>

<p class=programs><span style="mso-spacerun: yes"> </span><span
style='mso-tab-count:1'>           </span>rec.MoveNext</p>

<p class=programs><span style='mso-tab-count:1'>            </span>LOOP</p>

<p class=programs>END IF<span style='mso-tab-count:1'>   </span></p>

<p class=programs>IF val = 2 THEN</p>

<p class=programs><span style='mso-tab-count:2'>                        </span>strSQL
= “DELETE FROM “ &amp; Session(“username”) &amp; “ WHERE flddate = ‘“ &amp;
chkdate &amp; “‘ and fldtime<span style="mso-spacerun: yes">  </span>= ‘“ &amp;
chktime<span style="mso-spacerun: yes">  </span>&amp; “‘ “</p>

<p class=programs><span style='mso-tab-count:2'>                        </span>cn.Execute
strSQL</p>

<p class=programs><span style='mso-tab-count:2'>                        </span>msg
= “Shedule Deleted”</p>

<p class=programs><span style='mso-tab-count:2'>                        </span>cn.close</p>

<p class=programs>END IF</p>

<p class=programs><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=programs>%&gt;</p>

<p class=programs>&lt;?xml version=”1.0&quot; ?&gt;</p>

<p class=programs>&lt;!DOCTYPE wml PUBLIC “-//WAPFORUM//DTD WML 1.1//EN”
“http://www.wapforum.org/DTD/wml_1.1.xml”&gt;</p>

<p class=programs><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=programs>&lt;wml&gt; </p>

<p class=programs><span style="mso-spacerun: yes"> </span>&lt;head&gt;
&lt;meta<span style="mso-spacerun: yes">  </span>http-equiv=”Cache-Control”
content=”max-age=0&quot;/&gt; &lt;/head&gt;</p>

<p class=programs>&lt;card id=”card1&quot;&gt; </p>

<p class=programs>&lt;% </p>

<p class=programs><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=programs>Response.write(“&lt;onevent type=’ontimer’&gt; &lt;go
href=’http://127.0.0.1/wapproject/datamain.asp’/&gt; &lt;/onevent&gt; &lt;timer
value = ‘20’/&gt;”)</p>

<p class=programs><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=programs>%&gt;</p>

<p class=programs>&lt;p&gt;</p>

<p class=programs>&lt;%=msg %&gt;</p>

<p class=programs><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=programs>&lt;/p&gt;</p>

<p class=programs>&lt;/card&gt;</p>

<p class=programs>&lt;/wml&gt;</p>

<p class=programs><b><span style='font-size:11.5pt;font-family:"Times New Roman"'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></b></p>

<p class=WMLbasetext><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=WMLbasetext>deletedata.asp</p>

<p class=WMLbasetext>This file again checks whether the schedule mentioned by
the user is present in his table. If present, the given schedule is deleted and
the page is redirected to datamain.asp after 20 seconds.</p>

<p class=WMLbasetext><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=WMLbasetext>We have provided the full example on our site www.vijaymukhi.com
one can download the zip file and tryout our example. We hope that is will give
you a start to the vast world of WAP application.</p>

</div>

</body>


<!-- Mirrored from www.vijaymukhi.com/documents/books/wap/sec2/chap11/chap11.htm by HTTrack Website Copier/3.x [XR&CO'2014], Fri, 11 Oct 2024 14:39:25 GMT -->
</html>
