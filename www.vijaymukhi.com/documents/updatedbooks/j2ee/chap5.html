<html xmlns:o="urn:schemas-microsoft-com:office:office"
xmlns:w="urn:schemas-microsoft-com:office:word"
xmlns="http://www.w3.org/TR/REC-html40">


<!-- Mirrored from www.vijaymukhi.com/documents/updatedbooks/j2ee/chap5.htm by HTTrack Website Copier/3.x [XR&CO'2014], Fri, 11 Oct 2024 14:39:32 GMT -->
<head>
<meta http-equiv=Content-Type content="text/html; charset=windows-1252">
<meta name=ProgId content=Word.Document>
<meta name=Generator content="Microsoft Word 9">
<meta name=Originator content="Microsoft Word 9">
<link rel=File-List href="chap5_files/filelist.html">
<title>Java Server Pages</title>
<!--[if gte mso 9]><xml>
 <o:DocumentProperties>
  <o:Author>Mr. Vijay Mukhi</o:Author>
  <o:LastAuthor>Mr. Vijay Mukhi</o:LastAuthor>
  <o:Revision>18</o:Revision>
  <o:TotalTime>15</o:TotalTime>
  <o:Created>2004-10-21T06:35:00Z</o:Created>
  <o:LastSaved>2004-10-21T11:31:00Z</o:LastSaved>
  <o:Pages>29</o:Pages>
  <o:Words>10461</o:Words>
  <o:Characters>59629</o:Characters>
  <o:Company>V.M.C.I.</o:Company>
  <o:Lines>496</o:Lines>
  <o:Paragraphs>119</o:Paragraphs>
  <o:CharactersWithSpaces>73228</o:CharactersWithSpaces>
  <o:Version>9.2720</o:Version>
 </o:DocumentProperties>
</xml><![endif]--><!--[if gte mso 9]><xml>
 <w:WordDocument>
  <w:Zoom>80</w:Zoom>
  <w:DrawingGridHorizontalSpacing>9.35 pt</w:DrawingGridHorizontalSpacing>
  <w:DisplayVerticalDrawingGridEvery>2</w:DisplayVerticalDrawingGridEvery>
 </w:WordDocument>
</xml><![endif]-->
<style>
<!--
 /* Font Definitions */
@font-face
	{font-family:Tahoma;
	panose-1:2 11 6 4 3 5 4 4 2 4;
	mso-font-charset:0;
	mso-generic-font-family:swiss;
	mso-font-pitch:variable;
	mso-font-signature:553679495 -2147483648 8 0 66047 0;}
@font-face
	{font-family:"Book Antiqua";
	panose-1:2 4 6 2 5 3 5 3 3 4;
	mso-font-charset:0;
	mso-generic-font-family:roman;
	mso-font-pitch:variable;
	mso-font-signature:647 0 0 0 159 0;}
 /* Style Definitions */
p.MsoNormal, li.MsoNormal, div.MsoNormal
	{mso-style-parent:"";
	margin:0in;
	margin-bottom:.0001pt;
	mso-pagination:widow-orphan;
	font-size:12.0pt;
	font-family:"Times New Roman";
	mso-fareast-font-family:"Times New Roman";}
h1
	{mso-style-next:Normal;
	margin:0in;
	margin-bottom:.0001pt;
	mso-pagination:widow-orphan;
	page-break-after:avoid;
	mso-outline-level:1;
	mso-layout-grid-align:none;
	punctuation-wrap:simple;
	text-autospace:none;
	font-size:11.0pt;
	mso-bidi-font-size:10.0pt;
	font-family:"Book Antiqua";
	mso-font-kerning:0pt;
	font-weight:bold;
	text-decoration:underline;
	text-underline:single;}
h2
	{mso-style-next:Normal;
	margin:0in;
	margin-bottom:.0001pt;
	mso-pagination:widow-orphan;
	page-break-after:avoid;
	mso-outline-level:2;
	mso-layout-grid-align:none;
	punctuation-wrap:simple;
	text-autospace:none;
	font-size:15.0pt;
	mso-bidi-font-size:10.0pt;
	font-family:"Book Antiqua";
	font-weight:bold;
	text-decoration:underline;
	text-underline:single;}
h3
	{mso-style-next:Normal;
	margin:0in;
	margin-bottom:.0001pt;
	mso-pagination:widow-orphan;
	page-break-after:avoid;
	mso-outline-level:3;
	mso-layout-grid-align:none;
	punctuation-wrap:simple;
	text-autospace:none;
	font-size:16.0pt;
	mso-bidi-font-size:10.0pt;
	font-family:"Book Antiqua";
	font-weight:bold;
	text-decoration:underline;
	text-underline:single;}
p.MsoBodyText, li.MsoBodyText, div.MsoBodyText
	{margin:0in;
	margin-bottom:.0001pt;
	mso-pagination:widow-orphan;
	mso-layout-grid-align:none;
	punctuation-wrap:simple;
	text-autospace:none;
	font-size:11.0pt;
	mso-bidi-font-size:10.0pt;
	font-family:"Book Antiqua";
	mso-fareast-font-family:"Times New Roman";
	mso-bidi-font-family:"Times New Roman";
	color:#FF6600;}
p.MsoBodyText2, li.MsoBodyText2, div.MsoBodyText2
	{margin:0in;
	margin-bottom:.0001pt;
	mso-pagination:widow-orphan;
	mso-layout-grid-align:none;
	punctuation-wrap:simple;
	text-autospace:none;
	font-size:11.0pt;
	mso-bidi-font-size:10.0pt;
	font-family:"Book Antiqua";
	mso-fareast-font-family:"Times New Roman";
	mso-bidi-font-family:"Times New Roman";}
p.MsoBodyText3, li.MsoBodyText3, div.MsoBodyText3
	{margin:0in;
	margin-bottom:.0001pt;
	mso-pagination:widow-orphan;
	mso-layout-grid-align:none;
	punctuation-wrap:simple;
	text-autospace:none;
	font-size:12.0pt;
	mso-bidi-font-size:10.0pt;
	font-family:"Book Antiqua";
	mso-fareast-font-family:"Times New Roman";
	mso-bidi-font-family:"Times New Roman";
	font-style:italic;}
a:link, span.MsoHyperlink
	{color:blue;
	text-decoration:underline;
	text-underline:single;}
a:visited, span.MsoHyperlinkFollowed
	{color:purple;
	text-decoration:underline;
	text-underline:single;}
p
	{margin-right:0in;
	mso-margin-top-alt:auto;
	mso-margin-bottom-alt:auto;
	margin-left:0in;
	mso-pagination:widow-orphan;
	font-size:12.0pt;
	font-family:"Times New Roman";
	mso-fareast-font-family:"Times New Roman";}
p.cbasetext, li.cbasetext, div.cbasetext
	{mso-style-name:"c\# base text";
	mso-style-parent:"";
	margin:0in;
	margin-bottom:.0001pt;
	text-align:justify;
	mso-pagination:widow-orphan;
	mso-layout-grid-align:none;
	font-size:11.0pt;
	font-family:"Times New Roman";
	mso-fareast-font-family:"Times New Roman";
	color:black;}
p.programs, li.programs, div.programs
	{mso-style-name:programs;
	mso-style-parent:"c\# base text";
	margin-top:0in;
	margin-right:0in;
	margin-bottom:0in;
	margin-left:.5in;
	margin-bottom:.0001pt;
	mso-pagination:widow-orphan;
	mso-layout-grid-align:none;
	font-size:10.0pt;
	font-family:Tahoma;
	mso-fareast-font-family:"Times New Roman";}
@page Section1
	{size:595.45pt 841.7pt;
	margin:.5in .5in .5in .5in;
	mso-header-margin:.5in;
	mso-footer-margin:.5in;
	mso-paper-source:0;}
div.Section1
	{page:Section1;}
-->
</style>
</head>

<body lang=EN-US link=blue vlink=purple style='tab-interval:.5in'>

<div class=Section1>

<h1 style='page-break-after:auto;mso-layout-grid-align:auto;punctuation-wrap:
hanging;text-autospace:ideograph-other'><span style='font-size:36.0pt;
mso-bidi-font-size:12.0pt;font-family:"Times New Roman";font-weight:normal;
text-decoration:none;text-underline:none'>Java Server Pages</span></h1>

<p class=cbasetext><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=cbasetext><span style='color:windowtext'>ANT – Another Neat Tool<o:p></o:p></span></p>

<p class=cbasetext><span style='color:windowtext'>Working with Java Server
Pages or J2EE demands understanding the tool Ant. Ant is part of the Jakarta
Tomcat project and the tool basically replaces the Make tool. <o:p></o:p></span></p>

<p class=cbasetext><span style='color:windowtext'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=cbasetext><span style='color:windowtext'>The Make tool was used to build
applications, however due to it having a cryptic syntax it was difficult to
use. Also it lacks a lot of useful features and remained unportable to other
operating systems like Windows. The developers of Tomcat required a build tool
other than the make utility to build Tomcat so they createad their own tool
called Ant. Since the tool is written in Java portability was not an issue
anymore. Also the file containing the build instructions for Ant was placed in
an XML file. <o:p></o:p></span></p>

<p class=cbasetext><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=cbasetext>Now lets understand how to use ant. If you have installed
the binaries of J2EE properly, there is a batch file called ant.bat in the bin
subdirectory that calls Ant. If we run it, we will get the following error.</p>

<p class=cbasetext><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=programs>C:\Sun\AppServer\lib\ant\bin&gt;Ant</p>

<p class=programs>Buildfile: build.xml does not exist!</p>

<p class=programs>Build failed</p>

<p class=programs><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=cbasetext>Make sure the environmental variables are set for eg:</p>

<p class=programs><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=programs>Set JAVA_HOME= C:\Sun\AppServer\jdk</p>

<p class=cbasetext><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=cbasetext>Thus the ant program by default looks for its build
instructions in a file called build.xml by default. This is to the make or
nmake program that looks at the file Makefile. </p>

<p class=cbasetext><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=cbasetext>Lets first try and run the Ant program without the bat file.
</p>

<p class=cbasetext><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=programs>&gt;java org.apache.tools.ant.Main</p>

<p class=cbasetext><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=cbasetext>As Ant is a Java program with a Main function , the java
program is used to execute it along with the class file name and namespace of the
class that contains the Main function. The only problem is we forgot to specify
the<span style="mso-spacerun: yes">  </span>classpath or the jar file where the
above the class resides. </p>

<p class=cbasetext><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=programs>C:\Sun\AppServer\lib\ant\bin&gt;set
CLASSPATH=%JAVA_HOME%\lib\classes.zip;%JAVA_HOME%\lib\tools.jar;C:\Sun\AppServer\lib\ant\lib\ant.jar</p>

<p class=programs><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=programs>&gt;java org.apache.tools.ant.Main</p>

<p class=cbasetext><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=cbasetext>The above command now displays the same error as seen
earlier.</p>

<p class=cbasetext><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=cbasetext>The ant utiltiy requires a file by the name of build.xml. Since
the file is not present in the current directory, the error is reported. So
lets create this file.</p>

<p class=cbasetext><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=programs>C:\Sun\AppServer\lib\ant\bin&gt;notepad build.xml</p>

<p class=programs>(empty)</p>

<p class=programs><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=programs>C:\Sun\AppServer\lib\ant\bin&gt;ant</p>

<p class=programs>Buildfile: build.xml</p>

<p class=programs><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=programs>BUILD FAILED</p>

<p class=programs>file:C:/Sun/AppServer/lib/ant/bin/build.xml:1: Premature end
of file.</p>

<p class=programs><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=programs>Total time: 5 seconds</p>

<p class=cbasetext><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=cbasetext>Due to the presence of build.xml file, the error displayed
is very different from the earlier one. Since the file has no contents, it is
assumed that it does not follow the rules of a build file . Key in the
following lines in the file.</p>

<p class=cbasetext><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=programs>Build.xml</p>

<p class=programs>&lt;project &gt;</p>

<p class=programs>&lt;/project &gt;</p>

<p class=programs><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=programs>C:\Sun\AppServer\lib\ant\bin&gt;ant</p>

<p class=programs>Buildfile: build.xml</p>

<p class=programs><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=programs>BUILD FAILED</p>

<p class=programs>file:C:/Sun/AppServer/lib/ant/bin/build.xml:1: The default
attribute of project</p>

<p class=programs>is required</p>

<p class=programs><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=programs>Total time: 4 seconds</p>

<p class=cbasetext><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=cbasetext>Every build.xml file must start with a tag project. Besides,
these tags have attributes of which some are mandatory. The project tag
requires the default attribute.</p>

<p class=cbasetext><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=programs>Build.xml</p>

<p class=programs>&lt;project default=&quot;vijay&quot;&gt;</p>

<p class=programs>&lt;/project &gt;</p>

<p class=programs><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=programs>C:\Sun\AppServer\lib\ant\bin&gt;ant</p>

<p class=programs>Buildfile: build.xml</p>

<p class=programs><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=programs>BUILD FAILED</p>

<p class=programs>Target `vijay' does not exist in this project.</p>

<p class=programs><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=programs>Total time: 4 seconds</p>

<p class=cbasetext><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=cbasetext>We have added an attribute default to the project with its
value as vijay. This word is taken to be the name of a target, which is not yet
specified. Hence the error.</p>

<p class=cbasetext><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=programs>Build.xml</p>

<p class=programs>&lt;project default=&quot;vijay&quot;&gt;</p>

<p class=programs>&lt;target name=&quot;vijay&quot; &gt;</p>

<p class=programs>&lt;/target&gt;</p>

<p class=programs>&lt;/project &gt;</p>

<p class=programs><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=programs>C:\Sun\AppServer\lib\ant\bin&gt;ant</p>

<p class=programs>Buildfile: build.xml</p>

<p class=programs><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=programs>vijay:</p>

<p class=programs><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=programs>BUILD SUCCESSFUL</p>

<p class=programs>Total time: 4 seconds</p>

<p class=cbasetext><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=cbasetext>Finally no errors at all. The target name gets displayed on
the screen along with a build successful message. This goes to prove that the
ant program opens the file build.xml and looks out for the project tag first.
It then reads the default attributes value and thereupon it looks for a target
tag with the same name. Once it finds everything in proper order it executes
all the tags within this tag. Since we have none, nothing great happens.</p>

<p class=cbasetext><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=programs>Build.xml</p>

<p class=programs>&lt;project default=&quot;vijay&quot;&gt;</p>

<p class=programs>&lt;target name=&quot;vijay&quot; &gt;</p>

<p class=programs>&lt;echo message=&quot;hi&quot; /&gt;</p>

<p class=programs>&lt;/target&gt;</p>

<p class=programs>&lt;/project &gt;</p>

<p class=programs><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=programs>vijay:</p>

<p class=programs><span style="mso-spacerun: yes">     </span>[echo] hi</p>

<p class=cbasetext><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=cbasetext>The above xml file has a tag called echo. These tags are
called tasks by the Ant documentation. It has an attribute called message which
gets displayed in the dos box. The echo task is like the println function, it
displays messages for the user. This also proves that the task vijay did
actually get called.</p>

<p class=cbasetext><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=cbasetext>The echo task can do many more things like writing to a file
on disk. </p>

<p class=cbasetext><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=programs>Build.xml</p>

<p class=programs>&lt;project default=&quot;vijay&quot;&gt;</p>

<p class=programs>&lt;target name=&quot;vijay&quot; &gt;</p>

<p class=programs>&lt;property name=&quot;mukhi&quot; value=&quot;great
man&quot; /&gt;</p>

<p class=programs>&lt;echo message=&quot;hi ${mukhi}&quot; /&gt;</p>

<p class=programs>&lt;/target&gt;</p>

<p class=programs>&lt;/project &gt;</p>

<p class=programs><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=programs>vijay:</p>

<p class=programs><span style="mso-spacerun: yes">     </span>[echo] hi great
man</p>

<p class=cbasetext><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=cbasetext>We use the task property to create an entity called
property. A property has a name and a value. In the above file, the property is
given the name of mukhi<span style="mso-spacerun: yes">  </span>with a value of
great man. To use a property, it must be placed in curly braces with a dollar
sign in front of it. </p>

<p class=cbasetext><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=cbasetext>Thus wherever a word is seen in curly braces and a dollar
sign in front, it is considered to be a property. A property is like a variable
and is used extensively in ant build files. There are five built in properties.
</p>

<p class=cbasetext><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=programs>Build.xml</p>

<p class=programs>&lt;project default=&quot;vijay&quot;&gt;</p>

<p class=programs>&lt;target name=&quot;vijay&quot; &gt;</p>

<p class=programs>&lt;property environment =&quot;zzz&quot;/&gt;</p>

<p class=programs>&lt;echo message=&quot;ANT_HOME ${zzz.ANT_HOME}&quot;/&gt;</p>

<p class=programs>&lt;/target&gt;</p>

<p class=programs>&lt;/project &gt;</p>

<p class=programs><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=programs>vijay:</p>

<p class=programs><span style="mso-spacerun: yes">     </span>[echo] ANT_HOME
C:\Sun\AppServer\lib\ant\bin\..</p>

<p class=cbasetext><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=cbasetext>An operating system has a large number of environmental
variables. These variables can be accessed using the property attribute
environment. The value of zzz is given to it, which now will carry all these
environmental variables. Now to display any environmental variables, it must
begin with zzz followed by a dot and the name of the environmental variable, in
our case ANT_HOME.</p>

<p class=cbasetext><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=cbasetext>These environmental variables can be read from a file on
disk too.</p>

<p class=cbasetext><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=programs>ggg.aaa</p>

<p class=programs>name=vijay</p>

<p class=programs>password=mukhi</p>

<p class=programs><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=programs>build.xml</p>

<p class=programs>&lt;project default=&quot;vijay&quot;&gt;</p>

<p class=programs>&lt;target name=&quot;vijay&quot; &gt;</p>

<p class=programs>&lt;property file=&quot;ggg.aaa&quot;/&gt;</p>

<p class=programs>&lt;echo message=&quot;${name} ${password}&quot;/&gt;</p>

<p class=programs>&lt;/target&gt;</p>

<p class=programs>&lt;/project &gt;</p>

<p class=programs><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=programs>vijay:</p>

<p class=programs><span style="mso-spacerun: yes">     </span>[echo] vijay
mukhi</p>

<p class=cbasetext><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=cbasetext>A file called ggg.aaa is created with two name-value pairs.
The name-value pair start with the name of the property, an equal to sign
followed by the value of the property. The echo displays these two properties
of name and password task.</p>

<p class=cbasetext><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=programs>Build.xml</p>

<p class=programs>&lt;project default=&quot;vijay&quot;&gt;</p>

<p class=programs>&lt;target name=&quot;vijay&quot; &gt;</p>

<p class=programs>&lt;property name=&quot;fname&quot; value=&quot;ggg&quot;
/&gt;</p>

<p class=programs>&lt;property file=&quot;${fname}.aaa&quot;/&gt;</p>

<p class=programs>&lt;echo message=&quot;${name} ${password}&quot;/&gt;</p>

<p class=programs>&lt;/target&gt;</p>

<p class=programs>&lt;/project &gt;</p>

<p class=programs><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=programs>vijay:</p>

<p class=programs><span style="mso-spacerun: yes">     </span>[echo] vijay
mukhi</p>

<p class=programs><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=cbasetext>We go a step further. A property called fname is created and
given a value of ggg. A property name can be specified anywhere. In the file
attribute for the property task, we specify the file name partly as a value of
a property and partly as the actual value. A perfect example displaying the use
of properties in Ant extensively. The name of file can contain a path also
which can be specified using a property value. </p>

<p class=cbasetext><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=programs>Build.xml</p>

<p class=programs>&lt;project default=&quot;vijay&quot;&gt;</p>

<p class=programs>&lt;target name=&quot;vijay&quot;
depends=&quot;mukhi,sonal&quot;&gt;</p>

<p class=programs>&lt;echo message=&quot;task vijay&quot;/&gt;</p>

<p class=programs>&lt;/target&gt;</p>

<p class=programs>&lt;target name=&quot;mukhi&quot; &gt;</p>

<p class=programs>&lt;echo message=&quot;task mukhi&quot;/&gt;</p>

<p class=programs>&lt;/target&gt;</p>

<p class=programs>&lt;target name=&quot;sonal&quot; &gt;</p>

<p class=programs>&lt;echo message=&quot;task sonal&quot;/&gt;</p>

<p class=programs>&lt;/target&gt;</p>

<p class=programs>&lt;/project &gt;</p>

<p class=programs><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=programs>Buildfile: build.xml</p>

<p class=programs><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=programs>mukhi:</p>

<p class=programs><span style="mso-spacerun: yes">     </span>[echo] task mukhi</p>

<p class=programs><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=programs>sonal:</p>

<p class=programs><span style="mso-spacerun: yes">     </span>[echo] task sonal</p>

<p class=programs><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=programs>vijay:</p>

<p class=programs><span style="mso-spacerun: yes">     </span>[echo] task vijay</p>

<p class=cbasetext><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=cbasetext>The above example illustrates the real power of<span
style="mso-spacerun: yes">  </span>ant. The depends attribute is put to use to
specify the other targets that must be completed before the target mukhi can be
executed. Thus ant first executes the target mukhi and then sonal before it
comes to executing the default target vijay. </p>

<p class=cbasetext><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=cbasetext>This is the heart and soul of build. It first finds out all
the dependencies and then executes them in a certain order. </p>

<p class=cbasetext><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=programs>Build.xml</p>

<p class=programs>&lt;project default=&quot;vijay&quot;&gt;</p>

<p class=programs>&lt;target name=&quot;vijay&quot;
depends=&quot;mukhi&quot;&gt;</p>

<p class=programs>&lt;echo message=&quot;task vijay&quot;/&gt;</p>

<p class=programs>&lt;/target&gt;</p>

<p class=programs>&lt;target name=&quot;mukhi&quot;
depends=&quot;sonal&quot;&gt;</p>

<p class=programs>&lt;echo message=&quot;task mukhi&quot;/&gt;</p>

<p class=programs>&lt;/target&gt;</p>

<p class=programs>&lt;target name=&quot;sonal&quot; &gt;</p>

<p class=programs>&lt;echo message=&quot;task sonal&quot;/&gt;</p>

<p class=programs>&lt;/target&gt;</p>

<p class=programs>&lt;/project &gt;</p>

<p class=programs><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=programs>sonal:</p>

<p class=programs><span style="mso-spacerun: yes">     </span>[echo] task sonal</p>

<p class=programs><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=programs>mukhi:</p>

<p class=programs><span style="mso-spacerun: yes">     </span>[echo] task mukhi</p>

<p class=programs><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=programs>vijay:</p>

<p class=programs><span style="mso-spacerun: yes">     </span>[echo] task vijay</p>

<p class=cbasetext><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=cbasetext>In the next example, target vijay only depends on target
mukhi. When ant tries to execute the target mukhi, it realizes that it depends
upon target sonal. As a result, it first executes target sonal, then mukhi and
then vijay. </p>

<p class=cbasetext><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=programs>Build.xml</p>

<p class=programs>&lt;project default=&quot;vijay&quot;&gt;</p>

<p class=programs>&lt;target name=&quot;vijay&quot;
depends=&quot;mukhi&quot;&gt;</p>

<p class=programs>&lt;echo message=&quot;task vijay&quot;/&gt;</p>

<p class=programs>&lt;/target&gt;</p>

<p class=programs>&lt;target name=&quot;mukhi&quot;
depends=&quot;sonal&quot;&gt;</p>

<p class=programs>&lt;echo message=&quot;task mukhi&quot;/&gt;</p>

<p class=programs>&lt;/target&gt;</p>

<p class=programs>&lt;target name=&quot;sonal&quot;
depends=&quot;mukhi&quot;&gt;</p>

<p class=programs>&lt;echo message=&quot;task sonal&quot;/&gt;</p>

<p class=programs>&lt;/target&gt;</p>

<p class=programs>&lt;/project &gt;</p>

<p class=programs><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=programs>BUILD FAILED</p>

<p class=programs>Circular dependency: mukhi &lt;- sonal &lt;- mukhi</p>

<p class=cbasetext><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=cbasetext>You cannot beat the ant system. In the above example, the
default target vijay depends upon target mukhi. When the ant system goes to the
target mukhi, it realizes that it depends upon the target sonal. This target
sonal now depends upon the target mukhi. This becomes a circular reference. The
error reported proves that by no means you can send ant into an indefinite
loop.</p>

<p class=cbasetext><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=programs>Build.xml</p>

<p class=programs>&lt;project default=&quot;vijay&quot;&gt;</p>

<p class=programs>&lt;target name=&quot;vijay&quot;&gt;</p>

<p class=programs>&lt;echo message=&quot;task vijay&quot;/&gt;</p>

<p class=programs>&lt;/target&gt;</p>

<p class=programs>&lt;target name=&quot;mukhi&quot;&gt;</p>

<p class=programs>&lt;echo message=&quot;task mukhi&quot;/&gt;</p>

<p class=programs>&lt;/target&gt;</p>

<p class=programs>&lt;/project&gt;</p>

<p class=programs><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=programs>C:\Sun\AppServer\lib\ant\bin&gt;ant</p>

<p class=programs>Buildfile: build.xml</p>

<p class=programs><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=programs>vijay:</p>

<p class=programs><span style="mso-spacerun: yes">     </span>[echo] task vijay</p>

<p class=programs><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=programs>BUILD SUCCESSFUL</p>

<p class=programs>Total time: 5 seconds</p>

<p class=programs>C:\Sun\AppServer\lib\ant\bin&gt;ant mukhi</p>

<p class=programs>Buildfile: build.xml</p>

<p class=programs><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=programs>mukhi:</p>

<p class=programs><span style="mso-spacerun: yes">     </span>[echo] task mukhi</p>

<p class=programs><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=programs>BUILD SUCCESSFUL</p>

<p class=programs>Total time: 4 seconds</p>

<p class=cbasetext><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=cbasetext>The default behavior of executing the target with the default
attribute can be changed. To override this default behavior, we simply pass the
name of the target as a parameter to the bat file. The task associated with the
target will be executed. </p>

<p class=cbasetext><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=cbasetext>Thus in the above build.xml file, instead of the task vijay
getting called, the task mukhi gets executed.</p>

<p class=cbasetext><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=programs>Build.xml</p>

<p class=programs>&lt;project default=&quot;vijay&quot;&gt;</p>

<p class=programs>&lt;target name=&quot;vijay&quot;&gt;</p>

<p class=programs>&lt;copy file=&quot;ggg.aaa&quot;
tofile=&quot;ggg.bbb&quot;/&gt;</p>

<p class=programs>&lt;/target&gt;</p>

<p class=programs>&lt;/project&gt;</p>

<p class=programs><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=programs>vijay:</p>

<p class=programs><span style="mso-spacerun: yes">     </span>[copy] Copying 1
file to C:\Sun\AppServer\lib\ant\bin</p>

<p class=programs><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=cbasetext>One of the major tasks that ant must perform is copying
files to various directories. This is called the deploy task. Thus the simplest
use of the copy task is to copy a source file specified by the file attribute
to the destination file name that is specified by the tofile attribute. </p>

<p class=cbasetext><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=programs>Build.xml</p>

<p class=programs>&lt;project default=&quot;vijay&quot;&gt;</p>

<p class=programs>&lt;target name=&quot;vijay&quot;&gt;</p>

<p class=programs>&lt;copy file=&quot;ggg.aaa&quot; todir=&quot;..&quot;/&gt;</p>

<p class=programs>&lt;/target&gt;</p>

<p class=programs>&lt;/project&gt;</p>

<p class=programs><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=programs>vijay:</p>

<p class=programs><span style="mso-spacerun: yes">     </span>[copy] Copying 1
file to C:\Sun\AppServer\lib\ant</p>

<p class=cbasetext><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=cbasetext>By now you must have realized that we are running our
build.xml in the ant\bin sub-directory. We would like to copy the same file, to
our parent directory. For this purpose, the todir attribute is made to point to
our parent directory, thereupon leaving it to the copy task to do its job. The
copy task has some more complex options that will be touched upon a little
later.</p>

<p class=cbasetext><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=cbasetext>Now lets copy an entire subdirectory at a time. For this
purpose, the task to be used is copydir. But first we create two
sub-directories called a1 and a2 under the bin subdirectory. We then create three
files, a.java, b.java and c.txt within sub-directory a1 and then run the below
given build.xml file.</p>

<p class=cbasetext><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=programs>Build.xml</p>

<p class=programs>&lt;project default=&quot;vijay&quot;&gt;</p>

<p class=programs>&lt;target name=&quot;vijay&quot;&gt;</p>

<p class=programs>&lt;copydir src=&quot;./a1&quot; dest=&quot;./a2&quot; /&gt;</p>

<p class=programs>&lt;/target&gt;</p>

<p class=programs>&lt;/project&gt;</p>

<p class=programs><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=programs>Buildfile: build.xml</p>

<p class=programs><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=programs>vijay:</p>

<p class=programs><span style="mso-spacerun: yes">  </span>[copydir] DEPRECATED
- The copydir task is deprecated.<span style="mso-spacerun: yes">  </span>Use
copy instead.</p>

<p class=programs><span style="mso-spacerun: yes">  </span>[copydir] Copying 3
files to C:\Sun\AppServer\lib\ant\bin\a2</p>

<p class=programs><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=programs>BUILD SUCCESSFUL</p>

<p class=cbasetext><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=cbasetext>The src attribute specifies the source directory and a
single dot, if you have forgotten, denotes the current position. Normally these
values are set using properties. The dest attribute obviously specifies the
destination directory. </p>

<p class=cbasetext><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=cbasetext>The ant output tells us that the copydir task is deprecated
and we should have used the earlier copy task instead. What deprecation means
in the java world is that the previously distributed task copydir in the sdk
has now been recognized to be a bad idea. However, they cannot throw it away as
lots of build files would be using this task copydir. Thus the ant people would
like to remove this task copydir, but they cannot as older build files will
stop working. So by deprecating it, they are issuing notices that they will
remove it in the future, but cannot say when. By our experience, the next
century is when deprecate items finally get knocked off. </p>

<p class=cbasetext><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=cbasetext>Run ant again and the files do not get copied as the source
files have not changed, thus it makes no sense to copy them again.</p>

<p class=cbasetext><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=programs>vijay:</p>

<p class=programs><span style="mso-spacerun: yes">  </span>[copydir] DEPRECATED
- The copydir task is deprecated.<span style="mso-spacerun: yes">  </span>Use
copy instead.</p>

<p class=programs><span style="mso-spacerun: yes">  </span>[copydir] Copying 1
file to C:\Sun\AppServer\lib\ant\bin\a2</p>

<p class=cbasetext><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=cbasetext>Change the contents of one file only a.java in directory a1
and ant is smart enough to copy only this file. Change the file b.java in the
sub-directory a2, and no file gets copied.<span style="mso-spacerun: yes"> 
</span></p>

<p class=cbasetext><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=cbasetext>Thus to try out the next set of build files, always delete
all files in the sub-directory a2.</p>

<p class=cbasetext><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=programs>Build.xml</p>

<p class=programs>&lt;project default=&quot;vijay&quot;&gt;</p>

<p class=programs>&lt;target name=&quot;vijay&quot;&gt;</p>

<p class=programs>&lt;copydir src=&quot;./a1&quot; dest=&quot;./a2&quot;
includes=&quot;*.java&quot;/&gt;</p>

<p class=programs>&lt;/target&gt;</p>

<p class=programs>&lt;/project&gt;</p>

<p class=programs><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=programs>vijay:</p>

<p class=programs><span style="mso-spacerun: yes">  </span>[copydir] DEPRECATED
- The copydir task is deprecated.<span style="mso-spacerun: yes">  </span>Use
copy instead.</p>

<p class=programs><span style="mso-spacerun: yes">  </span>[copydir] Copying 2
files to C:\Sun\AppServer\lib\ant\bin\a2</p>

<p class=cbasetext><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=cbasetext>The includes attribute restricts the copy of only those
files that meet a condition. In this case we only want the files with a java
extension to be copied. Thus only files a.java and b.java get copied and the
file c.txt gets left behind.</p>

<p class=cbasetext><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=programs>Build.xml</p>

<p class=programs>&lt;project default=&quot;vijay&quot;&gt;</p>

<p class=programs>&lt;target name=&quot;vijay&quot;&gt;</p>

<p class=programs>&lt;copydir src=&quot;./a1&quot; dest=&quot;./a2&quot;
includes=&quot;*.java&quot; excludes=&quot;b*.*&quot; /&gt;</p>

<p class=programs>&lt;/target&gt;</p>

<p class=programs>&lt;/project&gt;</p>

<p class=programs><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=programs>vijay:</p>

<p class=programs><span style="mso-spacerun: yes">  </span>[copydir] DEPRECATED
- The copydir task is deprecated.<span style="mso-spacerun: yes">  </span>Use
copy instead.</p>

<p class=programs><span style="mso-spacerun: yes">  </span>[copydir] Copying 1
file to C:\Sun\AppServer\lib\ant\bin\a2</p>

<p class=cbasetext><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=cbasetext>The excludes option does the reverse, it excludes all those
files that meet the condition. In our case, all files that start with the
character b are to be ignored, thus only one file gets copied.</p>

<p class=cbasetext><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=cbasetext>We now create a sub-directory z1 under a1 and copy two files
to it, d.java and e.java. Mind you we do not create a sub-directory z1 under
a2.</p>

<p class=cbasetext><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=programs>&lt;project default=&quot;vijay&quot;&gt;</p>

<p class=programs>&lt;target name=&quot;vijay&quot;&gt;</p>

<p class=programs>&lt;copydir src=&quot;./a1&quot; dest=&quot;./a2&quot; /&gt;</p>

<p class=programs>&lt;/target&gt;</p>

<p class=programs>&lt;/project&gt;</p>

<p class=programs><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=programs>vijay:</p>

<p class=programs><span style="mso-spacerun: yes">  </span>[copydir] DEPRECATED
- The copydir task is deprecated.<span style="mso-spacerun: yes">  </span>Use
copy instead.</p>

<p class=programs><span style="mso-spacerun: yes">  </span>[copydir] Copying 5
files to C:\Sun\AppServer\lib\ant\bin\a2</p>

<p class=cbasetext><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=cbasetext>When we run ant it tells us that it copies 5 files and also
creates the sub-directory z1 within a2. Thus the includes and excludes should
start with ** to denote all subdirectories as include=”**/*.java”. Thus we can
start these attributes with a subdirectory name like /a1/z1. </p>

<p class=cbasetext><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=cbasetext>After copy the next task is to delete what we have copied. </p>

<p class=cbasetext><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=programs>Build.xml</p>

<p class=programs>&lt;project default=&quot;vijay&quot;&gt;</p>

<p class=programs>&lt;target name=&quot;vijay&quot;&gt;</p>

<p class=programs>&lt;delete file=&quot;./a1/a.java&quot;/&gt;</p>

<p class=programs>&lt;/target&gt;</p>

<p class=programs>&lt;/project&gt;</p>

<p class=programs><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=programs>vijay:</p>

<p class=programs><span style="mso-spacerun: yes">   </span>[delete] Deleting:
C:\Sun\AppServer\lib\ant\bin\a1\a.java</p>

<p class=cbasetext><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=cbasetext>We simply use the delete task and set the file attribute to
the name of the file that is to be deleted. </p>

<p class=cbasetext><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=programs>Build.xml</p>

<p class=programs>&lt;project default=&quot;vijay&quot;&gt;</p>

<p class=programs>&lt;target name=&quot;vijay&quot;&gt;</p>

<p class=programs>&lt;delete dir=&quot;./a1&quot;/&gt;</p>

<p class=programs>&lt;/target&gt;</p>

<p class=programs>&lt;/project&gt;</p>

<p class=programs><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=programs>vijay:</p>

<p class=programs><span style="mso-spacerun: yes">   </span>[delete] Deleting
directory C:\Sun\AppServer\lib\ant\bin\a1</p>

<p class=cbasetext><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=cbasetext>To delete a sub-directory and all the directories below it,
the dir attribute is used instead of the file attribute.</p>

<p class=cbasetext><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=programs>&lt;project default=&quot;vijay&quot;&gt;</p>

<p class=programs>&lt;target name=&quot;vijay&quot;
depends=&quot;a1,a2&quot;&gt;</p>

<p class=programs>&lt;echo message=&quot;in vijay&quot; /&gt;</p>

<p class=programs>&lt;/target&gt;</p>

<p class=programs>&lt;target name=&quot;a1&quot; if=&quot;mukhi&quot;&gt;</p>

<p class=programs>&lt;echo message=&quot;in a1&quot; /&gt;</p>

<p class=programs>&lt;/target&gt;</p>

<p class=programs>&lt;target name=&quot;a2&quot; unless=&quot;mukhi&quot;&gt;</p>

<p class=programs>&lt;echo message=&quot;in a2&quot; /&gt;</p>

<p class=programs>&lt;/target&gt;</p>

<p class=programs>&lt;/project&gt;</p>

<p class=programs><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=programs>a1:</p>

<p class=programs><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=programs>a2:</p>

<p class=programs><span style="mso-spacerun: yes">     </span>[echo] in a2</p>

<p class=programs><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=programs>vijay:</p>

<p class=programs><span style="mso-spacerun: yes">     </span>[echo] in vijay</p>

<p class=cbasetext><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=cbasetext>In the above build.xml, the target vijay depends upon two targets
a1 and a2. Ant goes to the first target a1, but before executing it, it sees
the if attribute. This attribute asserts that the target should only be
executed if the property mukhi has been created. Since this is not the case,
the target does not get executed. </p>

<p class=cbasetext><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=cbasetext>The second target a2 uses an unless that is the reverse of
the if. In this case the property mukhi should not be set for the target to be
executed thus, it leads to executing target a2 and not a1.</p>

<p class=cbasetext><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=programs>Build.xml</p>

<p class=programs>&lt;project default=&quot;vijay&quot;&gt;</p>

<p class=programs>&lt;property name=&quot;mukhi&quot; value=&quot;hi&quot;
/&gt;</p>

<p class=programs>&lt;target name=&quot;vijay&quot;
depends=&quot;a1,a2&quot;&gt;</p>

<p class=programs>&lt;echo message=&quot;in vijay&quot; /&gt;</p>

<p class=programs>&lt;/target&gt;</p>

<p class=programs>&lt;target name=&quot;a1&quot; if=&quot;mukhi&quot;&gt;</p>

<p class=programs>&lt;echo message=&quot;in a1&quot; /&gt;</p>

<p class=programs>&lt;/target&gt;</p>

<p class=programs>&lt;target name=&quot;a2&quot; unless=&quot;mukhi&quot;&gt;</p>

<p class=programs>&lt;echo message=&quot;in a2&quot; /&gt;</p>

<p class=programs>&lt;/target&gt;</p>

<p class=programs>&lt;/project&gt;</p>

<p class=programs><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=programs><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=programs>a1:</p>

<p class=programs><span style="mso-spacerun: yes">     </span>[echo] in a1</p>

<p class=programs><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=programs>a2:</p>

<p class=programs><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=programs>vijay:</p>

<p class=programs><span style="mso-spacerun: yes">     </span>[echo] in vijay</p>

<p class=cbasetext><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=cbasetext>The only change in the file is the newly created property
called mukhi. The if attribute becomes true and target a1 gets executed. The
unless is now false and thus the target a2 does not get executed.</p>

<p class=cbasetext><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=programs>Build.xml</p>

<p class=programs>&lt;project default=&quot;vijay&quot;&gt;</p>

<p class=programs>&lt;target name=&quot;vijay&quot;&gt;</p>

<p class=programs>&lt;mkdir dir=&quot;a3&quot; /&gt;</p>

<p class=programs>&lt;/target&gt;</p>

<p class=programs>&lt;/project&gt;</p>

<p class=programs><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=programs>vijay:</p>

<p class=programs><span style="mso-spacerun: yes">    </span>[mkdir] Created
dir: C:\Sun\AppServer\lib\ant\bin\a3</p>

<p class=cbasetext><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=cbasetext>The task mkdir has only one attribute dir which creates a
directory. In the above case the sub-directory is called a3.</p>

<p class=cbasetext><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=programs>Build.xml</p>

<p class=programs>&lt;project default=&quot;vijay&quot;&gt;</p>

<p class=programs>&lt;target name=&quot;vijay&quot;&gt;</p>

<p class=programs>&lt;sun-appserv-input message=&quot;User Name&quot;
addproperty=&quot;zzz&quot; /&gt;</p>

<p class=programs>&lt;echo message=&quot;You typed ${zzz}&quot; /&gt;</p>

<p class=programs>&lt;/target&gt;</p>

<p class=programs>&lt;/project&gt;</p>

<p class=programs><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=programs>You typed mukhi</p>

<p class=programs><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=programs>&gt;Asant</p>

<p class=cbasetext><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=cbasetext>Many a times, some interaction is required with the user,
some input is taken from the user. The task sun-appserv-input takes two
attributes, the message to display something for the user and the attribute
addproperty for name of the property that will contain the user input. </p>

<p class=cbasetext><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=cbasetext>The system prompts the message. Since we have keyed in
Mukhi, the value gets stored in the property zzz which eventually is displayed
using the echo task. For reasons to be explained later the ant batch file does
not work here. There is another batch file asant with the J2EE distribution,
which is to be used.</p>

<p class=cbasetext><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=programs>Build.xml</p>

<p class=programs>&lt;project default=&quot;vijay&quot;&gt;</p>

<p class=programs>&lt;target name=&quot;vijay&quot;&gt;</p>

<p class=programs>&lt;zip destfile=&quot;a.zip&quot; basedir=&quot;./a3&quot;
/&gt;</p>

<p class=programs>&lt;/target&gt;</p>

<p class=programs>&lt;/project&gt;</p>

<p class=programs><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=programs>vijay:</p>

<p class=programs><span style="mso-spacerun: yes">      </span>[zip] Building
zip: C:\Sun\AppServer\lib\ant\bin\a.zip</p>

<p class=cbasetext><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=cbasetext>Java does not like working with individual files and prefers
working with one file that contains loads of other files. This file is normally
a compressed archive file. The Zip file format is the most popular archive,
thus we have a task just to create a zip file. </p>

<p class=cbasetext><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=cbasetext>This task requires the name of the zip file as the value of
the destfile attribute and the directory containing files to be zipped as the
basedir attribute. In our case our directory is a3, the current location or
basedir and the name of the zip file is a.zip. Also, with the Ant tool, you can
also use the includes and excludes attributes to filter out the files required.</p>

<p class=cbasetext><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=cbasetext>Java Server Pages</p>

<p class=cbasetext><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=cbasetext>Lets us now take a practical application to showcase the
power of the ant tool. We would like to deploy a Java Server pages or JSP file.
The concept of Java Server Pages is similar to ASP.Net, which is nothing but
code in a html page. We cannot simply place a jsp page somewhere and expect the
J2EE server to execute it. </p>

<p class=cbasetext><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=cbasetext>Based on servlet technology, Java Server Pages (JSP) is one
of the most important elements of Java server programming. Java Server Pages
combine HTML or XML with nuggets of Java code to produce dynamic web pages.
Each page is automatically compiled to a servlet by the JSP engine the first
time it is requested, and then executed. JSP provides a variety of ways to talk
to Java classes, servlets, applets and the web server.</p>

<p class=cbasetext><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=cbasetext>The jsp page normally contains all the presentation logic
whereas the business logic is stored in Enterprise Java Beans or EJB’s. </p>

<p class=cbasetext><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=cbasetext>First of all start the default domain server </p>

<p class=cbasetext>Start-Programs- Sun Microsystems- J2ee 1.4 SDK – Start
Default Server </p>

<p class=cbasetext><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=cbasetext>First within the root create a new subdirectory called
myprg. </p>

<p class=cbasetext>Make sure the path is set</p>

<p class=cbasetext><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=programs>C:\myprg&gt;set path=c:\sun\appserver\lib\ant\bin;%PATH%</p>

<p class=cbasetext><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=cbasetext>For sake of convenience we have created a batch file in
myprg</p>

<p class=cbasetext><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=programs>aa.bat</p>

<p class=programs>Set JAVA_HOME= C:\Sun\AppServer\jdk</p>

<p class=programs>set
CLASSPATH=%JAVA_HOME%\lib\classes.zip;%JAVA_HOME%\lib\tools.jar;</p>

<p class=programs>C:\Sun\AppServer\lib\ant\lib\ant.jar</p>

<p class=programs>set path=c:\sun\appserver\lib\ant\bin;%PATH%</p>

<p class=programs><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=cbasetext>Then create a sub-directory a1 below myprg and write the
following in a file a.jsp.</p>

<p class=programs><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=programs>C:\myprg\a1&gt;edit e1.jsp</p>

<p class=programs>e1.jsp</p>

<p class=programs>Hi</p>

<p class=cbasetext><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=cbasetext>The server obviously needs more information on how to deploy
this jsp file. </p>

<p class=cbasetext><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=cbasetext>For the newbie, the jsp file is converted into java code and
then into a java servlet and then executed by the server. Thus we have other
entities that we may want to package together like images, graphic or sound
files, EJB’s etc. We have a war file or a Web Application Archive that puts
multiplies entities together. </p>

<p class=cbasetext><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=cbasetext>A war file is nothing but a zip file. To create a war file,
we need a file web.xml that configures our web application.<span
style="mso-spacerun: yes">  </span>Create this file in the myprg subdirectory. </p>

<p class=cbasetext><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=programs>C:\myprg&gt;edit web.xml</p>

<p class=programs><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=programs>Web.xml</p>

<p class=programs>&lt;?xml version=&quot;1.0&quot;
encoding=&quot;UTF-8&quot;?&gt;</p>

<p class=programs>&lt;web-app&gt;</p>

<p class=programs>&lt;/web-app&gt;</p>

<p class=cbasetext><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=cbasetext>This file being a xml file should start with the mandatory
?xml element. It has only one element the root element called web-app. As of
now it contains no other element. Then create the build file.</p>

<p class=cbasetext><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=programs>Build.xml</p>

<p class=programs>&lt;project default=&quot;vijay&quot;&gt;</p>

<p class=programs>&lt;target name=&quot;vijay&quot;&gt;</p>

<p class=programs>&lt;property name=&quot;fname&quot;<span style="mso-spacerun:
yes">  </span>value=&quot;zzz.war&quot; /&gt;</p>

<p class=programs>&lt;war destfile=&quot;${fname}&quot;
webxml=&quot;web.xml&quot; basedir=&quot;./a1&quot; &gt;</p>

<p class=programs>&lt;/war&gt; </p>

<p class=programs>&lt;/target&gt;</p>

<p class=programs>&lt;/project&gt;</p>

<p class=cbasetext><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=cbasetext>Our build.xml will now build the war file using the task
war. We have also created a property fname that specifies the name of the war
file to be created. Most samples use properties instead of actual values. In
the war task, we first use the attribute destfile to specify the name of the
war file zzz.war. </p>

<p class=cbasetext><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=cbasetext>The mandatory webxml attribute is used to specify the name
of the Web Application Descriptor file which is normally web.xml. The basedir
attribute tells the war task which directory contains the jsp and other files
to be packaged or archived. In our case we would like all files in the a1
sub-directory to be put together. </p>

<p class=cbasetext><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=cbasetext>When we run ant, a file zzz.war gets created in the
directory myprg. Use the winzip program to uncompress the file in the dummy4
directory. The following is the directory structure in dummy4.</p>

<p class=cbasetext><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=programs>Directory of C:\dummy4</p>

<p class=programs><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=programs>02/22/2004<span style="mso-spacerun: yes"> 
</span>11:29a<span style="mso-spacerun: yes">      </span>&lt;DIR&gt;<span
style="mso-spacerun: yes">          </span>.</p>

<p class=programs>02/22/2004<span style="mso-spacerun: yes"> 
</span>11:29a<span style="mso-spacerun: yes">      </span>&lt;DIR&gt;<span
style="mso-spacerun: yes">          </span>..</p>

<p class=programs>02/22/2004<span style="mso-spacerun: yes"> 
</span>11:29a<span style="mso-spacerun: yes">      </span>&lt;DIR&gt;<span
style="mso-spacerun: yes">          </span>META-INF</p>

<p class=programs>02/21/2004<span style="mso-spacerun: yes"> 
</span>11:24a<span style="mso-spacerun: yes">                   </span>6 e1.jsp</p>

<p class=programs>02/22/2004<span style="mso-spacerun: yes"> 
</span>11:29a<span style="mso-spacerun: yes">      </span>&lt;DIR&gt;<span
style="mso-spacerun: yes">          </span>WEB-INF</p>

<p class=programs>02/22/2004<span style="mso-spacerun: yes">  </span>11:29a<span
style="mso-spacerun: yes">                   </span>0 z</p>

<p class=programs><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=programs><span style="mso-spacerun: yes"> </span>Directory of
C:\dummy4\META-INF</p>

<p class=programs>02/22/2004<span style="mso-spacerun: yes"> 
</span>11:29a<span style="mso-spacerun: yes">      </span>&lt;DIR&gt;<span
style="mso-spacerun: yes">          </span>.</p>

<p class=programs>02/22/2004<span style="mso-spacerun: yes"> 
</span>11:29a<span style="mso-spacerun: yes">      </span>&lt;DIR&gt;<span
style="mso-spacerun: yes">          </span>..</p>

<p class=programs>02/22/2004<span style="mso-spacerun: yes"> 
</span>11:29a<span style="mso-spacerun: yes">                 </span>107
MANIFEST.MF</p>

<p class=programs><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=programs>Directory of C:\dummy4\WEB-INF</p>

<p class=programs>02/22/2004<span style="mso-spacerun: yes"> 
</span>11:29a<span style="mso-spacerun: yes">      </span>&lt;DIR&gt;<span
style="mso-spacerun: yes">          </span>.</p>

<p class=programs>02/22/2004<span style="mso-spacerun: yes"> 
</span>11:29a<span style="mso-spacerun: yes">      </span>&lt;DIR&gt;<span
style="mso-spacerun: yes">          </span>..</p>

<p class=programs>02/22/2004<span style="mso-spacerun: yes"> 
</span>10:41a<span style="mso-spacerun: yes">                 </span>142
web.xml</p>

<p class=cbasetext><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=cbasetext>Our only file a.jsp in the a1 directory gets placed in the
root directory. Two other directories Meta-Inf and Web-Inf get created which
were not there in our directory structure. The file web.xml gets placed in the
web-inf directory and a new file Manifest.mf gets placed in the meta-inf
directory. The contents of this file are as.</p>

<p class=cbasetext><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=programs>Manifest.mf</p>

<p class=programs>Manifest-Version: 1.0</p>

<p class=programs>Ant-Version: Apache Ant 1.5.4</p>

<p class=programs>Created-By: 1.4.2_04-b04 (Sun Microsystems Inc.)</p>

<p class=cbasetext><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=cbasetext>Nothing really useful. The above directory structure gets
created and the JSP and Servlet specifications specify the above format. The
war task does the job of placing things in the right place. </p>

<p class=cbasetext><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=cbasetext>Once the war file is created, we have to deploy it to the
server. For this we have to run a bat file called asadmin.bat that like all bat
files is present in the bin directory under appserver of the J2ee
distribution.<span style="mso-spacerun: yes">  </span>This file does nothing
but call the java program on some class file.</p>

<p class=cbasetext><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=cbasetext>We have to run this batch file with the following options.</p>

<p class=cbasetext><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=programs>C:\myprg&gt; C:/Sun/AppServer/bin/asadmin deploy --user admin
--password vijay712 --host office --port 4848 zzz.war</p>

<p class=cbasetext><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=cbasetext>Command deploy executed successfully.</p>

<p class=cbasetext><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=cbasetext>The deploy option tells the asadmin utility to deploy a web
application file which in our case is the last parameter zzz.war. There are
four parameters that need to supplied to the deploy option. </p>

<p class=cbasetext><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=cbasetext>The first is the user name admin, the second is our password
vijay712, the third is the name of the host machine running the j2ee server
office and lastly the port number the admin server is listening on 4848. </p>

<p class=cbasetext><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=cbasetext>Then start the web browser to test the installation of the
application. We write the URL http://localhost:8080/zzz. There are no errors
and on the screen we see a list of files present in the war file. In our case
as we have only one file a.jsp, we see only one file. </p>

<p class=cbasetext><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=cbasetext>When we click on this file e1.jsp, the J2EE server first converts
it into a java servlet program, compiles it and then runs it. This is why we
get a slight delay in seeing the output.</p>

<p class=cbasetext><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=programs>Web.xml</p>

<p class=programs>&lt;?xml version=&quot;1.0&quot;
encoding=&quot;UTF-8&quot;?&gt;</p>

<p class=programs>&lt;web-app&gt;</p>

<p class=programs>&lt;welcome-file-list&gt;</p>

<p class=programs>&lt;welcome-file&gt;a.jsp&lt;/welcome-file&gt;</p>

<p class=programs>&lt;/welcome-file-list&gt;</p>

<p class=programs>&lt;/web-app&gt;</p>

<p class=cbasetext><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=cbasetext>Modify the web.xml file to add one more element,
welcome-file-list. Within it bring in<span style="mso-spacerun: yes"> 
</span>another element welcome-file, and specify the file a.jsp. Thus whenever
we do not specify a servlet or jsp file name, the file a.jsp will get displayed
instead of a list of files. </p>

<p class=cbasetext><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=cbasetext><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=cbasetext>The next change is in the build.xml file.</p>

<p class=cbasetext><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=programs>Build.xml</p>

<p class=programs>&lt;project default=&quot;vijay&quot;&gt;</p>

<p class=programs>&lt;target name=&quot;vijay&quot;&gt;</p>

<p class=programs>&lt;property name=&quot;fname&quot;<span style="mso-spacerun:
yes">  </span>value=&quot;zzz.war&quot; /&gt;</p>

<p class=programs>&lt;war destfile=&quot;${fname}&quot;
webxml=&quot;web.xml&quot; basedir=&quot;./a1&quot; &gt;</p>

<p class=programs>&lt;/war&gt; </p>

<p class=programs>&lt;exec executable=&quot;cmd.exe&quot; &gt;</p>

<p class=programs>&lt;arg line=&quot; /c C:/Sun/AppServer/bin/asadmin&quot;
/&gt;</p>

<p class=programs>&lt;arg line=&quot; deploy&quot;/&gt;</p>

<p class=programs>&lt;arg line=&quot; --user admin&quot;/&gt;</p>

<p class=programs>&lt;arg line=&quot; --password vijay712&quot;/&gt;</p>

<p class=programs>&lt;arg line=&quot; --host office&quot;/&gt;</p>

<p class=programs>&lt;arg line=&quot; --port 4848&quot;/&gt;</p>

<p class=programs>&lt;arg line=&quot;${fname}&quot;/&gt;</p>

<p class=programs>&lt;/exec&gt;<span style="mso-spacerun: yes">   </span></p>

<p class=programs>&lt;/target&gt;</p>

<p class=programs>&lt;/project&gt;</p>

<p class=cbasetext><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=cbasetext>In the build file, we combine the building of the war file
and deployment in one step. Instead of calling the batch file separately, we
use the task exec to run the asadmin batch file. The exec task requires the
name of the executable in the executable attribute. </p>

<p class=cbasetext><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=cbasetext>The cmd.exe is the program that creates the dos box for us.
Then we specify all the parameters using the arg element and the line
attribute. For the sake of clarity we specify them on multiple lines. Thus on
running ant, we are building the war file and deploying it with a minimum of
fuss.</p>

<p class=cbasetext><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=cbasetext>Further on, these values could be picked up from a file
‘common.properties’ too.<span style="mso-spacerun: yes">  </span>The following
file demonstrates the same</p>

<p class=cbasetext><i><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></i></p>

<p class=programs>Build.xml</p>

<p class=programs>&lt;project default=&quot;vijay&quot;&gt;</p>

<p class=programs>&lt;target name=&quot;vijay&quot;&gt;</p>

<p class=programs>&lt;property name=&quot;fname&quot;<span style="mso-spacerun:
yes">  </span>value=&quot;zzz.war&quot; /&gt;</p>

<p class=programs>&lt;property file=&quot;
c:/sun/appserver/samples/common.properties &quot; /&gt;</p>

<p class=programs>&lt;war destfile=&quot;${fname}&quot;
webxml=&quot;web.xml&quot; basedir=&quot;./a1&quot; &gt;</p>

<p class=programs>&lt;/war&gt; </p>

<p class=programs>&lt;exec executable=&quot;cmd.exe&quot; &gt;</p>

<p class=programs>&lt;arg line=&quot; /c C:/Sun/AppServer/bin/asadmin&quot;
/&gt;</p>

<p class=programs>&lt;arg line=&quot; deploy&quot;/&gt;</p>

<p class=programs>&lt;arg line=&quot; --user ${admin.user}&quot;/&gt;</p>

<p class=programs>&lt;arg line=&quot; --password ${admin.password}&quot;/&gt;</p>

<p class=programs>&lt;arg line=&quot; --host ${admin.host}&quot;/&gt;</p>

<p class=programs>&lt;arg line=&quot; --port ${admin.port}&quot;/&gt;</p>

<p class=programs>&lt;arg line=&quot;${fname}&quot;/&gt;</p>

<p class=programs>&lt;/exec&gt;<span style="mso-spacerun: yes">   </span></p>

<p class=programs>&lt;/target&gt;</p>

<p class=programs>&lt;/project&gt;</p>

<p class=cbasetext><i><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></i></p>

<p class=cbasetext>There is a file called common.properties in the directory
c:/sun/appserver/samples/ that contains the user name, password, port number
and host name. Thus instead of specifying these names ourselves, we use the
file attribute as shown earlier to read this file and all the properties in it.
</p>

<p class=cbasetext><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=cbasetext>We then use these properties names instead of hard coding
them. We are also displaying the contents of this file as per our machine.</p>

<p class=cbasetext><i><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></i></p>

<p class=programs>Common.properties</p>

<p class=programs>#Sat Jan 17 11:50:02 GMT+05:30 2004</p>

<p class=programs>domain.name=domain1</p>

<p class=programs>com.sun.aas.javaRoot=C\:/Sun/AppServer/jdk</p>

<p class=programs>admin.host=office</p>

<p class=programs>admin.port=4848</p>

<p class=programs>com.sun.aas.installRoot=C\:/Sun/AppServer</p>

<p class=programs>appserver.instance=server</p>

<p class=programs>appserver.instance.port=8080</p>

<p class=programs>admin.user=admin</p>

<p class=programs>admin.password=vijay712</p>

<p class=cbasetext><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=cbasetext>Reload e1.jsp file in the browser. The browser initially
takes a long time to show you the result, however it is faster when the file is
reloaded. </p>

<p class=cbasetext><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=cbasetext>And Congratulations! You have written the world's smallest
JSP program. </p>

<p class=cbasetext><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=cbasetext>Now switch over to the command box and change to the
directory</p>

<p class=cbasetext><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=programs>C:\Sun\AppServer\domains\domain1\generated\jsp\j2ee-modules&gt;</p>

<p class=cbasetext><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=cbasetext>A dir command here displays a subdirectory zzz with the
other files and directories. Move into zzz and further into org\apache\jsp.
Listing the directory contents here will show a file e1_jsp.java. The contents
of this file are shown below.</p>

<p class=cbasetext><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=programs>e1_jsp.java</p>

<p class=programs>package org.apache.jsp;</p>

<p class=programs><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=programs>import javax.servlet.*;</p>

<p class=programs>import javax.servlet.http.*;</p>

<p class=programs>import javax.servlet.jsp.*;</p>

<p class=programs><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=programs>public final class e1_jsp extends
org.apache.jasper.runtime.HttpJspBase</p>

<p class=programs><span style="mso-spacerun: yes">    </span>implements org.apache.jasper.runtime.JspSourceDependent
{</p>

<p class=programs><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=programs><span style="mso-spacerun: yes">  </span>private static
java.util.Vector _jspx_dependants;</p>

<p class=programs><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=programs><span style="mso-spacerun: yes">  </span>public
java.util.List getDependants() {</p>

<p class=programs><span style="mso-spacerun: yes">    </span>return
_jspx_dependants;</p>

<p class=programs><span style="mso-spacerun: yes">  </span>}</p>

<p class=programs><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=programs><span style="mso-spacerun: yes">  </span>public void
_jspService(HttpServletRequest request, HttpServletResponse response)</p>

<p class=programs><span style="mso-spacerun: yes">        </span>throws
java.io.IOException, ServletException {</p>

<p class=programs><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=programs><span style="mso-spacerun: yes">    </span>JspFactory
_jspxFactory = null;</p>

<p class=programs><span style="mso-spacerun: yes">    </span>PageContext
pageContext = null;</p>

<p class=programs><span style="mso-spacerun: yes">    </span>HttpSession
session = null;</p>

<p class=programs><span style="mso-spacerun: yes">    </span>ServletContext
application = null;</p>

<p class=programs><span style="mso-spacerun: yes">    </span>ServletConfig
config = null;</p>

<p class=programs><span style="mso-spacerun: yes">    </span>JspWriter out =
null;</p>

<p class=programs><span style="mso-spacerun: yes">    </span>Object page =
this;</p>

<p class=programs><span style="mso-spacerun: yes">    </span>JspWriter
_jspx_out = null;</p>

<p class=programs><span style="mso-spacerun: yes">    </span>PageContext
_jspx_page_context = null;</p>

<p class=programs><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=programs><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=programs><span style="mso-spacerun: yes">    </span>try {</p>

<p class=programs><span style="mso-spacerun: yes">      </span>_jspxFactory =
JspFactory.getDefaultFactory();</p>

<p class=programs><span style="mso-spacerun: yes">     
</span>response.setContentType(&quot;text/html&quot;);</p>

<p class=programs><span style="mso-spacerun: yes">     
</span>response.addHeader(&quot;X-Powered-By&quot;, &quot;JSP/2.0&quot;);</p>

<p class=programs><span style="mso-spacerun: yes">      </span>pageContext =
_jspxFactory.getPageContext(this, request, response,</p>

<p class=programs><span style="mso-spacerun: yes">      </span><span
style='mso-tab-count:3'>                         </span>null, true, 8192,
true);</p>

<p class=programs><span style="mso-spacerun: yes">     
</span>_jspx_page_context = pageContext;</p>

<p class=programs><span style="mso-spacerun: yes">      </span>application =
pageContext.getServletContext();</p>

<p class=programs><span style="mso-spacerun: yes">      </span>config =
pageContext.getServletConfig();</p>

<p class=programs><span style="mso-spacerun: yes">      </span>session =
pageContext.getSession();</p>

<p class=programs><span style="mso-spacerun: yes">      </span>out =
pageContext.getOut();</p>

<p class=programs><span style="mso-spacerun: yes">      </span>_jspx_out = out;</p>

<p class=programs><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=programs><span style="mso-spacerun: yes">     
</span>out.write(&quot;hi\r\n&quot;);</p>

<p class=programs><span style="mso-spacerun: yes">    </span>} catch (Throwable
t) {</p>

<p class=programs><span style="mso-spacerun: yes">      </span>if (!(t
instanceof SkipPageException)){</p>

<p class=programs><span style="mso-spacerun: yes">        </span>out =
_jspx_out;</p>

<p class=programs><span style="mso-spacerun: yes">        </span>if (out !=
null &amp;&amp; out.getBufferSize() != 0)</p>

<p class=programs><span style="mso-spacerun: yes">         
</span>out.clearBuffer();</p>

<p class=programs><span style="mso-spacerun: yes">        </span>if
(_jspx_page_context != null) _jspx_page_context.handlePageException(t);</p>

<p class=programs><span style="mso-spacerun: yes">      </span>}</p>

<p class=programs><span style="mso-spacerun: yes">    </span>} finally {</p>

<p class=programs><span style="mso-spacerun: yes">      </span>if (_jspxFactory
!= null) _jspxFactory.releasePageContext(_jspx_page_context);</p>

<p class=programs><span style="mso-spacerun: yes">    </span>}</p>

<p class=programs><span style="mso-spacerun: yes">  </span>}</p>

<p class=programs>}</p>

<p class=cbasetext><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=cbasetext>Open this Java file in notepad, keeping in mind that it has
been created by the Java Web Server. </p>

<p class=cbasetext><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=cbasetext>The JSP file that you ran from the browser was converted
into a servlet. Then _jspService is called. Now you know why it takes a long
time for the output to show up in the browser. It takes some time to convert
the jsp file into a servlet and then compile the servlet to a .class file and
then run the servlet.</p>

<p class=cbasetext><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=cbasetext>JSP Expressions</p>

<p class=cbasetext><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=cbasetext>A JSP Expression is a great tool for embedding values within
your HTML code. Anything between &lt;%= and %&gt; tags will be evaluated,
converted to a string, and then displayed.</p>

<p class=cbasetext><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=cbasetext>Now let's create another file where we start with hi and
then send %=&quot;bye&quot; %. Just a reminder, always run ant and then asadmin
command. </p>

<p class=cbasetext><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=cbasetext>Also, make sure that you are not within the zzz directory as
the asadmin command renames this directory to zzz_old. The error reported at
such moments is </p>

<p class=cbasetext><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=programs>CLI171 Command deploy failed : Deployment Error -- Could not
rename C:\Sun\</p>

<p class=programs>AppServer\domains\domain1\generated\jsp\j2ee-modules\zzz to
C:\Sun\AppServer\domains\domain1\generated\jsp\j2ee-modules\zzz_old</p>

<p class=cbasetext><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=cbasetext>Follow the steps as given below once the jsp file is ready
to be deployed (server should be running)</p>

<p class=cbasetext><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=programs>C:\myprg&gt;del zzz.war</p>

<p class=programs>C:\myprg&gt;ant</p>

<p class=programs>C:\myprg&gt;C:/Sun/AppServer/bin/asadmin deploy --user admin
--password vijay712 --host office --port 4848 zzz.war</p>

<p class=cbasetext><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=cbasetext><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=programs>e2.jsp</p>

<p class=programs>hi</p>

<p class=programs>&lt;%= &quot;bye&quot; %&gt;</p>

<p class=programs>no</p>

<p class=cbasetext><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=cbasetext>The browser window shows hi, bye, no on a single line. </p>

<p class=cbasetext>Let's understand what we have just done. When the browser is
requested to open e2.jsp, the JSP engine takes over charge. It sees the tag
'&lt;%' whereby it understands this character and for it anything within &lt;%
%&gt; is JSP. A tag is anything that starts with an angle bracket. '&lt;%' is
also used in Active Server Pages. The '=' sign tells the engine to add the line
'out.print' in the Java program with the string given in double quotes as a
parameter to print. It automatically brings in the open and close bracket and a
semicolon at the end. </p>

<p class=cbasetext>---------------</p>

<p class=cbasetext><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=programs><span style="mso-spacerun: yes">     
</span>out.write(&quot;hi\r\n&quot;);</p>

<p class=programs><span style="mso-spacerun: yes">      </span>out.print(
&quot;bye&quot; );</p>

<p class=programs><span style="mso-spacerun: yes">     
</span>out.write(&quot;\r\n&quot;);</p>

<p class=programs><span style="mso-spacerun: yes">     
</span>out.write(&quot;no\r\n&quot;);</p>

<p class=cbasetext><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=cbasetext>---------------------</p>

<p class=cbasetext>Now in place of the '=' sign in the JSP file and enter
out.println (&quot;no&quot;);</p>

<p class=cbasetext><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=programs>e3.jsp</p>

<p class=programs>hi</p>

<p class=programs>&lt;% out.println(&quot;no&quot;); %&gt;</p>

<p class=programs>bye</p>

<p class=programs>------------------------</p>

<p class=programs><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=programs><span style="mso-spacerun: yes">     
</span>out.write(&quot;hi\r\n&quot;);</p>

<p class=programs><span style="mso-spacerun: yes">     
</span>out.println(&quot;no&quot;); </p>

<p class=programs><span style="mso-spacerun: yes">     
</span>out.write(&quot;\r\n&quot;);</p>

<p class=programs><span style="mso-spacerun: yes">     
</span>out.write(&quot;bye\r\n&quot;);</p>

<p class=programs>---------------------</p>

<p class=programs><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=cbasetext>Now remove the '=' sign in the JSP file and write
out.println (&quot;no&quot;); Since there is no '=' sign, the jspengine does
not add its own out.print. This jsp statement is introduced in the file as is
for the JSP engine assumes it to be Java code. This means that if you do not
write good Java code here, you will get horrible errors. This happens when
javac compiles the Java program. They will be displayed in your Java server
window. </p>

<p class=cbasetext><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=cbasetext>This implies that whenever you put an '=' sign, you must use
something that will be converted to a string in Java. This is because the
out.print that is added takes only a single string as its parameter. </p>

<p class=cbasetext><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=cbasetext>Hence bye is enclosed within double quotes. Try giving it
without quotes and you will be presented with an error. The bye is assumed to
be a variable. If you put a semicolon then it takes the semicolon as a part of
the double quotes. There is supposed to be no space between the % and =. It
must be typed in like this, &lt;%= </p>

<p class=cbasetext><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=cbasetext>In a nutshell, we have html code and then there are Java
Server Pages, where we have html, and Java code within that html. The html tags
and text are saved to disk and the Java code comes as is. Thus in a jsp program
we get to mix html and java code. All the java code written so far can be
placed in a jsp program along with html but within the &lt;% tag. </p>

<p class=cbasetext><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=programs>e4.jsp</p>

<p class=programs>hi</p>

<p class=programs>&lt;%= bye %&gt;</p>

<p class=programs>no</p>

<p class=cbasetext><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=cbasetext>No Output in Browser</p>

<p class=cbasetext>The server log shows the following:</p>

<p class=cbasetext><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=programs>[#|2004-10-18T15:16:38.239+0530|SEVERE|sun-appserver-pe8.0|org.apache.jasper.compiler.Compiler|_ThreadID=11;|Env:
Compile:
javaFileName=/C:/Sun/AppServer/domains/domain1/generated/jsp/j2ee-modules/zzz//org/apache/jsp\e4_jsp.java</p>

<p class=programs><span style="mso-spacerun: yes">   
</span>classpath=/C:/Sun/AppServer/domains/domain1/applications/j2ee-modules/zzz/WEB-INF/classes/;C:\Sun\AppServer\domains\domain1\generated\jsp\j2ee-modules\zzz;/C:/Sun/AppServer/domains/domain1/applications/j2ee-modules/zzz/WEB-INF/classes/;</p>

<p class=programs><span style="mso-spacerun: yes">   
</span>cp=C:\Sun\AppServer\lib\commons-launcher.jar;C:\Sun\AppServer\lib\activation.jar;C:\Sun\AppServer\lib\appserv-cmp.jar;C:\Sun\AppServer\lib\j2ee-svc.jar;C:\Sun\AppServer\lib\jaxr-api.jar;C:\Sun\AppServer\lib\admin-cli.jar;C:\Sun\AppServer\lib\appserv-admin.jar;C:\Sun\AppServer\lib\appserv-jstl.jar;C:\Sun\AppServer\lib\commons-logging.jar;C:\Sun\AppServer\lib\jax-qname.jar;C:\Sun\AppServer\lib\jaxr-impl.jar;C:\Sun\AppServer\lib\jaxrpc-api.jar;C:\Sun\AppServer\lib\jaxrpc-impl.jar;C:\Sun\AppServer\lib\mail.jar;C:\Sun\AppServer\lib\relaxngDatatype.jar;C:\Sun\AppServer\lib\saaj-api.jar;C:\Sun\AppServer\lib\saaj-impl.jar;C:\Sun\AppServer\lib\xsdlib.jar;C:\Sun\AppServer\lib\appserv-rt.jar;C:\Sun\AppServer\lib\jsf-api.jar;C:\Sun\AppServer\lib\jsf-impl.jar;C:\Sun\AppServer\lib\appserv-upgrade.jar;C:\Sun\AppServer\lib\appserv-ext.jar;C:\Sun\AppServer\lib\j2ee.jar;C:/Sun/AppServer/jdk/lib/tools.jar;C:/Sun/AppServer/lib/install/applications/jmsra/imqjmsra.jar;C:/Sun/AppServer/imq/lib/jaxm-api.jar;C:/Sun/AppServer/imq/lib/fscontext.jar;C:/Sun/AppServer/lib/ant/lib/ant.jar;C:/Sun/AppServer/pointbase/lib/pbclient.jar;C:/Sun/AppServer/pointbase/lib/pbembedded.jar</p>

<p class=programs><span style="mso-spacerun: yes">   
</span>cp=C:\Sun\AppServer\domains\domain1\applications\j2ee-modules\zzz\WEB-INF\classes</p>

<p class=programs><span style="mso-spacerun: yes">   
</span>cp=C:\Sun\AppServer\domains\domain1\generated\jsp\j2ee-modules\zzz</p>

<p class=programs><span style="mso-spacerun: yes">   
</span>cp=C:\Sun\AppServer\domains\domain1\applications\j2ee-modules\zzz\WEB-INF\classes</p>

<p class=programs><span style="mso-spacerun: yes">    </span>work
dir=C:\Sun\AppServer\domains\domain1\generated\jsp\j2ee-modules\zzz</p>

<p class=programs><span style="mso-spacerun: yes">    </span>extension
dir=C:/Sun/AppServer/jdk/jre/lib/ext;C:/Sun/AppServer/domains/domain1/lib/ext</p>

<p class=programs><span style="mso-spacerun: yes">   
</span>srcDir=C:\Sun\AppServer\domains\domain1\generated\jsp\j2ee-modules\zzz</p>

<p class=programs><span style="mso-spacerun: yes">   
</span>include=org/apache/jsp/e4_jsp.java</p>

<p class=programs>|#]</p>

<p class=programs><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=programs>[#|2004-10-18T15:16:38.239+0530|SEVERE|sun-appserver-pe8.0|org.apache.jasper.compiler.Compiler|_ThreadID=11;|Error
compiling file: /C:/Sun/AppServer/domains/domain1/generated/jsp/j2ee-modules/zzz//org/apache/jsp\e4_jsp.java<span
style="mso-spacerun: yes">     </span>[javac] Compiling 1 source file</p>

<p class=programs><span style="mso-spacerun: yes">    </span>[javac]
C:\Sun\AppServer\domains\domain1\generated\jsp\j2ee-modules\zzz\org\apache\jsp\e4_jsp.java:44:
cannot resolve symbol</p>

<p class=programs><span style="mso-spacerun: yes"> </span><span
style="mso-spacerun: yes">   </span>[javac] symbol<span style="mso-spacerun:
yes">  </span>: variable bye </p>

<p class=programs><span style="mso-spacerun: yes">    </span>[javac] location:
class org.apache.jsp.e4_jsp</p>

<p class=programs><span style="mso-spacerun: yes">    </span>[javac]<span
style="mso-spacerun: yes">       </span>out.print( bye );</p>

<p class=programs><span style="mso-spacerun: yes">    </span>[javac]<span
style="mso-spacerun: yes">                  </span>^</p>

<p class=programs><span style="mso-spacerun: yes">    </span>[javac] 1 error</p>

<p class=programs><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=programs>|#]</p>

<p class=cbasetext><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=cbasetext>Here it assumed that bye was a variable and the error is
detected by javac on compiling the servlet generated by the jsp engine.</p>

<p class=cbasetext><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=cbasetext>Moving on to the next example, where we are now writing
System.out.println(&quot;no&quot;) within the % tag. </p>

<p class=cbasetext><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=programs>e5.jsp</p>

<p class=programs>hi</p>

<p class=programs>&lt;% System.out.println(&quot;no&quot;); %&gt;</p>

<p class=programs>bye</p>

<p class=programs><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=programs>Output in Server log</p>

<p class=programs>[#|2004-10-18T17:23:58.625+0530|INFO|sun-appserver-pe8.0|javax.enterprise.system.stream.out|_ThreadID=12;|</p>

<p class=programs>no|#]</p>

<p class=programs>---------</p>

<p class=programs><span style="mso-spacerun: yes">     
</span>out.write(&quot;hi\r\n&quot;);</p>

<p class=programs><span style="mso-spacerun:
yes"> </span>System.out.println(&quot;no&quot;); </p>

<p class=programs><span style="mso-spacerun: yes">     
</span>out.write(&quot;\r\n&quot;);</p>

<p class=programs><span style="mso-spacerun: yes">     
</span>out.write(&quot;bye\r\n&quot;);</p>

<p class=programs>-------</p>

<p class=cbasetext><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=cbasetext>There is no '=' following the %, so it is included as it is
in the Java file. The 'no' will not be shown on your screen but in the server's
log. To display something on the screen, you can't use System.out.println,
instead you must use out.println. </p>

<p class=cbasetext><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=cbasetext>If you carefully study the code, you will observe that there
are nine variables created and one of them is out. Hence in JSP you are allowed
to use out and you can use any of these seven variables in your program. These
are the predefined objects available to you. System.out.println can also be
used anywhere in a jsp tag as it is a valid java statement. Do not forget the
terminating semicolon as java code written in a tag is added verbatim to the
function _jspx_service().</p>

<p class=cbasetext><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=programs><span style="mso-spacerun: yes">    </span>JspFactory
_jspxFactory = null;</p>

<p class=programs><span style="mso-spacerun: yes">    </span>PageContext pageContext
= null;</p>

<p class=programs><span style="mso-spacerun: yes">    </span>HttpSession
session = null;</p>

<p class=programs><span style="mso-spacerun: yes">    </span>ServletContext
application = null;</p>

<p class=programs><span style="mso-spacerun: yes">    </span>ServletConfig
config = null;</p>

<p class=programs><span style="mso-spacerun: yes">    </span>JspWriter out =
null;</p>

<p class=programs><span style="mso-spacerun: yes">    </span>Object page =
this;</p>

<p class=programs><span style="mso-spacerun: yes">    </span>JspWriter
_jspx_out = null;</p>

<p class=programs><span style="mso-spacerun: yes">    </span>PageContext
_jspx_page_context = null;</p>

<p class=cbasetext><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=cbasetext>JSP Declarations</p>

<p class=cbasetext><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=cbasetext>A JSP declaration can be thought of as the definition of
class level variables and methods that are to be used throughout the page.</p>

<p class=cbasetext><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=cbasetext>In the next example, we have hi and then bye. The JSP code
begins with int j preceded by an exclamation, and thereafter it has int i with
a semicolon. </p>

<p class=cbasetext><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=programs>e6.jsp</p>

<p class=programs>hi</p>

<p class=programs>&lt;%! int j; %&gt;</p>

<p class=programs>bye</p>

<p class=programs>&lt;% int i; %&gt;</p>

<p class=cbasetext><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=cbasetext>Whenever anything is put in an exclamation it is called a
declaration. This is done outside any function but within the class that is
public. The line int j comes up when your class starts with {. </p>

<p class=programs>-----------</p>

<p class=programs>public final class e6_jsp extends
org.apache.jasper.runtime.HttpJspBase</p>

<p class=programs><span style="mso-spacerun: yes">    </span>implements
org.apache.jasper.runtime.JspSourceDependent {</p>

<p class=programs><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=programs><span style="mso-spacerun: yes"> </span>int j;</p>

<p class=programs>-----------</p>

<p class=cbasetext>Whenever you put any statement in &lt;%, it is placed in jspservice
and becomes local. </p>

<p class=programs>----------</p>

<p class=programs><span style="mso-spacerun: yes">     
</span>out.write(&quot;hi\r\n&quot;);</p>

<p class=programs><span style="mso-spacerun: yes">     
</span>out.write(&quot;\r\n&quot;);</p>

<p class=programs><span style="mso-spacerun: yes">     
</span>out.write(&quot;bye\r\n&quot;);</p>

<p class=programs><span style="mso-spacerun: yes"> </span>int i; </p>

<p class=programs><span style="mso-spacerun: yes">      </span>out.write('\r');</p>

<p class=programs><span style="mso-spacerun: yes">      </span>out.write('\n');</p>

<p class=programs>--------------</p>

<p class=cbasetext>It is visible from then onwards. If you want to make a variable
global then use an exclamation. You can create functions and global variables
in a class. Unlike C, where 'global' is applicable to the file, here it is
limited to a class. </p>

<p class=cbasetext><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=cbasetext>Now we will mix java with html code. </p>

<p class=cbasetext><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=programs>e7.jsp</p>

<p class=programs>hi</p>

<p class=programs>&lt;% int i = 6;</p>

<p class=programs>if ( i == 6 ) %&gt;</p>

<p class=programs>bye</p>

<p class=programs><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=programs>-------------------</p>

<p class=programs><span style="mso-spacerun: yes">     
</span>out.write(&quot;hi\r\n&quot;);</p>

<p class=programs><span style="mso-spacerun: yes"> </span>int i = 6;</p>

<p class=programs>if ( i == 6 ) </p>

<p class=programs><span style="mso-spacerun: yes">     
</span>out.write(&quot;\r\n&quot;);</p>

<p class=programs><span style="mso-spacerun: yes">     
</span>out.write(&quot;bye\r\n&quot;);</p>

<p class=programs>-------------------</p>

<p class=cbasetext><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=cbasetext><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=cbasetext>At first, the variable i which is of type int is initialized
to the value 6. Then the if statement checks to see if i == 6. The next line
after the comments will print bye only if i holds the value 6, otherwise it
will do nothing. Since the bye is pure html, we have to end the jsp tag and
close the JSP scriptlet. The final code looks like this, if (i == 6)
out.println (&quot;bye&quot;); What ever is given in &lt;% %&gt; is kept as it
is.</p>

<p class=cbasetext><span style="mso-spacerun: yes"> </span></p>

<p class=cbasetext>But what is the purpose of all this? This is a method of
generating dynamic code. The Perl family of scripting languages generates the
entire page. The focus is on Perl writing the entire html page whereas ASP,
PHP, JSP opted to have an html page where the code would be inserted. In the
html page, you can put ASP, PHP or Java code to give the page dynamism and free
yourself of the tedium of trying to create every possible page the visitor must
be shown by hand. The file that you are writing is an html file, which means
you can use an existing html editor. </p>

<p class=cbasetext><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=cbasetext>For Java Server Pages, servlets are the foundation.
Normally, a web page has a static template i.e. things which are permanent.
With JSP, you separate the static and the dynamic, and insert dynamism into a
web page. We will also use beans extensively in the Java Server Pages and one
of the chapters will explain to you how you can create your own custom tags. </p>

<p class=cbasetext><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=cbasetext>A JSP page is a text-based document that describes how to
process a request and create a response. </p>

<p class=cbasetext><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=cbasetext>JSP pages in servlet classes are what Sun calls its web
components and these pages are delivered by a JSP container. When you look at a
JSP page, you will see 3 classes of scripting elements. These are declarations,
scriptlets and expressions.</p>

<p class=cbasetext><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=cbasetext>The following example has been taken from the Net from a
great FAQ that we stumbled upon. We don't mind if you take our programs too. We
have not mentioned any names here because there were too many brains behind it.
</p>

<p class=cbasetext><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=programs>e8.jsp</p>

<p class=programs>&lt;% for (int i = 1; i&lt;= 4 ; i++) { %&gt;</p>

<p class=programs>&lt;H&lt;%=i%&gt;&gt;Hello&lt;/H&lt;%=i%&gt;&gt;</p>

<p class=programs>&lt;% } %&gt;</p>

<p class=programs>hi</p>

<p class=cbasetext><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=cbasetext>The code looks complicated but you can easily understand it.</p>

<p class=cbasetext><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=cbasetext>The for statement goes on four times. Since the for
statement is not part of html, it is enclosed within the % and the angle
brackets. The '{' bracket starts the for loop. The set of statements to be
executed within the for is a combination of HTML and JSP. H is an html tag that
stands for heading. Along with H is a number that displays the heading in a
different format. We have not used a number directly because we want it to be
the value of i. i is a variable initialized in the for loop. The &lt;%= is used
to display the value of i which is 1 as of now. Hence the tag becomes H1.
Following this is Hello. To close the tag, the same rules are followed, the
closing tag becomes &lt;/H1&gt;. The '}' bracket within the % and the angle
brackets is used to close the for loop. When i becomes 2, the statement will be
&lt;H2&gt;Hello&lt;/H2&gt; and the same follows for 3 and 4. This is how Hello
can be seen in all 4 tags. </p>

<p class=cbasetext><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=cbasetext>View the actual code in the Java file and you will realize
that it is much easier to comprehend. </p>

<p class=programs>---------</p>

<p class=programs>for (int i = 1; i&lt;= 4 ; i++) { </p>

<p class=programs><span style="mso-spacerun: yes">     
</span>out.write(&quot;\r\n&quot;);</p>

<p class=programs><span style="mso-spacerun: yes">     
</span>out.write(&quot;&lt;H&quot;);</p>

<p class=programs><span style="mso-spacerun: yes">      </span>out.print(i);</p>

<p class=programs><span style="mso-spacerun: yes">     
</span>out.write(&quot;&gt;Hello&lt;/H&quot;);</p>

<p class=programs><span style="mso-spacerun: yes">      </span>out.print(i);</p>

<p class=programs><span style="mso-spacerun: yes">     
</span>out.write('&gt;');</p>

<p class=programs><span style="mso-spacerun: yes">      </span>out.write('\r');</p>

<p class=programs><span style="mso-spacerun: yes">      </span>out.write('\n');</p>

<p class=programs><span style="mso-spacerun: yes"> </span>} </p>

<p class=programs><span style="mso-spacerun: yes">     
</span>out.write(&quot;\r\n&quot;);</p>

<p class=programs><span style="mso-spacerun: yes">     
</span>out.write(&quot;hi\r\n&quot;);</p>

<p class=programs>----------------</p>

<p class=programs><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=programs>View Source</p>

<p class=programs><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=programs>&lt;H1&gt;Hello&lt;/H1&gt;</p>

<p class=programs><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=programs>&lt;H2&gt;Hello&lt;/H2&gt;</p>

<p class=programs><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=programs>&lt;H3&gt;Hello&lt;/H3&gt;</p>

<p class=programs><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=programs>&lt;H4&gt;Hello&lt;/H4&gt;</p>

<p class=programs><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=programs>hi</p>

<p class=cbasetext><span style='color:#FF6600'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=cbasetext><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=cbasetext>Let's go one step further, give two hyphens after %.
Whenever you start with a &lt;%- and end it with -%&gt;, it signals a comment. </p>

<p class=cbasetext><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=programs>e9.jsp</p>

<p class=programs>hi</p>

<p class=programs>&lt;%- vijay mukhi -%&gt;</p>

<p class=programs>bye</p>

<p class=cbasetext><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=cbasetext>Comments are not visible hence they can be safely ignored.
They are present only in the JSP file and will not be seen in the servlet.
Comments given in the jsp file get hidden from the client as it is on the
server. In case you do want comments, then use of html comments &lt;!-<span
style="mso-spacerun: yes">  </span>would be more appropriate.</p>

<p class=cbasetext><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=cbasetext>JSP Directives</p>

<p class=cbasetext><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=cbasetext>A JSP Directive is a statement that gives the JSP engine
information for the page that follows. Anything with a &lt;%@ sign is called a
Directive. In the following program, we have used a directive named page. The
other possible directives in JSP1.0 are include and taglib. </p>

<p class=cbasetext><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=programs>e10.jsp</p>

<p class=programs>&lt;%@ page info=&quot;vijay&quot; %&gt;</p>

<p class=programs><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=programs>public String getServletInfo() {</p>

<p class=programs>return &quot;vijay&quot;;</p>

<p class=programs>}</p>

<p class=cbasetext><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=cbasetext><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=cbasetext>The compiler generates different kinds of code depending upon
the directive you use. The effects are global. Here we say page info=vijay. A
page is a directive and info is an attribute. The attribute is given a value;
vijay in this case. On doing so, the JSP engine actually creates a function
named getServletinfo and this function returns the value given to info i.e.
vijay. </p>

<p class=cbasetext><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=programs>e11.jsp</p>

<p class=programs>hi</p>

<p class=programs>&lt;%@ page import=&quot;java.applet.*&quot; %&gt;</p>

<p class=programs><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=programs>-------</p>

<p class=programs>import javax.servlet.*;</p>

<p class=programs>import javax.servlet.http.*;</p>

<p class=programs>import javax.servlet.jsp.*;</p>

<p class=programs>import java.applet.*;</p>

<p class=programs><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=programs>----------</p>

<p class=programs><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=cbasetext>When you give import as an attribute and then look at the
Java generated file, you will see that at the end of the imports, there is
import java.applet.*. You don't have to put a semicolon. This means that if you
are a referring to some Java code in some classes, you don't have to preface
them i.e. give full names, you just put imports. In case you have more than one
import, then separate them using commas, they will all be added at the end. If
there are two similar imports, it is not considered an error. A point to be
noted here is that if the match is found earlier in the file, then the import
added by you is not used. </p>

<p class=cbasetext><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=programs>e12.jsp</p>

<p class=programs>hi</p>

<p class=programs>&lt;%@ page extends=&quot;java.util.Dictionary&quot; %&gt;</p>

<p class=programs>-------------------------</p>

<p class=programs>public final class e12_jsp extends java.util.Dictionary</p>

<p class=programs><span style="mso-spacerun: yes">    </span>implements org.apache.jasper.runtime.JspSourceDependent
{</p>

<p class=programs>-------------</p>

<p class=cbasetext><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=cbasetext>Normally, extends is not used because by default every class
extends HttpJspBase. But if you do so then HttpJspBase is replaced with java.util.Dictionary.
At times, when you want to write complicated code then you can have a class
that is derived from HttpJspBase, from which you can further extend your
classes. You must derive from HttpJspBase or else you will end up with a load
of errors. </p>

<p class=cbasetext><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=programs>e13.jsp</p>

<p class=programs>hi</p>

<p class=programs>&lt;%@ page implements=&quot;java.util.Dictionary&quot; %&gt;</p>

<p class=programs><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=programs>------</p>

<p class=programs>[#|2004-10-19T14:40:44.873+0530|SEVERE|sun-appserver-pe8.0|javax.enterprise.system.container.web|_ThreadID=13;|StandardWrapperValve[jsp]:
Servlet.service() for servlet jsp threw exception</p>

<p class=programs>org.apache.jasper.JasperException: /e13.jsp(2,0) Page
directive has invalid attribute: implements</p>

<p class=programs>----------</p>

<p class=cbasetext><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=cbasetext>Implements follows the same rules as that of extends. The
JSP engine adds a line to the class with implements. It gives an error and no
java file is generated as in this case as well, Dictionary is a class not an
interface.</p>

<p class=cbasetext><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=programs>e14.jsp</p>

<p class=programs>&lt;%@ page buffer=&quot;1000&quot; %&gt;</p>

<p class=programs>hi</p>

<p class=programs><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=programs>--------------</p>

<p class=programs>[#|2004-10-19T14:47:45.118+0530|SEVERE|sun-appserver-pe8.0|javax.enterprise.system.container.web|_ThreadID=11;|StandardWrapperValve[jsp]:
Servlet.service() for servlet jsp threw exception</p>

<p class=programs>org.apache.jasper.JasperException: /e14.jsp(1,1) Page
directive: invalid value for buffer</p>

<p class=programs>--------------</p>

<p class=cbasetext><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=cbasetext>Since we have given the buffer as 1000, the getPageContext
function makes the buffer parameter 1000KB i.e. 1000 multiplied by 1024. This
is the amount of buffering space required. Buffering improves speed since its
better to write a larger number of characters at one go than a small number
many times.</p>

<p class=cbasetext><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=cbasetext>You will have multiple requests being sent to your web
server. You may want either one instance of the servlet or you may want 20 of
them running at a time. If you want the servlet to create multiple instances of
itself then you must give isThreadsafe=false. The default is true.</p>

<p class=cbasetext><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=programs>e15.jsp</p>

<p class=programs>&lt;%@ page isThreadSafe=&quot;false&quot; %&gt;</p>

<p class=programs>&lt;b&gt;hi</p>

<p class=programs><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=programs>--------------------</p>

<p class=programs>public final class e15_jsp extends
org.apache.jasper.runtime.HttpJspBase</p>

<p class=programs><span style="mso-spacerun: yes">    </span>implements
org.apache.jasper.runtime.JspSourceDependent,</p>

<p class=programs><span style="mso-spacerun: yes">                
</span>SingleThreadModel {</p>

<p class=programs>-------------------</p>

<p class=cbasetext><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=cbasetext>By saying isThreadSafe=false, the JSP engine will implement
SingleThreadModel and it can load multiple instances of the servlet instead of
one. This class in that sense doesn't have any function prototypes and hence we
don't have to add any code in the file. It can however, check to see if we have
implemented certain interfaces.</p>

<p class=cbasetext><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=programs>e16.jsp</p>

<p class=programs>&lt;%@ page session=&quot;false&quot; %&gt;</p>

<p class=programs>Bye</p>

<p class=cbasetext><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=cbasetext><span style='color:windowtext'>Most of these attributes have
a default value of true or false, so you don't need to specify them. There is
one more attribute named session. By default, session is true,</span> </p>

<p class=cbasetext><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=cbasetext>The following are the variables that are created in the
_jspservice function:</p>

<p class=cbasetext><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=programs><span style="mso-spacerun: yes">    </span>JspFactory
_jspxFactory = null;</p>

<p class=programs><span style="mso-spacerun: yes">    </span>PageContext
pageContext = null;</p>

<p class=programs><span style="mso-spacerun: yes">    </span>HttpSession
session = null;</p>

<p class=programs><span style="mso-spacerun: yes">    </span>ServletContext
application = null;</p>

<p class=programs><span style="mso-spacerun: yes">    </span>ServletConfig
config = null;</p>

<p class=programs><span style="mso-spacerun: yes">    </span>JspWriter out =
null;</p>

<p class=programs><span style="mso-spacerun: yes">    </span>Object page =
this;</p>

<p class=programs><span style="mso-spacerun: yes">    </span>JspWriter
_jspx_out = null;</p>

<p class=programs><span style="mso-spacerun: yes">    </span>PageContext
_jspx_page_context = null;</p>

<p class=cbasetext><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=cbasetext>When you make the page session false, session that looks
like HttpSession, is not created at all.</p>

<p class=cbasetext><span style='color:windowtext'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=cbasetext>The next script has the contentType initialized to
text/plain. By default, the value assigned to this attribute is text/html. </p>

<p class=cbasetext><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=programs>e17.jsp</p>

<p class=programs>&lt;%@ page contentType=&quot;text/plain&quot; %&gt;</p>

<p class=programs>&lt;b&gt;Bye</p>

<p class=cbasetext><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=cbasetext>The tag b is not recognized by the browser anymore and thus
we see &lt;b&gt; Bye in the browser. The Content type depends upon the file
being sent over.</p>

<p class=cbasetext><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=programs><span style="mso-spacerun: yes">     
</span>response.setContentType(&quot;text/plain&quot;);</p>

<p class=cbasetext><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=cbasetext>If you initialize IsErrorPage to true, it will actually
create an object called exception that looks like Throwable. This is then initialized
by the getThrowable function.</p>

<p class=cbasetext><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=programs>e18.jsp</p>

<p class=programs>&lt;%@ page isErrorPage=&quot;true&quot; %&gt;</p>

<p class=programs>hi</p>

<p class=cbasetext><span style='color:#FF6600'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=programs>----------</p>

<p class=programs>Throwable exception =
org.apache.jasper.runtime.JspRuntimeLibrary.getThrowable(request);</p>

<p class=programs>-----------</p>

<p class=cbasetext><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=cbasetext>The request variable is given to us as a parameter in the jspservice
function. getAttribute takes one parameter which is a variable and returns a
value. Instead of a variable we call it an attribute. This is used to
initialize the new variable named exception which looks like jspException. The
concept of exceptions has already been discussed in one of the previous
chapters.</p>

<p class=cbasetext><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=programs>e19.jsp</p>

<p class=programs>&lt;%@ page errorPage=&quot;f1.jsp&quot; %&gt;</p>

<p class=programs>&lt;%@ page import=&quot;java.io.*&quot; %&gt;</p>

<p class=programs>&lt;html&gt;</p>

<p class=programs>&lt;%! void abc() throws IOException</p>

<p class=programs>{</p>

<p class=programs>throw new IOException(&quot;hi bye&quot;);</p>

<p class=programs>}</p>

<p class=programs>%&gt;</p>

<p class=programs><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=programs>&lt;%</p>

<p class=programs>//try</p>

<p class=programs>//{</p>

<p class=programs>abc();</p>

<p class=programs>//}</p>

<p class=programs>//catch ( Exception e) {}</p>

<p class=programs>%&gt;</p>

<p class=programs>&lt;/html&gt;</p>

<p class=cbasetext><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=cbasetext>If we stop here , we get the following error in the browser
window.</p>

<p class=cbasetext><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=programs>Error: 404</p>

<p class=programs>File not found</p>

<p class=cbasetext><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=cbasetext>Import saves us the trouble of typing too much. Here we have
a function named abc which has been defined in the public area. Thus the
declaration or the exclamation sign has been used. Basically, it throws an
IOException. The reason why we have page import=java.io* is because it is
easier to say IOException than java.io.IOException. The minute the function abc
is called, an exception will be thrown. Somebody has to be there to receive
this exception. </p>

<p class=cbasetext><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=cbasetext>We start by using page directive errorPage, which is also an
attribute and its value is a jsp file f1.jsp. If you look at the code you will
realize that it throws new HandleErrorPageException, which has f1.jsp as a
parameter. f1.jsp is your error page and because of this throw, it will now go
to f1.jsp. In abc we have a throw, we throw an IOException. Since an exception
is thrown, the catch in the servlet will catch it as the try and catch around
abc have been commented out. </p>

<p class=cbasetext><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=programs>------------------</p>

<p class=programs><span style="mso-spacerun: yes"> </span>void abc() throws
IOException</p>

<p class=programs>{</p>

<p class=programs>throw new IOException(&quot;hi bye&quot;);</p>

<p class=programs>}</p>

<p class=programs><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=programs><span style="mso-spacerun: yes">      </span>pageContext =
_jspxFactory.getPageContext(this, request, response,</p>

<p class=programs><span style="mso-spacerun: yes">      </span><span
style='mso-tab-count:3'>                         </span>&quot;f1.jsp&quot;,
true, 8192, true);</p>

<p class=programs>--------------</p>

<p class=programs>---------</p>

<p class=programs>Server log</p>

<p class=programs>[#|2004-10-19T15:18:49.028+0530|SEVERE|sun-appserver-pe8.0|javax.enterprise.system.container.web|_ThreadID=12;|StandardWrapperValve[jsp]:
Servlet.service() for servlet jsp threw exception</p>

<p class=programs>---------</p>

<p class=cbasetext><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=cbasetext>The servlet catch has HandleErrorPageException, where the
first parameter is f1.jsp and the last one is out. out is used to display
output. t is throwable as a parameter to catch. If you look at f1.jsp, it has
to start with isErrorPage=true and we use exception.printStackTrace to print
where the exception took place. </p>

<p class=cbasetext><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=programs>f1.jsp</p>

<p class=programs>&lt;%@ page isErrorPage=&quot;true&quot; %&gt;</p>

<p class=programs>&lt;%</p>

<p class=programs>out.println(&quot;&lt;pre&gt;&quot;);</p>

<p class=programs>java.io.PrintWriter pw = response.getWriter();</p>

<p class=programs>exception.printStackTrace(pw);</p>

<p class=programs>out.println(&quot;&lt;/pre&gt;&quot;);</p>

<p class=programs>%&gt;</p>

<p class=programs><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=programs>Output in browser window</p>

<p class=programs>java.io.IOException: hi bye at
org.apache.jsp.e19_jsp.abc(e19_jsp.java:13) at
org.apache.jsp.e19_jsp._jspService(e19_jsp.java:57) at
org.apache.jasper.runtime.HttpJspBase.service(HttpJspBase.java:141) at
javax.servlet.http.HttpServlet.service(HttpServlet.java:861) at org.apache.jasper.servlet.JspServletWrapper.service(JspServletWrapper.java:325)
at org.apache.jasper.servlet.JspServlet.serviceJspFile(JspServlet.java:306) at
org.apache.jasper.servlet.JspServlet.service(JspServlet.java:253) at
javax.servlet.http.HttpServlet.service(HttpServlet.java:861) at
sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method) at
sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:39)
at
sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:25)
at java.lang.reflect.Method.invoke(Method.java:324) at
org.apache.catalina.security.SecurityUtil$1.run(SecurityUtil.java:289) at
java.security.AccessController.doPrivileged(Native Method) at
javax.security.auth.Subject.doAsPrivileged(Subject.java:500) at
org.apache.catalina.security.SecurityUtil.execute(SecurityUtil.java:311) at
org.apache.catalina.security.SecurityUtil.doAsPrivilege(SecurityUtil.java:205)
at
org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:283)
at
org.apache.catalina.core.ApplicationFilterChain.access$000(ApplicationFilterChain.java:102)
at
org.apache.catalina.core.ApplicationFilterChain$1.run(ApplicationFilterChain.java:192)
at java.security.AccessController.doPrivileged(Native Method) at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:188)
at
org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:263)
at
org.apache.catalina.core.StandardValveContext.invokeNext(StandardValveContext.java:156)
at org.apache.catalina.core.StandardPipeline.invoke(StandardPipeline.java:569)
at
org.apache.catalina.core.StandardContextValve.invokeInternal(StandardContextValve.java:261)
at org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:215)
at
org.apache.catalina.core.StandardValveContext.invokeNext(StandardValveContext.java:156)
at org.apache.catalina.core.StandardPipeline.invoke(StandardPipeline.java:569)
at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:200)
at
org.apache.catalina.core.StandardValveContext.invokeNext(StandardValveContext.java:156)
at
org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:180)
at org.apache.catalina.core.StandardValveContext.invokeNext(StandardValveContext.java:154)
at org.apache.catalina.valves.AccessLogValve.invoke(AccessLogValve.java:582) at
org.apache.catalina.core.StandardValveContext.invokeNext(StandardValveContext.java:154)
at com.sun.enterprise.webservice.EjbWebServiceValve.invoke(EjbWebServiceValve.java:134)
at
org.apache.catalina.core.StandardValveContext.invokeNext(StandardValveContext.java:154)
at com.sun.enterprise.security.web.SingleSignOn.invoke(SingleSignOn.java:254)
at org.apache.catalina.core.StandardValveContext.invokeNext(StandardValveContext.java:154)
at
com.sun.enterprise.web.VirtualServerValve.invoke(VirtualServerValve.java:209)
at
org.apache.catalina.core.StandardValveContext.invokeNext(StandardValveContext.java:154)
at org.apache.catalina.core.StandardPipeline.invoke(StandardPipeline.java:569)
at
org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:161)
at
org.apache.catalina.core.StandardValveContext.invokeNext(StandardValveContext.java:156)
at com.sun.enterprise.web.VirtualServerMappingValve.invoke(VirtualServerMappingValve.java:166)
at
org.apache.catalina.core.StandardValveContext.invokeNext(StandardValveContext.java:154)
at org.apache.catalina.core.StandardPipeline.invoke(StandardPipeline.java:569)
at org.apache.catalina.core.ContainerBase.invoke(ContainerBase.java:979) at
org.apache.coyote.tomcat5.CoyoteAdapter.service(CoyoteAdapter.java:211) at
org.apache.coyote.http11.Http11Processor.process(Http11Processor.java:692) at
org.apache.coyote.http11.Http11Protocol$Http11ConnectionHandler.processConnection(Http11Protocol.java:647)
at org.apache.tomcat.util.net.TcpWorkerThread.runIt(PoolTcpEndpoint.java:589)
at
org.apache.tomcat.util.threads.ThreadPool$ControlRunnable.run(ThreadPool.java:691)
at java.lang.Thread.run(Thread.java:534)</p>

<p class=programs><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=programs>------------------</p>

<p class=programs>In _jspservice</p>

<p class=programs><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=programs><span style="mso-spacerun: yes">     
</span>out.write(&quot;\r\n&quot;);</p>

<p class=programs><span style="mso-spacerun: yes">     
</span>out.write(&quot;\r\n&quot;);</p>

<p class=programs><span style="mso-spacerun: yes">     
</span>out.write(&quot;&lt;html&gt;\r\n&quot;);</p>

<p class=programs><span style="mso-spacerun: yes">     
</span>out.write(&quot;\r\n&quot;);</p>

<p class=programs><span style="mso-spacerun: yes">     
</span>out.write(&quot;\r\n&quot;);</p>

<p class=programs><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=programs>//try</p>

<p class=programs>//{</p>

<p class=programs>abc();</p>

<p class=programs>//}</p>

<p class=programs>//catch ( Exception e) {}</p>

<p class=programs><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=programs><span style="mso-spacerun: yes">     
</span>out.write(&quot;\r\n&quot;);</p>

<p class=programs><span style="mso-spacerun: yes">     
</span>out.write(&quot;&lt;/html&gt;\r\n&quot;);</p>

<p class=cbasetext><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=cbasetext>Within the try and catch is abc, so the code of abc will be
called. You can have a 'try' and 'catch' within another 'try' and 'catch' pair,
nested as many levels deep as you want. abc throws an IOException, so the
exception will be called.</p>

<p class=cbasetext><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=programs>e19a.jsp</p>

<p class=programs>&lt;%@ page errorPage=&quot;f1.jsp&quot; %&gt;</p>

<p class=programs>&lt;%@ page import=&quot;java.io.*&quot; %&gt;</p>

<p class=programs>&lt;html&gt;</p>

<p class=programs>&lt;%! void abc() throws IOException</p>

<p class=programs>{</p>

<p class=programs>throw new IOException(&quot;hi bye&quot;);</p>

<p class=programs>}</p>

<p class=programs>%&gt;</p>

<p class=programs>&lt;%</p>

<p class=programs>try</p>

<p class=programs>{</p>

<p class=programs>abc();</p>

<p class=programs>}</p>

<p class=programs>catch ( Exception e) </p>

<p class=programs>{</p>

<p class=programs>System.out.println(&quot;hi in exception&quot;);</p>

<p class=programs>}</p>

<p class=programs>%&gt;</p>

<p class=programs>&lt;/html&gt; </p>

<p class=cbasetext><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=cbasetext>Now that we have uncommented the try and catch near abc, the
earlier catch was not called and in the web server log we see hi in exception,
which proves that only the inner try catch was activated.</p>

<p class=programs>------------</p>

<p class=programs>[#|2004-10-19T15:54:27.463+0530|INFO|sun-appserver-pe8.0|javax.enterprise.system.stream.out|_ThreadID=12;|</p>

<p class=programs>hi in exception|#]</p>

<p class=programs>-----------</p>

<p class=cbasetext><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=programs>e20.jsp</p>

<p class=programs>hi</p>

<p class=programs>&lt;%@ include file=&quot;aa.html&quot; %&gt;</p>

<p class=programs>Bye</p>

<p class=cbasetext><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=programs>C:\jswdk-1.0.1\examples\jsp&gt;edit aa.html</p>

<p class=programs>in aa.html</p>

<p class=programs><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=programs>Output in browser</p>

<p class=programs>hi in aa.html Bye </p>

<p class=cbasetext><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=cbasetext>A @ in a JSP file signals a directive. The earlier examples
had 'page', while in the program shown above, we use include. include takes a
string which has to be filename which is aa.html here. e20.jsp contains hi,
then the include and finally a bye. aa.html simply contains 'In aa.html'. </p>

<p class=cbasetext><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=cbasetext>As always, your entire JSP is converted into a servlet. </p>

<p class=cbasetext><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=programs><span style="mso-spacerun: yes">     
</span>out.write(&quot;hi\r\n&quot;);</p>

<p class=programs><span style="mso-spacerun: yes">     
</span>out.write(&quot;in aa.html&quot;);</p>

<p class=programs><span style="mso-spacerun: yes">     
</span>out.write(&quot;\r\n&quot;);</p>

<p class=programs><span style="mso-spacerun: yes">     
</span>out.write(&quot;Bye\r\n&quot;);</p>

<p class=cbasetext><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=cbasetext>The phase while creating a servlet is called the Translation
Phase. You can change aa.html, add some more text and then refresh the server.
The new text within the html file will not be displayed because the servlet is
not regenerated.</p>

<p class=cbasetext><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=cbasetext>The only way to incorporate changes is by either recompiling
the Java file or restarting the server. When the server shuts down ,it deletes
all the generated files in the domain, so also all files are created from
scratch when you want to view them.</p>

<p class=cbasetext><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=cbasetext>There are two phases in JSP. One of them is the Translation
Phase, which it happens only once. Then, the service function 'jspservice' is
called for every request. </p>

<p class=cbasetext><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=cbasetext>So far we have included a .html file, so now let's try it
out with JSP. </p>

<p class=cbasetext><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=programs>e21.jsp</p>

<p class=programs>hi</p>

<p class=programs>&lt;%@ include file=&quot;aa.jsp&quot; %&gt;</p>

<p class=programs>Bye</p>

<p class=programs><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=programs>aa.jsp</p>

<p class=programs>no</p>

<p class=programs>&lt;%= new java.util.Date() %&gt;</p>

<p class=programs>lousy</p>

<p class=cbasetext><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=cbasetext>There is no java file generated for aa.jsp.</p>

<p class=programs>-------------</p>

<p class=programs><span style="mso-spacerun: yes">     
</span>out.write(&quot;hi\r\n&quot;);</p>

<p class=programs><span style="mso-spacerun: yes">     
</span>out.write(&quot;no\r\n&quot;);</p>

<p class=programs><span style="mso-spacerun: yes">      </span>out.print( new
java.util.Date() );</p>

<p class=programs><span style="mso-spacerun: yes">     
</span>out.write(&quot;\r\n&quot;);</p>

<p class=programs><span style="mso-spacerun: yes">     
</span>out.write(&quot;lousy\r\n&quot;);</p>

<p class=programs><span style="mso-spacerun: yes">     
</span>out.write(&quot;\r\n&quot;);</p>

<p class=programs><span style="mso-spacerun: yes">     
</span>out.write(&quot;Bye\r\n&quot;);</p>

<p class=programs>---------------</p>

<p class=cbasetext>With this example you will realize that if you have JSP code
with the include directory, then it gets inserted in the service function. For
dynamism, create a JSP file and use it with the include directive. Now each time
you click on refresh the date function will be reexecuted, thus displaying a
different date and time. </p>

<p class=cbasetext><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=cbasetext>Let's go one step further. </p>

<p class=cbasetext><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=programs>e22.jsp</p>

<p class=programs>hi</p>

<p class=programs>&lt;jsp:include page=&quot;zz.jsp&quot;
flush=&quot;true&quot; /&gt;</p>

<p class=programs>bye</p>

<p class=programs><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=programs>zz.jsp</p>

<p class=programs>no</p>

<p class=programs>bad</p>

<p class=cbasetext><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=cbasetext>The first line in e22.jsp has hi and the second line is
jsp:include page=&quot;zz.jsp&quot; within angle brackets. If you notice there
is no % sign like we had earlier. This is termed as 'action'. Each time you
refresh the file, the server is requested for that file. </p>

<p class=cbasetext><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=programs>-----------------</p>

<p class=programs><span style="mso-spacerun: yes">     
</span>out.write(&quot;hi\r\n&quot;);</p>

<p class=programs><span style="mso-spacerun: yes">     
</span>org.apache.jasper.runtime.JspRuntimeLibrary.include(request, response,
&quot;zz.jsp&quot;, out, true);</p>

<p class=programs><span style="mso-spacerun: yes">     
</span>out.write(&quot;\r\n&quot;);</p>

<p class=programs><span style="mso-spacerun: yes">     
</span>out.write(&quot;bye\r\n&quot;);</p>

<p class=programs>----------------</p>

<p class=cbasetext><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=cbasetext>However, the glitch here is that with include as an action,
you cannot have Java code nor can you change the headers and cookies.</p>

<p class=cbasetext><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=programs>e23.jsp</p>

<p class=programs>hi</p>

<p class=programs>&lt;jsp:include page=&quot;a40.html&quot;
flush=&quot;true&quot; /&gt;</p>

<p class=programs>bye</p>

<p class=programs><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=programs>a40.html</p>

<p class=programs>bye</p>

<p class=programs><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=programs>In e23.jsp, the first line is hi. Then a40.html, which
contains bye, is included. </p>

<p class=programs>----------</p>

<p class=programs><span style="mso-spacerun: yes">     
</span>out.write(&quot;hi\r\n&quot;);</p>

<p class=programs><span style="mso-spacerun: yes">      </span>org.apache.jasper.runtime.JspRuntimeLibrary.include(request,
response, &quot;a40.html&quot;, out, true);</p>

<p class=programs><span style="mso-spacerun: yes">     
</span>out.write(&quot;\r\n&quot;);</p>

<p class=programs><span style="mso-spacerun: yes">     
</span>out.write(&quot;bye\r\n&quot;);</p>

<p class=programs>----------</p>

<p class=cbasetext><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=cbasetext>Replace 'bye' in the html file with 'over' and click on
refresh. This time you will see over instead of bye. include here is an action.</p>

<p class=cbasetext><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=cbasetext>In the next script, we have a new action called forward. </p>

<p class=cbasetext><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=programs>e24.jsp</p>

<p class=programs>hi</p>

<p class=programs>&lt;jsp:forward page=&quot;cc.jsp&quot; /&gt;</p>

<p class=programs>bye</p>

<p class=programs><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=programs>cc.jsp</p>

<p class=programs>no</p>

<p class=programs>&lt;%= new java.util.Date() %&gt;</p>

<p class=programs>lousy</p>

<p class=cbasetext><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=cbasetext>This example introduces a new action named forward.
page=cc.jsp implies that a page is sent with the file. Hence every time you try
to load e24.jsp, you will be forwarded to cc.jsp. Forward becomes
_jspx_page_context.forward in the Java file. </p>

<p class=cbasetext><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=cbasetext>A valid question to ask here would be, 'will it come back to
e24.jsp?' The answer is no. That's because the last line before the closing
brace is a return. So whenever you have forward as an action, the file given to
_jspx_page_context.forward becomes your active html file, everything else is
forgotten. </p>

<p class=cbasetext><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=programs>e24_jsp.java</p>

<p class=programs>-----------------------------</p>

<p class=programs><span style="mso-spacerun: yes"> 
</span>out.write(&quot;hi\r\n&quot;);</p>

<p class=programs><span style="mso-spacerun: yes">      </span>if (true) {</p>

<p class=programs><span style="mso-spacerun: yes">       
</span>_jspx_page_context.forward(&quot;cc.jsp&quot;);</p>

<p class=programs><span style="mso-spacerun: yes">        </span>return;</p>

<p class=programs><span style="mso-spacerun: yes">      </span>}</p>

<p class=programs><span style="mso-spacerun: yes">     
</span>out.write(&quot;\r\n&quot;);</p>

<p class=programs><span style="mso-spacerun: yes">     
</span>out.write(&quot;bye\r\n&quot;);</p>

<p class=programs>--------------------</p>

<p class=programs><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=programs><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=programs>cc_jsp.java</p>

<p class=programs>----------------</p>

<p class=programs><span style="mso-spacerun: yes">      </span>out.write(&quot;no\r\n&quot;);</p>

<p class=programs><span style="mso-spacerun: yes">      </span>out.print( new
java.util.Date() );</p>

<p class=programs><span style="mso-spacerun: yes">     
</span>out.write(&quot;\r\n&quot;);</p>

<p class=programs><span style="mso-spacerun: yes">     
</span>out.write(&quot;lousy\r\n&quot;);</p>

<p class=programs>------------------</p>

<p class=cbasetext><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=cbasetext>Bear in mind that the http protocol is a stateless protocol.
Each time you connect to the web server you are disconnected after you receive
the page. So if you are on the Amazon.com site and you buy 6 books, moving from
one page to the other, it becomes a session and this session has to be tracked.
This is where the session object comes into use.</p>

<p class=cbasetext><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=programs>z.htm</p>

<p class=programs>&lt;html&gt;</p>

<p class=programs>&lt;form action=e25.jsp&gt;</p>

<p class=programs>&lt;input type='text' name='aa'&gt;</p>

<p class=programs>&lt;input type='submit' value='click'&gt;</p>

<p class=programs>&lt;/form&gt;</p>

<p class=programs>&lt;/html&gt;</p>

<p class=programs><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=programs>e25.jsp</p>

<p class=programs>&lt;%= request.getParameter(&quot;aa&quot;) %&gt;</p>

<p class=cbasetext><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=cbasetext>Open the htm file in browser </p>

<p class=cbasetext><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=programs><a href="http://localhost:8080/zzz/z.htm"><span
style='color:windowtext;text-decoration:none;text-underline:none'>http://localhost:8080/zzz/z.htm</span></a></p>

<p class=cbasetext><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=cbasetext>Enter abc in the text box and click on the button. The net
result is that abc is displayed in the browser and in the address bar of the
browser changes to:</p>

<p class=cbasetext><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=programs><a href="http://localhost:8080/zzz/e25.jsp?aa=abc"><span
style='color:windowtext;text-decoration:none;text-underline:none'>http://localhost:8080/zzz/e25.jsp?aa=abc</span></a></p>

<p class=cbasetext><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=cbasetext>Further, to read data from a form, the request object is
used, therefore request.getParameter(&quot;aa&quot;).<span style="mso-spacerun:
yes">  </span>Here aa is some name associated with a control in the form. </p>

<p class=cbasetext>This returns abc as the text box was filled with abc. </p>

<p class=cbasetext><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=cbasetext>The form has an action attribute which is initialized to a
.jsp file. As a result, the JSP code on the server is executed when the user
clicks on the submit button. The net effect is that a new page comes up with
the appendage of ?aa=abc to the url and the value 'abc' is displayed on the screen.</p>

<p class=cbasetext><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=programs>-----------------</p>

<p class=programs><span style="mso-spacerun: yes">      </span>out.print(
request.getParameter(&quot;aa&quot;) );</p>

<p class=programs>-----------------</p>

<p class=cbasetext><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=cbasetext>In CGI programming, when the button named submit is clicked,
the browser looks for a tag named form with an attribute named action. It then
creates a url with action and add a ?. Thereafter it takes all the input
statements, figures out the value given to each of them and converts then to a
name value pair seperated by '=', as in</p>

<p class=cbasetext>aa=abc. The benefit of using JSP is that it becomes easy to
extract these values, thereby making it the preferred tool for Web programmers.
</p>

<p class=cbasetext><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=cbasetext>In the following example we have created two functions, one
named jspInit and the other named jspDestroy. </p>

<p class=cbasetext><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=programs>e26.jsp</p>

<p class=programs>&lt;%!</p>

<p class=programs>public void jspInit()</p>

<p class=programs>{</p>

<p class=programs>super.jspInit();</p>

<p class=programs>System.out.println(&quot;jspinit&quot;);</p>

<p class=programs>}</p>

<p class=programs>public void jspDestroy()</p>

<p class=programs>{</p>

<p class=programs>super.jspDestroy();</p>

<p class=programs>System.out.println(&quot;jspdestroy&quot;);</p>

<p class=programs>}</p>

<p class=programs>%&gt;</p>

<p class=programs>hi</p>

<p class=programs><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=programs>server log</p>

<p class=programs>[#|2004-10-20T14:24:05.790+0530|INFO|sun-appserver-pe8.0|javax.enterprise.system.stream.out|_ThreadID=13;|</p>

<p class=programs>jspinit|#]</p>

<p class=cbasetext><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=cbasetext>Whenever a class extends HttpJspBase, the service function
within HttpJspBase is called. This service calls jspInit once and only once,
when the class is loaded or initialized. It is not like _jspservice, which is
called multiple times. jspDestroy is called when the servlet is destroyed. We have
ot create our own jspInit when variables are to be initialized or when a
certain chunk of code is to be executed in a one time job. Similarly jspDestroy
can be used to release the memory used by variables or do end processing task.
It is but difficult to pin point as to when jspDestroy will be called. </p>

<p class=cbasetext>Super is used to call the code in the original class. </p>

<p class=cbasetext><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=cbasetext>In the next script, we have response.sendRedirect with a
url. The job of this function is to redirect the user to the site that has been
passed as a parameter. The redirected page then becomes the active Page. </p>

<p class=cbasetext><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=programs>e27.jsp</p>

<p class=programs>&lt;%
response.sendRedirect(&quot;http://127.0.0.1:8080/zzz/e1.jsp&quot;); %&gt;</p>

<p class=programs><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=programs>Generally there should be no text before or after
sendRedirect as it does not get displayed. </p>

<p class=programs>------------</p>

<p class=programs>response.sendRedirect(&quot;http://127.0.0.1:8080/zzz/e1.jsp&quot;);</p>

<p class=programs>------------</p>

<p class=programs><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=programs>e28.jsp</p>

<p class=programs>hi &lt;p&gt; bye</p>

<p class=programs>&lt;%
response.sendRedirect(&quot;http://127.0.0.1:8080/zzz/e1.jsp&quot;); %&gt;</p>

<p class=programs>no &lt;p&gt; good</p>

<p class=programs><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=programs>http://127.0.0.1:8080/zzz/e1.jsp</p>

<p class=programs><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=programs>The address bar in the browser displays the new url, thus implying
that the browser requested for a new file from the given url.</p>

<p class=programs><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=programs>------------------------</p>

<p class=programs><span style="mso-spacerun: yes">     
</span>out.write(&quot;hi &lt;p&gt; bye\r\n&quot;);</p>

<p class=programs><span style="mso-spacerun:
yes"> </span>response.sendRedirect(&quot;http://127.0.0.1:8080/zzz/e1.jsp&quot;);
</p>

<p class=programs><span style="mso-spacerun: yes">     
</span>out.write(&quot;\r\n&quot;);</p>

<p class=programs><span style="mso-spacerun: yes">     
</span>out.write(&quot;no &lt;p&gt; good\r\n&quot;);</p>

<p class=programs>-------------------------</p>

<p class=cbasetext><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=cbasetext>Every http page starts with a header. Normally, it will be
200 OK. 200 is called the http status code. There are around 20 to 30
predefined status codes, where 200 means OK, 404 is file not found and so on.
Redirection has a status code of 304. </p>

<p class=cbasetext><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=cbasetext>In the next script, we have response.setStatus. </p>

<p class=cbasetext><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=programs>e29.jsp</p>

<p class=programs>&lt;%</p>

<p class=programs>response.setStatus(HttpServletResponse.SC_MOVED_PERMANENTLY);</p>

<p class=programs>response.setHeader(&quot;Location&quot;,&quot;/zzz/e1.jsp&quot;);</p>

<p class=programs>%&gt;</p>

<p class=programs><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=programs>-----------------</p>

<p class=programs>response.setStatus(HttpServletResponse.SC_MOVED_PERMANENTLY);</p>

<p class=programs>response.setHeader(&quot;Location&quot;,&quot;/zzz/e1.jsp&quot;);</p>

<p class=programs>-----------------</p>

<p class=cbasetext><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=cbasetext>SC_MOVED_PERMANENTLY is a status code informing the browser
to read the next header line because the file has been moved. The next line sets
the header variable Location to a location or a url from where the file is to
be picked up. With response.sendRedirect or setStatus, the status code is sent
over to the client with more information in the header, whereupon the browser
asks for the new file. As a result, the user sees e1.jsp. </p>

<p class=cbasetext><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=cbasetext>Now let's take a case where we want the user to visit a
certain page, barring which he will not be allowed to browse our site.
Something similar to a login page, unless the user doesn't sign in, he can't
browse through the rest of the site. </p>

<p class=cbasetext><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=programs>e30.jsp</p>

<p class=programs>&lt;%@ page session=&quot;true&quot; %&gt;</p>

<p class=programs>login</p>

<p class=programs>&lt;%</p>

<p class=programs>HttpSession s = request.getSession(true);</p>

<p class=programs>if ( s.getValue(&quot;EID&quot;) == null )</p>

<p class=programs>{</p>

<p class=programs>String s1 = (String )
response.encodeRedirectUrl(&quot;e31.jsp?Origin=e30.jsp&quot;);</p>

<p class=programs>System.out.println(s1);</p>

<p class=programs>response.sendRedirect(s1);</p>

<p class=programs>}</p>

<p class=programs>else</p>

<p class=programs>out.println(&quot;&lt;h1&gt;hi&quot;);</p>

<p class=programs>%&gt;</p>

<p class=programs><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=programs>e31.jsp</p>

<p class=programs>&lt;%</p>

<p class=programs>session.putValue(&quot;EID&quot;,&quot;sonal&quot;);</p>

<p class=programs>String s1=(String)</p>

<p class=programs>response.encodeRedirectURL(request.getParameter(&quot;Origin&quot;));</p>

<p class=programs>System.out.println(&quot;e31 &quot; + s1);</p>

<p class=programs>response.sendRedirect(s1);</p>

<p class=programs>%&gt;</p>

<p class=cbasetext><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=cbasetext>The browser shows.</p>

<p class=programs>login </p>

<p class=programs>hi </p>

<p class=cbasetext><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=programs>server log</p>

<p class=programs>[#|2004-10-20T14:48:32.699+0530|INFO|sun-appserver-pe8.0|javax.enterprise.system.stream.out|_ThreadID=13;|</p>

<p class=programs>e31.jsp?Origin=e30.jsp|#]</p>

<p class=programs><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=programs>[#|2004-10-20T14:48:58.806+0530|INFO|sun-appserver-pe8.0|javax.enterprise.system.stream.out|_ThreadID=13;|</p>

<p class=programs>e31 e30.jsp|#]</p>

<p class=cbasetext><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=cbasetext>Here we have two files, e30.jsp and e31.jsp. The directive,
page session=&quot;true&quot;, is not required but is retained. Then is the
text login. Following this is s, a variable that looks like HttpSession and it
is initialized to the return value of request.getSession. This function returns
details of the current session. It may be noted that getSession will either
create a new session or will return a handle to the current session. </p>

<p class=cbasetext><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=cbasetext>Of all the variables, we are currently interested in the
value of the variable EID (given in caps). As of now since the variable is not
declared, it will be null. </p>

<p class=cbasetext><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=cbasetext>The next line of response.encodeRedirectUrl creates a url of
the string given within the brackets and stores it in s1. It is response.sendRedirect
that calss for e31.jsp</p>

<p class=cbasetext><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=cbasetext>In e31.jsp, session.putValue creates the variable EID and
initializes it to 'sonal'. request.getParameter then returns the value of
Origin, which is e30.jsp, and as before response.encodeRedirectUrl convert it
into a url. Finally, there is a redirection to e30.jsp again. </p>

<p class=cbasetext><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=cbasetext>Now, within e30.jsp, the variable EID has a value, thus the
else block is called and hi is displayed. This further goes to prove that both
s and the session are the same. </p>

<p class=cbasetext><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=cbasetext>Thus, as long as it is the same user on the website, he will
not have to login twice. But, when the user shuts down the browser and starts
another copy, the entire process has to be repeated. The next program provides
further insight into sessions.</p>

<p class=cbasetext><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=programs>e32.jsp</p>

<p class=programs>&lt;%@ page session=&quot;true&quot; %&gt;</p>

<p class=programs>hi</p>

<p class=programs>&lt;%</p>

<p class=programs>HttpSession s = request.getSession(true);</p>

<p class=programs>s.putValue(&quot;vij&quot;,&quot;sonal&quot;);</p>

<p class=programs>%&gt;</p>

<p class=programs><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=programs>e33.jsp</p>

<p class=programs>&lt;%@ page session=&quot;true&quot; %&gt;</p>

<p class=programs>Bye</p>

<p class=programs>&lt;%</p>

<p class=programs>HttpSession s = request.getSession(true);</p>

<p class=programs>%&gt;</p>

<p class=programs>&lt;%= s.getValue(&quot;vij&quot;) %&gt;</p>

<p class=cbasetext><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=cbasetext>In e32.jsp, request.getSession returns the current session
handle which is stored in s. Then s.putValue creates 'vij' if not present and
initializes it to 'sonal'. </p>

<p class=cbasetext><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=cbasetext>In e33.jsp, s is a handle to HttpSession. Since the session
is the same, s.getValue of vij will return 'sonal'.</p>

<p class=cbasetext><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=cbasetext>Start with executing e33.jsp. The output will be bye and
null because at the moment vij has no value. Thereafter, run e32.jsp and it
will display hi on the screen. Now once again reload e33.jsp. You will see 'Bye
sonal' displayed on your screen. </p>

<p class=cbasetext><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=cbasetext>The point to be noted here is that there are two types of
objects, implicit objects and explicit objects. Session and out are examples of
implicit objects; they are already created. The explicit objects are not
created by default, they have to be created and initialized. </p>

<p class=cbasetext><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=cbasetext>We move on to the next example. Applets are not allowed to
write data to disk but with servlets no such rules apply. The next example
confirms this.</p>

<p class=cbasetext><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=programs>e34.jsp</p>

<p class=programs>&lt;%@ page import=&quot;java.io.*&quot;
isErrorPage=&quot;true&quot; %&gt;</p>

<p class=programs>&lt;%</p>

<p class=programs>try</p>

<p class=programs>{</p>

<p class=programs>PrintWriter p=new PrintWriter(new
FileOutputStream(&quot;pp.txt&quot;));</p>

<p class=programs>p.println(&quot;hi&quot;);</p>

<p class=programs>p.close();</p>

<p class=programs>}</p>

<p class=programs>catch ( Exception e) {</p>

<p class=programs>e.printStackTrace();</p>

<p class=programs>}</p>

<p class=programs>%&gt;</p>

<p class=cbasetext><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=cbasetext>FileOutputStream is used when a file is opened in output mode
i.e. for writing. However if the file is not present on the disk, it gets
created. Thus file pp.txt is created on the hard disk. Now, to write to this
file, a file handle is required. This is achieved using the PrintWriter which
return a handle to the open file.</p>

<p class=cbasetext><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=cbasetext>p thus becomes a handle to pp.txt. Then p.println with
(&quot;hi&quot;) as a paramter write the text to the file. You have an option
of giving the complete path along with the filename, or use the default, which
is the C:\Sun\AppServer\domains\domain1\config. </p>

<p class=cbasetext><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=cbasetext>Similarly, to read from a file, FileInputStream is used
instead of FileOutputStream. </p>

<p class=cbasetext><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=programs>‘type pp.txt' in C:\Sun\AppServer\domains\domain1\config, and
it will display hi on the screen.</p>

<p class=cbasetext><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=cbasetext>For the grand finale of this chapter, we have one last
example.</p>

<p class=cbasetext><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=programs>e35.jsp</p>

<p class=programs>&lt;%@ page import=&quot;java.util.*&quot; %&gt;</p>

<p class=programs>&lt;%!</p>

<p class=programs>ServletConfig cfg;</p>

<p class=programs>public void jspInit()</p>

<p class=programs>{</p>

<p class=programs>cfg = getServletConfig();</p>

<p class=programs>for ( Enumeration e = cfg.getInitParameterNames();
e.hasMoreElements();){</p>

<p class=programs>String name = (String) e.nextElement();</p>

<p class=programs>String value = cfg.getInitParameter(name);</p>

<p class=programs>System.out.println(name+&quot;=..&quot;+value);</p>

<p class=programs>}</p>

<p class=programs>}</p>

<p class=programs>%&gt;</p>

<p class=programs><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=programs>[#|2004-10-20T14:59:43.534+0530|INFO|sun-appserver-pe8.0|javax.enterprise.system.stream.out|_ThreadID=15;|</p>

<p class=programs>xpoweredBy=..true|#]</p>

<p class=programs><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=programs>[#|2004-10-20T14:59:43.554+0530|INFO|sun-appserver-pe8.0|javax.enterprise.system.stream.out|_ThreadID=15;|</p>

<p class=programs>logVerbosityLevel=..warning|#]</p>

<p class=cbasetext><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=cbasetext>getServletConfig enables us to preview the parameters set by
the Java Web Server. This function returns an object that looks like
ServletConfig(). Further, cfg.getInitParameterNames() returns an enumeration
which in turn has a member hasMoreElements. e.nextElement then gives the name
of the element and getInitParameter along with the name will emit its value.
They are all stored as a name-value pair. </p>

<p class=cbasetext><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=cbasetext>Conclusion</p>

<p class=cbasetext><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=cbasetext>Java Server Pages bring together the power of Java Servlets
and HTML coding thereby give the developers a powerful method to create
Server-Side web applications. In this chapter, we learnt the following: </p>

<p class=cbasetext><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=cbasetext>A Java Server Page file consists of HTML tags, content, JSP
directives, JSP declarations, JSP scriptlets and action tags. Initially, the
JSP engine parses the JSP file and then generates a new servlet with the
desired content. If the file changes, then a new servlet is generated;
otherwise, the compiled version is used. </p>

</div>

</body>


<!-- Mirrored from www.vijaymukhi.com/documents/updatedbooks/j2ee/chap5.htm by HTTrack Website Copier/3.x [XR&CO'2014], Fri, 11 Oct 2024 14:39:33 GMT -->
</html>
